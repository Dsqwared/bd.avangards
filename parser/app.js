console.log('working');

function q(e) {
    throw e
}

function y(e, t, n) {
    4 !== t.length && q(new sjcl.exception.invalid("invalid aes block size"));
    var r = e.b[n],
        i = t[0] ^ r[0],
        s = t[n ? 3 : 1] ^ r[1],
        o = t[2] ^ r[2];
    t = t[n ? 1 : 3] ^ r[3];
    var u, a, f, l = r.length / 4 - 2,
        c, h = 4,
        p = [0, 0, 0, 0];
    u = e.k[n], e = u[0];
    var d = u[1],
        v = u[2],
        m = u[3],
        g = u[4];
    for (c = 0; c < l; c++) u = e[i >>> 24] ^ d[s >> 16 & 255] ^ v[o >> 8 & 255] ^ m[t & 255] ^ r[h], a = e[s >>> 24] ^ d[o >> 16 & 255] ^ v[t >> 8 & 255] ^ m[i & 255] ^ r[h + 1], f = e[o >>> 24] ^ d[t >> 16 & 255] ^ v[i >> 8 & 255] ^ m[s & 255] ^ r[h + 2], t = e[t >>> 24] ^ d[i >> 16 & 255] ^ v[s >> 8 & 255] ^ m[o & 255] ^ r[h + 3], h += 4, i = u, s = a, o = f;
    for (c = 0; 4 > c; c++) p[n ? 3 & -c : c] = g[i >>> 24] << 24 ^ g[s >> 16 & 255] << 16 ^ g[o >> 8 & 255] << 8 ^ g[t & 255] ^ r[h++], u = i, i = s, s = o, o = t, t = u;
    return p
}

function z(e, t) {
    var n, r, i, s = t.slice(0),
        o = e.r,
        u = e.b,
        a = o[0],
        f = o[1],
        l = o[2],
        c = o[3],
        h = o[4],
        p = o[5],
        d = o[6],
        v = o[7];
    for (n = 0; 64 > n; n++) 16 > n ? r = s[n] : (r = s[n + 1 & 15], i = s[n + 14 & 15], r = s[n & 15] = (r >>> 7 ^ r >>> 18 ^ r >>> 3 ^ r << 25 ^ r << 14) + (i >>> 17 ^ i >>> 19 ^ i >>> 10 ^ i << 15 ^ i << 13) + s[n & 15] + s[n + 9 & 15] | 0), r = r + v + (h >>> 6 ^ h >>> 11 ^ h >>> 25 ^ h << 26 ^ h << 21 ^ h << 7) + (d ^ h & (p ^ d)) + u[n], v = d, d = p, p = h, h = c + r | 0, c = l, l = f, f = a, a = r + (f & l ^ c & (f ^ l)) + (f >>> 2 ^ f >>> 13 ^ f >>> 22 ^ f << 30 ^ f << 19 ^ f << 10) | 0;
    o[0] = o[0] + a | 0, o[1] = o[1] + f | 0, o[2] = o[2] + l | 0, o[3] = o[3] + c | 0, o[4] = o[4] + h | 0, o[5] = o[5] + p | 0, o[6] = o[6] + d | 0, o[7] = o[7] + v | 0
}

function C(e, t) {
    var n, r = sjcl.random.w[e],
        i = [];
    for (n in r) r.hasOwnProperty(n) && i.push(r[n]);
    for (n = 0; n < i.length; n++) i[n](t)
}

function E(e) {
    window && window.performance && "function" == typeof window.performance.now ? sjcl.random.addEntropy(window.performance.now(), e, "loadtime") : sjcl.random.addEntropy((new Date).valueOf(), e, "loadtime")
}

function A(e) {
    e.b = B(e).concat(B(e)), e.A = new sjcl.cipher.aes(e.b)
}

function B(e) {
    for (var t = 0; 4 > t && (e.f[t] = e.f[t] + 1 | 0, !e.f[t]); t++);
    return e.A.encrypt(e.f)
}

function D(e, t) {
    return function() {
        t.apply(e, arguments)
    }
}
var requirejs, require, define;
(function(global) {
    function isFunction(e) {
        return ostring.call(e) === "[object Function]"
    }

    function isArray(e) {
        return ostring.call(e) === "[object Array]"
    }

    function each(e, t) {
        if (e) {
            var n;
            for (n = 0; n < e.length; n += 1)
                if (e[n] && t(e[n], n, e)) break
        }
    }

    function eachReverse(e, t) {
        if (e) {
            var n;
            for (n = e.length - 1; n > -1; n -= 1)
                if (e[n] && t(e[n], n, e)) break
        }
    }

    function hasProp(e, t) {
        return hasOwn.call(e, t)
    }

    function getOwn(e, t) {
        return hasProp(e, t) && e[t]
    }

    function eachProp(e, t) {
        var n;
        for (n in e)
            if (hasProp(e, n) && t(e[n], n)) break
    }

    function mixin(e, t, n, r) {
        return t && eachProp(t, function(t, i) {
            if (n || !hasProp(e, i)) r && typeof t != "string" ? (e[i] || (e[i] = {}), mixin(e[i], t, n, r)) : e[i] = t
        }), e
    }

    function bind(e, t) {
        return function() {
            return t.apply(e, arguments)
        }
    }

    function scripts() {
        return document.getElementsByTagName("script")
    }

    function getGlobal(e) {
        if (!e) return e;
        var t = global;
        return each(e.split("."), function(e) {
            t = t[e]
        }), t
    }

    function makeError(e, t, n, r) {
        var i = new Error(t + "\nhttp://requirejs.org/docs/errors.html#" + e);
        return i.requireType = e, i.requireModules = r, n && (i.originalError = n), i
    }

    function newContext(e) {
        function d(e) {
            var t, n;
            for (t = 0; e[t]; t += 1) {
                n = e[t];
                if (n === ".") e.splice(t, 1), t -= 1;
                else if (n === "..") {
                    if (t === 1 && (e[2] === ".." || e[0] === "..")) break;
                    t > 0 && (e.splice(t - 1, 2), t -= 2)
                }
            }
        }

        function v(e, t, n) {
            var r, i, s, u, a, f, l, c, h, p, v, m = t && t.split("/"),
                g = m,
                y = o.map,
                b = y && y["*"];
            e && e.charAt(0) === "." && (t ? (getOwn(o.pkgs, t) ? g = m = [t] : g = m.slice(0, m.length - 1), e = g.concat(e.split("/")), d(e), i = getOwn(o.pkgs, r = e[0]), e = e.join("/"), i && e === r + "/" + i.main && (e = r)) : e.indexOf("./") === 0 && (e = e.substring(2)));
            if (n && (m || b) && y) {
                u = e.split("/");
                for (a = u.length; a > 0; a -= 1) {
                    l = u.slice(0, a).join("/");
                    if (m)
                        for (f = m.length; f > 0; f -= 1) {
                            s = getOwn(y, m.slice(0, f).join("/"));
                            if (s) {
                                s = getOwn(s, l);
                                if (s) {
                                    c = s, h = a;
                                    break
                                }
                            }
                        }
                    if (c) break;
                    !p && b && getOwn(b, l) && (p = getOwn(b, l), v = a)
                }!c && p && (c = p, h = v), c && (u.splice(0, h, c), e = u.join("/"))
            }
            return e
        }

        function m(e) {
            isBrowser && each(scripts(), function(t) {
                if (t.getAttribute("data-requiremodule") === e && t.getAttribute("data-requirecontext") === r.contextName) return t.parentNode.removeChild(t), !0
            })
        }

        function g(e) {
            var t = getOwn(o.paths, e);
            if (t && isArray(t) && t.length > 1) return m(e), t.shift(), r.require.undef(e), r.require([e]), !0
        }

        function y(e) {
            var t, n = e ? e.indexOf("!") : -1;
            return n > -1 && (t = e.substring(0, n), e = e.substring(n + 1, e.length)), [t, e]
        }

        function b(e, t, n, i) {
            var s, o, u, a, f = null,
                c = t ? t.name : null,
                d = e,
                m = !0,
                g = "";
            return e || (m = !1, e = "_@r" + (h += 1)), a = y(e), f = a[0], e = a[1], f && (f = v(f, c, i), o = getOwn(l, f)), e && (f ? o && o.normalize ? g = o.normalize(e, function(e) {
                return v(e, c, i)
            }) : g = v(e, c, i) : (g = v(e, c, i), a = y(g), f = a[0], g = a[1], n = !0, s = r.nameToUrl(g))), u = f && !o && !n ? "_unnormalized" + (p += 1) : "", {
                prefix: f,
                name: g,
                parentMap: t,
                unnormalized: !!u,
                url: s,
                originalName: d,
                isDefine: m,
                id: (f ? f + "!" + g : g) + u
            }
        }

        function w(e) {
            var t = e.id,
                n = getOwn(u, t);
            return n || (n = u[t] = new r.Module(e)), n
        }

        function E(e, t, n) {
            var r = e.id,
                i = getOwn(u, r);
            hasProp(l, r) && (!i || i.defineEmitComplete) ? t === "defined" && n(l[r]) : w(e).on(t, n)
        }

        function S(e, t) {
            var n = e.requireModules,
                r = !1;
            t ? t(e) : (each(n, function(t) {
                var n = getOwn(u, t);
                n && (n.error = e, n.events.error && (r = !0, n.emit("error", e)))
            }), r || req.onError(e))
        }

        function x() {
            globalDefQueue.length && (apsp.apply(f, [f.length - 1, 0].concat(globalDefQueue)), globalDefQueue = [])
        }

        function T(e) {
            delete u[e]
        }

        function N(e, t, n) {
            var r = e.map.id;
            e.error ? e.emit("error", e.error) : (t[r] = !0, each(e.depMaps, function(r, i) {
                var s = r.id,
                    o = getOwn(u, s);
                o && !e.depMatched[i] && !n[s] && (getOwn(t, s) ? (e.defineDep(i, l[s]), e.check()) : N(o, t, n))
            }), n[r] = !0)
        }

        function C() {
            var e, n, i, a, f = o.waitSeconds * 1e3,
                l = f && r.startTime + f < (new Date).getTime(),
                c = [],
                h = [],
                p = !1,
                d = !0;
            if (t) return;
            t = !0, eachProp(u, function(t) {
                e = t.map, n = e.id;
                if (!t.enabled) return;
                e.isDefine || h.push(t);
                if (!t.error)
                    if (!t.inited && l) g(n) ? (a = !0, p = !0) : (c.push(n), m(n));
                    else if (!t.inited && t.fetched && e.isDefine) {
                    p = !0;
                    if (!e.prefix) return d = !1
                }
            });
            if (l && c.length) return i = makeError("timeout", "Load timeout for modules: " + c, null, c), i.contextName = r.contextName, S(i);
            d && each(h, function(e) {
                N(e, {}, {})
            }), (!l || a) && p && (isBrowser || isWebWorker) && !s && (s = setTimeout(function() {
                s = 0, C()
            }, 50)), t = !1
        }

        function k(e) {
            hasProp(l, e[0]) || w(b(e[0], null, !0)).init(e[1], e[2])
        }

        function L(e, t, n, r) {
            e.detachEvent && !isOpera ? r && e.detachEvent(r, t) : e.removeEventListener(n, t, !1)
        }

        function A(e) {
            var t = e.currentTarget || e.srcElement;
            return L(t, r.onScriptLoad, "load", "onreadystatechange"), L(t, r.onScriptError, "error"), {
                node: t,
                id: t && t.getAttribute("data-requiremodule")
            }
        }

        function O() {
            var e;
            x();
            while (f.length) {
                e = f.shift();
                if (e[0] === null) return S(makeError("mismatch", "Mismatched anonymous define() module: " + e[e.length - 1]));
                k(e)
            }
        }
        var t, n, r, i, s, o = {
                waitSeconds: 7,
                baseUrl: "./",
                paths: {},
                pkgs: {},
                shim: {},
                map: {},
                config: {}
            },
            u = {},
            a = {},
            f = [],
            l = {},
            c = {},
            h = 1,
            p = 1;
        return i = {
            require: function(e) {
                return e.require ? e.require : e.require = r.makeRequire(e.map)
            },
            exports: function(e) {
                e.usingExports = !0;
                if (e.map.isDefine) return e.exports ? e.exports : e.exports = l[e.map.id] = {}
            },
            module: function(e) {
                return e.module ? e.module : e.module = {
                    id: e.map.id,
                    uri: e.map.url,
                    config: function() {
                        return o.config && getOwn(o.config, e.map.id) || {}
                    },
                    exports: l[e.map.id]
                }
            }
        }, n = function(e) {
            this.events = getOwn(a, e.id) || {}, this.map = e, this.shim = getOwn(o.shim, e.id), this.depExports = [], this.depMaps = [], this.depMatched = [], this.pluginMaps = {}, this.depCount = 0
        }, n.prototype = {
            init: function(e, t, n, r) {
                r = r || {};
                if (this.inited) return;
                this.factory = t, n ? this.on("error", n) : this.events.error && (n = bind(this, function(e) {
                    this.emit("error", e)
                })), this.depMaps = e && e.slice(0), this.errback = n, this.inited = !0, this.ignore = r.ignore, r.enabled || this.enabled ? this.enable() : this.check()
            },
            defineDep: function(e, t) {
                this.depMatched[e] || (this.depMatched[e] = !0, this.depCount -= 1, this.depExports[e] = t)
            },
            fetch: function() {
                if (this.fetched) return;
                this.fetched = !0, r.startTime = (new Date).getTime();
                var e = this.map;
                if (!this.shim) return e.prefix ? this.callPlugin() : this.load();
                r.makeRequire(this.map, {
                    enableBuildCallback: !0
                })(this.shim.deps || [], bind(this, function() {
                    return e.prefix ? this.callPlugin() : this.load()
                }))
            },
            load: function() {
                var e = this.map.url;
                c[e] || (c[e] = !0, r.load(this.map.id, e))
            },
            check: function() {
                if (!this.enabled || this.enabling) return;
                var e, t, n = this.map.id,
                    i = this.depExports,
                    s = this.exports,
                    o = this.factory;
                if (!this.inited) this.fetch();
                else if (this.error) this.emit("error", this.error);
                else if (!this.defining) {
                    this.defining = !0;
                    if (this.depCount < 1 && !this.defined) {
                        if (isFunction(o)) {
                            if (this.events.error) try {
                                s = r.execCb(n, o, i, s)
                            } catch (a) {
                                e = a
                            } else s = r.execCb(n, o, i, s);
                            this.map.isDefine && (t = this.module, t && t.exports !== undefined && t.exports !== this.exports ? s = t.exports : s === undefined && this.usingExports && (s = this.exports));
                            if (e) return e.requireMap = this.map, e.requireModules = [this.map.id], e.requireType = "define", S(this.error = e)
                        } else s = o;
                        this.exports = s, this.map.isDefine && !this.ignore && (l[n] = s, req.onResourceLoad && req.onResourceLoad(r, this.map, this.depMaps)), delete u[n], this.defined = !0
                    }
                    this.defining = !1, this.defined && !this.defineEmitted && (this.defineEmitted = !0, this.emit("defined", this.exports), this.defineEmitComplete = !0)
                }
            },
            callPlugin: function() {
                var e = this.map,
                    t = e.id,
                    n = b(e.prefix);
                this.depMaps.push(n), E(n, "defined", bind(this, function(n) {
                    var i, s, a, f = this.map.name,
                        l = this.map.parentMap ? this.map.parentMap.name : null,
                        c = r.makeRequire(e.parentMap, {
                            enableBuildCallback: !0
                        });
                    if (this.map.unnormalized) {
                        n.normalize && (f = n.normalize(f, function(e) {
                            return v(e, l, !0)
                        }) || ""), s = b(e.prefix + "!" + f, this.map.parentMap), E(s, "defined", bind(this, function(e) {
                            this.init([], function() {
                                return e
                            }, null, {
                                enabled: !0,
                                ignore: !0
                            })
                        })), a = getOwn(u, s.id), a && (this.depMaps.push(s), this.events.error && a.on("error", bind(this, function(e) {
                            this.emit("error", e)
                        })), a.enable());
                        return
                    }
                    i = bind(this, function(e) {
                        this.init([], function() {
                            return e
                        }, null, {
                            enabled: !0
                        })
                    }), i.error = bind(this, function(e) {
                        this.inited = !0, this.error = e, e.requireModules = [t], eachProp(u, function(e) {
                            e.map.id.indexOf(t + "_unnormalized") === 0 && T(e.map.id)
                        }), S(e)
                    }), i.fromText = bind(this, function(n, s) {
                        var u = e.name,
                            a = b(u),
                            f = useInteractive;
                        s && (n = s), f && (useInteractive = !1), w(a), hasProp(o.config, t) && (o.config[u] = o.config[t]);
                        try {
                            req.exec(n)
                        } catch (l) {
                            return S(makeError("fromtexteval", "fromText eval for " + t + " failed: " + l, l, [t]))
                        }
                        f && (useInteractive = !0), this.depMaps.push(a), r.completeLoad(u), c([u], i)
                    }), n.load(e.name, c, i, o)
                })), r.enable(n, this), this.pluginMaps[n.id] = n
            },
            enable: function() {
                this.enabled = !0, this.enabling = !0, each(this.depMaps, bind(this, function(e, t) {
                    var n, s, o;
                    if (typeof e == "string") {
                        e = b(e, this.map.isDefine ? this.map : this.map.parentMap, !1, !this.skipMap), this.depMaps[t] = e, o = getOwn(i, e.id);
                        if (o) {
                            this.depExports[t] = o(this);
                            return
                        }
                        this.depCount += 1, E(e, "defined", bind(this, function(e) {
                            this.defineDep(t, e), this.check()
                        })), this.errback && E(e, "error", this.errback)
                    }
                    n = e.id, s = u[n], !hasProp(i, n) && s && !s.enabled && r.enable(e, this)
                })), eachProp(this.pluginMaps, bind(this, function(e) {
                    var t = getOwn(u, e.id);
                    t && !t.enabled && r.enable(e, this)
                })), this.enabling = !1, this.check()
            },
            on: function(e, t) {
                var n = this.events[e];
                n || (n = this.events[e] = []), n.push(t)
            },
            emit: function(e, t) {
                each(this.events[e], function(e) {
                    e(t)
                }), e === "error" && delete this.events[e]
            }
        }, r = {
            config: o,
            contextName: e,
            registry: u,
            defined: l,
            urlFetched: c,
            defQueue: f,
            Module: n,
            makeModuleMap: b,
            nextTick: req.nextTick,
            configure: function(e) {
                e.baseUrl && e.baseUrl.charAt(e.baseUrl.length - 1) !== "/" && (e.baseUrl += "/");
                var t = o.pkgs,
                    n = o.shim,
                    i = {
                        paths: !0,
                        config: !0,
                        map: !0
                    };
                eachProp(e, function(e, t) {
                    i[t] ? t === "map" ? mixin(o[t], e, !0, !0) : mixin(o[t], e, !0) : o[t] = e
                }), e.shim && (eachProp(e.shim, function(e, t) {
                    isArray(e) && (e = {
                        deps: e
                    }), (e.exports || e.init) && !e.exportsFn && (e.exportsFn = r.makeShimExports(e)), n[t] = e
                }), o.shim = n), e.packages && (each(e.packages, function(e) {
                    var n;
                    e = typeof e == "string" ? {
                        name: e
                    } : e, n = e.location, t[e.name] = {
                        name: e.name,
                        location: n || e.name,
                        main: (e.main || "main").replace(currDirRegExp, "").replace(jsSuffixRegExp, "")
                    }
                }), o.pkgs = t), eachProp(u, function(e, t) {
                    !e.inited && !e.map.unnormalized && (e.map = b(t))
                }), (e.deps || e.callback) && r.require(e.deps || [], e.callback)
            },
            makeShimExports: function(e) {
                function t() {
                    var t;
                    return e.init && (t = e.init.apply(global, arguments)), t || e.exports && getGlobal(e.exports)
                }
                return t
            },
            makeRequire: function(t, n) {
                function s(o, a, f) {
                    var c, h, p;
                    return n.enableBuildCallback && a && isFunction(a) && (a.__requireJsBuild = !0), typeof o == "string" ? isFunction(a) ? S(makeError("requireargs", "Invalid require call"), f) : t && hasProp(i, o) ? i[o](u[t.id]) : req.get ? req.get(r, o, t) : (h = b(o, t, !1, !0), c = h.id, hasProp(l, c) ? l[c] : S(makeError("notloaded", 'Module name "' + c + '" has not been loaded yet for context: ' + e + (t ? "" : ". Use require([])")))) : (O(), r.nextTick(function() {
                        O(), p = w(b(null, t)), p.skipMap = n.skipMap, p.init(o, a, f, {
                            enabled: !0
                        }), C()
                    }), s)
                }
                return n = n || {}, mixin(s, {
                    isBrowser: isBrowser,
                    toUrl: function(e) {
                        var n, i, s = e.lastIndexOf("."),
                            o = e.split("/")[0],
                            u = o === "." || o === "..";
                        return s !== -1 && (!u || s > 1) && (n = e.substring(s, e.length), e = e.substring(0, s)), i = r.nameToUrl(v(e, t && t.id, !0), n || ".fake"), n ? i : i.substring(0, i.length - 5)
                    },
                    defined: function(e) {
                        return hasProp(l, b(e, t, !1, !0).id)
                    },
                    specified: function(e) {
                        return e = b(e, t, !1, !0).id, hasProp(l, e) || hasProp(u, e)
                    }
                }), t || (s.undef = function(e) {
                    x();
                    var n = b(e, t, !0),
                        r = getOwn(u, e);
                    delete l[e], delete c[n.url], delete a[e], r && (r.events.defined && (a[e] = r.events), T(e))
                }), s
            },
            enable: function(e) {
                var t = getOwn(u, e.id);
                t && w(e).enable()
            },
            completeLoad: function(e) {
                var t, n, r, i = getOwn(o.shim, e) || {},
                    s = i.exports;
                x();
                while (f.length) {
                    n = f.shift();
                    if (n[0] === null) {
                        n[0] = e;
                        if (t) break;
                        t = !0
                    } else n[0] === e && (t = !0);
                    k(n)
                }
                r = getOwn(u, e);
                if (!t && !hasProp(l, e) && r && !r.inited) {
                    if (o.enforceDefine && (!s || !getGlobal(s))) {
                        if (g(e)) return;
                        return S(makeError("nodefine", "No define call for " + e, null, [e]))
                    }
                    k([e, i.deps || [], i.exportsFn])
                }
                C()
            },
            nameToUrl: function(e, t) {
                var n, r, i, s, u, a, f, l, c;
                if (req.jsExtRegExp.test(e)) l = e + (t || "");
                else {
                    n = o.paths, r = o.pkgs, u = e.split("/");
                    for (a = u.length; a > 0; a -= 1) {
                        f = u.slice(0, a).join("/"), i = getOwn(r, f), c = getOwn(n, f);
                        if (c) {
                            isArray(c) && (c = c[0]), u.splice(0, a, c);
                            break
                        }
                        if (i) {
                            e === i.name ? s = i.location + "/" + i.main : s = i.location, u.splice(0, a, s);
                            break
                        }
                    }
                    l = u.join("/"), l += t || (/\?/.test(l) ? "" : ".js"), l = (l.charAt(0) === "/" || l.match(/^[\w\+\.\-]+:/) ? "" : o.baseUrl) + l
                }
                return o.urlArgs ? l + ((l.indexOf("?") === -1 ? "?" : "&") + o.urlArgs) : l
            },
            load: function(e, t) {
                req.load(r, e, t)
            },
            execCb: function(e, t, n, r) {
                return t.apply(r, n)
            },
            onScriptLoad: function(e) {
                if (e.type === "load" || readyRegExp.test((e.currentTarget || e.srcElement).readyState)) {
                    interactiveScript = null;
                    var t = A(e);
                    r.completeLoad(t.id)
                }
            },
            onScriptError: function(e) {
                var t = A(e);
                if (!g(t.id)) return S(makeError("scripterror", "Script error", e, [t.id]))
            }
        }, r.require = r.makeRequire(), r
    }

    function getInteractiveScript() {
        return interactiveScript && interactiveScript.readyState === "interactive" ? interactiveScript : (eachReverse(scripts(), function(e) {
            if (e.readyState === "interactive") return interactiveScript = e
        }), interactiveScript)
    }
    var req, s, head, baseElement, dataMain, src, interactiveScript, currentlyAddingScript, mainScript, subPath, version = "2.1.4",
        commentRegExp = /(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/mg,
        cjsRequireRegExp = /[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,
        jsSuffixRegExp = /\.js$/,
        currDirRegExp = /^\.\//,
        op = Object.prototype,
        ostring = op.toString,
        hasOwn = op.hasOwnProperty,
        ap = Array.prototype,
        apsp = ap.splice,
        isBrowser = typeof window != "undefined" && !!navigator && !!document,
        isWebWorker = !isBrowser && typeof importScripts != "undefined",
        readyRegExp = isBrowser && navigator.platform === "PLAYSTATION 3" ? /^complete$/ : /^(complete|loaded)$/,
        defContextName = "_",
        isOpera = typeof opera != "undefined" && opera.toString() === "[object Opera]",
        contexts = {},
        cfg = {},
        globalDefQueue = [],
        useInteractive = !1;
    if (typeof define != "undefined") return;
    if (typeof requirejs != "undefined") {
        if (isFunction(requirejs)) return;
        cfg = requirejs, requirejs = undefined
    }
    typeof require != "undefined" && !isFunction(require) && (cfg = require, require = undefined), req = requirejs = function(e, t, n, r) {
        var i, s, o = defContextName;
        return !isArray(e) && typeof e != "string" && (s = e, isArray(t) ? (e = t, t = n, n = r) : e = []), s && s.context && (o = s.context), i = getOwn(contexts, o), i || (i = contexts[o] = req.s.newContext(o)), s && i.configure(s), i.require(e, t, n)
    }, req.config = function(e) {
        return req(e)
    }, req.nextTick = typeof setTimeout != "undefined" ? function(e) {
        setTimeout(e, 4)
    } : function(e) {
        e()
    }, require || (require = req), req.version = version, req.jsExtRegExp = /^\/|:|\?|\.js$/, req.isBrowser = isBrowser, s = req.s = {
        contexts: contexts,
        newContext: newContext
    }, req({}), each(["toUrl", "undef", "defined", "specified"], function(e) {
        req[e] = function() {
            var t = contexts[defContextName];
            return t.require[e].apply(t, arguments)
        }
    }), isBrowser && (head = s.head = document.getElementsByTagName("head")[0], baseElement = document.getElementsByTagName("base")[0], baseElement && (head = s.head = baseElement.parentNode)), req.onError = function(e) {
        throw e
    }, req.load = function(e, t, n) {
        var r = e && e.config || {},
            i;
        if (isBrowser) return i = r.xhtml ? document.createElementNS("http://www.w3.org/1999/xhtml", "html:script") : document.createElement("script"), i.type = r.scriptType || "text/javascript", i.charset = "utf-8", i.async = !0, i.setAttribute("data-requirecontext", e.contextName), i.setAttribute("data-requiremodule", t), i.attachEvent && !(i.attachEvent.toString && i.attachEvent.toString().indexOf("[native code") < 0) && !isOpera ? (useInteractive = !0, i.attachEvent("onreadystatechange", e.onScriptLoad)) : (i.addEventListener("load", e.onScriptLoad, !1), i.addEventListener("error", e.onScriptError, !1)), i.src = n, currentlyAddingScript = i, baseElement ? head.insertBefore(i, baseElement) : head.appendChild(i), currentlyAddingScript = null, i;
        isWebWorker && (importScripts(n), e.completeLoad(t))
    }, isBrowser && eachReverse(scripts(), function(e) {
        head || (head = e.parentNode), dataMain = e.getAttribute("data-main");
        if (dataMain) return cfg.baseUrl || (src = dataMain.split("/"), mainScript = src.pop(), subPath = src.length ? src.join("/") + "/" : "./", cfg.baseUrl = subPath, dataMain = mainScript), dataMain = dataMain.replace(jsSuffixRegExp, ""), cfg.deps = cfg.deps ? cfg.deps.concat(dataMain) : [dataMain], !0
    }), define = function(e, t, n) {
        var r, i;
        typeof e != "string" && (n = t, t = e, e = null), isArray(t) || (n = t, t = []), !t.length && isFunction(n) && n.length && (n.toString().replace(commentRegExp, "").replace(cjsRequireRegExp, function(e, n) {
            t.push(n)
        }), t = (n.length === 1 ? ["require"] : ["require", "exports", "module"]).concat(t)), useInteractive && (r = currentlyAddingScript || getInteractiveScript(), r && (e || (e = r.getAttribute("data-requiremodule")), i = contexts[r.getAttribute("data-requirecontext")])), (i ? i.defQueue : globalDefQueue).push([e, t, n])
    }, define.amd = {
        jQuery: !0
    }, req.exec = function(text) {
        return eval(text)
    }, req(cfg)
})(this), define("requireLib", function() {});
var config = {
    baseUrl: "/js/src",
    packages: [{
        name: "backbone",
        location: "../libs",
        main: "backbone-0.9.10.js"
    }, {
        name: "Libs/Backbone/ModelBinder",
        location: "../libs",
        main: "Backbone.ModelBinder-0.1.6.js"
    }, {
        name: "Libs/Backbone/DeepModel",
        location: "../libs",
        main: "deep-model-0.10.4.js"
    }, {
        name: "Libs/Backbone/Validation",
        location: "../libs",
        main: "backbone-validation-0.8.1.js"
    }, {
        name: "Libs/Modernizr",
        location: "../libs",
        main: "modernizr-2.6.2.min.js"
    }, {
        name: "underscore",
        location: "../libs",
        main: "underscore-1.4.4.js"
    }, {
        name: "Libs/Ejs",
        location: "../libs",
        main: "ejs-1.0.0.js"
    }, {
        name: "Libs/DatePicker",
        location: "../libs",
        main: "bootstrap-datepicker-2.0.js"
    }, {
        name: "moment",
        location: "../libs",
        main: "moment-1.7.2.js"
    }, {
        name: "momentRu",
        location: "../libs",
        main: "moment-ru.js"
    }, {
        name: "jquery",
        location: "../libs",
        main: "jquery-1.8.2.js"
    }, {
        name: "Libs/jQuery/Scroll",
        location: "../libs",
        main: "jquery.scroll-0.4.0.js"
    }, {
        name: "Libs/jQuery/DisableSelect",
        location: "../libs",
        main: "jquery.disable.text.select-1.1.0.js"
    }, {
        name: "Libs/jQuery/MouseWheel",
        location: "../libs",
        main: "jquery.mousewheel-3.0.6.js"
    }, {
        name: "Libs/jQuery/TextareaAutosize",
        location: "../libs",
        main: "jquery.autosize-1.16.4.js"
    }, {
        name: "Libs/jQuery/Cookie",
        location: "../libs",
        main: "jquery.cookie-1.3.1.js"
    }, {
        name: "Libs/jQuery/Transit",
        location: "../libs",
        main: "jquery.transit-0.9.9.js"
    }, {
        name: "Libs/jQuery/ScrollTo",
        location: "../libs",
        main: "jquery.scrollTo-1.4.3.1.js"
    }, {
        name: "Libs/jQuery/JSON",
        location: "../libs",
        main: "jquery.json-2.4.js"
    }, {
        name: "Libs/jQuery/UI",
        location: "../libs",
        main: "jquery-ui-1.10.3.custom.js"
    }, {
        name: "Libs/jQuery/IFrameTransport",
        location: "../libs",
        main: "jquery.iframe-transport-1.7.js"
    }, {
        name: "jquery.fileupload",
        location: "../libs",
        main: "jquery.fileupload.js"
    }, {
        name: "jquery.fileupload-image",
        location: "../libs",
        main: "jquery.fileupload-image.js"
    }, {
        name: "jquery.fileupload-process",
        location: "../libs",
        main: "jquery.fileupload-process.js"
    }, {
        name: "jquery.ui.widget",
        location: "../libs",
        main: "jquery.ui.widget.js"
    }, {
        name: "canvas-to-blob",
        location: "../libs",
        main: "canvas-to-blob.js"
    }, {
        name: "load-image",
        location: "../libs",
        main: "load-image.js"
    }, {
        name: "load-image-meta",
        location: "../libs",
        main: "load-image-meta.js"
    }, {
        name: "load-image-exif",
        location: "../libs",
        main: "load-image-exif.js"
    }, {
        name: "load-image-ios",
        location: "../libs",
        main: "load-image-ios.js"
    }, {
        name: "sjcl",
        location: "../libs",
        main: "sjcl.js"
    }],
    version: "0.2.11",
    shim: {
        "Libs/jQuery/MouseWheel": {
            deps: ["jquery"]
        },
        "Libs/DatePicker": {
            deps: ["jquery"]
        },
        "Libs/jQuery/TextareaAutosize": {
            deps: ["jquery"]
        },
        "Libs/jQuery/DisableSelect": {
            deps: ["jquery"]
        },
        "Libs/jQuery/Scroll": {
            deps: ["jquery", "Libs/jQuery/MouseWheel"]
        },
        momentMu: {
            deps: ["moment"]
        },
        "Libs/Backbone/Validation": {
            deps: ["underscore", "backbone"]
        },
        "Libs/jQuery/Cookie": {
            deps: ["jquery"]
        },
        "Libs/jQuery/Transit": {
            deps: ["jquery"]
        },
        "Libs/jQuery/ScrollTo": {
            deps: ["jquery"]
        },
        "Libs/jQuery/JSON": {
            deps: ["jquery"]
        },
        "Libs/jQuery/Ejs": {
            deps: ["Libs/jQuery/JSON"]
        },
        "Libs/jQuery/UI": {
            deps: ["jquery"]
        },
        "Libs/jQuery/IFrameTransport": {
            deps: ["jquery"]
        }
    }
};
if (typeof require != "undefined" && require.config) require.config(config);
else var require = config;
typeof exports != "undefined" && typeof module != "undefined" && (module.exports = config), define("../libs/require.config", function() {}),
    function() {
        var e = this,
            t = e._,
            n = {},
            r = Array.prototype,
            i = Object.prototype,
            s = Function.prototype,
            o = r.push,
            u = r.slice,
            a = r.concat,
            f = i.toString,
            l = i.hasOwnProperty,
            c = r.forEach,
            h = r.map,
            p = r.reduce,
            d = r.reduceRight,
            v = r.filter,
            m = r.every,
            g = r.some,
            y = r.indexOf,
            b = r.lastIndexOf,
            w = Array.isArray,
            E = Object.keys,
            S = s.bind,
            x = function(e) {
                if (e instanceof x) return e;
                if (!(this instanceof x)) return new x(e);
                this._wrapped = e
            };
        typeof exports != "undefined" ? (typeof module != "undefined" && module.exports && (exports = module.exports = x), exports._ = x) : e._ = x, x.VERSION = "1.4.4";
        var T = x.each = x.forEach = function(e, t, r) {
            if (e == null) return;
            if (c && e.forEach === c) e.forEach(t, r);
            else if (e.length === +e.length) {
                for (var i = 0, s = e.length; i < s; i++)
                    if (t.call(r, e[i], i, e) === n) return
            } else
                for (var o in e)
                    if (x.has(e, o) && t.call(r, e[o], o, e) === n) return
        };
        x.map = x.collect = function(e, t, n) {
            var r = [];
            return e == null ? r : h && e.map === h ? e.map(t, n) : (T(e, function(e, i, s) {
                r[r.length] = t.call(n, e, i, s)
            }), r)
        };
        var N = "Reduce of empty array with no initial value";
        x.reduce = x.foldl = x.inject = function(e, t, n, r) {
            var i = arguments.length > 2;
            e == null && (e = []);
            if (p && e.reduce === p) return r && (t = x.bind(t, r)), i ? e.reduce(t, n) : e.reduce(t);
            T(e, function(e, s, o) {
                i ? n = t.call(r, n, e, s, o) : (n = e, i = !0)
            });
            if (!i) throw new TypeError(N);
            return n
        }, x.reduceRight = x.foldr = function(e, t, n, r) {
            var i = arguments.length > 2;
            e == null && (e = []);
            if (d && e.reduceRight === d) return r && (t = x.bind(t, r)), i ? e.reduceRight(t, n) : e.reduceRight(t);
            var s = e.length;
            if (s !== +s) {
                var o = x.keys(e);
                s = o.length
            }
            T(e, function(u, a, f) {
                a = o ? o[--s] : --s, i ? n = t.call(r, n, e[a], a, f) : (n = e[a], i = !0)
            });
            if (!i) throw new TypeError(N);
            return n
        }, x.find = x.detect = function(e, t, n) {
            var r;
            return C(e, function(e, i, s) {
                if (t.call(n, e, i, s)) return r = e, !0
            }), r
        }, x.filter = x.select = function(e, t, n) {
            var r = [];
            return e == null ? r : v && e.filter === v ? e.filter(t, n) : (T(e, function(e, i, s) {
                t.call(n, e, i, s) && (r[r.length] = e)
            }), r)
        }, x.reject = function(e, t, n) {
            return x.filter(e, function(e, r, i) {
                return !t.call(n, e, r, i)
            }, n)
        }, x.every = x.all = function(e, t, r) {
            t || (t = x.identity);
            var i = !0;
            return e == null ? i : m && e.every === m ? e.every(t, r) : (T(e, function(e, s, o) {
                if (!(i = i && t.call(r, e, s, o))) return n
            }), !!i)
        };
        var C = x.some = x.any = function(e, t, r) {
            t || (t = x.identity);
            var i = !1;
            return e == null ? i : g && e.some === g ? e.some(t, r) : (T(e, function(e, s, o) {
                if (i || (i = t.call(r, e, s, o))) return n
            }), !!i)
        };
        x.contains = x.include = function(e, t) {
            return e == null ? !1 : y && e.indexOf === y ? e.indexOf(t) != -1 : C(e, function(e) {
                return e === t
            })
        }, x.invoke = function(e, t) {
            var n = u.call(arguments, 2),
                r = x.isFunction(t);
            return x.map(e, function(e) {
                return (r ? t : e[t]).apply(e, n)
            })
        }, x.pluck = function(e, t) {
            return x.map(e, function(e) {
                return e[t]
            })
        }, x.where = function(e, t, n) {
            return x.isEmpty(t) ? n ? null : [] : x[n ? "find" : "filter"](e, function(e) {
                for (var n in t)
                    if (t[n] !== e[n]) return !1;
                return !0
            })
        }, x.findWhere = function(e, t) {
            return x.where(e, t, !0)
        }, x.max = function(e, t, n) {
            if (!t && x.isArray(e) && e[0] === +e[0] && e.length < 65535) return Math.max.apply(Math, e);
            if (!t && x.isEmpty(e)) return -Infinity;
            var r = {
                computed: -Infinity,
                value: -Infinity
            };
            return T(e, function(e, i, s) {
                var o = t ? t.call(n, e, i, s) : e;
                o >= r.computed && (r = {
                    value: e,
                    computed: o
                })
            }), r.value
        }, x.min = function(e, t, n) {
            if (!t && x.isArray(e) && e[0] === +e[0] && e.length < 65535) return Math.min.apply(Math, e);
            if (!t && x.isEmpty(e)) return Infinity;
            var r = {
                computed: Infinity,
                value: Infinity
            };
            return T(e, function(e, i, s) {
                var o = t ? t.call(n, e, i, s) : e;
                o < r.computed && (r = {
                    value: e,
                    computed: o
                })
            }), r.value
        }, x.shuffle = function(e) {
            var t, n = 0,
                r = [];
            return T(e, function(e) {
                t = x.random(n++), r[n - 1] = r[t], r[t] = e
            }), r
        };
        var k = function(e) {
            return x.isFunction(e) ? e : function(t) {
                return t[e]
            }
        };
        x.sortBy = function(e, t, n) {
            var r = k(t);
            return x.pluck(x.map(e, function(e, t, i) {
                return {
                    value: e,
                    index: t,
                    criteria: r.call(n, e, t, i)
                }
            }).sort(function(e, t) {
                var n = e.criteria,
                    r = t.criteria;
                if (n !== r) {
                    if (n > r || n === void 0) return 1;
                    if (n < r || r === void 0) return -1
                }
                return e.index < t.index ? -1 : 1
            }), "value")
        };
        var L = function(e, t, n, r) {
            var i = {},
                s = k(t || x.identity);
            return T(e, function(t, o) {
                var u = s.call(n, t, o, e);
                r(i, u, t)
            }), i
        };
        x.groupBy = function(e, t, n) {
            return L(e, t, n, function(e, t, n) {
                (x.has(e, t) ? e[t] : e[t] = []).push(n)
            })
        }, x.countBy = function(e, t, n) {
            return L(e, t, n, function(e, t) {
                x.has(e, t) || (e[t] = 0), e[t] ++
            })
        }, x.sortedIndex = function(e, t, n, r) {
            n = n == null ? x.identity : k(n);
            var i = n.call(r, t),
                s = 0,
                o = e.length;
            while (s < o) {
                var u = s + o >>> 1;
                n.call(r, e[u]) < i ? s = u + 1 : o = u
            }
            return s
        }, x.toArray = function(e) {
            return e ? x.isArray(e) ? u.call(e) : e.length === +e.length ? x.map(e, x.identity) : x.values(e) : []
        }, x.size = function(e) {
            return e == null ? 0 : e.length === +e.length ? e.length : x.keys(e).length
        }, x.first = x.head = x.take = function(e, t, n) {
            return e == null ? void 0 : t != null && !n ? u.call(e, 0, t) : e[0]
        }, x.initial = function(e, t, n) {
            return u.call(e, 0, e.length - (t == null || n ? 1 : t))
        }, x.last = function(e, t, n) {
            return e == null ? void 0 : t != null && !n ? u.call(e, Math.max(e.length - t, 0)) : e[e.length - 1]
        }, x.rest = x.tail = x.drop = function(e, t, n) {
            return u.call(e, t == null || n ? 1 : t)
        }, x.compact = function(e) {
            return x.filter(e, x.identity)
        };
        var A = function(e, t, n) {
            return T(e, function(e) {
                x.isArray(e) ? t ? o.apply(n, e) : A(e, t, n) : n.push(e)
            }), n
        };
        x.flatten = function(e, t) {
            return A(e, t, [])
        }, x.without = function(e) {
            return x.difference(e, u.call(arguments, 1))
        }, x.uniq = x.unique = function(e, t, n, r) {
            x.isFunction(t) && (r = n, n = t, t = !1);
            var i = n ? x.map(e, n, r) : e,
                s = [],
                o = [];
            return T(i, function(n, r) {
                if (t ? !r || o[o.length - 1] !== n : !x.contains(o, n)) o.push(n), s.push(e[r])
            }), s
        }, x.union = function() {
            return x.uniq(a.apply(r, arguments))
        }, x.intersection = function(e) {
            var t = u.call(arguments, 1);
            return x.filter(x.uniq(e), function(e) {
                return x.every(t, function(t) {
                    return x.indexOf(t, e) >= 0
                })
            })
        }, x.difference = function(e) {
            var t = a.apply(r, u.call(arguments, 1));
            return x.filter(e, function(e) {
                return !x.contains(t, e)
            })
        }, x.zip = function() {
            var e = u.call(arguments),
                t = x.max(x.pluck(e, "length")),
                n = new Array(t);
            for (var r = 0; r < t; r++) n[r] = x.pluck(e, "" + r);
            return n
        }, x.object = function(e, t) {
            if (e == null) return {};
            var n = {};
            for (var r = 0, i = e.length; r < i; r++) t ? n[e[r]] = t[r] : n[e[r][0]] = e[r][1];
            return n
        }, x.indexOf = function(e, t, n) {
            if (e == null) return -1;
            var r = 0,
                i = e.length;
            if (n) {
                if (typeof n != "number") return r = x.sortedIndex(e, t), e[r] === t ? r : -1;
                r = n < 0 ? Math.max(0, i + n) : n
            }
            if (y && e.indexOf === y) return e.indexOf(t, n);
            for (; r < i; r++)
                if (e[r] === t) return r;
            return -1
        }, x.lastIndexOf = function(e, t, n) {
            if (e == null) return -1;
            var r = n != null;
            if (b && e.lastIndexOf === b) return r ? e.lastIndexOf(t, n) : e.lastIndexOf(t);
            var i = r ? n : e.length;
            while (i--)
                if (e[i] === t) return i;
            return -1
        }, x.range = function(e, t, n) {
            arguments.length <= 1 && (t = e || 0, e = 0), n = arguments[2] || 1;
            var r = Math.max(Math.ceil((t - e) / n), 0),
                i = 0,
                s = new Array(r);
            while (i < r) s[i++] = e, e += n;
            return s
        }, x.bind = function(e, t) {
            if (e.bind === S && S) return S.apply(e, u.call(arguments, 1));
            var n = u.call(arguments, 2);
            return function() {
                return e.apply(t, n.concat(u.call(arguments)))
            }
        }, x.partial = function(e) {
            var t = u.call(arguments, 1);
            return function() {
                return e.apply(this, t.concat(u.call(arguments)))
            }
        }, x.bindAll = function(e) {
            var t = u.call(arguments, 1);
            return t.length === 0 && (t = x.functions(e)), T(t, function(t) {
                e[t] = x.bind(e[t], e)
            }), e
        }, x.memoize = function(e, t) {
            var n = {};
            return t || (t = x.identity),
                function() {
                    var r = t.apply(this, arguments);
                    return x.has(n, r) ? n[r] : n[r] = e.apply(this, arguments)
                }
        }, x.delay = function(e, t) {
            var n = u.call(arguments, 2);
            return setTimeout(function() {
                return e.apply(null, n)
            }, t)
        }, x.defer = function(e) {
            return x.delay.apply(x, [e, 1].concat(u.call(arguments, 1)))
        }, x.throttle = function(e, t) {
            var n, r, i, s, o = 0,
                u = function() {
                    o = new Date, i = null, s = e.apply(n, r)
                };
            return function() {
                var a = new Date,
                    f = t - (a - o);
                return n = this, r = arguments, f <= 0 ? (clearTimeout(i), i = null, o = a, s = e.apply(n, r)) : i || (i = setTimeout(u, f)), s
            }
        }, x.debounce = function(e, t, n) {
            var r, i;
            return function() {
                var s = this,
                    o = arguments,
                    u = function() {
                        r = null, n || (i = e.apply(s, o))
                    },
                    a = n && !r;
                return clearTimeout(r), r = setTimeout(u, t), a && (i = e.apply(s, o)), i
            }
        }, x.once = function(e) {
            var t = !1,
                n;
            return function() {
                return t ? n : (t = !0, n = e.apply(this, arguments), e = null, n)
            }
        }, x.wrap = function(e, t) {
            return function() {
                var n = [e];
                return o.apply(n, arguments), t.apply(this, n)
            }
        }, x.compose = function() {
            var e = arguments;
            return function() {
                var t = arguments;
                for (var n = e.length - 1; n >= 0; n--) t = [e[n].apply(this, t)];
                return t[0]
            }
        }, x.after = function(e, t) {
            return e <= 0 ? t() : function() {
                if (--e < 1) return t.apply(this, arguments)
            }
        }, x.keys = E || function(e) {
            if (e !== Object(e)) throw new TypeError("Invalid object");
            var t = [];
            for (var n in e) x.has(e, n) && (t[t.length] = n);
            return t
        }, x.values = function(e) {
            var t = [];
            for (var n in e) x.has(e, n) && t.push(e[n]);
            return t
        }, x.pairs = function(e) {
            var t = [];
            for (var n in e) x.has(e, n) && t.push([n, e[n]]);
            return t
        }, x.invert = function(e) {
            var t = {};
            for (var n in e) x.has(e, n) && (t[e[n]] = n);
            return t
        }, x.functions = x.methods = function(e) {
            var t = [];
            for (var n in e) x.isFunction(e[n]) && t.push(n);
            return t.sort()
        }, x.extend = function(e) {
            return T(u.call(arguments, 1), function(t) {
                if (t)
                    for (var n in t) e[n] = t[n]
            }), e
        }, x.pick = function(e) {
            var t = {},
                n = a.apply(r, u.call(arguments, 1));
            return T(n, function(n) {
                n in e && (t[n] = e[n])
            }), t
        }, x.omit = function(e) {
            var t = {},
                n = a.apply(r, u.call(arguments, 1));
            for (var i in e) x.contains(n, i) || (t[i] = e[i]);
            return t
        }, x.defaults = function(e) {
            return T(u.call(arguments, 1), function(t) {
                if (t)
                    for (var n in t) e[n] == null && (e[n] = t[n])
            }), e
        }, x.clone = function(e) {
            return x.isObject(e) ? x.isArray(e) ? e.slice() : x.extend({}, e) : e
        }, x.tap = function(e, t) {
            return t(e), e
        };
        var O = function(e, t, n, r) {
            if (e === t) return e !== 0 || 1 / e == 1 / t;
            if (e == null || t == null) return e === t;
            e instanceof x && (e = e._wrapped), t instanceof x && (t = t._wrapped);
            var i = f.call(e);
            if (i != f.call(t)) return !1;
            switch (i) {
                case "[object String]":
                    return e == String(t);
                case "[object Number]":
                    return e != +e ? t != +t : e == 0 ? 1 / e == 1 / t : e == +t;
                case "[object Date]":
                case "[object Boolean]":
                    return +e == +t;
                case "[object RegExp]":
                    return e.source == t.source && e.global == t.global && e.multiline == t.multiline && e.ignoreCase == t.ignoreCase
            }
            if (typeof e != "object" || typeof t != "object") return !1;
            var s = n.length;
            while (s--)
                if (n[s] == e) return r[s] == t;
            n.push(e), r.push(t);
            var o = 0,
                u = !0;
            if (i == "[object Array]") {
                o = e.length, u = o == t.length;
                if (u)
                    while (o--)
                        if (!(u = O(e[o], t[o], n, r))) break
            } else {
                var a = e.constructor,
                    l = t.constructor;
                if (a !== l && !(x.isFunction(a) && a instanceof a && x.isFunction(l) && l instanceof l)) return !1;
                for (var c in e)
                    if (x.has(e, c)) {
                        o++;
                        if (!(u = x.has(t, c) && O(e[c], t[c], n, r))) break
                    }
                if (u) {
                    for (c in t)
                        if (x.has(t, c) && !(o--)) break;
                    u = !o
                }
            }
            return n.pop(), r.pop(), u
        };
        x.isEqual = function(e, t) {
            return O(e, t, [], [])
        }, x.isEmpty = function(e) {
            if (e == null) return !0;
            if (x.isArray(e) || x.isString(e)) return e.length === 0;
            for (var t in e)
                if (x.has(e, t)) return !1;
            return !0
        }, x.isElement = function(e) {
            return !!e && e.nodeType === 1
        }, x.isArray = w || function(e) {
            return f.call(e) == "[object Array]"
        }, x.isObject = function(e) {
            return e === Object(e)
        }, T(["Arguments", "Function", "String", "Number", "Date", "RegExp"], function(e) {
            x["is" + e] = function(t) {
                return f.call(t) == "[object " + e + "]"
            }
        }), x.isArguments(arguments) || (x.isArguments = function(e) {
            return !!e && !!x.has(e, "callee")
        }), typeof / . / != "function" && (x.isFunction = function(e) {
            return typeof e == "function"
        }), x.isFinite = function(e) {
            return isFinite(e) && !isNaN(parseFloat(e))
        }, x.isNaN = function(e) {
            return x.isNumber(e) && e != +e
        }, x.isBoolean = function(e) {
            return e === !0 || e === !1 || f.call(e) == "[object Boolean]"
        }, x.isNull = function(e) {
            return e === null
        }, x.isUndefined = function(e) {
            return e === void 0
        }, x.has = function(e, t) {
            return l.call(e, t)
        }, x.noConflict = function() {
            return e._ = t, this
        }, x.identity = function(e) {
            return e
        }, x.times = function(e, t, n) {
            var r = Array(e);
            for (var i = 0; i < e; i++) r[i] = t.call(n, i);
            return r
        }, x.random = function(e, t) {
            return t == null && (t = e, e = 0), e + Math.floor(Math.random() * (t - e + 1))
        };
        var M = {
            escape: {
                "&": "&amp;",
                "<": "&lt;",
                ">": "&gt;",
                '"': "&quot;",
                "'": "&#x27;",
                "/": "&#x2F;"
            }
        };
        M.unescape = x.invert(M.escape);
        var _ = {
            escape: new RegExp("[" + x.keys(M.escape).join("") + "]", "g"),
            unescape: new RegExp("(" + x.keys(M.unescape).join("|") + ")", "g")
        };
        x.each(["escape", "unescape"], function(e) {
            x[e] = function(t) {
                return t == null ? "" : ("" + t).replace(_[e], function(t) {
                    return M[e][t]
                })
            }
        }), x.result = function(e, t) {
            if (e == null) return null;
            var n = e[t];
            return x.isFunction(n) ? n.call(e) : n
        }, x.mixin = function(e) {
            T(x.functions(e), function(t) {
                var n = x[t] = e[t];
                x.prototype[t] = function() {
                    var e = [this._wrapped];
                    return o.apply(e, arguments), j.call(this, n.apply(x, e))
                }
            })
        };
        var D = 0;
        x.uniqueId = function(e) {
            var t = ++D + "";
            return e ? e + t : t
        }, x.templateSettings = {
            evaluate: /<%([\s\S]+?)%>/g,
            interpolate: /<%=([\s\S]+?)%>/g,
            escape: /<%-([\s\S]+?)%>/g
        };
        var P = /(.)^/,
            H = {
                "'": "'",
                "\\": "\\",
                "\r": "r",
                "\n": "n",
                "	": "t",
                "\u2028": "u2028",
                "\u2029": "u2029"
            },
            B = /\\|'|\r|\n|\t|\u2028|\u2029/g;
        x.template = function(e, t, n) {
            var r;
            n = x.defaults({}, n, x.templateSettings);
            var i = new RegExp([(n.escape || P).source, (n.interpolate || P).source, (n.evaluate || P).source].join("|") + "|$", "g"),
                s = 0,
                o = "__p+='";
            e.replace(i, function(t, n, r, i, u) {
                return o += e.slice(s, u).replace(B, function(e) {
                    return "\\" + H[e]
                }), n && (o += "'+\n((__t=(" + n + "))==null?'':_.escape(__t))+\n'"), r && (o += "'+\n((__t=(" + r + "))==null?'':__t)+\n'"), i && (o += "';\n" + i + "\n__p+='"), s = u + t.length, t
            }), o += "';\n", n.variable || (o = "with(obj||{}){\n" + o + "}\n"), o = "var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n" + o + "return __p;\n";
            try {
                r = new Function(n.variable || "obj", "_", o)
            } catch (u) {
                throw u.source = o, u
            }
            if (t) return r(t, x);
            var a = function(e) {
                return r.call(this, e, x)
            };
            return a.source = "function(" + (n.variable || "obj") + "){\n" + o + "}", a
        }, x.chain = function(e) {
            return x(e).chain()
        };
        var j = function(e) {
            return this._chain ? x(e).chain() : e
        };
        x.mixin(x), T(["pop", "push", "reverse", "shift", "sort", "splice", "unshift"], function(e) {
            var t = r[e];
            x.prototype[e] = function() {
                var n = this._wrapped;
                return t.apply(n, arguments), (e == "shift" || e == "splice") && n.length === 0 && delete n[0], j.call(this, n)
            }
        }), T(["concat", "join", "slice"], function(e) {
            var t = r[e];
            x.prototype[e] = function() {
                return j.call(this, t.apply(this._wrapped, arguments))
            }
        }), x.extend(x.prototype, {
            chain: function() {
                return this._chain = !0, this
            },
            value: function() {
                return this._wrapped
            }
        }), typeof define == "function" && define.amd && define("underscore", [], function() {
            return x
        })
    }.call(this), define("underscore/underscore-1.4.4", function() {}),
    function(e, t) {
        function _(e) {
            var t = M[e] = {};
            return v.each(e.split(y), function(e, n) {
                t[n] = !0
            }), t
        }

        function H(e, n, r) {
            if (r === t && e.nodeType === 1) {
                var i = "data-" + n.replace(P, "-$1").toLowerCase();
                r = e.getAttribute(i);
                if (typeof r == "string") {
                    try {
                        r = r === "true" ? !0 : r === "false" ? !1 : r === "null" ? null : +r + "" === r ? +r : D.test(r) ? v.parseJSON(r) : r
                    } catch (s) {}
                    v.data(e, n, r)
                } else r = t
            }
            return r
        }

        function B(e) {
            var t;
            for (t in e) {
                if (t === "data" && v.isEmptyObject(e[t])) continue;
                if (t !== "toJSON") return !1
            }
            return !0
        }

        function et() {
            return !1
        }

        function tt() {
            return !0
        }

        function ut(e) {
            return !e || !e.parentNode || e.parentNode.nodeType === 11
        }

        function at(e, t) {
            do e = e[t]; while (e && e.nodeType !== 1);
            return e
        }

        function ft(e, t, n) {
            t = t || 0;
            if (v.isFunction(t)) return v.grep(e, function(e, r) {
                var i = !!t.call(e, r, e);
                return i === n
            });
            if (t.nodeType) return v.grep(e, function(e, r) {
                return e === t === n
            });
            if (typeof t == "string") {
                var r = v.grep(e, function(e) {
                    return e.nodeType === 1
                });
                if (it.test(t)) return v.filter(t, r, !n);
                t = v.filter(t, r)
            }
            return v.grep(e, function(e, r) {
                return v.inArray(e, t) >= 0 === n
            })
        }

        function lt(e) {
            var t = ct.split("|"),
                n = e.createDocumentFragment();
            if (n.createElement)
                while (t.length) n.createElement(t.pop());
            return n
        }

        function Lt(e, t) {
            return e.getElementsByTagName(t)[0] || e.appendChild(e.ownerDocument.createElement(t))
        }

        function At(e, t) {
            if (t.nodeType !== 1 || !v.hasData(e)) return;
            var n, r, i, s = v._data(e),
                o = v._data(t, s),
                u = s.events;
            if (u) {
                delete o.handle, o.events = {};
                for (n in u)
                    for (r = 0, i = u[n].length; r < i; r++) v.event.add(t, n, u[n][r])
            }
            o.data && (o.data = v.extend({}, o.data))
        }

        function Ot(e, t) {
            var n;
            if (t.nodeType !== 1) return;
            t.clearAttributes && t.clearAttributes(), t.mergeAttributes && t.mergeAttributes(e), n = t.nodeName.toLowerCase(), n === "object" ? (t.parentNode && (t.outerHTML = e.outerHTML), v.support.html5Clone && e.innerHTML && !v.trim(t.innerHTML) && (t.innerHTML = e.innerHTML)) : n === "input" && Et.test(e.type) ? (t.defaultChecked = t.checked = e.checked, t.value !== e.value && (t.value = e.value)) : n === "option" ? t.selected = e.defaultSelected : n === "input" || n === "textarea" ? t.defaultValue = e.defaultValue : n === "script" && t.text !== e.text && (t.text = e.text), t.removeAttribute(v.expando)
        }

        function Mt(e) {
            return typeof e.getElementsByTagName != "undefined" ? e.getElementsByTagName("*") : typeof e.querySelectorAll != "undefined" ? e.querySelectorAll("*") : []
        }

        function _t(e) {
            Et.test(e.type) && (e.defaultChecked = e.checked)
        }

        function Qt(e, t) {
            if (t in e) return t;
            var n = t.charAt(0).toUpperCase() + t.slice(1),
                r = t,
                i = Jt.length;
            while (i--) {
                t = Jt[i] + n;
                if (t in e) return t
            }
            return r
        }

        function Gt(e, t) {
            return e = t || e, v.css(e, "display") === "none" || !v.contains(e.ownerDocument, e)
        }

        function Yt(e, t) {
            var n, r, i = [],
                s = 0,
                o = e.length;
            for (; s < o; s++) {
                n = e[s];
                if (!n.style) continue;
                i[s] = v._data(n, "olddisplay"), t ? (!i[s] && n.style.display === "none" && (n.style.display = ""), n.style.display === "" && Gt(n) && (i[s] = v._data(n, "olddisplay", nn(n.nodeName)))) : (r = Dt(n, "display"), !i[s] && r !== "none" && v._data(n, "olddisplay", r))
            }
            for (s = 0; s < o; s++) {
                n = e[s];
                if (!n.style) continue;
                if (!t || n.style.display === "none" || n.style.display === "") n.style.display = t ? i[s] || "" : "none"
            }
            return e
        }

        function Zt(e, t, n) {
            var r = Rt.exec(t);
            return r ? Math.max(0, r[1] - (n || 0)) + (r[2] || "px") : t
        }

        function en(e, t, n, r) {
            var i = n === (r ? "border" : "content") ? 4 : t === "width" ? 1 : 0,
                s = 0;
            for (; i < 4; i += 2) n === "margin" && (s += v.css(e, n + $t[i], !0)), r ? (n === "content" && (s -= parseFloat(Dt(e, "padding" + $t[i])) || 0), n !== "margin" && (s -= parseFloat(Dt(e, "border" + $t[i] + "Width")) || 0)) : (s += parseFloat(Dt(e, "padding" + $t[i])) || 0, n !== "padding" && (s += parseFloat(Dt(e, "border" + $t[i] + "Width")) || 0));
            return s
        }

        function tn(e, t, n) {
            var r = t === "width" ? e.offsetWidth : e.offsetHeight,
                i = !0,
                s = v.support.boxSizing && v.css(e, "boxSizing") === "border-box";
            if (r <= 0 || r == null) {
                r = Dt(e, t);
                if (r < 0 || r == null) r = e.style[t];
                if (Ut.test(r)) return r;
                i = s && (v.support.boxSizingReliable || r === e.style[t]), r = parseFloat(r) || 0
            }
            return r + en(e, t, n || (s ? "border" : "content"), i) + "px"
        }

        function nn(e) {
            if (Wt[e]) return Wt[e];
            var t = v("<" + e + ">").appendTo(i.body),
                n = t.css("display");
            t.remove();
            if (n === "none" || n === "") {
                Pt = i.body.appendChild(Pt || v.extend(i.createElement("iframe"), {
                    frameBorder: 0,
                    width: 0,
                    height: 0
                }));
                if (!Ht || !Pt.createElement) Ht = (Pt.contentWindow || Pt.contentDocument).document, Ht.write("<!doctype html><html><body>"), Ht.close();
                t = Ht.body.appendChild(Ht.createElement(e)), n = Dt(t, "display"), i.body.removeChild(Pt)
            }
            return Wt[e] = n, n
        }

        function fn(e, t, n, r) {
            var i;
            if (v.isArray(t)) v.each(t, function(t, i) {
                n || sn.test(e) ? r(e, i) : fn(e + "[" + (typeof i == "object" ? t : "") + "]", i, n, r)
            });
            else if (!n && v.type(t) === "object")
                for (i in t) fn(e + "[" + i + "]", t[i], n, r);
            else r(e, t)
        }

        function Cn(e) {
            return function(t, n) {
                typeof t != "string" && (n = t, t = "*");
                var r, i, s, o = t.toLowerCase().split(y),
                    u = 0,
                    a = o.length;
                if (v.isFunction(n))
                    for (; u < a; u++) r = o[u], s = /^\+/.test(r), s && (r = r.substr(1) || "*"), i = e[r] = e[r] || [], i[s ? "unshift" : "push"](n)
            }
        }

        function kn(e, n, r, i, s, o) {
            s = s || n.dataTypes[0], o = o || {}, o[s] = !0;
            var u, a = e[s],
                f = 0,
                l = a ? a.length : 0,
                c = e === Sn;
            for (; f < l && (c || !u); f++) u = a[f](n, r, i), typeof u == "string" && (!c || o[u] ? u = t : (n.dataTypes.unshift(u), u = kn(e, n, r, i, u, o)));
            return (c || !u) && !o["*"] && (u = kn(e, n, r, i, "*", o)), u
        }

        function Ln(e, n) {
            var r, i, s = v.ajaxSettings.flatOptions || {};
            for (r in n) n[r] !== t && ((s[r] ? e : i || (i = {}))[r] = n[r]);
            i && v.extend(!0, e, i)
        }

        function An(e, n, r) {
            var i, s, o, u, a = e.contents,
                f = e.dataTypes,
                l = e.responseFields;
            for (s in l) s in r && (n[l[s]] = r[s]);
            while (f[0] === "*") f.shift(), i === t && (i = e.mimeType || n.getResponseHeader("content-type"));
            if (i)
                for (s in a)
                    if (a[s] && a[s].test(i)) {
                        f.unshift(s);
                        break
                    }
            if (f[0] in r) o = f[0];
            else {
                for (s in r) {
                    if (!f[0] || e.converters[s + " " + f[0]]) {
                        o = s;
                        break
                    }
                    u || (u = s)
                }
                o = o || u
            } if (o) return o !== f[0] && f.unshift(o), r[o]
        }

        function On(e, t) {
            var n, r, i, s, o = e.dataTypes.slice(),
                u = o[0],
                a = {},
                f = 0;
            e.dataFilter && (t = e.dataFilter(t, e.dataType));
            if (o[1])
                for (n in e.converters) a[n.toLowerCase()] = e.converters[n];
            for (; i = o[++f];)
                if (i !== "*") {
                    if (u !== "*" && u !== i) {
                        n = a[u + " " + i] || a["* " + i];
                        if (!n)
                            for (r in a) {
                                s = r.split(" ");
                                if (s[1] === i) {
                                    n = a[u + " " + s[0]] || a["* " + s[0]];
                                    if (n) {
                                        n === !0 ? n = a[r] : a[r] !== !0 && (i = s[0], o.splice(f--, 0, i));
                                        break
                                    }
                                }
                            }
                        if (n !== !0)
                            if (n && e["throws"]) t = n(t);
                            else try {
                                t = n(t)
                            } catch (l) {
                                return {
                                    state: "parsererror",
                                    error: n ? l : "No conversion from " + u + " to " + i
                                }
                            }
                    }
                    u = i
                }
            return {
                state: "success",
                data: t
            }
        }

        function Fn() {
            try {
                return new e.XMLHttpRequest
            } catch (t) {}
        }

        function In() {
            try {
                return new e.ActiveXObject("Microsoft.XMLHTTP")
            } catch (t) {}
        }

        function $n() {
            return setTimeout(function() {
                qn = t
            }, 0), qn = v.now()
        }

        function Jn(e, t) {
            v.each(t, function(t, n) {
                var r = (Vn[t] || []).concat(Vn["*"]),
                    i = 0,
                    s = r.length;
                for (; i < s; i++)
                    if (r[i].call(e, t, n)) return
            })
        }

        function Kn(e, t, n) {
            var r, i = 0,
                s = 0,
                o = Xn.length,
                u = v.Deferred().always(function() {
                    delete a.elem
                }),
                a = function() {
                    var t = qn || $n(),
                        n = Math.max(0, f.startTime + f.duration - t),
                        r = 1 - (n / f.duration || 0),
                        i = 0,
                        s = f.tweens.length;
                    for (; i < s; i++) f.tweens[i].run(r);
                    return u.notifyWith(e, [f, r, n]), r < 1 && s ? n : (u.resolveWith(e, [f]), !1)
                },
                f = u.promise({
                    elem: e,
                    props: v.extend({}, t),
                    opts: v.extend(!0, {
                        specialEasing: {}
                    }, n),
                    originalProperties: t,
                    originalOptions: n,
                    startTime: qn || $n(),
                    duration: n.duration,
                    tweens: [],
                    createTween: function(t, n, r) {
                        var i = v.Tween(e, f.opts, t, n, f.opts.specialEasing[t] || f.opts.easing);
                        return f.tweens.push(i), i
                    },
                    stop: function(t) {
                        var n = 0,
                            r = t ? f.tweens.length : 0;
                        for (; n < r; n++) f.tweens[n].run(1);
                        return t ? u.resolveWith(e, [f, t]) : u.rejectWith(e, [f, t]), this
                    }
                }),
                l = f.props;
            Qn(l, f.opts.specialEasing);
            for (; i < o; i++) {
                r = Xn[i].call(f, e, l, f.opts);
                if (r) return r
            }
            return Jn(f, l), v.isFunction(f.opts.start) && f.opts.start.call(e, f), v.fx.timer(v.extend(a, {
                anim: f,
                queue: f.opts.queue,
                elem: e
            })), f.progress(f.opts.progress).done(f.opts.done, f.opts.complete).fail(f.opts.fail).always(f.opts.always)
        }

        function Qn(e, t) {
            var n, r, i, s, o;
            for (n in e) {
                r = v.camelCase(n), i = t[r], s = e[n], v.isArray(s) && (i = s[1], s = e[n] = s[0]), n !== r && (e[r] = s, delete e[n]), o = v.cssHooks[r];
                if (o && "expand" in o) {
                    s = o.expand(s), delete e[r];
                    for (n in s) n in e || (e[n] = s[n], t[n] = i)
                } else t[r] = i
            }
        }

        function Gn(e, t, n) {
            var r, i, s, o, u, a, f, l, c = this,
                h = e.style,
                p = {},
                d = [],
                m = e.nodeType && Gt(e);
            n.queue || (f = v._queueHooks(e, "fx"), f.unqueued == null && (f.unqueued = 0, l = f.empty.fire, f.empty.fire = function() {
                f.unqueued || l()
            }), f.unqueued++, c.always(function() {
                c.always(function() {
                    f.unqueued--, v.queue(e, "fx").length || f.empty.fire()
                })
            })), e.nodeType === 1 && ("height" in t || "width" in t) && (n.overflow = [h.overflow, h.overflowX, h.overflowY], v.css(e, "display") === "inline" && v.css(e, "float") === "none" && (!v.support.inlineBlockNeedsLayout || nn(e.nodeName) === "inline" ? h.display = "inline-block" : h.zoom = 1)), n.overflow && (h.overflow = "hidden", v.support.shrinkWrapBlocks || c.done(function() {
                h.overflow = n.overflow[0], h.overflowX = n.overflow[1], h.overflowY = n.overflow[2]
            }));
            for (r in t) {
                s = t[r];
                if (Un.exec(s)) {
                    delete t[r];
                    if (s === (m ? "hide" : "show")) continue;
                    d.push(r)
                }
            }
            o = d.length;
            if (o) {
                u = v._data(e, "fxshow") || v._data(e, "fxshow", {}), m ? v(e).show() : c.done(function() {
                    v(e).hide()
                }), c.done(function() {
                    var t;
                    v.removeData(e, "fxshow", !0);
                    for (t in p) v.style(e, t, p[t])
                });
                for (r = 0; r < o; r++) i = d[r], a = c.createTween(i, m ? u[i] : 0), p[i] = u[i] || v.style(e, i), i in u || (u[i] = a.start, m && (a.end = a.start, a.start = i === "width" || i === "height" ? 1 : 0))
            }
        }

        function Yn(e, t, n, r, i) {
            return new Yn.prototype.init(e, t, n, r, i)
        }

        function Zn(e, t) {
            var n, r = {
                    height: e
                },
                i = 0;
            t = t ? 1 : 0;
            for (; i < 4; i += 2 - t) n = $t[i], r["margin" + n] = r["padding" + n] = e;
            return t && (r.opacity = r.width = e), r
        }

        function tr(e) {
            return v.isWindow(e) ? e : e.nodeType === 9 ? e.defaultView || e.parentWindow : !1
        }
        var n, r, i = e.document,
            s = e.location,
            o = e.navigator,
            u = e.jQuery,
            a = e.$,
            f = Array.prototype.push,
            l = Array.prototype.slice,
            c = Array.prototype.indexOf,
            h = Object.prototype.toString,
            p = Object.prototype.hasOwnProperty,
            d = String.prototype.trim,
            v = function(e, t) {
                return new v.fn.init(e, t, n)
            },
            m = /[\-+]?(?:\d*\.|)\d+(?:[eE][\-+]?\d+|)/.source,
            g = /\S/,
            y = /\s+/,
            b = /^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,
            w = /^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,
            E = /^<(\w+)\s*\/?>(?:<\/\1>|)$/,
            S = /^[\],:{}\s]*$/,
            x = /(?:^|:|,)(?:\s*\[)+/g,
            T = /\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,
            N = /"[^"\\\r\n]*"|true|false|null|-?(?:\d\d*\.|)\d+(?:[eE][\-+]?\d+|)/g,
            C = /^-ms-/,
            k = /-([\da-z])/gi,
            L = function(e, t) {
                return (t + "").toUpperCase()
            },
            A = function() {
                i.addEventListener ? (i.removeEventListener("DOMContentLoaded", A, !1), v.ready()) : i.readyState === "complete" && (i.detachEvent("onreadystatechange", A), v.ready())
            },
            O = {};
        v.fn = v.prototype = {
            constructor: v,
            init: function(e, n, r) {
                var s, o, u, a;
                if (!e) return this;
                if (e.nodeType) return this.context = this[0] = e, this.length = 1, this;
                if (typeof e == "string") {
                    e.charAt(0) === "<" && e.charAt(e.length - 1) === ">" && e.length >= 3 ? s = [null, e, null] : s = w.exec(e);
                    if (s && (s[1] || !n)) {
                        if (s[1]) return n = n instanceof v ? n[0] : n, a = n && n.nodeType ? n.ownerDocument || n : i, e = v.parseHTML(s[1], a, !0), E.test(s[1]) && v.isPlainObject(n) && this.attr.call(e, n, !0), v.merge(this, e);
                        o = i.getElementById(s[2]);
                        if (o && o.parentNode) {
                            if (o.id !== s[2]) return r.find(e);
                            this.length = 1, this[0] = o
                        }
                        return this.context = i, this.selector = e, this
                    }
                    return !n || n.jquery ? (n || r).find(e) : this.constructor(n).find(e)
                }
                return v.isFunction(e) ? r.ready(e) : (e.selector !== t && (this.selector = e.selector, this.context = e.context), v.makeArray(e, this))
            },
            selector: "",
            jquery: "1.8.2",
            length: 0,
            size: function() {
                return this.length
            },
            toArray: function() {
                return l.call(this)
            },
            get: function(e) {
                return e == null ? this.toArray() : e < 0 ? this[this.length + e] : this[e]
            },
            pushStack: function(e, t, n) {
                var r = v.merge(this.constructor(), e);
                return r.prevObject = this, r.context = this.context, t === "find" ? r.selector = this.selector + (this.selector ? " " : "") + n : t && (r.selector = this.selector + "." + t + "(" + n + ")"), r
            },
            each: function(e, t) {
                return v.each(this, e, t)
            },
            ready: function(e) {
                return v.ready.promise().done(e), this
            },
            eq: function(e) {
                return e = +e, e === -1 ? this.slice(e) : this.slice(e, e + 1)
            },
            first: function() {
                return this.eq(0)
            },
            last: function() {
                return this.eq(-1)
            },
            slice: function() {
                return this.pushStack(l.apply(this, arguments), "slice", l.call(arguments).join(","))
            },
            map: function(e) {
                return this.pushStack(v.map(this, function(t, n) {
                    return e.call(t, n, t)
                }))
            },
            end: function() {
                return this.prevObject || this.constructor(null)
            },
            push: f,
            sort: [].sort,
            splice: [].splice
        }, v.fn.init.prototype = v.fn, v.extend = v.fn.extend = function() {
            var e, n, r, i, s, o, u = arguments[0] || {},
                a = 1,
                f = arguments.length,
                l = !1;
            typeof u == "boolean" && (l = u, u = arguments[1] || {}, a = 2), typeof u != "object" && !v.isFunction(u) && (u = {}), f === a && (u = this, --a);
            for (; a < f; a++)
                if ((e = arguments[a]) != null)
                    for (n in e) {
                        r = u[n], i = e[n];
                        if (u === i) continue;
                        l && i && (v.isPlainObject(i) || (s = v.isArray(i))) ? (s ? (s = !1, o = r && v.isArray(r) ? r : []) : o = r && v.isPlainObject(r) ? r : {}, u[n] = v.extend(l, o, i)) : i !== t && (u[n] = i)
                    }
                return u
        }, v.extend({
            noConflict: function(t) {
                return e.$ === v && (e.$ = a), t && e.jQuery === v && (e.jQuery = u), v
            },
            isReady: !1,
            readyWait: 1,
            holdReady: function(e) {
                e ? v.readyWait++ : v.ready(!0)
            },
            ready: function(e) {
                if (e === !0 ? --v.readyWait : v.isReady) return;
                if (!i.body) return setTimeout(v.ready, 1);
                v.isReady = !0;
                if (e !== !0 && --v.readyWait > 0) return;
                r.resolveWith(i, [v]), v.fn.trigger && v(i).trigger("ready").off("ready")
            },
            isFunction: function(e) {
                return v.type(e) === "function"
            },
            isArray: Array.isArray || function(e) {
                return v.type(e) === "array"
            },
            isWindow: function(e) {
                return e != null && e == e.window
            },
            isNumeric: function(e) {
                return !isNaN(parseFloat(e)) && isFinite(e)
            },
            type: function(e) {
                return e == null ? String(e) : O[h.call(e)] || "object"
            },
            isPlainObject: function(e) {
                if (!e || v.type(e) !== "object" || e.nodeType || v.isWindow(e)) return !1;
                try {
                    if (e.constructor && !p.call(e, "constructor") && !p.call(e.constructor.prototype, "isPrototypeOf")) return !1
                } catch (n) {
                    return !1
                }
                var r;
                for (r in e);
                return r === t || p.call(e, r)
            },
            isEmptyObject: function(e) {
                var t;
                for (t in e) return !1;
                return !0
            },
            error: function(e) {
                throw new Error(e)
            },
            parseHTML: function(e, t, n) {
                var r;
                return !e || typeof e != "string" ? null : (typeof t == "boolean" && (n = t, t = 0), t = t || i, (r = E.exec(e)) ? [t.createElement(r[1])] : (r = v.buildFragment([e], t, n ? null : []), v.merge([], (r.cacheable ? v.clone(r.fragment) : r.fragment).childNodes)))
            },
            parseJSON: function(t) {
                if (!t || typeof t != "string") return null;
                t = v.trim(t);
                if (e.JSON && e.JSON.parse) return e.JSON.parse(t);
                if (S.test(t.replace(T, "@").replace(N, "]").replace(x, ""))) return (new Function("return " + t))();
                v.error("Invalid JSON: " + t)
            },
            parseXML: function(n) {
                var r, i;
                if (!n || typeof n != "string") return null;
                try {
                    e.DOMParser ? (i = new DOMParser, r = i.parseFromString(n, "text/xml")) : (r = new ActiveXObject("Microsoft.XMLDOM"), r.async = "false", r.loadXML(n))
                } catch (s) {
                    r = t
                }
                return (!r || !r.documentElement || r.getElementsByTagName("parsererror").length) && v.error("Invalid XML: " + n), r
            },
            noop: function() {},
            globalEval: function(t) {
                t && g.test(t) && (e.execScript || function(t) {
                    e.eval.call(e, t)
                })(t)
            },
            camelCase: function(e) {
                return e.replace(C, "ms-").replace(k, L)
            },
            nodeName: function(e, t) {
                return e.nodeName && e.nodeName.toLowerCase() === t.toLowerCase()
            },
            each: function(e, n, r) {
                var i, s = 0,
                    o = e.length,
                    u = o === t || v.isFunction(e);
                if (r) {
                    if (u) {
                        for (i in e)
                            if (n.apply(e[i], r) === !1) break
                    } else
                        for (; s < o;)
                            if (n.apply(e[s++], r) === !1) break
                } else if (u) {
                    for (i in e)
                        if (n.call(e[i], i, e[i]) === !1) break
                } else
                    for (; s < o;)
                        if (n.call(e[s], s, e[s++]) === !1) break; return e
            },
            trim: d && !d.call("﻿ ") ? function(e) {
                return e == null ? "" : d.call(e)
            } : function(e) {
                return e == null ? "" : (e + "").replace(b, "")
            },
            makeArray: function(e, t) {
                var n, r = t || [];
                return e != null && (n = v.type(e), e.length == null || n === "string" || n === "function" || n === "regexp" || v.isWindow(e) ? f.call(r, e) : v.merge(r, e)), r
            },
            inArray: function(e, t, n) {
                var r;
                if (t) {
                    if (c) return c.call(t, e, n);
                    r = t.length, n = n ? n < 0 ? Math.max(0, r + n) : n : 0;
                    for (; n < r; n++)
                        if (n in t && t[n] === e) return n
                }
                return -1
            },
            merge: function(e, n) {
                var r = n.length,
                    i = e.length,
                    s = 0;
                if (typeof r == "number")
                    for (; s < r; s++) e[i++] = n[s];
                else
                    while (n[s] !== t) e[i++] = n[s++];
                return e.length = i, e
            },
            grep: function(e, t, n) {
                var r, i = [],
                    s = 0,
                    o = e.length;
                n = !!n;
                for (; s < o; s++) r = !!t(e[s], s), n !== r && i.push(e[s]);
                return i
            },
            map: function(e, n, r) {
                var i, s, o = [],
                    u = 0,
                    a = e.length,
                    f = e instanceof v || a !== t && typeof a == "number" && (a > 0 && e[0] && e[a - 1] || a === 0 || v.isArray(e));
                if (f)
                    for (; u < a; u++) i = n(e[u], u, r), i != null && (o[o.length] = i);
                else
                    for (s in e) i = n(e[s], s, r), i != null && (o[o.length] = i);
                return o.concat.apply([], o)
            },
            guid: 1,
            proxy: function(e, n) {
                var r, i, s;
                return typeof n == "string" && (r = e[n], n = e, e = r), v.isFunction(e) ? (i = l.call(arguments, 2), s = function() {
                    return e.apply(n, i.concat(l.call(arguments)))
                }, s.guid = e.guid = e.guid || v.guid++, s) : t
            },
            access: function(e, n, r, i, s, o, u) {
                var a, f = r == null,
                    l = 0,
                    c = e.length;
                if (r && typeof r == "object") {
                    for (l in r) v.access(e, n, l, r[l], 1, o, i);
                    s = 1
                } else if (i !== t) {
                    a = u === t && v.isFunction(i), f && (a ? (a = n, n = function(e, t, n) {
                        return a.call(v(e), n)
                    }) : (n.call(e, i), n = null));
                    if (n)
                        for (; l < c; l++) n(e[l], r, a ? i.call(e[l], l, n(e[l], r)) : i, u);
                    s = 1
                }
                return s ? e : f ? n.call(e) : c ? n(e[0], r) : o
            },
            now: function() {
                return (new Date).getTime()
            }
        }), v.ready.promise = function(t) {
            if (!r) {
                r = v.Deferred();
                if (i.readyState === "complete") setTimeout(v.ready, 1);
                else if (i.addEventListener) i.addEventListener("DOMContentLoaded", A, !1), e.addEventListener("load", v.ready, !1);
                else {
                    i.attachEvent("onreadystatechange", A), e.attachEvent("onload", v.ready);
                    var n = !1;
                    try {
                        n = e.frameElement == null && i.documentElement
                    } catch (s) {}
                    n && n.doScroll && function o() {
                        if (!v.isReady) {
                            try {
                                n.doScroll("left")
                            } catch (e) {
                                return setTimeout(o, 50)
                            }
                            v.ready()
                        }
                    }()
                }
            }
            return r.promise(t)
        }, v.each("Boolean Number String Function Array Date RegExp Object".split(" "), function(e, t) {
            O["[object " + t + "]"] = t.toLowerCase()
        }), n = v(i);
        var M = {};
        v.Callbacks = function(e) {
            e = typeof e == "string" ? M[e] || _(e) : v.extend({}, e);
            var n, r, i, s, o, u, a = [],
                f = !e.once && [],
                l = function(t) {
                    n = e.memory && t, r = !0, u = s || 0, s = 0, o = a.length, i = !0;
                    for (; a && u < o; u++)
                        if (a[u].apply(t[0], t[1]) === !1 && e.stopOnFalse) {
                            n = !1;
                            break
                        }
                    i = !1, a && (f ? f.length && l(f.shift()) : n ? a = [] : c.disable())
                },
                c = {
                    add: function() {
                        if (a) {
                            var t = a.length;
                            (function r(t) {
                                v.each(t, function(t, n) {
                                    var i = v.type(n);
                                    i === "function" && (!e.unique || !c.has(n)) ? a.push(n) : n && n.length && i !== "string" && r(n)
                                })
                            })(arguments), i ? o = a.length : n && (s = t, l(n))
                        }
                        return this
                    },
                    remove: function() {
                        return a && v.each(arguments, function(e, t) {
                            var n;
                            while ((n = v.inArray(t, a, n)) > -1) a.splice(n, 1), i && (n <= o && o--, n <= u && u--)
                        }), this
                    },
                    has: function(e) {
                        return v.inArray(e, a) > -1
                    },
                    empty: function() {
                        return a = [], this
                    },
                    disable: function() {
                        return a = f = n = t, this
                    },
                    disabled: function() {
                        return !a
                    },
                    lock: function() {
                        return f = t, n || c.disable(), this
                    },
                    locked: function() {
                        return !f
                    },
                    fireWith: function(e, t) {
                        return t = t || [], t = [e, t.slice ? t.slice() : t], a && (!r || f) && (i ? f.push(t) : l(t)), this
                    },
                    fire: function() {
                        return c.fireWith(this, arguments), this
                    },
                    fired: function() {
                        return !!r
                    }
                };
            return c
        }, v.extend({
            Deferred: function(e) {
                var t = [
                        ["resolve", "done", v.Callbacks("once memory"), "resolved"],
                        ["reject", "fail", v.Callbacks("once memory"), "rejected"],
                        ["notify", "progress", v.Callbacks("memory")]
                    ],
                    n = "pending",
                    r = {
                        state: function() {
                            return n
                        },
                        always: function() {
                            return i.done(arguments).fail(arguments), this
                        },
                        then: function() {
                            var e = arguments;
                            return v.Deferred(function(n) {
                                v.each(t, function(t, r) {
                                    var s = r[0],
                                        o = e[t];
                                    i[r[1]](v.isFunction(o) ? function() {
                                        var e = o.apply(this, arguments);
                                        e && v.isFunction(e.promise) ? e.promise().done(n.resolve).fail(n.reject).progress(n.notify) : n[s + "With"](this === i ? n : this, [e])
                                    } : n[s])
                                }), e = null
                            }).promise()
                        },
                        promise: function(e) {
                            return e != null ? v.extend(e, r) : r
                        }
                    },
                    i = {};
                return r.pipe = r.then, v.each(t, function(e, s) {
                    var o = s[2],
                        u = s[3];
                    r[s[1]] = o.add, u && o.add(function() {
                        n = u
                    }, t[e ^ 1][2].disable, t[2][2].lock), i[s[0]] = o.fire, i[s[0] + "With"] = o.fireWith
                }), r.promise(i), e && e.call(i, i), i
            },
            when: function(e) {
                var t = 0,
                    n = l.call(arguments),
                    r = n.length,
                    i = r !== 1 || e && v.isFunction(e.promise) ? r : 0,
                    s = i === 1 ? e : v.Deferred(),
                    o = function(e, t, n) {
                        return function(r) {
                            t[e] = this, n[e] = arguments.length > 1 ? l.call(arguments) : r, n === u ? s.notifyWith(t, n) : --i || s.resolveWith(t, n)
                        }
                    },
                    u, a, f;
                if (r > 1) {
                    u = new Array(r), a = new Array(r), f = new Array(r);
                    for (; t < r; t++) n[t] && v.isFunction(n[t].promise) ? n[t].promise().done(o(t, f, n)).fail(s.reject).progress(o(t, a, u)) : --i
                }
                return i || s.resolveWith(f, n), s.promise()
            }
        }), v.support = function() {
            var t, n, r, s, o, u, a, f, l, c, h, p = i.createElement("div");
            p.setAttribute("className", "t"), p.innerHTML = "  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>", n = p.getElementsByTagName("*"), r = p.getElementsByTagName("a")[0], r.style.cssText = "top:1px;float:left;opacity:.5";
            if (!n || !n.length) return {};
            s = i.createElement("select"), o = s.appendChild(i.createElement("option")), u = p.getElementsByTagName("input")[0], t = {
                leadingWhitespace: p.firstChild.nodeType === 3,
                tbody: !p.getElementsByTagName("tbody").length,
                htmlSerialize: !!p.getElementsByTagName("link").length,
                style: /top/.test(r.getAttribute("style")),
                hrefNormalized: r.getAttribute("href") === "/a",
                opacity: /^0.5/.test(r.style.opacity),
                cssFloat: !!r.style.cssFloat,
                checkOn: u.value === "on",
                optSelected: o.selected,
                getSetAttribute: p.className !== "t",
                enctype: !!i.createElement("form").enctype,
                html5Clone: i.createElement("nav").cloneNode(!0).outerHTML !== "<:nav></:nav>",
                boxModel: i.compatMode === "CSS1Compat",
                submitBubbles: !0,
                changeBubbles: !0,
                focusinBubbles: !1,
                deleteExpando: !0,
                noCloneEvent: !0,
                inlineBlockNeedsLayout: !1,
                shrinkWrapBlocks: !1,
                reliableMarginRight: !0,
                boxSizingReliable: !0,
                pixelPosition: !1
            }, u.checked = !0, t.noCloneChecked = u.cloneNode(!0).checked, s.disabled = !0, t.optDisabled = !o.disabled;
            try {
                delete p.test
            } catch (d) {
                t.deleteExpando = !1
            }!p.addEventListener && p.attachEvent && p.fireEvent && (p.attachEvent("onclick", h = function() {
                t.noCloneEvent = !1
            }), p.cloneNode(!0).fireEvent("onclick"), p.detachEvent("onclick", h)), u = i.createElement("input"), u.value = "t", u.setAttribute("type", "radio"), t.radioValue = u.value === "t", u.setAttribute("checked", "checked"), u.setAttribute("name", "t"), p.appendChild(u), a = i.createDocumentFragment(), a.appendChild(p.lastChild), t.checkClone = a.cloneNode(!0).cloneNode(!0).lastChild.checked, t.appendChecked = u.checked, a.removeChild(u), a.appendChild(p);
            if (p.attachEvent)
                for (l in {
                    submit: !0,
                    change: !0,
                    focusin: !0
                }) f = "on" + l, c = f in p, c || (p.setAttribute(f, "return;"), c = typeof p[f] == "function"), t[l + "Bubbles"] = c;
            return v(function() {
                var n, r, s, o, u = "padding:0;margin:0;border:0;display:block;overflow:hidden;",
                    a = i.getElementsByTagName("body")[0];
                if (!a) return;
                n = i.createElement("div"), n.style.cssText = "visibility:hidden;border:0;width:0;height:0;position:static;top:0;margin-top:1px", a.insertBefore(n, a.firstChild), r = i.createElement("div"), n.appendChild(r), r.innerHTML = "<table><tr><td></td><td>t</td></tr></table>", s = r.getElementsByTagName("td"), s[0].style.cssText = "padding:0;margin:0;border:0;display:none", c = s[0].offsetHeight === 0, s[0].style.display = "", s[1].style.display = "none", t.reliableHiddenOffsets = c && s[0].offsetHeight === 0, r.innerHTML = "", r.style.cssText = "box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;", t.boxSizing = r.offsetWidth === 4, t.doesNotIncludeMarginInBodyOffset = a.offsetTop !== 1, e.getComputedStyle && (t.pixelPosition = (e.getComputedStyle(r, null) || {}).top !== "1%", t.boxSizingReliable = (e.getComputedStyle(r, null) || {
                    width: "4px"
                }).width === "4px", o = i.createElement("div"), o.style.cssText = r.style.cssText = u, o.style.marginRight = o.style.width = "0", r.style.width = "1px", r.appendChild(o), t.reliableMarginRight = !parseFloat((e.getComputedStyle(o, null) || {}).marginRight)), typeof r.style.zoom != "undefined" && (r.innerHTML = "", r.style.cssText = u + "width:1px;padding:1px;display:inline;zoom:1", t.inlineBlockNeedsLayout = r.offsetWidth === 3, r.style.display = "block", r.style.overflow = "visible", r.innerHTML = "<div></div>", r.firstChild.style.width = "5px", t.shrinkWrapBlocks = r.offsetWidth !== 3, n.style.zoom = 1), a.removeChild(n), n = r = s = o = null
            }), a.removeChild(p), n = r = s = o = u = a = p = null, t
        }();
        var D = /(?:\{[\s\S]*\}|\[[\s\S]*\])$/,
            P = /([A-Z])/g;
        v.extend({
            cache: {},
            deletedIds: [],
            uuid: 0,
            expando: "jQuery" + (v.fn.jquery + Math.random()).replace(/\D/g, ""),
            noData: {
                embed: !0,
                object: "clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",
                applet: !0
            },
            hasData: function(e) {
                return e = e.nodeType ? v.cache[e[v.expando]] : e[v.expando], !!e && !B(e)
            },
            data: function(e, n, r, i) {
                if (!v.acceptData(e)) return;
                var s, o, u = v.expando,
                    a = typeof n == "string",
                    f = e.nodeType,
                    l = f ? v.cache : e,
                    c = f ? e[u] : e[u] && u;
                if ((!c || !l[c] || !i && !l[c].data) && a && r === t) return;
                c || (f ? e[u] = c = v.deletedIds.pop() || v.guid++ : c = u), l[c] || (l[c] = {}, f || (l[c].toJSON = v.noop));
                if (typeof n == "object" || typeof n == "function") i ? l[c] = v.extend(l[c], n) : l[c].data = v.extend(l[c].data, n);
                return s = l[c], i || (s.data || (s.data = {}), s = s.data), r !== t && (s[v.camelCase(n)] = r), a ? (o = s[n], o == null && (o = s[v.camelCase(n)])) : o = s, o
            },
            removeData: function(e, t, n) {
                if (!v.acceptData(e)) return;
                var r, i, s, o = e.nodeType,
                    u = o ? v.cache : e,
                    a = o ? e[v.expando] : v.expando;
                if (!u[a]) return;
                if (t) {
                    r = n ? u[a] : u[a].data;
                    if (r) {
                        v.isArray(t) || (t in r ? t = [t] : (t = v.camelCase(t), t in r ? t = [t] : t = t.split(" ")));
                        for (i = 0, s = t.length; i < s; i++) delete r[t[i]];
                        if (!(n ? B : v.isEmptyObject)(r)) return
                    }
                }
                if (!n) {
                    delete u[a].data;
                    if (!B(u[a])) return
                }
                o ? v.cleanData([e], !0) : v.support.deleteExpando || u != u.window ? delete u[a] : u[a] = null
            },
            _data: function(e, t, n) {
                return v.data(e, t, n, !0)
            },
            acceptData: function(e) {
                var t = e.nodeName && v.noData[e.nodeName.toLowerCase()];
                return !t || t !== !0 && e.getAttribute("classid") === t
            }
        }), v.fn.extend({
            data: function(e, n) {
                var r, i, s, o, u, a = this[0],
                    f = 0,
                    l = null;
                if (e === t) {
                    if (this.length) {
                        l = v.data(a);
                        if (a.nodeType === 1 && !v._data(a, "parsedAttrs")) {
                            s = a.attributes;
                            for (u = s.length; f < u; f++) o = s[f].name, o.indexOf("data-") || (o = v.camelCase(o.substring(5)), H(a, o, l[o]));
                            v._data(a, "parsedAttrs", !0)
                        }
                    }
                    return l
                }
                return typeof e == "object" ? this.each(function() {
                    v.data(this, e)
                }) : (r = e.split(".", 2), r[1] = r[1] ? "." + r[1] : "", i = r[1] + "!", v.access(this, function(n) {
                    if (n === t) return l = this.triggerHandler("getData" + i, [r[0]]), l === t && a && (l = v.data(a, e), l = H(a, e, l)), l === t && r[1] ? this.data(r[0]) : l;
                    r[1] = n, this.each(function() {
                        var t = v(this);
                        t.triggerHandler("setData" + i, r), v.data(this, e, n), t.triggerHandler("changeData" + i, r)
                    })
                }, null, n, arguments.length > 1, null, !1))
            },
            removeData: function(e) {
                return this.each(function() {
                    v.removeData(this, e)
                })
            }
        }), v.extend({
            queue: function(e, t, n) {
                var r;
                if (e) return t = (t || "fx") + "queue", r = v._data(e, t), n && (!r || v.isArray(n) ? r = v._data(e, t, v.makeArray(n)) : r.push(n)), r || []
            },
            dequeue: function(e, t) {
                t = t || "fx";
                var n = v.queue(e, t),
                    r = n.length,
                    i = n.shift(),
                    s = v._queueHooks(e, t),
                    o = function() {
                        v.dequeue(e, t)
                    };
                i === "inprogress" && (i = n.shift(), r--), i && (t === "fx" && n.unshift("inprogress"), delete s.stop, i.call(e, o, s)), !r && s && s.empty.fire()
            },
            _queueHooks: function(e, t) {
                var n = t + "queueHooks";
                return v._data(e, n) || v._data(e, n, {
                    empty: v.Callbacks("once memory").add(function() {
                        v.removeData(e, t + "queue", !0), v.removeData(e, n, !0)
                    })
                })
            }
        }), v.fn.extend({
            queue: function(e, n) {
                var r = 2;
                return typeof e != "string" && (n = e, e = "fx", r--), arguments.length < r ? v.queue(this[0], e) : n === t ? this : this.each(function() {
                    var t = v.queue(this, e, n);
                    v._queueHooks(this, e), e === "fx" && t[0] !== "inprogress" && v.dequeue(this, e)
                })
            },
            dequeue: function(e) {
                return this.each(function() {
                    v.dequeue(this, e)
                })
            },
            delay: function(e, t) {
                return e = v.fx ? v.fx.speeds[e] || e : e, t = t || "fx", this.queue(t, function(t, n) {
                    var r = setTimeout(t, e);
                    n.stop = function() {
                        clearTimeout(r)
                    }
                })
            },
            clearQueue: function(e) {
                return this.queue(e || "fx", [])
            },
            promise: function(e, n) {
                var r, i = 1,
                    s = v.Deferred(),
                    o = this,
                    u = this.length,
                    a = function() {
                        --i || s.resolveWith(o, [o])
                    };
                typeof e != "string" && (n = e, e = t), e = e || "fx";
                while (u--) r = v._data(o[u], e + "queueHooks"), r && r.empty && (i++, r.empty.add(a));
                return a(), s.promise(n)
            }
        });
        var j, F, I, q = /[\t\r\n]/g,
            R = /\r/g,
            U = /^(?:button|input)$/i,
            z = /^(?:button|input|object|select|textarea)$/i,
            W = /^a(?:rea|)$/i,
            X = /^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,
            V = v.support.getSetAttribute;
        v.fn.extend({
            attr: function(e, t) {
                return v.access(this, v.attr, e, t, arguments.length > 1)
            },
            removeAttr: function(e) {
                return this.each(function() {
                    v.removeAttr(this, e)
                })
            },
            prop: function(e, t) {
                return v.access(this, v.prop, e, t, arguments.length > 1)
            },
            removeProp: function(e) {
                return e = v.propFix[e] || e, this.each(function() {
                    try {
                        this[e] = t, delete this[e]
                    } catch (n) {}
                })
            },
            addClass: function(e) {
                var t, n, r, i, s, o, u;
                if (v.isFunction(e)) return this.each(function(t) {
                    v(this).addClass(e.call(this, t, this.className))
                });
                if (e && typeof e == "string") {
                    t = e.split(y);
                    for (n = 0, r = this.length; n < r; n++) {
                        i = this[n];
                        if (i.nodeType === 1)
                            if (!i.className && t.length === 1) i.className = e;
                            else {
                                s = " " + i.className + " ";
                                for (o = 0, u = t.length; o < u; o++) s.indexOf(" " + t[o] + " ") < 0 && (s += t[o] + " ");
                                i.className = v.trim(s)
                            }
                    }
                }
                return this
            },
            removeClass: function(e) {
                var n, r, i, s, o, u, a;
                if (v.isFunction(e)) return this.each(function(t) {
                    v(this).removeClass(e.call(this, t, this.className))
                });
                if (e && typeof e == "string" || e === t) {
                    n = (e || "").split(y);
                    for (u = 0, a = this.length; u < a; u++) {
                        i = this[u];
                        if (i.nodeType === 1 && i.className) {
                            r = (" " + i.className + " ").replace(q, " ");
                            for (s = 0, o = n.length; s < o; s++)
                                while (r.indexOf(" " + n[s] + " ") >= 0) r = r.replace(" " + n[s] + " ", " ");
                            i.className = e ? v.trim(r) : ""
                        }
                    }
                }
                return this
            },
            toggleClass: function(e, t) {
                var n = typeof e,
                    r = typeof t == "boolean";
                return v.isFunction(e) ? this.each(function(n) {
                    v(this).toggleClass(e.call(this, n, this.className, t), t)
                }) : this.each(function() {
                    if (n === "string") {
                        var i, s = 0,
                            o = v(this),
                            u = t,
                            a = e.split(y);
                        while (i = a[s++]) u = r ? u : !o.hasClass(i), o[u ? "addClass" : "removeClass"](i)
                    } else if (n === "undefined" || n === "boolean") this.className && v._data(this, "__className__", this.className), this.className = this.className || e === !1 ? "" : v._data(this, "__className__") || ""
                })
            },
            hasClass: function(e) {
                var t = " " + e + " ",
                    n = 0,
                    r = this.length;
                for (; n < r; n++)
                    if (this[n].nodeType === 1 && (" " + this[n].className + " ").replace(q, " ").indexOf(t) >= 0) return !0;
                return !1
            },
            val: function(e) {
                var n, r, i, s = this[0];
                if (!arguments.length) {
                    if (s) return n = v.valHooks[s.type] || v.valHooks[s.nodeName.toLowerCase()], n && "get" in n && (r = n.get(s, "value")) !== t ? r : (r = s.value, typeof r == "string" ? r.replace(R, "") : r == null ? "" : r);
                    return
                }
                return i = v.isFunction(e), this.each(function(r) {
                    var s, o = v(this);
                    if (this.nodeType !== 1) return;
                    i ? s = e.call(this, r, o.val()) : s = e, s == null ? s = "" : typeof s == "number" ? s += "" : v.isArray(s) && (s = v.map(s, function(e) {
                        return e == null ? "" : e + ""
                    })), n = v.valHooks[this.type] || v.valHooks[this.nodeName.toLowerCase()];
                    if (!n || !("set" in n) || n.set(this, s, "value") === t) this.value = s
                })
            }
        }), v.extend({
            valHooks: {
                option: {
                    get: function(e) {
                        var t = e.attributes.value;
                        return !t || t.specified ? e.value : e.text
                    }
                },
                select: {
                    get: function(e) {
                        var t, n, r, i, s = e.selectedIndex,
                            o = [],
                            u = e.options,
                            a = e.type === "select-one";
                        if (s < 0) return null;
                        n = a ? s : 0, r = a ? s + 1 : u.length;
                        for (; n < r; n++) {
                            i = u[n];
                            if (i.selected && (v.support.optDisabled ? !i.disabled : i.getAttribute("disabled") === null) && (!i.parentNode.disabled || !v.nodeName(i.parentNode, "optgroup"))) {
                                t = v(i).val();
                                if (a) return t;
                                o.push(t)
                            }
                        }
                        return a && !o.length && u.length ? v(u[s]).val() : o
                    },
                    set: function(e, t) {
                        var n = v.makeArray(t);
                        return v(e).find("option").each(function() {
                            this.selected = v.inArray(v(this).val(), n) >= 0
                        }), n.length || (e.selectedIndex = -1), n
                    }
                }
            },
            attrFn: {},
            attr: function(e, n, r, i) {
                var s, o, u, a = e.nodeType;
                if (!e || a === 3 || a === 8 || a === 2) return;
                if (i && v.isFunction(v.fn[n])) return v(e)[n](r);
                if (typeof e.getAttribute == "undefined") return v.prop(e, n, r);
                u = a !== 1 || !v.isXMLDoc(e), u && (n = n.toLowerCase(), o = v.attrHooks[n] || (X.test(n) ? F : j));
                if (r !== t) {
                    if (r === null) {
                        v.removeAttr(e, n);
                        return
                    }
                    return o && "set" in o && u && (s = o.set(e, r, n)) !== t ? s : (e.setAttribute(n, r + ""), r)
                }
                return o && "get" in o && u && (s = o.get(e, n)) !== null ? s : (s = e.getAttribute(n), s === null ? t : s)
            },
            removeAttr: function(e, t) {
                var n, r, i, s, o = 0;
                if (t && e.nodeType === 1) {
                    r = t.split(y);
                    for (; o < r.length; o++) i = r[o], i && (n = v.propFix[i] || i, s = X.test(i), s || v.attr(e, i, ""), e.removeAttribute(V ? i : n), s && n in e && (e[n] = !1))
                }
            },
            attrHooks: {
                type: {
                    set: function(e, t) {
                        if (U.test(e.nodeName) && e.parentNode) v.error("type property can't be changed");
                        else if (!v.support.radioValue && t === "radio" && v.nodeName(e, "input")) {
                            var n = e.value;
                            return e.setAttribute("type", t), n && (e.value = n), t
                        }
                    }
                },
                value: {
                    get: function(e, t) {
                        return j && v.nodeName(e, "button") ? j.get(e, t) : t in e ? e.value : null
                    },
                    set: function(e, t, n) {
                        if (j && v.nodeName(e, "button")) return j.set(e, t, n);
                        e.value = t
                    }
                }
            },
            propFix: {
                tabindex: "tabIndex",
                readonly: "readOnly",
                "for": "htmlFor",
                "class": "className",
                maxlength: "maxLength",
                cellspacing: "cellSpacing",
                cellpadding: "cellPadding",
                rowspan: "rowSpan",
                colspan: "colSpan",
                usemap: "useMap",
                frameborder: "frameBorder",
                contenteditable: "contentEditable"
            },
            prop: function(e, n, r) {
                var i, s, o, u = e.nodeType;
                if (!e || u === 3 || u === 8 || u === 2) return;
                return o = u !== 1 || !v.isXMLDoc(e), o && (n = v.propFix[n] || n, s = v.propHooks[n]), r !== t ? s && "set" in s && (i = s.set(e, r, n)) !== t ? i : e[n] = r : s && "get" in s && (i = s.get(e, n)) !== null ? i : e[n]
            },
            propHooks: {
                tabIndex: {
                    get: function(e) {
                        var n = e.getAttributeNode("tabindex");
                        return n && n.specified ? parseInt(n.value, 10) : z.test(e.nodeName) || W.test(e.nodeName) && e.href ? 0 : t
                    }
                }
            }
        }), F = {
            get: function(e, n) {
                var r, i = v.prop(e, n);
                return i === !0 || typeof i != "boolean" && (r = e.getAttributeNode(n)) && r.nodeValue !== !1 ? n.toLowerCase() : t
            },
            set: function(e, t, n) {
                var r;
                return t === !1 ? v.removeAttr(e, n) : (r = v.propFix[n] || n, r in e && (e[r] = !0), e.setAttribute(n, n.toLowerCase())), n
            }
        }, V || (I = {
            name: !0,
            id: !0,
            coords: !0
        }, j = v.valHooks.button = {
            get: function(e, n) {
                var r;
                return r = e.getAttributeNode(n), r && (I[n] ? r.value !== "" : r.specified) ? r.value : t
            },
            set: function(e, t, n) {
                var r = e.getAttributeNode(n);
                return r || (r = i.createAttribute(n), e.setAttributeNode(r)), r.value = t + ""
            }
        }, v.each(["width", "height"], function(e, t) {
            v.attrHooks[t] = v.extend(v.attrHooks[t], {
                set: function(e, n) {
                    if (n === "") return e.setAttribute(t, "auto"), n
                }
            })
        }), v.attrHooks.contenteditable = {
            get: j.get,
            set: function(e, t, n) {
                t === "" && (t = "false"), j.set(e, t, n)
            }
        }), v.support.hrefNormalized || v.each(["href", "src", "width", "height"], function(e, n) {
            v.attrHooks[n] = v.extend(v.attrHooks[n], {
                get: function(e) {
                    var r = e.getAttribute(n, 2);
                    return r === null ? t : r
                }
            })
        }), v.support.style || (v.attrHooks.style = {
            get: function(e) {
                return e.style.cssText.toLowerCase() || t
            },
            set: function(e, t) {
                return e.style.cssText = t + ""
            }
        }), v.support.optSelected || (v.propHooks.selected = v.extend(v.propHooks.selected, {
            get: function(e) {
                var t = e.parentNode;
                return t && (t.selectedIndex, t.parentNode && t.parentNode.selectedIndex), null
            }
        })), v.support.enctype || (v.propFix.enctype = "encoding"), v.support.checkOn || v.each(["radio", "checkbox"], function() {
            v.valHooks[this] = {
                get: function(e) {
                    return e.getAttribute("value") === null ? "on" : e.value
                }
            }
        }), v.each(["radio", "checkbox"], function() {
            v.valHooks[this] = v.extend(v.valHooks[this], {
                set: function(e, t) {
                    if (v.isArray(t)) return e.checked = v.inArray(v(e).val(), t) >= 0
                }
            })
        });
        var $ = /^(?:textarea|input|select)$/i,
            J = /^([^\.]*|)(?:\.(.+)|)$/,
            K = /(?:^|\s)hover(\.\S+|)\b/,
            Q = /^key/,
            G = /^(?:mouse|contextmenu)|click/,
            Y = /^(?:focusinfocus|focusoutblur)$/,
            Z = function(e) {
                return v.event.special.hover ? e : e.replace(K, "mouseenter$1 mouseleave$1")
            };
        v.event = {
                add: function(e, n, r, i, s) {
                    var o, u, a, f, l, c, h, p, d, m, g;
                    if (e.nodeType === 3 || e.nodeType === 8 || !n || !r || !(o = v._data(e))) return;
                    r.handler && (d = r, r = d.handler, s = d.selector), r.guid || (r.guid = v.guid++), a = o.events, a || (o.events = a = {}), u = o.handle, u || (o.handle = u = function(e) {
                        return typeof v == "undefined" || !!e && v.event.triggered === e.type ? t : v.event.dispatch.apply(u.elem, arguments)
                    }, u.elem = e), n = v.trim(Z(n)).split(" ");
                    for (f = 0; f < n.length; f++) {
                        l = J.exec(n[f]) || [], c = l[1], h = (l[2] || "").split(".").sort(), g = v.event.special[c] || {}, c = (s ? g.delegateType : g.bindType) || c, g = v.event.special[c] || {}, p = v.extend({
                            type: c,
                            origType: l[1],
                            data: i,
                            handler: r,
                            guid: r.guid,
                            selector: s,
                            needsContext: s && v.expr.match.needsContext.test(s),
                            namespace: h.join(".")
                        }, d), m = a[c];
                        if (!m) {
                            m = a[c] = [], m.delegateCount = 0;
                            if (!g.setup || g.setup.call(e, i, h, u) === !1) e.addEventListener ? e.addEventListener(c, u, !1) : e.attachEvent && e.attachEvent("on" + c, u)
                        }
                        g.add && (g.add.call(e, p), p.handler.guid || (p.handler.guid = r.guid)), s ? m.splice(m.delegateCount++, 0, p) : m.push(p), v.event.global[c] = !0
                    }
                    e = null
                },
                global: {},
                remove: function(e, t, n, r, i) {
                    var s, o, u, a, f, l, c, h, p, d, m, g = v.hasData(e) && v._data(e);
                    if (!g || !(h = g.events)) return;
                    t = v.trim(Z(t || "")).split(" ");
                    for (s = 0; s < t.length; s++) {
                        o = J.exec(t[s]) || [], u = a = o[1], f = o[2];
                        if (!u) {
                            for (u in h) v.event.remove(e, u + t[s], n, r, !0);
                            continue
                        }
                        p = v.event.special[u] || {}, u = (r ? p.delegateType : p.bindType) || u, d = h[u] || [], l = d.length, f = f ? new RegExp("(^|\\.)" + f.split(".").sort().join("\\.(?:.*\\.|)") + "(\\.|$)") : null;
                        for (c = 0; c < d.length; c++) m = d[c], (i || a === m.origType) && (!n || n.guid === m.guid) && (!f || f.test(m.namespace)) && (!r || r === m.selector || r === "**" && m.selector) && (d.splice(c--, 1), m.selector && d.delegateCount--, p.remove && p.remove.call(e, m));
                        d.length === 0 && l !== d.length && ((!p.teardown || p.teardown.call(e, f, g.handle) === !1) && v.removeEvent(e, u, g.handle), delete h[u])
                    }
                    v.isEmptyObject(h) && (delete g.handle, v.removeData(e, "events", !0))
                },
                customEvent: {
                    getData: !0,
                    setData: !0,
                    changeData: !0
                },
                trigger: function(n, r, s, o) {
                    if (!s || s.nodeType !== 3 && s.nodeType !== 8) {
                        var u, a, f, l, c, h, p, d, m, g, y = n.type || n,
                            b = [];
                        if (Y.test(y + v.event.triggered)) return;
                        y.indexOf("!") >= 0 && (y = y.slice(0, -1), a = !0), y.indexOf(".") >= 0 && (b = y.split("."), y = b.shift(), b.sort());
                        if ((!s || v.event.customEvent[y]) && !v.event.global[y]) return;
                        n = typeof n == "object" ? n[v.expando] ? n : new v.Event(y, n) : new v.Event(y), n.type = y, n.isTrigger = !0, n.exclusive = a, n.namespace = b.join("."), n.namespace_re = n.namespace ? new RegExp("(^|\\.)" + b.join("\\.(?:.*\\.|)") + "(\\.|$)") : null, h = y.indexOf(":") < 0 ? "on" + y : "";
                        if (!s) {
                            u = v.cache;
                            for (f in u) u[f].events && u[f].events[y] && v.event.trigger(n, r, u[f].handle.elem, !0);
                            return
                        }
                        n.result = t, n.target || (n.target = s), r = r != null ? v.makeArray(r) : [], r.unshift(n), p = v.event.special[y] || {};
                        if (p.trigger && p.trigger.apply(s, r) === !1) return;
                        m = [
                            [s, p.bindType || y]
                        ];
                        if (!o && !p.noBubble && !v.isWindow(s)) {
                            g = p.delegateType || y, l = Y.test(g + y) ? s : s.parentNode;
                            for (c = s; l; l = l.parentNode) m.push([l, g]), c = l;
                            c === (s.ownerDocument || i) && m.push([c.defaultView || c.parentWindow || e, g])
                        }
                        for (f = 0; f < m.length && !n.isPropagationStopped(); f++) l = m[f][0], n.type = m[f][1], d = (v._data(l, "events") || {})[n.type] && v._data(l, "handle"), d && d.apply(l, r), d = h && l[h], d && v.acceptData(l) && d.apply && d.apply(l, r) === !1 && n.preventDefault();
                        return n.type = y, !o && !n.isDefaultPrevented() && (!p._default || p._default.apply(s.ownerDocument, r) === !1) && (y !== "click" || !v.nodeName(s, "a")) && v.acceptData(s) && h && s[y] && (y !== "focus" && y !== "blur" || n.target.offsetWidth !== 0) && !v.isWindow(s) && (c = s[h], c && (s[h] = null), v.event.triggered = y, s[y](), v.event.triggered = t, c && (s[h] = c)), n.result
                    }
                    return
                },
                dispatch: function(n) {
                    n = v.event.fix(n || e.event);
                    var r, i, s, o, u, a, f, c, h, p, d = (v._data(this, "events") || {})[n.type] || [],
                        m = d.delegateCount,
                        g = l.call(arguments),
                        y = !n.exclusive && !n.namespace,
                        b = v.event.special[n.type] || {},
                        w = [];
                    g[0] = n, n.delegateTarget = this;
                    if (b.preDispatch && b.preDispatch.call(this, n) === !1) return;
                    if (m && (!n.button || n.type !== "click"))
                        for (s = n.target; s != this; s = s.parentNode || this)
                            if (s.disabled !== !0 || n.type !== "click") {
                                u = {}, f = [];
                                for (r = 0; r < m; r++) c = d[r], h = c.selector, u[h] === t && (u[h] = c.needsContext ? v(h, this).index(s) >= 0 : v.find(h, this, null, [s]).length), u[h] && f.push(c);
                                f.length && w.push({
                                    elem: s,
                                    matches: f
                                })
                            }
                    d.length > m && w.push({
                        elem: this,
                        matches: d.slice(m)
                    });
                    for (r = 0; r < w.length && !n.isPropagationStopped(); r++) {
                        a = w[r], n.currentTarget = a.elem;
                        for (i = 0; i < a.matches.length && !n.isImmediatePropagationStopped(); i++) {
                            c = a.matches[i];
                            if (y || !n.namespace && !c.namespace || n.namespace_re && n.namespace_re.test(c.namespace)) n.data = c.data, n.handleObj = c, o = ((v.event.special[c.origType] || {}).handle || c.handler).apply(a.elem, g), o !== t && (n.result = o, o === !1 && (n.preventDefault(), n.stopPropagation()))
                        }
                    }
                    return b.postDispatch && b.postDispatch.call(this, n), n.result
                },
                props: "attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),
                fixHooks: {},
                keyHooks: {
                    props: "char charCode key keyCode".split(" "),
                    filter: function(e, t) {
                        return e.which == null && (e.which = t.charCode != null ? t.charCode : t.keyCode), e
                    }
                },
                mouseHooks: {
                    props: "button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),
                    filter: function(e, n) {
                        var r, s, o, u = n.button,
                            a = n.fromElement;
                        return e.pageX == null && n.clientX != null && (r = e.target.ownerDocument || i, s = r.documentElement, o = r.body, e.pageX = n.clientX + (s && s.scrollLeft || o && o.scrollLeft || 0) - (s && s.clientLeft || o && o.clientLeft || 0), e.pageY = n.clientY + (s && s.scrollTop || o && o.scrollTop || 0) - (s && s.clientTop || o && o.clientTop || 0)), !e.relatedTarget && a && (e.relatedTarget = a === e.target ? n.toElement : a), !e.which && u !== t && (e.which = u & 1 ? 1 : u & 2 ? 3 : u & 4 ? 2 : 0), e
                    }
                },
                fix: function(e) {
                    if (e[v.expando]) return e;
                    var t, n, r = e,
                        s = v.event.fixHooks[e.type] || {},
                        o = s.props ? this.props.concat(s.props) : this.props;
                    e = v.Event(r);
                    for (t = o.length; t;) n = o[--t], e[n] = r[n];
                    return e.target || (e.target = r.srcElement || i), e.target.nodeType === 3 && (e.target = e.target.parentNode), e.metaKey = !!e.metaKey, s.filter ? s.filter(e, r) : e
                },
                special: {
                    load: {
                        noBubble: !0
                    },
                    focus: {
                        delegateType: "focusin"
                    },
                    blur: {
                        delegateType: "focusout"
                    },
                    beforeunload: {
                        setup: function(e, t, n) {
                            v.isWindow(this) && (this.onbeforeunload = n)
                        },
                        teardown: function(e, t) {
                            this.onbeforeunload === t && (this.onbeforeunload = null)
                        }
                    }
                },
                simulate: function(e, t, n, r) {
                    var i = v.extend(new v.Event, n, {
                        type: e,
                        isSimulated: !0,
                        originalEvent: {}
                    });
                    r ? v.event.trigger(i, null, t) : v.event.dispatch.call(t, i), i.isDefaultPrevented() && n.preventDefault()
                }
            }, v.event.handle = v.event.dispatch, v.removeEvent = i.removeEventListener ? function(e, t, n) {
                e.removeEventListener && e.removeEventListener(t, n, !1)
            } : function(e, t, n) {
                var r = "on" + t;
                e.detachEvent && (typeof e[r] == "undefined" && (e[r] = null), e.detachEvent(r, n))
            }, v.Event = function(e, t) {
                if (!(this instanceof v.Event)) return new v.Event(e, t);
                e && e.type ? (this.originalEvent = e, this.type = e.type, this.isDefaultPrevented = e.defaultPrevented || e.returnValue === !1 || e.getPreventDefault && e.getPreventDefault() ? tt : et) : this.type = e, t && v.extend(this, t), this.timeStamp = e && e.timeStamp || v.now(), this[v.expando] = !0
            }, v.Event.prototype = {
                preventDefault: function() {
                    this.isDefaultPrevented = tt;
                    var e = this.originalEvent;
                    if (!e) return;
                    e.preventDefault ? e.preventDefault() : e.returnValue = !1
                },
                stopPropagation: function() {
                    this.isPropagationStopped = tt;
                    var e = this.originalEvent;
                    if (!e) return;
                    e.stopPropagation && e.stopPropagation(), e.cancelBubble = !0
                },
                stopImmediatePropagation: function() {
                    this.isImmediatePropagationStopped = tt, this.stopPropagation()
                },
                isDefaultPrevented: et,
                isPropagationStopped: et,
                isImmediatePropagationStopped: et
            }, v.each({
                mouseenter: "mouseover",
                mouseleave: "mouseout"
            }, function(e, t) {
                v.event.special[e] = {
                    delegateType: t,
                    bindType: t,
                    handle: function(e) {
                        var n, r = this,
                            i = e.relatedTarget,
                            s = e.handleObj,
                            o = s.selector;
                        if (!i || i !== r && !v.contains(r, i)) e.type = s.origType, n = s.handler.apply(this, arguments), e.type = t;
                        return n
                    }
                }
            }), v.support.submitBubbles || (v.event.special.submit = {
                setup: function() {
                    if (v.nodeName(this, "form")) return !1;
                    v.event.add(this, "click._submit keypress._submit", function(e) {
                        var n = e.target,
                            r = v.nodeName(n, "input") || v.nodeName(n, "button") ? n.form : t;
                        r && !v._data(r, "_submit_attached") && (v.event.add(r, "submit._submit", function(e) {
                            e._submit_bubble = !0
                        }), v._data(r, "_submit_attached", !0))
                    })
                },
                postDispatch: function(e) {
                    e._submit_bubble && (delete e._submit_bubble, this.parentNode && !e.isTrigger && v.event.simulate("submit", this.parentNode, e, !0))
                },
                teardown: function() {
                    if (v.nodeName(this, "form")) return !1;
                    v.event.remove(this, "._submit")
                }
            }), v.support.changeBubbles || (v.event.special.change = {
                setup: function() {
                    if ($.test(this.nodeName)) {
                        if (this.type === "checkbox" || this.type === "radio") v.event.add(this, "propertychange._change", function(e) {
                            e.originalEvent.propertyName === "checked" && (this._just_changed = !0)
                        }), v.event.add(this, "click._change", function(e) {
                            this._just_changed && !e.isTrigger && (this._just_changed = !1), v.event.simulate("change", this, e, !0)
                        });
                        return !1
                    }
                    v.event.add(this, "beforeactivate._change", function(e) {
                        var t = e.target;
                        $.test(t.nodeName) && !v._data(t, "_change_attached") && (v.event.add(t, "change._change", function(e) {
                            this.parentNode && !e.isSimulated && !e.isTrigger && v.event.simulate("change", this.parentNode, e, !0)
                        }), v._data(t, "_change_attached", !0))
                    })
                },
                handle: function(e) {
                    var t = e.target;
                    if (this !== t || e.isSimulated || e.isTrigger || t.type !== "radio" && t.type !== "checkbox") return e.handleObj.handler.apply(this, arguments)
                },
                teardown: function() {
                    return v.event.remove(this, "._change"), !$.test(this.nodeName)
                }
            }), v.support.focusinBubbles || v.each({
                focus: "focusin",
                blur: "focusout"
            }, function(e, t) {
                var n = 0,
                    r = function(e) {
                        v.event.simulate(t, e.target, v.event.fix(e), !0)
                    };
                v.event.special[t] = {
                    setup: function() {
                        n++ === 0 && i.addEventListener(e, r, !0)
                    },
                    teardown: function() {
                        --n === 0 && i.removeEventListener(e, r, !0)
                    }
                }
            }), v.fn.extend({
                on: function(e, n, r, i, s) {
                    var o, u;
                    if (typeof e == "object") {
                        typeof n != "string" && (r = r || n, n = t);
                        for (u in e) this.on(u, n, r, e[u], s);
                        return this
                    }
                    r == null && i == null ? (i = n, r = n = t) : i == null && (typeof n == "string" ? (i = r, r = t) : (i = r, r = n, n = t));
                    if (i === !1) i = et;
                    else if (!i) return this;
                    return s === 1 && (o = i, i = function(e) {
                        return v().off(e), o.apply(this, arguments)
                    }, i.guid = o.guid || (o.guid = v.guid++)), this.each(function() {
                        v.event.add(this, e, i, r, n)
                    })
                },
                one: function(e, t, n, r) {
                    return this.on(e, t, n, r, 1)
                },
                off: function(e, n, r) {
                    var i, s;
                    if (e && e.preventDefault && e.handleObj) return i = e.handleObj, v(e.delegateTarget).off(i.namespace ? i.origType + "." + i.namespace : i.origType, i.selector, i.handler), this;
                    if (typeof e == "object") {
                        for (s in e) this.off(s, n, e[s]);
                        return this
                    }
                    if (n === !1 || typeof n == "function") r = n, n = t;
                    return r === !1 && (r = et), this.each(function() {
                        v.event.remove(this, e, r, n)
                    })
                },
                bind: function(e, t, n) {
                    return this.on(e, null, t, n)
                },
                unbind: function(e, t) {
                    return this.off(e, null, t)
                },
                live: function(e, t, n) {
                    return v(this.context).on(e, this.selector, t, n), this
                },
                die: function(e, t) {
                    return v(this.context).off(e, this.selector || "**", t), this
                },
                delegate: function(e, t, n, r) {
                    return this.on(t, e, n, r)
                },
                undelegate: function(e, t, n) {
                    return arguments.length === 1 ? this.off(e, "**") : this.off(t, e || "**", n)
                },
                trigger: function(e, t) {
                    return this.each(function() {
                        v.event.trigger(e, t, this)
                    })
                },
                triggerHandler: function(e, t) {
                    if (this[0]) return v.event.trigger(e, t, this[0], !0)
                },
                toggle: function(e) {
                    var t = arguments,
                        n = e.guid || v.guid++,
                        r = 0,
                        i = function(n) {
                            var i = (v._data(this, "lastToggle" + e.guid) || 0) % r;
                            return v._data(this, "lastToggle" + e.guid, i + 1), n.preventDefault(), t[i].apply(this, arguments) || !1
                        };
                    i.guid = n;
                    while (r < t.length) t[r++].guid = n;
                    return this.click(i)
                },
                hover: function(e, t) {
                    return this.mouseenter(e).mouseleave(t || e)
                }
            }), v.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "), function(e, t) {
                v.fn[t] = function(e, n) {
                    return n == null && (n = e, e = null), arguments.length > 0 ? this.on(t, null, e, n) : this.trigger(t)
                }, Q.test(t) && (v.event.fixHooks[t] = v.event.keyHooks), G.test(t) && (v.event.fixHooks[t] = v.event.mouseHooks)
            }),
            function(e, t) {
                function nt(e, t, n, r) {
                    n = n || [], t = t || g;
                    var i, s, a, f, l = t.nodeType;
                    if (!e || typeof e != "string") return n;
                    if (l !== 1 && l !== 9) return [];
                    a = o(t);
                    if (!a && !r)
                        if (i = R.exec(e))
                            if (f = i[1]) {
                                if (l === 9) {
                                    s = t.getElementById(f);
                                    if (!s || !s.parentNode) return n;
                                    if (s.id === f) return n.push(s), n
                                } else if (t.ownerDocument && (s = t.ownerDocument.getElementById(f)) && u(t, s) && s.id === f) return n.push(s), n
                            } else {
                                if (i[2]) return S.apply(n, x.call(t.getElementsByTagName(e), 0)), n;
                                if ((f = i[3]) && Z && t.getElementsByClassName) return S.apply(n, x.call(t.getElementsByClassName(f), 0)), n
                            }
                    return vt(e.replace(j, "$1"), t, n, r, a)
                }

                function rt(e) {
                    return function(t) {
                        var n = t.nodeName.toLowerCase();
                        return n === "input" && t.type === e
                    }
                }

                function it(e) {
                    return function(t) {
                        var n = t.nodeName.toLowerCase();
                        return (n === "input" || n === "button") && t.type === e
                    }
                }

                function st(e) {
                    return N(function(t) {
                        return t = +t, N(function(n, r) {
                            var i, s = e([], n.length, t),
                                o = s.length;
                            while (o--) n[i = s[o]] && (n[i] = !(r[i] = n[i]))
                        })
                    })
                }

                function ot(e, t, n) {
                    if (e === t) return n;
                    var r = e.nextSibling;
                    while (r) {
                        if (r === t) return -1;
                        r = r.nextSibling
                    }
                    return 1
                }

                function ut(e, t) {
                    var n, r, s, o, u, a, f, l = L[d][e];
                    if (l) return t ? 0 : l.slice(0);
                    u = e, a = [], f = i.preFilter;
                    while (u) {
                        if (!n || (r = F.exec(u))) r && (u = u.slice(r[0].length)), a.push(s = []);
                        n = !1;
                        if (r = I.exec(u)) s.push(n = new m(r.shift())), u = u.slice(n.length), n.type = r[0].replace(j, " ");
                        for (o in i.filter)(r = J[o].exec(u)) && (!f[o] || (r = f[o](r, g, !0))) && (s.push(n = new m(r.shift())), u = u.slice(n.length), n.type = o, n.matches = r);
                        if (!n) break
                    }
                    return t ? u.length : u ? nt.error(e) : L(e, a).slice(0)
                }

                function at(e, t, r) {
                    var i = t.dir,
                        s = r && t.dir === "parentNode",
                        o = w++;
                    return t.first ? function(t, n, r) {
                        while (t = t[i])
                            if (s || t.nodeType === 1) return e(t, n, r)
                    } : function(t, r, u) {
                        if (!u) {
                            var a, f = b + " " + o + " ",
                                l = f + n;
                            while (t = t[i])
                                if (s || t.nodeType === 1) {
                                    if ((a = t[d]) === l) return t.sizset;
                                    if (typeof a == "string" && a.indexOf(f) === 0) {
                                        if (t.sizset) return t
                                    } else {
                                        t[d] = l;
                                        if (e(t, r, u)) return t.sizset = !0, t;
                                        t.sizset = !1
                                    }
                                }
                        } else
                            while (t = t[i])
                                if (s || t.nodeType === 1)
                                    if (e(t, r, u)) return t
                    }
                }

                function ft(e) {
                    return e.length > 1 ? function(t, n, r) {
                        var i = e.length;
                        while (i--)
                            if (!e[i](t, n, r)) return !1;
                        return !0
                    } : e[0]
                }

                function lt(e, t, n, r, i) {
                    var s, o = [],
                        u = 0,
                        a = e.length,
                        f = t != null;
                    for (; u < a; u++)
                        if (s = e[u])
                            if (!n || n(s, r, i)) o.push(s), f && t.push(u);
                    return o
                }

                function ct(e, t, n, r, i, s) {
                    return r && !r[d] && (r = ct(r)), i && !i[d] && (i = ct(i, s)), N(function(s, o, u, a) {
                        if (s && i) return;
                        var f, l, c, h = [],
                            p = [],
                            d = o.length,
                            v = s || dt(t || "*", u.nodeType ? [u] : u, [], s),
                            m = e && (s || !t) ? lt(v, h, e, u, a) : v,
                            g = n ? i || (s ? e : d || r) ? [] : o : m;
                        n && n(m, g, u, a);
                        if (r) {
                            c = lt(g, p), r(c, [], u, a), f = c.length;
                            while (f--)
                                if (l = c[f]) g[p[f]] = !(m[p[f]] = l)
                        }
                        if (s) {
                            f = e && g.length;
                            while (f--)
                                if (l = g[f]) s[h[f]] = !(o[h[f]] = l)
                        } else g = lt(g === o ? g.splice(d, g.length) : g), i ? i(null, o, g, a) : S.apply(o, g)
                    })
                }

                function ht(e) {
                    var t, n, r, s = e.length,
                        o = i.relative[e[0].type],
                        u = o || i.relative[" "],
                        a = o ? 1 : 0,
                        f = at(function(e) {
                            return e === t
                        }, u, !0),
                        l = at(function(e) {
                            return T.call(t, e) > -1
                        }, u, !0),
                        h = [
                            function(e, n, r) {
                                return !o && (r || n !== c) || ((t = n).nodeType ? f(e, n, r) : l(e, n, r))
                            }
                        ];
                    for (; a < s; a++)
                        if (n = i.relative[e[a].type]) h = [at(ft(h), n)];
                        else {
                            n = i.filter[e[a].type].apply(null, e[a].matches);
                            if (n[d]) {
                                r = ++a;
                                for (; r < s; r++)
                                    if (i.relative[e[r].type]) break;
                                return ct(a > 1 && ft(h), a > 1 && e.slice(0, a - 1).join("").replace(j, "$1"), n, a < r && ht(e.slice(a, r)), r < s && ht(e = e.slice(r)), r < s && e.join(""))
                            }
                            h.push(n)
                        }
                    return ft(h)
                }

                function pt(e, t) {
                    var r = t.length > 0,
                        s = e.length > 0,
                        o = function(u, a, f, l, h) {
                            var p, d, v, m = [],
                                y = 0,
                                w = "0",
                                x = u && [],
                                T = h != null,
                                N = c,
                                C = u || s && i.find.TAG("*", h && a.parentNode || a),
                                k = b += N == null ? 1 : Math.E;
                            T && (c = a !== g && a, n = o.el);
                            for (;
                                (p = C[w]) != null; w++) {
                                if (s && p) {
                                    for (d = 0; v = e[d]; d++)
                                        if (v(p, a, f)) {
                                            l.push(p);
                                            break
                                        }
                                    T && (b = k, n = ++o.el)
                                }
                                r && ((p = !v && p) && y--, u && x.push(p))
                            }
                            y += w;
                            if (r && w !== y) {
                                for (d = 0; v = t[d]; d++) v(x, m, a, f);
                                if (u) {
                                    if (y > 0)
                                        while (w--) !x[w] && !m[w] && (m[w] = E.call(l));
                                    m = lt(m)
                                }
                                S.apply(l, m), T && !u && m.length > 0 && y + t.length > 1 && nt.uniqueSort(l)
                            }
                            return T && (b = k, c = N), x
                        };
                    return o.el = 0, r ? N(o) : o
                }

                function dt(e, t, n, r) {
                    var i = 0,
                        s = t.length;
                    for (; i < s; i++) nt(e, t[i], n, r);
                    return n
                }

                function vt(e, t, n, r, s) {
                    var o, u, f, l, c, h = ut(e),
                        p = h.length;
                    if (!r && h.length === 1) {
                        u = h[0] = h[0].slice(0);
                        if (u.length > 2 && (f = u[0]).type === "ID" && t.nodeType === 9 && !s && i.relative[u[1].type]) {
                            t = i.find.ID(f.matches[0].replace($, ""), t, s)[0];
                            if (!t) return n;
                            e = e.slice(u.shift().length)
                        }
                        for (o = J.POS.test(e) ? -1 : u.length - 1; o >= 0; o--) {
                            f = u[o];
                            if (i.relative[l = f.type]) break;
                            if (c = i.find[l])
                                if (r = c(f.matches[0].replace($, ""), z.test(u[0].type) && t.parentNode || t, s)) {
                                    u.splice(o, 1), e = r.length && u.join("");
                                    if (!e) return S.apply(n, x.call(r, 0)), n;
                                    break
                                }
                        }
                    }
                    return a(e, h)(r, t, s, n, z.test(e)), n
                }

                function mt() {}
                var n, r, i, s, o, u, a, f, l, c, h = !0,
                    p = "undefined",
                    d = ("sizcache" + Math.random()).replace(".", ""),
                    m = String,
                    g = e.document,
                    y = g.documentElement,
                    b = 0,
                    w = 0,
                    E = [].pop,
                    S = [].push,
                    x = [].slice,
                    T = [].indexOf || function(e) {
                        var t = 0,
                            n = this.length;
                        for (; t < n; t++)
                            if (this[t] === e) return t;
                        return -1
                    },
                    N = function(e, t) {
                        return e[d] = t == null || t, e
                    },
                    C = function() {
                        var e = {},
                            t = [];
                        return N(function(n, r) {
                            return t.push(n) > i.cacheLength && delete e[t.shift()], e[n] = r
                        }, e)
                    },
                    k = C(),
                    L = C(),
                    A = C(),
                    O = "[\\x20\\t\\r\\n\\f]",
                    M = "(?:\\\\.|[-\\w]|[^\\x00-\\xa0])+",
                    _ = M.replace("w", "w#"),
                    D = "([*^$|!~]?=)",
                    P = "\\[" + O + "*(" + M + ")" + O + "*(?:" + D + O + "*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|(" + _ + ")|)|)" + O + "*\\]",
                    H = ":(" + M + ")(?:\\((?:(['\"])((?:\\\\.|[^\\\\])*?)\\2|([^()[\\]]*|(?:(?:" + P + ")|[^:]|\\\\.)*|.*))\\)|)",
                    B = ":(even|odd|eq|gt|lt|nth|first|last)(?:\\(" + O + "*((?:-\\d)?\\d*)" + O + "*\\)|)(?=[^-]|$)",
                    j = new RegExp("^" + O + "+|((?:^|[^\\\\])(?:\\\\.)*)" + O + "+$", "g"),
                    F = new RegExp("^" + O + "*," + O + "*"),
                    I = new RegExp("^" + O + "*([\\x20\\t\\r\\n\\f>+~])" + O + "*"),
                    q = new RegExp(H),
                    R = /^(?:#([\w\-]+)|(\w+)|\.([\w\-]+))$/,
                    U = /^:not/,
                    z = /[\x20\t\r\n\f]*[+~]/,
                    W = /:not\($/,
                    X = /h\d/i,
                    V = /input|select|textarea|button/i,
                    $ = /\\(?!\\)/g,
                    J = {
                        ID: new RegExp("^#(" + M + ")"),
                        CLASS: new RegExp("^\\.(" + M + ")"),
                        NAME: new RegExp("^\\[name=['\"]?(" + M + ")['\"]?\\]"),
                        TAG: new RegExp("^(" + M.replace("w", "w*") + ")"),
                        ATTR: new RegExp("^" + P),
                        PSEUDO: new RegExp("^" + H),
                        POS: new RegExp(B, "i"),
                        CHILD: new RegExp("^:(only|nth|first|last)-child(?:\\(" + O + "*(even|odd|(([+-]|)(\\d*)n|)" + O + "*(?:([+-]|)" + O + "*(\\d+)|))" + O + "*\\)|)", "i"),
                        needsContext: new RegExp("^" + O + "*[>+~]|" + B, "i")
                    },
                    K = function(e) {
                        var t = g.createElement("div");
                        try {
                            return e(t)
                        } catch (n) {
                            return !1
                        } finally {
                            t = null
                        }
                    },
                    Q = K(function(e) {
                        return e.appendChild(g.createComment("")), !e.getElementsByTagName("*").length
                    }),
                    G = K(function(e) {
                        return e.innerHTML = "<a href='#'></a>", e.firstChild && typeof e.firstChild.getAttribute !== p && e.firstChild.getAttribute("href") === "#"
                    }),
                    Y = K(function(e) {
                        e.innerHTML = "<select></select>";
                        var t = typeof e.lastChild.getAttribute("multiple");
                        return t !== "boolean" && t !== "string"
                    }),
                    Z = K(function(e) {
                        return e.innerHTML = "<div class='hidden e'></div><div class='hidden'></div>", !e.getElementsByClassName || !e.getElementsByClassName("e").length ? !1 : (e.lastChild.className = "e", e.getElementsByClassName("e").length === 2)
                    }),
                    et = K(function(e) {
                        e.id = d + 0, e.innerHTML = "<a name='" + d + "'></a><div name='" + d + "'></div>", y.insertBefore(e, y.firstChild);
                        var t = g.getElementsByName && g.getElementsByName(d).length === 2 + g.getElementsByName(d + 0).length;
                        return r = !g.getElementById(d), y.removeChild(e), t
                    });
                try {
                    x.call(y.childNodes, 0)[0].nodeType
                } catch (tt) {
                    x = function(e) {
                        var t, n = [];
                        for (; t = this[e]; e++) n.push(t);
                        return n
                    }
                }
                nt.matches = function(e, t) {
                    return nt(e, null, null, t)
                }, nt.matchesSelector = function(e, t) {
                    return nt(t, null, null, [e]).length > 0
                }, s = nt.getText = function(e) {
                    var t, n = "",
                        r = 0,
                        i = e.nodeType;
                    if (i) {
                        if (i === 1 || i === 9 || i === 11) {
                            if (typeof e.textContent == "string") return e.textContent;
                            for (e = e.firstChild; e; e = e.nextSibling) n += s(e)
                        } else if (i === 3 || i === 4) return e.nodeValue
                    } else
                        for (; t = e[r]; r++) n += s(t);
                    return n
                }, o = nt.isXML = function(e) {
                    var t = e && (e.ownerDocument || e).documentElement;
                    return t ? t.nodeName !== "HTML" : !1
                }, u = nt.contains = y.contains ? function(e, t) {
                    var n = e.nodeType === 9 ? e.documentElement : e,
                        r = t && t.parentNode;
                    return e === r || !!(r && r.nodeType === 1 && n.contains && n.contains(r))
                } : y.compareDocumentPosition ? function(e, t) {
                    return t && !!(e.compareDocumentPosition(t) & 16)
                } : function(e, t) {
                    while (t = t.parentNode)
                        if (t === e) return !0;
                    return !1
                }, nt.attr = function(e, t) {
                    var n, r = o(e);
                    return r || (t = t.toLowerCase()), (n = i.attrHandle[t]) ? n(e) : r || Y ? e.getAttribute(t) : (n = e.getAttributeNode(t), n ? typeof e[t] == "boolean" ? e[t] ? t : null : n.specified ? n.value : null : null)
                }, i = nt.selectors = {
                    cacheLength: 50,
                    createPseudo: N,
                    match: J,
                    attrHandle: G ? {} : {
                        href: function(e) {
                            return e.getAttribute("href", 2)
                        },
                        type: function(e) {
                            return e.getAttribute("type")
                        }
                    },
                    find: {
                        ID: r ? function(e, t, n) {
                            if (typeof t.getElementById !== p && !n) {
                                var r = t.getElementById(e);
                                return r && r.parentNode ? [r] : []
                            }
                        } : function(e, n, r) {
                            if (typeof n.getElementById !== p && !r) {
                                var i = n.getElementById(e);
                                return i ? i.id === e || typeof i.getAttributeNode !== p && i.getAttributeNode("id").value === e ? [i] : t : []
                            }
                        },
                        TAG: Q ? function(e, t) {
                            if (typeof t.getElementsByTagName !== p) return t.getElementsByTagName(e)
                        } : function(e, t) {
                            var n = t.getElementsByTagName(e);
                            if (e === "*") {
                                var r, i = [],
                                    s = 0;
                                for (; r = n[s]; s++) r.nodeType === 1 && i.push(r);
                                return i
                            }
                            return n
                        },
                        NAME: et && function(e, t) {
                            if (typeof t.getElementsByName !== p) return t.getElementsByName(name)
                        },
                        CLASS: Z && function(e, t, n) {
                            if (typeof t.getElementsByClassName !== p && !n) return t.getElementsByClassName(e)
                        }
                    },
                    relative: {
                        ">": {
                            dir: "parentNode",
                            first: !0
                        },
                        " ": {
                            dir: "parentNode"
                        },
                        "+": {
                            dir: "previousSibling",
                            first: !0
                        },
                        "~": {
                            dir: "previousSibling"
                        }
                    },
                    preFilter: {
                        ATTR: function(e) {
                            return e[1] = e[1].replace($, ""), e[3] = (e[4] || e[5] || "").replace($, ""), e[2] === "~=" && (e[3] = " " + e[3] + " "), e.slice(0, 4)
                        },
                        CHILD: function(e) {
                            return e[1] = e[1].toLowerCase(), e[1] === "nth" ? (e[2] || nt.error(e[0]), e[3] = +(e[3] ? e[4] + (e[5] || 1) : 2 * (e[2] === "even" || e[2] === "odd")), e[4] = +(e[6] + e[7] || e[2] === "odd")) : e[2] && nt.error(e[0]), e
                        },
                        PSEUDO: function(e) {
                            var t, n;
                            if (J.CHILD.test(e[0])) return null;
                            if (e[3]) e[2] = e[3];
                            else if (t = e[4]) q.test(t) && (n = ut(t, !0)) && (n = t.indexOf(")", t.length - n) - t.length) && (t = t.slice(0, n), e[0] = e[0].slice(0, n)), e[2] = t;
                            return e.slice(0, 3)
                        }
                    },
                    filter: {
                        ID: r ? function(e) {
                            return e = e.replace($, ""),
                                function(t) {
                                    return t.getAttribute("id") === e
                                }
                        } : function(e) {
                            return e = e.replace($, ""),
                                function(t) {
                                    var n = typeof t.getAttributeNode !== p && t.getAttributeNode("id");
                                    return n && n.value === e
                                }
                        },
                        TAG: function(e) {
                            return e === "*" ? function() {
                                return !0
                            } : (e = e.replace($, "").toLowerCase(), function(t) {
                                return t.nodeName && t.nodeName.toLowerCase() === e
                            })
                        },
                        CLASS: function(e) {
                            var t = k[d][e];
                            return t || (t = k(e, new RegExp("(^|" + O + ")" + e + "(" + O + "|$)"))),
                                function(e) {
                                    return t.test(e.className || typeof e.getAttribute !== p && e.getAttribute("class") || "")
                                }
                        },
                        ATTR: function(e, t, n) {
                            return function(r, i) {
                                var s = nt.attr(r, e);
                                return s == null ? t === "!=" : t ? (s += "", t === "=" ? s === n : t === "!=" ? s !== n : t === "^=" ? n && s.indexOf(n) === 0 : t === "*=" ? n && s.indexOf(n) > -1 : t === "$=" ? n && s.substr(s.length - n.length) === n : t === "~=" ? (" " + s + " ").indexOf(n) > -1 : t === "|=" ? s === n || s.substr(0, n.length + 1) === n + "-" : !1) : !0
                            }
                        },
                        CHILD: function(e, t, n, r) {
                            return e === "nth" ? function(e) {
                                var t, i, s = e.parentNode;
                                if (n === 1 && r === 0) return !0;
                                if (s) {
                                    i = 0;
                                    for (t = s.firstChild; t; t = t.nextSibling)
                                        if (t.nodeType === 1) {
                                            i++;
                                            if (e === t) break
                                        }
                                }
                                return i -= r, i === n || i % n === 0 && i / n >= 0
                            } : function(t) {
                                var n = t;
                                switch (e) {
                                    case "only":
                                    case "first":
                                        while (n = n.previousSibling)
                                            if (n.nodeType === 1) return !1;
                                        if (e === "first") return !0;
                                        n = t;
                                    case "last":
                                        while (n = n.nextSibling)
                                            if (n.nodeType === 1) return !1;
                                        return !0
                                }
                            }
                        },
                        PSEUDO: function(e, t) {
                            var n, r = i.pseudos[e] || i.setFilters[e.toLowerCase()] || nt.error("unsupported pseudo: " + e);
                            return r[d] ? r(t) : r.length > 1 ? (n = [e, e, "", t], i.setFilters.hasOwnProperty(e.toLowerCase()) ? N(function(e, n) {
                                var i, s = r(e, t),
                                    o = s.length;
                                while (o--) i = T.call(e, s[o]), e[i] = !(n[i] = s[o])
                            }) : function(e) {
                                return r(e, 0, n)
                            }) : r
                        }
                    },
                    pseudos: {
                        not: N(function(e) {
                            var t = [],
                                n = [],
                                r = a(e.replace(j, "$1"));
                            return r[d] ? N(function(e, t, n, i) {
                                var s, o = r(e, null, i, []),
                                    u = e.length;
                                while (u--)
                                    if (s = o[u]) e[u] = !(t[u] = s)
                            }) : function(e, i, s) {
                                return t[0] = e, r(t, null, s, n), !n.pop()
                            }
                        }),
                        has: N(function(e) {
                            return function(t) {
                                return nt(e, t).length > 0
                            }
                        }),
                        contains: N(function(e) {
                            return function(t) {
                                return (t.textContent || t.innerText || s(t)).indexOf(e) > -1
                            }
                        }),
                        enabled: function(e) {
                            return e.disabled === !1
                        },
                        disabled: function(e) {
                            return e.disabled === !0
                        },
                        checked: function(e) {
                            var t = e.nodeName.toLowerCase();
                            return t === "input" && !!e.checked || t === "option" && !!e.selected
                        },
                        selected: function(e) {
                            return e.parentNode && e.parentNode.selectedIndex, e.selected === !0
                        },
                        parent: function(e) {
                            return !i.pseudos.empty(e)
                        },
                        empty: function(e) {
                            var t;
                            e = e.firstChild;
                            while (e) {
                                if (e.nodeName > "@" || (t = e.nodeType) === 3 || t === 4) return !1;
                                e = e.nextSibling
                            }
                            return !0
                        },
                        header: function(e) {
                            return X.test(e.nodeName)
                        },
                        text: function(e) {
                            var t, n;
                            return e.nodeName.toLowerCase() === "input" && (t = e.type) === "text" && ((n = e.getAttribute("type")) == null || n.toLowerCase() === t)
                        },
                        radio: rt("radio"),
                        checkbox: rt("checkbox"),
                        file: rt("file"),
                        password: rt("password"),
                        image: rt("image"),
                        submit: it("submit"),
                        reset: it("reset"),
                        button: function(e) {
                            var t = e.nodeName.toLowerCase();
                            return t === "input" && e.type === "button" || t === "button"
                        },
                        input: function(e) {
                            return V.test(e.nodeName)
                        },
                        focus: function(e) {
                            var t = e.ownerDocument;
                            return e === t.activeElement && (!t.hasFocus || t.hasFocus()) && (!!e.type || !!e.href)
                        },
                        active: function(e) {
                            return e === e.ownerDocument.activeElement
                        },
                        first: st(function(e, t, n) {
                            return [0]
                        }),
                        last: st(function(e, t, n) {
                            return [t - 1]
                        }),
                        eq: st(function(e, t, n) {
                            return [n < 0 ? n + t : n]
                        }),
                        even: st(function(e, t, n) {
                            for (var r = 0; r < t; r += 2) e.push(r);
                            return e
                        }),
                        odd: st(function(e, t, n) {
                            for (var r = 1; r < t; r += 2) e.push(r);
                            return e
                        }),
                        lt: st(function(e, t, n) {
                            for (var r = n < 0 ? n + t : n; --r >= 0;) e.push(r);
                            return e
                        }),
                        gt: st(function(e, t, n) {
                            for (var r = n < 0 ? n + t : n; ++r < t;) e.push(r);
                            return e
                        })
                    }
                }, f = y.compareDocumentPosition ? function(e, t) {
                    return e === t ? (l = !0, 0) : (!e.compareDocumentPosition || !t.compareDocumentPosition ? e.compareDocumentPosition : e.compareDocumentPosition(t) & 4) ? -1 : 1
                } : function(e, t) {
                    if (e === t) return l = !0, 0;
                    if (e.sourceIndex && t.sourceIndex) return e.sourceIndex - t.sourceIndex;
                    var n, r, i = [],
                        s = [],
                        o = e.parentNode,
                        u = t.parentNode,
                        a = o;
                    if (o === u) return ot(e, t);
                    if (!o) return -1;
                    if (!u) return 1;
                    while (a) i.unshift(a), a = a.parentNode;
                    a = u;
                    while (a) s.unshift(a), a = a.parentNode;
                    n = i.length, r = s.length;
                    for (var f = 0; f < n && f < r; f++)
                        if (i[f] !== s[f]) return ot(i[f], s[f]);
                    return f === n ? ot(e, s[f], -1) : ot(i[f], t, 1)
                }, [0, 0].sort(f), h = !l, nt.uniqueSort = function(e) {
                    var t, n = 1;
                    l = h, e.sort(f);
                    if (l)
                        for (; t = e[n]; n++) t === e[n - 1] && e.splice(n--, 1);
                    return e
                }, nt.error = function(e) {
                    throw new Error("Syntax error, unrecognized expression: " + e)
                }, a = nt.compile = function(e, t) {
                    var n, r = [],
                        i = [],
                        s = A[d][e];
                    if (!s) {
                        t || (t = ut(e)), n = t.length;
                        while (n--) s = ht(t[n]), s[d] ? r.push(s) : i.push(s);
                        s = A(e, pt(i, r))
                    }
                    return s
                }, g.querySelectorAll && function() {
                    var e, t = vt,
                        n = /'|\\/g,
                        r = /\=[\x20\t\r\n\f]*([^'"\]]*)[\x20\t\r\n\f]*\]/g,
                        i = [":focus"],
                        s = [":active", ":focus"],
                        u = y.matchesSelector || y.mozMatchesSelector || y.webkitMatchesSelector || y.oMatchesSelector || y.msMatchesSelector;
                    K(function(e) {
                        e.innerHTML = "<select><option selected=''></option></select>", e.querySelectorAll("[selected]").length || i.push("\\[" + O + "*(?:checked|disabled|ismap|multiple|readonly|selected|value)"), e.querySelectorAll(":checked").length || i.push(":checked")
                    }), K(function(e) {
                        e.innerHTML = "<p test=''></p>", e.querySelectorAll("[test^='']").length && i.push("[*^$]=" + O + "*(?:\"\"|'')"), e.innerHTML = "<input type='hidden'/>", e.querySelectorAll(":enabled").length || i.push(":enabled", ":disabled")
                    }), i = new RegExp(i.join("|")), vt = function(e, r, s, o, u) {
                        if (!o && !u && (!i || !i.test(e))) {
                            var a, f, l = !0,
                                c = d,
                                h = r,
                                p = r.nodeType === 9 && e;
                            if (r.nodeType === 1 && r.nodeName.toLowerCase() !== "object") {
                                a = ut(e), (l = r.getAttribute("id")) ? c = l.replace(n, "\\$&") : r.setAttribute("id", c), c = "[id='" + c + "'] ", f = a.length;
                                while (f--) a[f] = c + a[f].join("");
                                h = z.test(e) && r.parentNode || r, p = a.join(",")
                            }
                            if (p) try {
                                return S.apply(s, x.call(h.querySelectorAll(p), 0)), s
                            } catch (v) {} finally {
                                l || r.removeAttribute("id")
                            }
                        }
                        return t(e, r, s, o, u)
                    }, u && (K(function(t) {
                        e = u.call(t, "div");
                        try {
                            u.call(t, "[test!='']:sizzle"), s.push("!=", H)
                        } catch (n) {}
                    }), s = new RegExp(s.join("|")), nt.matchesSelector = function(t, n) {
                        n = n.replace(r, "='$1']");
                        if (!o(t) && !s.test(n) && (!i || !i.test(n))) try {
                            var a = u.call(t, n);
                            if (a || e || t.document && t.document.nodeType !== 11) return a
                        } catch (f) {}
                        return nt(n, null, null, [t]).length > 0
                    })
                }(), i.pseudos.nth = i.pseudos.eq, i.filters = mt.prototype = i.pseudos, i.setFilters = new mt, nt.attr = v.attr, v.find = nt, v.expr = nt.selectors, v.expr[":"] = v.expr.pseudos, v.unique = nt.uniqueSort, v.text = nt.getText, v.isXMLDoc = nt.isXML, v.contains = nt.contains
            }(e);
        var nt = /Until$/,
            rt = /^(?:parents|prev(?:Until|All))/,
            it = /^.[^:#\[\.,]*$/,
            st = v.expr.match.needsContext,
            ot = {
                children: !0,
                contents: !0,
                next: !0,
                prev: !0
            };
        v.fn.extend({
            find: function(e) {
                var t, n, r, i, s, o, u = this;
                if (typeof e != "string") return v(e).filter(function() {
                    for (t = 0, n = u.length; t < n; t++)
                        if (v.contains(u[t], this)) return !0
                });
                o = this.pushStack("", "find", e);
                for (t = 0, n = this.length; t < n; t++) {
                    r = o.length, v.find(e, this[t], o);
                    if (t > 0)
                        for (i = r; i < o.length; i++)
                            for (s = 0; s < r; s++)
                                if (o[s] === o[i]) {
                                    o.splice(i--, 1);
                                    break
                                }
                }
                return o
            },
            has: function(e) {
                var t, n = v(e, this),
                    r = n.length;
                return this.filter(function() {
                    for (t = 0; t < r; t++)
                        if (v.contains(this, n[t])) return !0
                })
            },
            not: function(e) {
                return this.pushStack(ft(this, e, !1), "not", e)
            },
            filter: function(e) {
                return this.pushStack(ft(this, e, !0), "filter", e)
            },
            is: function(e) {
                return !!e && (typeof e == "string" ? st.test(e) ? v(e, this.context).index(this[0]) >= 0 : v.filter(e, this).length > 0 : this.filter(e).length > 0)
            },
            closest: function(e, t) {
                var n, r = 0,
                    i = this.length,
                    s = [],
                    o = st.test(e) || typeof e != "string" ? v(e, t || this.context) : 0;
                for (; r < i; r++) {
                    n = this[r];
                    while (n && n.ownerDocument && n !== t && n.nodeType !== 11) {
                        if (o ? o.index(n) > -1 : v.find.matchesSelector(n, e)) {
                            s.push(n);
                            break
                        }
                        n = n.parentNode
                    }
                }
                return s = s.length > 1 ? v.unique(s) : s, this.pushStack(s, "closest", e)
            },
            index: function(e) {
                return e ? typeof e == "string" ? v.inArray(this[0], v(e)) : v.inArray(e.jquery ? e[0] : e, this) : this[0] && this[0].parentNode ? this.prevAll().length : -1
            },
            add: function(e, t) {
                var n = typeof e == "string" ? v(e, t) : v.makeArray(e && e.nodeType ? [e] : e),
                    r = v.merge(this.get(), n);
                return this.pushStack(ut(n[0]) || ut(r[0]) ? r : v.unique(r))
            },
            addBack: function(e) {
                return this.add(e == null ? this.prevObject : this.prevObject.filter(e))
            }
        }), v.fn.andSelf = v.fn.addBack, v.each({
            parent: function(e) {
                var t = e.parentNode;
                return t && t.nodeType !== 11 ? t : null
            },
            parents: function(e) {
                return v.dir(e, "parentNode")
            },
            parentsUntil: function(e, t, n) {
                return v.dir(e, "parentNode", n)
            },
            next: function(e) {
                return at(e, "nextSibling")
            },
            prev: function(e) {
                return at(e, "previousSibling")
            },
            nextAll: function(e) {
                return v.dir(e, "nextSibling")
            },
            prevAll: function(e) {
                return v.dir(e, "previousSibling")
            },
            nextUntil: function(e, t, n) {
                return v.dir(e, "nextSibling", n)
            },
            prevUntil: function(e, t, n) {
                return v.dir(e, "previousSibling", n)
            },
            siblings: function(e) {
                return v.sibling((e.parentNode || {}).firstChild, e)
            },
            children: function(e) {
                return v.sibling(e.firstChild)
            },
            contents: function(e) {
                return v.nodeName(e, "iframe") ? e.contentDocument || e.contentWindow.document : v.merge([], e.childNodes)
            }
        }, function(e, t) {
            v.fn[e] = function(n, r) {
                var i = v.map(this, t, n);
                return nt.test(e) || (r = n), r && typeof r == "string" && (i = v.filter(r, i)), i = this.length > 1 && !ot[e] ? v.unique(i) : i, this.length > 1 && rt.test(e) && (i = i.reverse()), this.pushStack(i, e, l.call(arguments).join(","))
            }
        }), v.extend({
            filter: function(e, t, n) {
                return n && (e = ":not(" + e + ")"), t.length === 1 ? v.find.matchesSelector(t[0], e) ? [t[0]] : [] : v.find.matches(e, t)
            },
            dir: function(e, n, r) {
                var i = [],
                    s = e[n];
                while (s && s.nodeType !== 9 && (r === t || s.nodeType !== 1 || !v(s).is(r))) s.nodeType === 1 && i.push(s), s = s[n];
                return i
            },
            sibling: function(e, t) {
                var n = [];
                for (; e; e = e.nextSibling) e.nodeType === 1 && e !== t && n.push(e);
                return n
            }
        });
        var ct = "abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",
            ht = / jQuery\d+="(?:null|\d+)"/g,
            pt = /^\s+/,
            dt = /<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,
            vt = /<([\w:]+)/,
            mt = /<tbody/i,
            gt = /<|&#?\w+;/,
            yt = /<(?:script|style|link)/i,
            bt = /<(?:script|object|embed|option|style)/i,
            wt = new RegExp("<(?:" + ct + ")[\\s/>]", "i"),
            Et = /^(?:checkbox|radio)$/,
            St = /checked\s*(?:[^=]|=\s*.checked.)/i,
            xt = /\/(java|ecma)script/i,
            Tt = /^\s*<!(?:\[CDATA\[|\-\-)|[\]\-]{2}>\s*$/g,
            Nt = {
                option: [1, "<select multiple='multiple'>", "</select>"],
                legend: [1, "<fieldset>", "</fieldset>"],
                thead: [1, "<table>", "</table>"],
                tr: [2, "<table><tbody>", "</tbody></table>"],
                td: [3, "<table><tbody><tr>", "</tr></tbody></table>"],
                col: [2, "<table><tbody></tbody><colgroup>", "</colgroup></table>"],
                area: [1, "<map>", "</map>"],
                _default: [0, "", ""]
            },
            Ct = lt(i),
            kt = Ct.appendChild(i.createElement("div"));
        Nt.optgroup = Nt.option, Nt.tbody = Nt.tfoot = Nt.colgroup = Nt.caption = Nt.thead, Nt.th = Nt.td, v.support.htmlSerialize || (Nt._default = [1, "X<div>", "</div>"]), v.fn.extend({
                text: function(e) {
                    return v.access(this, function(e) {
                        return e === t ? v.text(this) : this.empty().append((this[0] && this[0].ownerDocument || i).createTextNode(e))
                    }, null, e, arguments.length)
                },
                wrapAll: function(e) {
                    if (v.isFunction(e)) return this.each(function(t) {
                        v(this).wrapAll(e.call(this, t))
                    });
                    if (this[0]) {
                        var t = v(e, this[0].ownerDocument).eq(0).clone(!0);
                        this[0].parentNode && t.insertBefore(this[0]), t.map(function() {
                            var e = this;
                            while (e.firstChild && e.firstChild.nodeType === 1) e = e.firstChild;
                            return e
                        }).append(this)
                    }
                    return this
                },
                wrapInner: function(e) {
                    return v.isFunction(e) ? this.each(function(t) {
                        v(this).wrapInner(e.call(this, t))
                    }) : this.each(function() {
                        var t = v(this),
                            n = t.contents();
                        n.length ? n.wrapAll(e) : t.append(e)
                    })
                },
                wrap: function(e) {
                    var t = v.isFunction(e);
                    return this.each(function(n) {
                        v(this).wrapAll(t ? e.call(this, n) : e)
                    })
                },
                unwrap: function() {
                    return this.parent().each(function() {
                        v.nodeName(this, "body") || v(this).replaceWith(this.childNodes)
                    }).end()
                },
                append: function() {
                    return this.domManip(arguments, !0, function(e) {
                        (this.nodeType === 1 || this.nodeType === 11) && this.appendChild(e)
                    })
                },
                prepend: function() {
                    return this.domManip(arguments, !0, function(e) {
                        (this.nodeType === 1 || this.nodeType === 11) && this.insertBefore(e, this.firstChild)
                    })
                },
                before: function() {
                    if (!ut(this[0])) return this.domManip(arguments, !1, function(e) {
                        this.parentNode.insertBefore(e, this)
                    });
                    if (arguments.length) {
                        var e = v.clean(arguments);
                        return this.pushStack(v.merge(e, this), "before", this.selector)
                    }
                },
                after: function() {
                    if (!ut(this[0])) return this.domManip(arguments, !1, function(e) {
                        this.parentNode.insertBefore(e, this.nextSibling)
                    });
                    if (arguments.length) {
                        var e = v.clean(arguments);
                        return this.pushStack(v.merge(this, e), "after", this.selector)
                    }
                },
                remove: function(e, t) {
                    var n, r = 0;
                    for (;
                        (n = this[r]) != null; r++)
                        if (!e || v.filter(e, [n]).length) !t && n.nodeType === 1 && (v.cleanData(n.getElementsByTagName("*")), v.cleanData([n])), n.parentNode && n.parentNode.removeChild(n);
                    return this
                },
                empty: function() {
                    var e, t = 0;
                    for (;
                        (e = this[t]) != null; t++) {
                        e.nodeType === 1 && v.cleanData(e.getElementsByTagName("*"));
                        while (e.firstChild) e.removeChild(e.firstChild)
                    }
                    return this
                },
                clone: function(e, t) {
                    return e = e == null ? !1 : e, t = t == null ? e : t, this.map(function() {
                        return v.clone(this, e, t)
                    })
                },
                html: function(e) {
                    return v.access(this, function(e) {
                        var n = this[0] || {},
                            r = 0,
                            i = this.length;
                        if (e === t) return n.nodeType === 1 ? n.innerHTML.replace(ht, "") : t;
                        if (typeof e == "string" && !yt.test(e) && (v.support.htmlSerialize || !wt.test(e)) && (v.support.leadingWhitespace || !pt.test(e)) && !Nt[(vt.exec(e) || ["", ""])[1].toLowerCase()]) {
                            e = e.replace(dt, "<$1></$2>");
                            try {
                                for (; r < i; r++) n = this[r] || {}, n.nodeType === 1 && (v.cleanData(n.getElementsByTagName("*")), n.innerHTML = e);
                                n = 0
                            } catch (s) {}
                        }
                        n && this.empty().append(e)
                    }, null, e, arguments.length)
                },
                replaceWith: function(e) {
                    return ut(this[0]) ? this.length ? this.pushStack(v(v.isFunction(e) ? e() : e), "replaceWith", e) : this : v.isFunction(e) ? this.each(function(t) {
                        var n = v(this),
                            r = n.html();
                        n.replaceWith(e.call(this, t, r))
                    }) : (typeof e != "string" && (e = v(e).detach()), this.each(function() {
                        var t = this.nextSibling,
                            n = this.parentNode;
                        v(this).remove(), t ? v(t).before(e) : v(n).append(e)
                    }))
                },
                detach: function(e) {
                    return this.remove(e, !0)
                },
                domManip: function(e, n, r) {
                    e = [].concat.apply([], e);
                    var i, s, o, u, a = 0,
                        f = e[0],
                        l = [],
                        c = this.length;
                    if (!v.support.checkClone && c > 1 && typeof f == "string" && St.test(f)) return this.each(function() {
                        v(this).domManip(e, n, r)
                    });
                    if (v.isFunction(f)) return this.each(function(i) {
                        var s = v(this);
                        e[0] = f.call(this, i, n ? s.html() : t), s.domManip(e, n, r)
                    });
                    if (this[0]) {
                        i = v.buildFragment(e, this, l), o = i.fragment, s = o.firstChild, o.childNodes.length === 1 && (o = s);
                        if (s) {
                            n = n && v.nodeName(s, "tr");
                            for (u = i.cacheable || c - 1; a < c; a++) r.call(n && v.nodeName(this[a], "table") ? Lt(this[a], "tbody") : this[a], a === u ? o : v.clone(o, !0, !0))
                        }
                        o = s = null, l.length && v.each(l, function(e, t) {
                            t.src ? v.ajax ? v.ajax({
                                url: t.src,
                                type: "GET",
                                dataType: "script",
                                async: !1,
                                global: !1,
                                "throws": !0
                            }) : v.error("no ajax") : v.globalEval((t.text || t.textContent || t.innerHTML || "").replace(Tt, "")), t.parentNode && t.parentNode.removeChild(t)
                        })
                    }
                    return this
                }
            }), v.buildFragment = function(e, n, r) {
                var s, o, u, a = e[0];
                return n = n || i, n = !n.nodeType && n[0] || n, n = n.ownerDocument || n, e.length === 1 && typeof a == "string" && a.length < 512 && n === i && a.charAt(0) === "<" && !bt.test(a) && (v.support.checkClone || !St.test(a)) && (v.support.html5Clone || !wt.test(a)) && (o = !0, s = v.fragments[a], u = s !== t), s || (s = n.createDocumentFragment(), v.clean(e, n, s, r), o && (v.fragments[a] = u && s)), {
                    fragment: s,
                    cacheable: o
                }
            }, v.fragments = {}, v.each({
                appendTo: "append",
                prependTo: "prepend",
                insertBefore: "before",
                insertAfter: "after",
                replaceAll: "replaceWith"
            }, function(e, t) {
                v.fn[e] = function(n) {
                    var r, i = 0,
                        s = [],
                        o = v(n),
                        u = o.length,
                        a = this.length === 1 && this[0].parentNode;
                    if ((a == null || a && a.nodeType === 11 && a.childNodes.length === 1) && u === 1) return o[t](this[0]), this;
                    for (; i < u; i++) r = (i > 0 ? this.clone(!0) : this).get(), v(o[i])[t](r), s = s.concat(r);
                    return this.pushStack(s, e, o.selector)
                }
            }), v.extend({
                clone: function(e, t, n) {
                    var r, i, s, o;
                    v.support.html5Clone || v.isXMLDoc(e) || !wt.test("<" + e.nodeName + ">") ? o = e.cloneNode(!0) : (kt.innerHTML = e.outerHTML, kt.removeChild(o = kt.firstChild));
                    if ((!v.support.noCloneEvent || !v.support.noCloneChecked) && (e.nodeType === 1 || e.nodeType === 11) && !v.isXMLDoc(e)) {
                        Ot(e, o), r = Mt(e), i = Mt(o);
                        for (s = 0; r[s]; ++s) i[s] && Ot(r[s], i[s])
                    }
                    if (t) {
                        At(e, o);
                        if (n) {
                            r = Mt(e), i = Mt(o);
                            for (s = 0; r[s]; ++s) At(r[s], i[s])
                        }
                    }
                    return r = i = null, o
                },
                clean: function(e, t, n, r) {
                    var s, o, u, a, f, l, c, h, p, d, m, g, y = t === i && Ct,
                        b = [];
                    if (!t || typeof t.createDocumentFragment == "undefined") t = i;
                    for (s = 0;
                        (u = e[s]) != null; s++) {
                        typeof u == "number" && (u += "");
                        if (!u) continue;
                        if (typeof u == "string")
                            if (!gt.test(u)) u = t.createTextNode(u);
                            else {
                                y = y || lt(t), c = t.createElement("div"), y.appendChild(c), u = u.replace(dt, "<$1></$2>"), a = (vt.exec(u) || ["", ""])[1].toLowerCase(), f = Nt[a] || Nt._default, l = f[0], c.innerHTML = f[1] + u + f[2];
                                while (l--) c = c.lastChild;
                                if (!v.support.tbody) {
                                    h = mt.test(u), p = a === "table" && !h ? c.firstChild && c.firstChild.childNodes : f[1] === "<table>" && !h ? c.childNodes : [];
                                    for (o = p.length - 1; o >= 0; --o) v.nodeName(p[o], "tbody") && !p[o].childNodes.length && p[o].parentNode.removeChild(p[o])
                                }!v.support.leadingWhitespace && pt.test(u) && c.insertBefore(t.createTextNode(pt.exec(u)[0]), c.firstChild), u = c.childNodes, c.parentNode.removeChild(c)
                            }
                        u.nodeType ? b.push(u) : v.merge(b, u)
                    }
                    c && (u = c = y = null);
                    if (!v.support.appendChecked)
                        for (s = 0;
                            (u = b[s]) != null; s++) v.nodeName(u, "input") ? _t(u) : typeof u.getElementsByTagName != "undefined" && v.grep(u.getElementsByTagName("input"), _t);
                    if (n) {
                        m = function(e) {
                            if (!e.type || xt.test(e.type)) return r ? r.push(e.parentNode ? e.parentNode.removeChild(e) : e) : n.appendChild(e)
                        };
                        for (s = 0;
                            (u = b[s]) != null; s++)
                            if (!v.nodeName(u, "script") || !m(u)) n.appendChild(u), typeof u.getElementsByTagName != "undefined" && (g = v.grep(v.merge([], u.getElementsByTagName("script")), m), b.splice.apply(b, [s + 1, 0].concat(g)), s += g.length)
                    }
                    return b
                },
                cleanData: function(e, t) {
                    var n, r, i, s, o = 0,
                        u = v.expando,
                        a = v.cache,
                        f = v.support.deleteExpando,
                        l = v.event.special;
                    for (;
                        (i = e[o]) != null; o++)
                        if (t || v.acceptData(i)) {
                            r = i[u], n = r && a[r];
                            if (n) {
                                if (n.events)
                                    for (s in n.events) l[s] ? v.event.remove(i, s) : v.removeEvent(i, s, n.handle);
                                a[r] && (delete a[r], f ? delete i[u] : i.removeAttribute ? i.removeAttribute(u) : i[u] = null, v.deletedIds.push(r))
                            }
                        }
                }
            }),
            function() {
                var e, t;
                v.uaMatch = function(e) {
                    e = e.toLowerCase();
                    var t = /(chrome)[ \/]([\w.]+)/.exec(e) || /(webkit)[ \/]([\w.]+)/.exec(e) || /(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e) || /(msie) ([\w.]+)/.exec(e) || e.indexOf("compatible") < 0 && /(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e) || [];
                    return {
                        browser: t[1] || "",
                        version: t[2] || "0"
                    }
                }, e = v.uaMatch(o.userAgent), t = {}, e.browser && (t[e.browser] = !0, t.version = e.version), t.chrome ? t.webkit = !0 : t.webkit && (t.safari = !0), v.browser = t, v.sub = function() {
                    function e(t, n) {
                        return new e.fn.init(t, n)
                    }
                    v.extend(!0, e, this), e.superclass = this, e.fn = e.prototype = this(), e.fn.constructor = e, e.sub = this.sub, e.fn.init = function(r, i) {
                        return i && i instanceof v && !(i instanceof e) && (i = e(i)), v.fn.init.call(this, r, i, t)
                    }, e.fn.init.prototype = e.fn;
                    var t = e(i);
                    return e
                }
            }();
        var Dt, Pt, Ht, Bt = /alpha\([^)]*\)/i,
            jt = /opacity=([^)]*)/,
            Ft = /^(top|right|bottom|left)$/,
            It = /^(none|table(?!-c[ea]).+)/,
            qt = /^margin/,
            Rt = new RegExp("^(" + m + ")(.*)$", "i"),
            Ut = new RegExp("^(" + m + ")(?!px)[a-z%]+$", "i"),
            zt = new RegExp("^([-+])=(" + m + ")", "i"),
            Wt = {},
            Xt = {
                position: "absolute",
                visibility: "hidden",
                display: "block"
            },
            Vt = {
                letterSpacing: 0,
                fontWeight: 400
            },
            $t = ["Top", "Right", "Bottom", "Left"],
            Jt = ["Webkit", "O", "Moz", "ms"],
            Kt = v.fn.toggle;
        v.fn.extend({
            css: function(e, n) {
                return v.access(this, function(e, n, r) {
                    return r !== t ? v.style(e, n, r) : v.css(e, n)
                }, e, n, arguments.length > 1)
            },
            show: function() {
                return Yt(this, !0)
            },
            hide: function() {
                return Yt(this)
            },
            toggle: function(e, t) {
                var n = typeof e == "boolean";
                return v.isFunction(e) && v.isFunction(t) ? Kt.apply(this, arguments) : this.each(function() {
                    (n ? e : Gt(this)) ? v(this).show(): v(this).hide()
                })
            }
        }), v.extend({
            cssHooks: {
                opacity: {
                    get: function(e, t) {
                        if (t) {
                            var n = Dt(e, "opacity");
                            return n === "" ? "1" : n
                        }
                    }
                }
            },
            cssNumber: {
                fillOpacity: !0,
                fontWeight: !0,
                lineHeight: !0,
                opacity: !0,
                orphans: !0,
                widows: !0,
                zIndex: !0,
                zoom: !0
            },
            cssProps: {
                "float": v.support.cssFloat ? "cssFloat" : "styleFloat"
            },
            style: function(e, n, r, i) {
                if (!e || e.nodeType === 3 || e.nodeType === 8 || !e.style) return;
                var s, o, u, a = v.camelCase(n),
                    f = e.style;
                n = v.cssProps[a] || (v.cssProps[a] = Qt(f, a)), u = v.cssHooks[n] || v.cssHooks[a];
                if (r === t) return u && "get" in u && (s = u.get(e, !1, i)) !== t ? s : f[n];
                o = typeof r, o === "string" && (s = zt.exec(r)) && (r = (s[1] + 1) * s[2] + parseFloat(v.css(e, n)), o = "number");
                if (r == null || o === "number" && isNaN(r)) return;
                o === "number" && !v.cssNumber[a] && (r += "px");
                if (!u || !("set" in u) || (r = u.set(e, r, i)) !== t) try {
                    f[n] = r
                } catch (l) {}
            },
            css: function(e, n, r, i) {
                var s, o, u, a = v.camelCase(n);
                return n = v.cssProps[a] || (v.cssProps[a] = Qt(e.style, a)), u = v.cssHooks[n] || v.cssHooks[a], u && "get" in u && (s = u.get(e, !0, i)), s === t && (s = Dt(e, n)), s === "normal" && n in Vt && (s = Vt[n]), r || i !== t ? (o = parseFloat(s), r || v.isNumeric(o) ? o || 0 : s) : s
            },
            swap: function(e, t, n) {
                var r, i, s = {};
                for (i in t) s[i] = e.style[i], e.style[i] = t[i];
                r = n.call(e);
                for (i in t) e.style[i] = s[i];
                return r
            }
        }), e.getComputedStyle ? Dt = function(t, n) {
            var r, i, s, o, u = e.getComputedStyle(t, null),
                a = t.style;
            return u && (r = u[n], r === "" && !v.contains(t.ownerDocument, t) && (r = v.style(t, n)), Ut.test(r) && qt.test(n) && (i = a.width, s = a.minWidth, o = a.maxWidth, a.minWidth = a.maxWidth = a.width = r, r = u.width, a.width = i, a.minWidth = s, a.maxWidth = o)), r
        } : i.documentElement.currentStyle && (Dt = function(e, t) {
            var n, r, i = e.currentStyle && e.currentStyle[t],
                s = e.style;
            return i == null && s && s[t] && (i = s[t]), Ut.test(i) && !Ft.test(t) && (n = s.left, r = e.runtimeStyle && e.runtimeStyle.left, r && (e.runtimeStyle.left = e.currentStyle.left), s.left = t === "fontSize" ? "1em" : i, i = s.pixelLeft + "px", s.left = n, r && (e.runtimeStyle.left = r)), i === "" ? "auto" : i
        }), v.each(["height", "width"], function(e, t) {
            v.cssHooks[t] = {
                get: function(e, n, r) {
                    if (n) return e.offsetWidth === 0 && It.test(Dt(e, "display")) ? v.swap(e, Xt, function() {
                        return tn(e, t, r)
                    }) : tn(e, t, r)
                },
                set: function(e, n, r) {
                    return Zt(e, n, r ? en(e, t, r, v.support.boxSizing && v.css(e, "boxSizing") === "border-box") : 0)
                }
            }
        }), v.support.opacity || (v.cssHooks.opacity = {
            get: function(e, t) {
                return jt.test((t && e.currentStyle ? e.currentStyle.filter : e.style.filter) || "") ? .01 * parseFloat(RegExp.$1) + "" : t ? "1" : ""
            },
            set: function(e, t) {
                var n = e.style,
                    r = e.currentStyle,
                    i = v.isNumeric(t) ? "alpha(opacity=" + t * 100 + ")" : "",
                    s = r && r.filter || n.filter || "";
                n.zoom = 1;
                if (t >= 1 && v.trim(s.replace(Bt, "")) === "" && n.removeAttribute) {
                    n.removeAttribute("filter");
                    if (r && !r.filter) return
                }
                n.filter = Bt.test(s) ? s.replace(Bt, i) : s + " " + i
            }
        }), v(function() {
            v.support.reliableMarginRight || (v.cssHooks.marginRight = {
                get: function(e, t) {
                    return v.swap(e, {
                        display: "inline-block"
                    }, function() {
                        if (t) return Dt(e, "marginRight")
                    })
                }
            }), !v.support.pixelPosition && v.fn.position && v.each(["top", "left"], function(e, t) {
                v.cssHooks[t] = {
                    get: function(e, n) {
                        if (n) {
                            var r = Dt(e, t);
                            return Ut.test(r) ? v(e).position()[t] + "px" : r
                        }
                    }
                }
            })
        }), v.expr && v.expr.filters && (v.expr.filters.hidden = function(e) {
            return e.offsetWidth === 0 && e.offsetHeight === 0 || !v.support.reliableHiddenOffsets && (e.style && e.style.display || Dt(e, "display")) === "none"
        }, v.expr.filters.visible = function(e) {
            return !v.expr.filters.hidden(e)
        }), v.each({
            margin: "",
            padding: "",
            border: "Width"
        }, function(e, t) {
            v.cssHooks[e + t] = {
                expand: function(n) {
                    var r, i = typeof n == "string" ? n.split(" ") : [n],
                        s = {};
                    for (r = 0; r < 4; r++) s[e + $t[r] + t] = i[r] || i[r - 2] || i[0];
                    return s
                }
            }, qt.test(e) || (v.cssHooks[e + t].set = Zt)
        });
        var rn = /%20/g,
            sn = /\[\]$/,
            on = /\r?\n/g,
            un = /^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,
            an = /^(?:select|textarea)/i;
        v.fn.extend({
            serialize: function() {
                return v.param(this.serializeArray())
            },
            serializeArray: function() {
                return this.map(function() {
                    return this.elements ? v.makeArray(this.elements) : this
                }).filter(function() {
                    return this.name && !this.disabled && (this.checked || an.test(this.nodeName) || un.test(this.type))
                }).map(function(e, t) {
                    var n = v(this).val();
                    return n == null ? null : v.isArray(n) ? v.map(n, function(e, n) {
                        return {
                            name: t.name,
                            value: e.replace(on, "\r\n")
                        }
                    }) : {
                        name: t.name,
                        value: n.replace(on, "\r\n")
                    }
                }).get()
            }
        }), v.param = function(e, n) {
            var r, i = [],
                s = function(e, t) {
                    t = v.isFunction(t) ? t() : t == null ? "" : t, i[i.length] = encodeURIComponent(e) + "=" + encodeURIComponent(t)
                };
            n === t && (n = v.ajaxSettings && v.ajaxSettings.traditional);
            if (v.isArray(e) || e.jquery && !v.isPlainObject(e)) v.each(e, function() {
                s(this.name, this.value)
            });
            else
                for (r in e) fn(r, e[r], n, s);
            return i.join("&").replace(rn, "+")
        };
        var ln, cn, hn = /#.*$/,
            pn = /^(.*?):[ \t]*([^\r\n]*)\r?$/mg,
            dn = /^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/,
            vn = /^(?:GET|HEAD)$/,
            mn = /^\/\//,
            gn = /\?/,
            yn = /<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,
            bn = /([?&])_=[^&]*/,
            wn = /^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,
            En = v.fn.load,
            Sn = {},
            xn = {},
            Tn = ["*/"] + ["*"];
        try {
            cn = s.href
        } catch (Nn) {
            cn = i.createElement("a"), cn.href = "", cn = cn.href
        }
        ln = wn.exec(cn.toLowerCase()) || [], v.fn.load = function(e, n, r) {
            if (typeof e != "string" && En) return En.apply(this, arguments);
            if (!this.length) return this;
            var i, s, o, u = this,
                a = e.indexOf(" ");
            return a >= 0 && (i = e.slice(a, e.length), e = e.slice(0, a)), v.isFunction(n) ? (r = n, n = t) : n && typeof n == "object" && (s = "POST"), v.ajax({
                url: e,
                type: s,
                dataType: "html",
                data: n,
                complete: function(e, t) {
                    r && u.each(r, o || [e.responseText, t, e])
                }
            }).done(function(e) {
                o = arguments, u.html(i ? v("<div>").append(e.replace(yn, "")).find(i) : e)
            }), this
        }, v.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "), function(e, t) {
            v.fn[t] = function(e) {
                return this.on(t, e)
            }
        }), v.each(["get", "post"], function(e, n) {
            v[n] = function(e, r, i, s) {
                return v.isFunction(r) && (s = s || i, i = r, r = t), v.ajax({
                    type: n,
                    url: e,
                    data: r,
                    success: i,
                    dataType: s
                })
            }
        }), v.extend({
            getScript: function(e, n) {
                return v.get(e, t, n, "script")
            },
            getJSON: function(e, t, n) {
                return v.get(e, t, n, "json")
            },
            ajaxSetup: function(e, t) {
                return t ? Ln(e, v.ajaxSettings) : (t = e, e = v.ajaxSettings), Ln(e, t), e
            },
            ajaxSettings: {
                url: cn,
                isLocal: dn.test(ln[1]),
                global: !0,
                type: "GET",
                contentType: "application/x-www-form-urlencoded; charset=UTF-8",
                processData: !0,
                async: !0,
                accepts: {
                    xml: "application/xml, text/xml",
                    html: "text/html",
                    text: "text/plain",
                    json: "application/json, text/javascript",
                    "*": Tn
                },
                contents: {
                    xml: /xml/,
                    html: /html/,
                    json: /json/
                },
                responseFields: {
                    xml: "responseXML",
                    text: "responseText"
                },
                converters: {
                    "* text": e.String,
                    "text html": !0,
                    "text json": v.parseJSON,
                    "text xml": v.parseXML
                },
                flatOptions: {
                    context: !0,
                    url: !0
                }
            },
            ajaxPrefilter: Cn(Sn),
            ajaxTransport: Cn(xn),
            ajax: function(e, n) {
                function T(e, n, s, a) {
                    var l, y, b, w, S, T = n;
                    if (E === 2) return;
                    E = 2, u && clearTimeout(u), o = t, i = a || "", x.readyState = e > 0 ? 4 : 0, s && (w = An(c, x, s));
                    if (e >= 200 && e < 300 || e === 304) c.ifModified && (S = x.getResponseHeader("Last-Modified"), S && (v.lastModified[r] = S), S = x.getResponseHeader("Etag"), S && (v.etag[r] = S)), e === 304 ? (T = "notmodified", l = !0) : (l = On(c, w), T = l.state, y = l.data, b = l.error, l = !b);
                    else {
                        b = T;
                        if (!T || e) T = "error", e < 0 && (e = 0)
                    }
                    x.status = e, x.statusText = (n || T) + "", l ? d.resolveWith(h, [y, T, x]) : d.rejectWith(h, [x, T, b]), x.statusCode(g), g = t, f && p.trigger("ajax" + (l ? "Success" : "Error"), [x, c, l ? y : b]), m.fireWith(h, [x, T]), f && (p.trigger("ajaxComplete", [x, c]), --v.active || v.event.trigger("ajaxStop"))
                }
                typeof e == "object" && (n = e, e = t), n = n || {};
                var r, i, s, o, u, a, f, l, c = v.ajaxSetup({}, n),
                    h = c.context || c,
                    p = h !== c && (h.nodeType || h instanceof v) ? v(h) : v.event,
                    d = v.Deferred(),
                    m = v.Callbacks("once memory"),
                    g = c.statusCode || {},
                    b = {},
                    w = {},
                    E = 0,
                    S = "canceled",
                    x = {
                        readyState: 0,
                        setRequestHeader: function(e, t) {
                            if (!E) {
                                var n = e.toLowerCase();
                                e = w[n] = w[n] || e, b[e] = t
                            }
                            return this
                        },
                        getAllResponseHeaders: function() {
                            return E === 2 ? i : null
                        },
                        getResponseHeader: function(e) {
                            var n;
                            if (E === 2) {
                                if (!s) {
                                    s = {};
                                    while (n = pn.exec(i)) s[n[1].toLowerCase()] = n[2]
                                }
                                n = s[e.toLowerCase()]
                            }
                            return n === t ? null : n
                        },
                        overrideMimeType: function(e) {
                            return E || (c.mimeType = e), this
                        },
                        abort: function(e) {
                            return e = e || S, o && o.abort(e), T(0, e), this
                        }
                    };
                d.promise(x), x.success = x.done, x.error = x.fail, x.complete = m.add, x.statusCode = function(e) {
                    if (e) {
                        var t;
                        if (E < 2)
                            for (t in e) g[t] = [g[t], e[t]];
                        else t = e[x.status], x.always(t)
                    }
                    return this
                }, c.url = ((e || c.url) + "").replace(hn, "").replace(mn, ln[1] + "//"), c.dataTypes = v.trim(c.dataType || "*").toLowerCase().split(y), c.crossDomain == null && (a = wn.exec(c.url.toLowerCase()) || !1, c.crossDomain = a && a.join(":") + (a[3] ? "" : a[1] === "http:" ? 80 : 443) !== ln.join(":") + (ln[3] ? "" : ln[1] === "http:" ? 80 : 443)), c.data && c.processData && typeof c.data != "string" && (c.data = v.param(c.data, c.traditional)), kn(Sn, c, n, x);
                if (E === 2) return x;
                f = c.global, c.type = c.type.toUpperCase(), c.hasContent = !vn.test(c.type), f && v.active++ === 0 && v.event.trigger("ajaxStart");
                if (!c.hasContent) {
                    c.data && (c.url += (gn.test(c.url) ? "&" : "?") + c.data, delete c.data), r = c.url;
                    if (c.cache === !1) {
                        var N = v.now(),
                            C = c.url.replace(bn, "$1_=" + N);
                        c.url = C + (C === c.url ? (gn.test(c.url) ? "&" : "?") + "_=" + N : "")
                    }
                }(c.data && c.hasContent && c.contentType !== !1 || n.contentType) && x.setRequestHeader("Content-Type", c.contentType), c.ifModified && (r = r || c.url, v.lastModified[r] && x.setRequestHeader("If-Modified-Since", v.lastModified[r]), v.etag[r] && x.setRequestHeader("If-None-Match", v.etag[r])), x.setRequestHeader("Accept", c.dataTypes[0] && c.accepts[c.dataTypes[0]] ? c.accepts[c.dataTypes[0]] + (c.dataTypes[0] !== "*" ? ", " + Tn + "; q=0.01" : "") : c.accepts["*"]);
                for (l in c.headers) x.setRequestHeader(l, c.headers[l]);
                if (!c.beforeSend || c.beforeSend.call(h, x, c) !== !1 && E !== 2) {
                    S = "abort";
                    for (l in {
                        success: 1,
                        error: 1,
                        complete: 1
                    }) x[l](c[l]);
                    o = kn(xn, c, n, x);
                    if (!o) T(-1, "No Transport");
                    else {
                        x.readyState = 1, f && p.trigger("ajaxSend", [x, c]), c.async && c.timeout > 0 && (u = setTimeout(function() {
                            x.abort("timeout")
                        }, c.timeout));
                        try {
                            E = 1, o.send(b, T)
                        } catch (k) {
                            if (!(E < 2)) throw k;
                            T(-1, k)
                        }
                    }
                    return x
                }
                return x.abort()
            },
            active: 0,
            lastModified: {},
            etag: {}
        });
        var Mn = [],
            _n = /\?/,
            Dn = /(=)\?(?=&|$)|\?\?/,
            Pn = v.now();
        v.ajaxSetup({
            jsonp: "callback",
            jsonpCallback: function() {
                var e = Mn.pop() || v.expando + "_" + Pn++;
                return this[e] = !0, e
            }
        }), v.ajaxPrefilter("json jsonp", function(n, r, i) {
            var s, o, u, a = n.data,
                f = n.url,
                l = n.jsonp !== !1,
                c = l && Dn.test(f),
                h = l && !c && typeof a == "string" && !(n.contentType || "").indexOf("application/x-www-form-urlencoded") && Dn.test(a);
            if (n.dataTypes[0] === "jsonp" || c || h) return s = n.jsonpCallback = v.isFunction(n.jsonpCallback) ? n.jsonpCallback() : n.jsonpCallback, o = e[s], c ? n.url = f.replace(Dn, "$1" + s) : h ? n.data = a.replace(Dn, "$1" + s) : l && (n.url += (_n.test(f) ? "&" : "?") + n.jsonp + "=" + s), n.converters["script json"] = function() {
                return u || v.error(s + " was not called"), u[0]
            }, n.dataTypes[0] = "json", e[s] = function() {
                u = arguments
            }, i.always(function() {
                e[s] = o, n[s] && (n.jsonpCallback = r.jsonpCallback, Mn.push(s)), u && v.isFunction(o) && o(u[0]), u = o = t
            }), "script"
        }), v.ajaxSetup({
            accepts: {
                script: "text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"
            },
            contents: {
                script: /javascript|ecmascript/
            },
            converters: {
                "text script": function(e) {
                    return v.globalEval(e), e
                }
            }
        }), v.ajaxPrefilter("script", function(e) {
            e.cache === t && (e.cache = !1), e.crossDomain && (e.type = "GET", e.global = !1)
        }), v.ajaxTransport("script", function(e) {
            if (e.crossDomain) {
                var n, r = i.head || i.getElementsByTagName("head")[0] || i.documentElement;
                return {
                    send: function(s, o) {
                        n = i.createElement("script"), n.async = "async", e.scriptCharset && (n.charset = e.scriptCharset), n.src = e.url, n.onload = n.onreadystatechange = function(e, i) {
                            if (i || !n.readyState || /loaded|complete/.test(n.readyState)) n.onload = n.onreadystatechange = null, r && n.parentNode && r.removeChild(n), n = t, i || o(200, "success")
                        }, r.insertBefore(n, r.firstChild)
                    },
                    abort: function() {
                        n && n.onload(0, 1)
                    }
                }
            }
        });
        var Hn, Bn = e.ActiveXObject ? function() {
                for (var e in Hn) Hn[e](0, 1)
            } : !1,
            jn = 0;
        v.ajaxSettings.xhr = e.ActiveXObject ? function() {
                return !this.isLocal && Fn() || In()
            } : Fn,
            function(e) {
                v.extend(v.support, {
                    ajax: !!e,
                    cors: !!e && "withCredentials" in e
                })
            }(v.ajaxSettings.xhr()), v.support.ajax && v.ajaxTransport(function(n) {
                if (!n.crossDomain || v.support.cors) {
                    var r;
                    return {
                        send: function(i, s) {
                            var o, u, a = n.xhr();
                            n.username ? a.open(n.type, n.url, n.async, n.username, n.password) : a.open(n.type, n.url, n.async);
                            if (n.xhrFields)
                                for (u in n.xhrFields) a[u] = n.xhrFields[u];
                            n.mimeType && a.overrideMimeType && a.overrideMimeType(n.mimeType), !n.crossDomain && !i["X-Requested-With"] && (i["X-Requested-With"] = "XMLHttpRequest");
                            try {
                                for (u in i) a.setRequestHeader(u, i[u])
                            } catch (f) {}
                            a.send(n.hasContent && n.data || null), r = function(e, i) {
                                var u, f, l, c, h;
                                try {
                                    if (r && (i || a.readyState === 4)) {
                                        r = t, o && (a.onreadystatechange = v.noop, Bn && delete Hn[o]);
                                        if (i) a.readyState !== 4 && a.abort();
                                        else {
                                            u = a.status, l = a.getAllResponseHeaders(), c = {}, h = a.responseXML, h && h.documentElement && (c.xml = h);
                                            try {
                                                c.text = a.responseText
                                            } catch (e) {}
                                            try {
                                                f = a.statusText
                                            } catch (p) {
                                                f = ""
                                            }!u && n.isLocal && !n.crossDomain ? u = c.text ? 200 : 404 : u === 1223 && (u = 204)
                                        }
                                    }
                                } catch (d) {
                                    i || s(-1, d)
                                }
                                c && s(u, f, c, l)
                            }, n.async ? a.readyState === 4 ? setTimeout(r, 0) : (o = ++jn, Bn && (Hn || (Hn = {}, v(e).unload(Bn)), Hn[o] = r), a.onreadystatechange = r) : r()
                        },
                        abort: function() {
                            r && r(0, 1)
                        }
                    }
                }
            });
        var qn, Rn, Un = /^(?:toggle|show|hide)$/,
            zn = new RegExp("^(?:([-+])=|)(" + m + ")([a-z%]*)$", "i"),
            Wn = /queueHooks$/,
            Xn = [Gn],
            Vn = {
                "*": [
                    function(e, t) {
                        var n, r, i = this.createTween(e, t),
                            s = zn.exec(t),
                            o = i.cur(),
                            u = +o || 0,
                            a = 1,
                            f = 20;
                        if (s) {
                            n = +s[2], r = s[3] || (v.cssNumber[e] ? "" : "px");
                            if (r !== "px" && u) {
                                u = v.css(i.elem, e, !0) || n || 1;
                                do a = a || ".5", u /= a, v.style(i.elem, e, u + r); while (a !== (a = i.cur() / o) && a !== 1 && --f)
                            }
                            i.unit = r, i.start = u, i.end = s[1] ? u + (s[1] + 1) * n : n
                        }
                        return i
                    }
                ]
            };
        v.Animation = v.extend(Kn, {
            tweener: function(e, t) {
                v.isFunction(e) ? (t = e, e = ["*"]) : e = e.split(" ");
                var n, r = 0,
                    i = e.length;
                for (; r < i; r++) n = e[r], Vn[n] = Vn[n] || [], Vn[n].unshift(t)
            },
            prefilter: function(e, t) {
                t ? Xn.unshift(e) : Xn.push(e)
            }
        }), v.Tween = Yn, Yn.prototype = {
            constructor: Yn,
            init: function(e, t, n, r, i, s) {
                this.elem = e, this.prop = n, this.easing = i || "swing", this.options = t, this.start = this.now = this.cur(), this.end = r, this.unit = s || (v.cssNumber[n] ? "" : "px")
            },
            cur: function() {
                var e = Yn.propHooks[this.prop];
                return e && e.get ? e.get(this) : Yn.propHooks._default.get(this)
            },
            run: function(e) {
                var t, n = Yn.propHooks[this.prop];
                return this.options.duration ? this.pos = t = v.easing[this.easing](e, this.options.duration * e, 0, 1, this.options.duration) : this.pos = t = e, this.now = (this.end - this.start) * t + this.start, this.options.step && this.options.step.call(this.elem, this.now, this), n && n.set ? n.set(this) : Yn.propHooks._default.set(this), this
            }
        }, Yn.prototype.init.prototype = Yn.prototype, Yn.propHooks = {
            _default: {
                get: function(e) {
                    var t;
                    return e.elem[e.prop] == null || !!e.elem.style && e.elem.style[e.prop] != null ? (t = v.css(e.elem, e.prop, !1, ""), !t || t === "auto" ? 0 : t) : e.elem[e.prop]
                },
                set: function(e) {
                    v.fx.step[e.prop] ? v.fx.step[e.prop](e) : e.elem.style && (e.elem.style[v.cssProps[e.prop]] != null || v.cssHooks[e.prop]) ? v.style(e.elem, e.prop, e.now + e.unit) : e.elem[e.prop] = e.now
                }
            }
        }, Yn.propHooks.scrollTop = Yn.propHooks.scrollLeft = {
            set: function(e) {
                e.elem.nodeType && e.elem.parentNode && (e.elem[e.prop] = e.now)
            }
        }, v.each(["toggle", "show", "hide"], function(e, t) {
            var n = v.fn[t];
            v.fn[t] = function(r, i, s) {
                return r == null || typeof r == "boolean" || !e && v.isFunction(r) && v.isFunction(i) ? n.apply(this, arguments) : this.animate(Zn(t, !0), r, i, s)
            }
        }), v.fn.extend({
            fadeTo: function(e, t, n, r) {
                return this.filter(Gt).css("opacity", 0).show().end().animate({
                    opacity: t
                }, e, n, r)
            },
            animate: function(e, t, n, r) {
                var i = v.isEmptyObject(e),
                    s = v.speed(t, n, r),
                    o = function() {
                        var t = Kn(this, v.extend({}, e), s);
                        i && t.stop(!0)
                    };
                return i || s.queue === !1 ? this.each(o) : this.queue(s.queue, o)
            },
            stop: function(e, n, r) {
                var i = function(e) {
                    var t = e.stop;
                    delete e.stop, t(r)
                };
                return typeof e != "string" && (r = n, n = e, e = t), n && e !== !1 && this.queue(e || "fx", []), this.each(function() {
                    var t = !0,
                        n = e != null && e + "queueHooks",
                        s = v.timers,
                        o = v._data(this);
                    if (n) o[n] && o[n].stop && i(o[n]);
                    else
                        for (n in o) o[n] && o[n].stop && Wn.test(n) && i(o[n]);
                    for (n = s.length; n--;) s[n].elem === this && (e == null || s[n].queue === e) && (s[n].anim.stop(r), t = !1, s.splice(n, 1));
                    (t || !r) && v.dequeue(this, e)
                })
            }
        }), v.each({
            slideDown: Zn("show"),
            slideUp: Zn("hide"),
            slideToggle: Zn("toggle"),
            fadeIn: {
                opacity: "show"
            },
            fadeOut: {
                opacity: "hide"
            },
            fadeToggle: {
                opacity: "toggle"
            }
        }, function(e, t) {
            v.fn[e] = function(e, n, r) {
                return this.animate(t, e, n, r)
            }
        }), v.speed = function(e, t, n) {
            var r = e && typeof e == "object" ? v.extend({}, e) : {
                complete: n || !n && t || v.isFunction(e) && e,
                duration: e,
                easing: n && t || t && !v.isFunction(t) && t
            };
            r.duration = v.fx.off ? 0 : typeof r.duration == "number" ? r.duration : r.duration in v.fx.speeds ? v.fx.speeds[r.duration] : v.fx.speeds._default;
            if (r.queue == null || r.queue === !0) r.queue = "fx";
            return r.old = r.complete, r.complete = function() {
                v.isFunction(r.old) && r.old.call(this), r.queue && v.dequeue(this, r.queue)
            }, r
        }, v.easing = {
            linear: function(e) {
                return e
            },
            swing: function(e) {
                return .5 - Math.cos(e * Math.PI) / 2
            }
        }, v.timers = [], v.fx = Yn.prototype.init, v.fx.tick = function() {
            var e, t = v.timers,
                n = 0;
            for (; n < t.length; n++) e = t[n], !e() && t[n] === e && t.splice(n--, 1);
            t.length || v.fx.stop()
        }, v.fx.timer = function(e) {
            e() && v.timers.push(e) && !Rn && (Rn = setInterval(v.fx.tick, v.fx.interval))
        }, v.fx.interval = 13, v.fx.stop = function() {
            clearInterval(Rn), Rn = null
        }, v.fx.speeds = {
            slow: 600,
            fast: 200,
            _default: 400
        }, v.fx.step = {}, v.expr && v.expr.filters && (v.expr.filters.animated = function(e) {
            return v.grep(v.timers, function(t) {
                return e === t.elem
            }).length
        });
        var er = /^(?:body|html)$/i;
        v.fn.offset = function(e) {
            if (arguments.length) return e === t ? this : this.each(function(t) {
                v.offset.setOffset(this, e, t)
            });
            var n, r, i, s, o, u, a, f = {
                    top: 0,
                    left: 0
                },
                l = this[0],
                c = l && l.ownerDocument;
            if (!c) return;
            return (r = c.body) === l ? v.offset.bodyOffset(l) : (n = c.documentElement, v.contains(n, l) ? (typeof l.getBoundingClientRect != "undefined" && (f = l.getBoundingClientRect()), i = tr(c), s = n.clientTop || r.clientTop || 0, o = n.clientLeft || r.clientLeft || 0, u = i.pageYOffset || n.scrollTop, a = i.pageXOffset || n.scrollLeft, {
                top: f.top + u - s,
                left: f.left + a - o
            }) : f)
        }, v.offset = {
            bodyOffset: function(e) {
                var t = e.offsetTop,
                    n = e.offsetLeft;
                return v.support.doesNotIncludeMarginInBodyOffset && (t += parseFloat(v.css(e, "marginTop")) || 0, n += parseFloat(v.css(e, "marginLeft")) || 0), {
                    top: t,
                    left: n
                }
            },
            setOffset: function(e, t, n) {
                var r = v.css(e, "position");
                r === "static" && (e.style.position = "relative");
                var i = v(e),
                    s = i.offset(),
                    o = v.css(e, "top"),
                    u = v.css(e, "left"),
                    a = (r === "absolute" || r === "fixed") && v.inArray("auto", [o, u]) > -1,
                    f = {},
                    l = {},
                    c, h;
                a ? (l = i.position(), c = l.top, h = l.left) : (c = parseFloat(o) || 0, h = parseFloat(u) || 0), v.isFunction(t) && (t = t.call(e, n, s)), t.top != null && (f.top = t.top - s.top + c), t.left != null && (f.left = t.left - s.left + h), "using" in t ? t.using.call(e, f) : i.css(f)
            }
        }, v.fn.extend({
            position: function() {
                if (!this[0]) return;
                var e = this[0],
                    t = this.offsetParent(),
                    n = this.offset(),
                    r = er.test(t[0].nodeName) ? {
                        top: 0,
                        left: 0
                    } : t.offset();
                return n.top -= parseFloat(v.css(e, "marginTop")) || 0, n.left -= parseFloat(v.css(e, "marginLeft")) || 0, r.top += parseFloat(v.css(t[0], "borderTopWidth")) || 0, r.left += parseFloat(v.css(t[0], "borderLeftWidth")) || 0, {
                    top: n.top - r.top,
                    left: n.left - r.left
                }
            },
            offsetParent: function() {
                return this.map(function() {
                    var e = this.offsetParent || i.body;
                    while (e && !er.test(e.nodeName) && v.css(e, "position") === "static") e = e.offsetParent;
                    return e || i.body
                })
            }
        }), v.each({
            scrollLeft: "pageXOffset",
            scrollTop: "pageYOffset"
        }, function(e, n) {
            var r = /Y/.test(n);
            v.fn[e] = function(i) {
                return v.access(this, function(e, i, s) {
                    var o = tr(e);
                    if (s === t) return o ? n in o ? o[n] : o.document.documentElement[i] : e[i];
                    o ? o.scrollTo(r ? v(o).scrollLeft() : s, r ? s : v(o).scrollTop()) : e[i] = s
                }, e, i, arguments.length, null)
            }
        }), v.each({
            Height: "height",
            Width: "width"
        }, function(e, n) {
            v.each({
                padding: "inner" + e,
                content: n,
                "": "outer" + e
            }, function(r, i) {
                v.fn[i] = function(i, s) {
                    var o = arguments.length && (r || typeof i != "boolean"),
                        u = r || (i === !0 || s === !0 ? "margin" : "border");
                    return v.access(this, function(n, r, i) {
                        var s;
                        return v.isWindow(n) ? n.document.documentElement["client" + e] : n.nodeType === 9 ? (s = n.documentElement, Math.max(n.body["scroll" + e], s["scroll" + e], n.body["offset" + e], s["offset" + e], s["client" + e])) : i === t ? v.css(n, r, i, u) : v.style(n, r, i, u)
                    }, n, o ? i : t, o, null)
                }
            })
        }), e.jQuery = e.$ = v, typeof define == "function" && define.amd && define.amd.jQuery && define("jquery", [], function() {
            return v
        })
    }(window), define("jquery/jquery-1.8.2", function() {}),
    function(e, t) {
        typeof exports != "undefined" ? t(e, exports, require("underscore")) : typeof define == "function" && define.amd ? define("backbone/backbone-0.9.10", ["underscore", "jquery", "exports"], function(n, r, i) {
            e.Backbone = t(e, i, n, r)
        }) : e.Backbone = t(e, {}, e._, e.jQuery || e.Zepto || e.ender)
    }(this, function(e, t, n, r) {
        var i = e.Backbone,
            s = [],
            o = s.push,
            u = s.slice,
            a = s.splice;
        t.VERSION = "0.9.10", t.$ = r, t.noConflict = function() {
            return e.Backbone = i, this
        }, t.emulateHTTP = !1, t.emulateJSON = !1;
        var f = /\s+/,
            l = function(e, t, n, r) {
                if (!n) return !0;
                if (typeof n == "object")
                    for (var i in n) e[t].apply(e, [i, n[i]].concat(r));
                else {
                    if (!f.test(n)) return !0;
                    var s = n.split(f);
                    for (var o = 0, u = s.length; o < u; o++) e[t].apply(e, [s[o]].concat(r))
                }
            },
            c = function(e, t) {
                var n, r = -1,
                    i = e.length;
                switch (t.length) {
                    case 0:
                        while (++r < i)(n = e[r]).callback.call(n.ctx);
                        return;
                    case 1:
                        while (++r < i)(n = e[r]).callback.call(n.ctx, t[0]);
                        return;
                    case 2:
                        while (++r < i)(n = e[r]).callback.call(n.ctx, t[0], t[1]);
                        return;
                    case 3:
                        while (++r < i)(n = e[r]).callback.call(n.ctx, t[0], t[1], t[2]);
                        return;
                    default:
                        while (++r < i)(n = e[r]).callback.apply(n.ctx, t)
                }
            },
            h = t.Events = {
                on: function(e, t, n) {
                    if (!l(this, "on", e, [t, n]) || !t) return this;
                    this._events || (this._events = {});
                    var r = this._events[e] || (this._events[e] = []);
                    return r.push({
                        callback: t,
                        context: n,
                        ctx: n || this
                    }), this
                },
                once: function(e, t, r) {
                    if (!l(this, "once", e, [t, r]) || !t) return this;
                    var i = this,
                        s = n.once(function() {
                            i.off(e, s), t.apply(this, arguments)
                        });
                    return s._callback = t, this.on(e, s, r), this
                },
                off: function(e, t, r) {
                    var i, s, o, u, a, f, c, h;
                    if (!this._events || !l(this, "off", e, [t, r])) return this;
                    if (!e && !t && !r) return this._events = {}, this;
                    u = e ? [e] : n.keys(this._events);
                    for (a = 0, f = u.length; a < f; a++) {
                        e = u[a];
                        if (i = this._events[e]) {
                            o = [];
                            if (t || r)
                                for (c = 0, h = i.length; c < h; c++) s = i[c], (t && t !== s.callback && t !== s.callback._callback || r && r !== s.context) && o.push(s);
                            this._events[e] = o
                        }
                    }
                    return this
                },
                trigger: function(e) {
                    if (!this._events) return this;
                    var t = u.call(arguments, 1);
                    if (!l(this, "trigger", e, t)) return this;
                    var n = this._events[e],
                        r = this._events.all;
                    return n && c(n, t), r && c(r, arguments), this
                },
                listenTo: function(e, t, r) {
                    var i = this._listeners || (this._listeners = {}),
                        s = e._listenerId || (e._listenerId = n.uniqueId("l"));
                    return i[s] = e, e.on(t, typeof t == "object" ? this : r, this), this
                },
                stopListening: function(e, t, n) {
                    var r = this._listeners;
                    if (!r) return;
                    if (e) e.off(t, typeof t == "object" ? this : n, this), !t && !n && delete r[e._listenerId];
                    else {
                        typeof t == "object" && (n = this);
                        for (var i in r) r[i].off(t, n, this);
                        this._listeners = {}
                    }
                    return this
                }
            };
        h.bind = h.on, h.unbind = h.off, n.extend(t, h);
        var p = t.Model = function(e, t) {
            var r, i = e || {};
            this.cid = n.uniqueId("c"), this.attributes = {}, t && t.collection && (this.collection = t.collection), t && t.parse && (i = this.parse(i, t) || {});
            if (r = n.result(this, "defaults")) i = n.defaults({}, i, r);
            this.set(i, t), this.changed = {}, this.initialize.apply(this, arguments)
        };
        n.extend(p.prototype, h, {
            changed: null,
            idAttribute: "id",
            initialize: function() {},
            toJSON: function(e) {
                return n.clone(this.attributes)
            },
            sync: function() {
                return t.sync.apply(this, arguments)
            },
            get: function(e) {
                return this.attributes[e]
            },
            escape: function(e) {
                return n.escape(this.get(e))
            },
            has: function(e) {
                return this.get(e) != null
            },
            set: function(e, t, r) {
                var i, s, o, u, a, f, l, c;
                if (e == null) return this;
                typeof e == "object" ? (s = e, r = t) : (s = {})[e] = t, r || (r = {});
                if (!this._validate(s, r)) return !1;
                o = r.unset, a = r.silent, u = [], f = this._changing, this._changing = !0, f || (this._previousAttributes = n.clone(this.attributes), this.changed = {}), c = this.attributes, l = this._previousAttributes, this.idAttribute in s && (this.id = s[this.idAttribute]);
                for (i in s) t = s[i], n.isEqual(c[i], t) || u.push(i), n.isEqual(l[i], t) ? delete this.changed[i] : this.changed[i] = t, o ? delete c[i] : c[i] = t;
                if (!a) {
                    u.length && (this._pending = !0);
                    for (var h = 0, p = u.length; h < p; h++) this.trigger("change:" + u[h], this, c[u[h]], r)
                }
                if (f) return this;
                if (!a)
                    while (this._pending) this._pending = !1, this.trigger("change", this, r);
                return this._pending = !1, this._changing = !1, this
            },
            unset: function(e, t) {
                return this.set(e, void 0, n.extend({}, t, {
                    unset: !0
                }))
            },
            clear: function(e) {
                var t = {};
                for (var r in this.attributes) t[r] = void 0;
                return this.set(t, n.extend({}, e, {
                    unset: !0
                }))
            },
            hasChanged: function(e) {
                return e == null ? !n.isEmpty(this.changed) : n.has(this.changed, e)
            },
            changedAttributes: function(e) {
                if (!e) return this.hasChanged() ? n.clone(this.changed) : !1;
                var t, r = !1,
                    i = this._changing ? this._previousAttributes : this.attributes;
                for (var s in e) {
                    if (n.isEqual(i[s], t = e[s])) continue;
                    (r || (r = {}))[s] = t
                }
                return r
            },
            previous: function(e) {
                return e == null || !this._previousAttributes ? null : this._previousAttributes[e]
            },
            previousAttributes: function() {
                return n.clone(this._previousAttributes)
            },
            fetch: function(e) {
                e = e ? n.clone(e) : {}, e.parse === void 0 && (e.parse = !0);
                var t = e.success;
                return e.success = function(e, n, r) {
                    if (!e.set(e.parse(n, r), r)) return !1;
                    t && t(e, n, r)
                }, this.sync("read", this, e)
            },
            save: function(e, t, r) {
                var i, s, o, u, a = this.attributes;
                return e == null || typeof e == "object" ? (i = e, r = t) : (i = {})[e] = t, i && (!r || !r.wait) && !this.set(i, r) ? !1 : (r = n.extend({
                    validate: !0
                }, r), this._validate(i, r) ? (i && r.wait && (this.attributes = n.extend({}, a, i)), r.parse === void 0 && (r.parse = !0), s = r.success, r.success = function(e, t, r) {
                    e.attributes = a;
                    var o = e.parse(t, r);
                    r.wait && (o = n.extend(i || {}, o));
                    if (n.isObject(o) && !e.set(o, r)) return !1;
                    s && s(e, t, r)
                }, o = this.isNew() ? "create" : r.patch ? "patch" : "update", o === "patch" && (r.attrs = i), u = this.sync(o, this, r), i && r.wait && (this.attributes = a), u) : !1)
            },
            destroy: function(e) {
                e = e ? n.clone(e) : {};
                var t = this,
                    r = e.success,
                    i = function() {
                        t.trigger("destroy", t, t.collection, e)
                    };
                e.success = function(e, t, n) {
                    (n.wait || e.isNew()) && i(), r && r(e, t, n)
                };
                if (this.isNew()) return e.success(this, null, e), !1;
                var s = this.sync("delete", this, e);
                return e.wait || i(), s
            },
            url: function() {
                var e = n.result(this, "urlRoot") || n.result(this.collection, "url") || _();
                return this.isNew() ? e : e + (e.charAt(e.length - 1) === "/" ? "" : "/") + encodeURIComponent(this.id)
            },
            parse: function(e, t) {
                return e
            },
            clone: function() {
                return new this.constructor(this.attributes)
            },
            isNew: function() {
                return this.id == null
            },
            isValid: function(e) {
                return !this.validate || !this.validate(this.attributes, e)
            },
            _validate: function(e, t) {
                if (!t.validate || !this.validate) return !0;
                e = n.extend({}, this.attributes, e);
                var r = this.validationError = this.validate(e, t) || null;
                return r ? (this.trigger("invalid", this, r, t || {}), !1) : !0
            }
        });
        var d = t.Collection = function(e, t) {
            t || (t = {}), t.model && (this.model = t.model), t.comparator !== void 0 && (this.comparator = t.comparator), this.models = [], this._reset(), this.initialize.apply(this, arguments), e && this.reset(e, n.extend({
                silent: !0
            }, t))
        };
        n.extend(d.prototype, h, {
            model: p,
            initialize: function() {},
            toJSON: function(e) {
                return this.map(function(t) {
                    return t.toJSON(e)
                })
            },
            sync: function() {
                return t.sync.apply(this, arguments)
            },
            add: function(e, t) {
                e = n.isArray(e) ? e.slice() : [e], t || (t = {});
                var r, i, s, u, f, l, c, h, p, d;
                c = [], h = t.at, p = this.comparator && h == null && t.sort != 0, d = n.isString(this.comparator) ? this.comparator : null;
                for (r = 0, i = e.length; r < i; r++) {
                    if (!(s = this._prepareModel(u = e[r], t))) {
                        this.trigger("invalid", this, u, t);
                        continue
                    }
                    if (f = this.get(s)) {
                        t.merge && (f.set(u === s ? s.attributes : u, t), p && !l && f.hasChanged(d) && (l = !0));
                        continue
                    }
                    c.push(s), s.on("all", this._onModelEvent, this), this._byId[s.cid] = s, s.id != null && (this._byId[s.id] = s)
                }
                c.length && (p && (l = !0), this.length += c.length, h != null ? a.apply(this.models, [h, 0].concat(c)) : o.apply(this.models, c)), l && this.sort({
                    silent: !0
                });
                if (t.silent) return this;
                for (r = 0, i = c.length; r < i; r++)(s = c[r]).trigger("add", s, this, t);
                return l && this.trigger("sort", this, t), this
            },
            remove: function(e, t) {
                e = n.isArray(e) ? e.slice() : [e], t || (t = {});
                var r, i, s, o;
                for (r = 0, i = e.length; r < i; r++) {
                    o = this.get(e[r]);
                    if (!o) continue;
                    delete this._byId[o.id], delete this._byId[o.cid], s = this.indexOf(o), this.models.splice(s, 1), this.length--, t.silent || (t.index = s, o.trigger("remove", o, this, t)), this._removeReference(o)
                }
                return this
            },
            push: function(e, t) {
                return e = this._prepareModel(e, t), this.add(e, n.extend({
                    at: this.length
                }, t)), e
            },
            pop: function(e) {
                var t = this.at(this.length - 1);
                return this.remove(t, e), t
            },
            unshift: function(e, t) {
                return e = this._prepareModel(e, t), this.add(e, n.extend({
                    at: 0
                }, t)), e
            },
            shift: function(e) {
                var t = this.at(0);
                return this.remove(t, e), t
            },
            slice: function(e, t) {
                return this.models.slice(e, t)
            },
            get: function(e) {
                return e == null ? void 0 : (this._idAttr || (this._idAttr = this.model.prototype.idAttribute), this._byId[e.id || e.cid || e[this._idAttr] || e])
            },
            at: function(e) {
                return this.models[e]
            },
            where: function(e) {
                return n.isEmpty(e) ? [] : this.filter(function(t) {
                    for (var n in e)
                        if (e[n] !== t.get(n)) return !1;
                    return !0
                })
            },
            sort: function(e) {
                if (!this.comparator) throw new Error("Cannot sort a set without a comparator");
                return e || (e = {}), n.isString(this.comparator) || this.comparator.length === 1 ? this.models = this.sortBy(this.comparator, this) : this.models.sort(n.bind(this.comparator, this)), e.silent || this.trigger("sort", this, e), this
            },
            pluck: function(e) {
                return n.invoke(this.models, "get", e)
            },
            update: function(e, t) {
                t = n.extend({
                    add: !0,
                    merge: !0,
                    remove: !0
                }, t), t.parse && (e = this.parse(e, t));
                var r, i, s, o, u = [],
                    a = [],
                    f = {};
                n.isArray(e) || (e = e ? [e] : []);
                if (t.add && !t.remove) return this.add(e, t);
                for (i = 0, s = e.length; i < s; i++) r = e[i], o = this.get(r), t.remove && o && (f[o.cid] = !0), (t.add && !o || t.merge && o) && u.push(r);
                if (t.remove)
                    for (i = 0, s = this.models.length; i < s; i++) r = this.models[i], f[r.cid] || a.push(r);
                return a.length && this.remove(a, t), u.length && this.add(u, t), this
            },
            reset: function(e, t) {
                t || (t = {}), t.parse && (e = this.parse(e, t));
                for (var r = 0, i = this.models.length; r < i; r++) this._removeReference(this.models[r]);
                return t.previousModels = this.models.slice(), this._reset(), e && this.add(e, n.extend({
                    silent: !0
                }, t)), t.silent || this.trigger("reset", this, t), this
            },
            fetch: function(e) {
                e = e ? n.clone(e) : {}, e.parse === void 0 && (e.parse = !0);
                var t = e.success;
                return e.success = function(e, n, r) {
                    var i = r.update ? "update" : "reset";
                    e[i](n, r), t && t(e, n, r)
                }, this.sync("read", this, e)
            },
            create: function(e, t) {
                t = t ? n.clone(t) : {};
                if (!(e = this._prepareModel(e, t))) return !1;
                t.wait || this.add(e, t);
                var r = this,
                    i = t.success;
                return t.success = function(e, t, n) {
                    n.wait && r.add(e, n), i && i(e, t, n)
                }, e.save(null, t), e
            },
            parse: function(e, t) {
                return e
            },
            clone: function() {
                return new this.constructor(this.models)
            },
            _reset: function() {
                this.length = 0, this.models.length = 0, this._byId = {}
            },
            _prepareModel: function(e, t) {
                if (e instanceof p) return e.collection || (e.collection = this), e;
                t || (t = {}), t.collection = this;
                var n = new this.model(e, t);
                return n._validate(e, t) ? n : !1
            },
            _removeReference: function(e) {
                this === e.collection && delete e.collection, e.off("all", this._onModelEvent, this)
            },
            _onModelEvent: function(e, t, n, r) {
                if ((e === "add" || e === "remove") && n !== this) return;
                e === "destroy" && this.remove(t, r), t && e === "change:" + t.idAttribute && (delete this._byId[t.previous(t.idAttribute)], t.id != null && (this._byId[t.id] = t)), this.trigger.apply(this, arguments)
            },
            sortedIndex: function(e, t, r) {
                t || (t = this.comparator);
                var i = n.isFunction(t) ? t : function(e) {
                    return e.get(t)
                };
                return n.sortedIndex(this.models, e, i, r)
            }
        });
        var v = ["forEach", "each", "map", "collect", "reduce", "foldl", "inject", "reduceRight", "foldr", "find", "detect", "filter", "select", "reject", "every", "all", "some", "any", "include", "contains", "invoke", "max", "min", "toArray", "size", "first", "head", "take", "initial", "rest", "tail", "drop", "last", "without", "indexOf", "shuffle", "lastIndexOf", "isEmpty", "chain"];
        n.each(v, function(e) {
            d.prototype[e] = function() {
                var t = u.call(arguments);
                return t.unshift(this.models), n[e].apply(n, t)
            }
        });
        var m = ["groupBy", "countBy", "sortBy"];
        n.each(m, function(e) {
            d.prototype[e] = function(t, r) {
                var i = n.isFunction(t) ? t : function(e) {
                    return e.get(t)
                };
                return n[e](this.models, i, r)
            }
        });
        var g = t.Router = function(e) {
                e || (e = {}), e.routes && (this.routes = e.routes), this._bindRoutes(), this.initialize.apply(this, arguments)
            },
            y = /\((.*?)\)/g,
            b = /(\(\?)?:\w+/g,
            w = /\*\w+/g,
            E = /[\-{}\[\]+?.,\\\^$|#\s]/g;
        n.extend(g.prototype, h, {
            initialize: function() {},
            route: function(e, r, i) {
                return n.isRegExp(e) || (e = this._routeToRegExp(e)), i || (i = this[r]), t.history.route(e, n.bind(function(n) {
                    var s = this._extractParameters(e, n);
                    i && i.apply(this, s), this.trigger.apply(this, ["route:" + r].concat(s)), this.trigger("route", r, s), t.history.trigger("route", this, r, s)
                }, this)), this
            },
            navigate: function(e, n) {
                return t.history.navigate(e, n), this
            },
            _bindRoutes: function() {
                if (!this.routes) return;
                var e, t = n.keys(this.routes);
                while ((e = t.pop()) != null) this.route(e, this.routes[e])
            },
            _routeToRegExp: function(e) {
                return e = e.replace(E, "\\$&").replace(y, "(?:$1)?").replace(b, function(e, t) {
                    return t ? e : "([^/]+)"
                }).replace(w, "(.*?)"), new RegExp("^" + e + "$")
            },
            _extractParameters: function(e, t) {
                return e.exec(t).slice(1)
            }
        });
        var S = t.History = function() {
                this.handlers = [], n.bindAll(this, "checkUrl"), typeof window != "undefined" && (this.location = window.location, this.history = window.history)
            },
            x = /^[#\/]|\s+$/g,
            T = /^\/+|\/+$/g,
            N = /msie [\w.]+/,
            C = /\/$/;
        S.started = !1, n.extend(S.prototype, h, {
            interval: 50,
            getHash: function(e) {
                var t = (e || this).location.href.match(/#(.*)$/);
                return t ? t[1] : ""
            },
            getFragment: function(e, t) {
                if (e == null)
                    if (this._hasPushState || !this._wantsHashChange || t) {
                        e = this.location.pathname;
                        var n = this.root.replace(C, "");
                        e.indexOf(n) || (e = e.substr(n.length))
                    } else e = this.getHash();
                return e.replace(x, "")
            },
            start: function(e) {
                if (S.started) throw new Error("Backbone.history has already been started");
                S.started = !0, this.options = n.extend({}, {
                    root: "/"
                }, this.options, e), this.root = this.options.root, this._wantsHashChange = this.options.hashChange !== !1, this._wantsPushState = !!this.options.pushState, this._hasPushState = !!(this.options.pushState && this.history && this.history.pushState);
                var r = this.getFragment(),
                    i = document.documentMode,
                    s = N.exec(navigator.userAgent.toLowerCase()) && (!i || i <= 7);
                this.root = ("/" + this.root + "/").replace(T, "/"), s && this._wantsHashChange && (this.iframe = t.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow, this.navigate(r)), this._hasPushState ? t.$(window).on("popstate", this.checkUrl) : this._wantsHashChange && "onhashchange" in window && !s ? t.$(window).on("hashchange", this.checkUrl) : this._wantsHashChange && (this._checkUrlInterval = setInterval(this.checkUrl, this.interval)), this.fragment = r;
                var o = this.location,
                    u = o.pathname.replace(/[^\/]$/, "$&/") === this.root;
                if (this._wantsHashChange && this._wantsPushState && !this._hasPushState && !u) return this.fragment = this.getFragment(null, !0), this.location.replace(this.root + this.location.search + "#" + this.fragment), !0;
                this._wantsPushState && this._hasPushState && u && o.hash && (this.fragment = this.getHash().replace(x, ""), this.history.replaceState({}, document.title, this.root + this.fragment + o.search));
                if (!this.options.silent) return this.loadUrl()
            },
            stop: function() {
                t.$(window).off("popstate", this.checkUrl).off("hashchange", this.checkUrl), clearInterval(this._checkUrlInterval), S.started = !1
            },
            route: function(e, t) {
                this.handlers.unshift({
                    route: e,
                    callback: t
                })
            },
            checkUrl: function(e) {
                var t = this.getFragment();
                t === this.fragment && this.iframe && (t = this.getFragment(this.getHash(this.iframe)));
                if (t === this.fragment) return !1;
                this.iframe && this.navigate(t), this.loadUrl() || this.loadUrl(this.getHash())
            },
            loadUrl: function(e) {
                var t = this.fragment = this.getFragment(e),
                    r = n.any(this.handlers, function(e) {
                        if (e.route.test(t)) return e.callback(t), !0
                    });
                return r
            },
            navigate: function(e, t) {
                if (!S.started) return !1;
                if (!t || t === !0) t = {
                    trigger: t
                };
                e = this.getFragment(e || "");
                if (this.fragment === e) return;
                this.fragment = e;
                var n = this.root + e;
                if (this._hasPushState) this.history[t.replace ? "replaceState" : "pushState"]({}, document.title, n);
                else {
                    if (!this._wantsHashChange) return this.location.assign(n);
                    this._updateHash(this.location, e, t.replace), this.iframe && e !== this.getFragment(this.getHash(this.iframe)) && (t.replace || this.iframe.document.open().close(), this._updateHash(this.iframe.location, e, t.replace))
                }
                t.trigger && this.loadUrl(e)
            },
            _updateHash: function(e, t, n) {
                if (n) {
                    var r = e.href.replace(/(javascript:|#).*$/, "");
                    e.replace(r + "#" + t)
                } else e.hash = "#" + t
            }
        }), t.history = new S;
        var k = t.View = function(e) {
                this.cid = n.uniqueId("view"), this._configure(e || {}), this._ensureElement(), this.initialize.apply(this, arguments), this.delegateEvents()
            },
            L = /^(\S+)\s*(.*)$/,
            A = ["model", "collection", "el", "id", "attributes", "className", "tagName", "events"];
        n.extend(k.prototype, h, {
            tagName: "div",
            $: function(e) {
                return this.$el.find(e)
            },
            initialize: function() {},
            render: function() {
                return this
            },
            remove: function() {
                return this.$el.remove(), this.stopListening(), this
            },
            setElement: function(e, n) {
                return this.$el && this.undelegateEvents(), this.$el = e instanceof t.$ ? e : t.$(e), this.el = this.$el[0], n !== !1 && this.delegateEvents(), this
            },
            delegateEvents: function(e) {
                if (!e && !(e = n.result(this, "events"))) return;
                this.undelegateEvents();
                for (var t in e) {
                    var r = e[t];
                    n.isFunction(r) || (r = this[e[t]]);
                    if (!r) throw new Error('Method "' + e[t] + '" does not exist');
                    var i = t.match(L),
                        s = i[1],
                        o = i[2];
                    r = n.bind(r, this), s += ".delegateEvents" + this.cid, o === "" ? this.$el.on(s, r) : this.$el.on(s, o, r)
                }
            },
            undelegateEvents: function() {
                this.$el.off(".delegateEvents" + this.cid)
            },
            _configure: function(e) {
                this.options && (e = n.extend({}, n.result(this, "options"), e)), n.extend(this, n.pick(e, A)), this.options = e
            },
            _ensureElement: function() {
                if (!this.el) {
                    var e = n.extend({}, n.result(this, "attributes"));
                    this.id && (e.id = n.result(this, "id")), this.className && (e["class"] = n.result(this, "className"));
                    var r = t.$("<" + n.result(this, "tagName") + ">").attr(e);
                    this.setElement(r, !1)
                } else this.setElement(n.result(this, "el"), !1)
            }
        });
        var O = {
            create: "POST",
            update: "PUT",
            patch: "PATCH",
            "delete": "DELETE",
            read: "GET"
        };
        t.sync = function(e, r, i) {
            var s = O[e];
            n.defaults(i || (i = {}), {
                emulateHTTP: t.emulateHTTP,
                emulateJSON: t.emulateJSON
            });
            var o = {
                type: s,
                dataType: "json"
            };
            i.url || (o.url = n.result(r, "url") || _()), i.data == null && r && (e === "create" || e === "update" || e === "patch") && (o.contentType = "application/json", o.data = JSON.stringify(i.attrs || r.toJSON(i))), i.emulateJSON && (o.contentType = "application/x-www-form-urlencoded", o.data = o.data ? {
                model: o.data
            } : {});
            if (i.emulateHTTP && (s === "PUT" || s === "DELETE" || s === "PATCH")) {
                o.type = "POST", i.emulateJSON && (o.data._method = s);
                var u = i.beforeSend;
                i.beforeSend = function(e) {
                    e.setRequestHeader("X-HTTP-Method-Override", s);
                    if (u) return u.apply(this, arguments)
                }
            }
            o.type !== "GET" && !i.emulateJSON && (o.processData = !1);
            var a = i.success;
            i.success = function(e) {
                a && a(r, e, i), r.trigger("sync", r, e, i)
            };
            var f = i.error;
            i.error = function(e) {
                f && f(r, e, i), r.trigger("error", r, e, i)
            };
            var l = i.xhr = t.ajax(n.extend(o, i));
            return r.trigger("request", r, l, i), l
        }, t.ajax = function() {
            return t.$.ajax.apply(t.$, arguments)
        };
        var M = function(e, t) {
            var r = this,
                i;
            e && n.has(e, "constructor") ? i = e.constructor : i = function() {
                return r.apply(this, arguments)
            }, n.extend(i, r, t);
            var s = function() {
                this.constructor = i
            };
            return s.prototype = r.prototype, i.prototype = new s, e && n.extend(i.prototype, e), i.__super__ = r.prototype, i
        };
        p.extend = d.extend = g.extend = k.extend = S.extend = M;
        var _ = function() {
            throw new Error('A "url" property or function must be specified')
        };
        return t
    }), define("backbone", ["backbone/backbone-0.9.10"], function(e) {
        return e
    }), define("Config", [], function() {
        SITE_ADMINS = [22, 6358], SITE_DEVELOPERS = [1, 2, 3, 22, 6358, 5607, 5618], SITE_MAIN_DEVELOPER = [1], REGIONS = [{
            id: 1,
            title: "АР Крым",
            regionCenter: 1
        }, {
            id: 2,
            title: "Винницкая обл.",
            regionCenter: 981
        }, {
            id: 3,
            title: "Волынская обл.",
            regionCenter: 2488
        }, {
            id: 4,
            title: "Днепропетровская обл.",
            regionCenter: 3574
        }, {
            id: 5,
            title: "Донецкая обл.",
            regionCenter: 5059
        }, {
            id: 6,
            title: "Житомирская обл.",
            regionCenter: 6164
        }, {
            id: 7,
            title: "Закарпатская обл.",
            regionCenter: 7857
        }, {
            id: 8,
            title: "Запорожская обл.",
            regionCenter: 8462
        }, {
            id: 9,
            title: "Ивано-Франковская обл.",
            regionCenter: 9410
        }, {
            id: 10,
            title: "Киевская обл.",
            regionCenter: 10188
        }, {
            id: 11,
            title: "Кировоградская обл.",
            regionCenter: 11368
        }, {
            id: 12,
            title: "Луганская обл.",
            regionCenter: 12394
        }, {
            id: 13,
            title: "Львовская обл.",
            regionCenter: 13202
        }, {
            id: 14,
            title: "Николаевская обл.",
            regionCenter: 15123
        }, {
            id: 15,
            title: "Одесская обл.",
            regionCenter: 16044
        }, {
            id: 16,
            title: "Полтавская обл.",
            regionCenter: 17216
        }, {
            id: 17,
            title: "Ровенская обл.",
            regionCenter: 19059
        }, {
            id: 18,
            title: "Сумская обл.",
            regionCenter: 20086
        }, {
            id: 19,
            title: "Тернопольская обл.",
            regionCenter: 21567
        }, {
            id: 20,
            title: "Харьковская обл.",
            regionCenter: 22624
        }, {
            id: 21,
            title: "Херсонская обл.",
            regionCenter: 24367
        }, {
            id: 22,
            title: "Хмельницкая обл.",
            regionCenter: 25035
        }, {
            id: 23,
            title: "Черкасская обл.",
            regionCenter: 26487
        }, {
            id: 24,
            title: "Черниговская обл.",
            regionCenter: 27334
        }, {
            id: 25,
            title: "Черновицкая обл.",
            regionCenter: 28856
        }], MARKET_SEGMENTS = [{
            id: 1,
            title: "Квартиры и комнаты"
        }, {
            id: 2,
            title: "Дома и дачи"
        }, {
            id: 3,
            title: "Коммерческая недвижимость"
        }, {
            id: 4,
            title: "Земельные участки"
        }, {
            id: 5,
            title: "Гаражи и паркинги"
        }], OPERATIONS = [{
            id: 1,
            title: "Продам"
        }, {
            id: 2,
            title: "Сдам"
        }, {
            id: 3,
            title: "Сдам посуточно"
        }, {
            id: 4,
            title: "Куплю"
        }, {
            id: 5,
            title: "Сниму"
        }], "console" in window || (window.console = {}, window.console.log = function(e) {})
    }),
    function(e) {
        typeof exports == "object" ? module.exports = e(require("backbone"), require("underscore")) : typeof define == "function" && define.amd && define("Libs/Backbone/Validation/backbone-validation-0.8.1", ["backbone", "underscore"], e)
    }(function(e, t) {
        return e.Validation = function(t) {
            var n = {
                    forceUpdate: !1,
                    selector: "name",
                    labelFormatter: "sentenceCase",
                    valid: Function.prototype,
                    invalid: Function.prototype
                },
                r = {
                    formatLabel: function(e, t) {
                        return f[n.labelFormatter](e, t)
                    },
                    format: function() {
                        var e = Array.prototype.slice.call(arguments),
                            t = e.shift();
                        return t.replace(/\{(\d+)\}/g, function(t, n) {
                            return typeof e[n] != "undefined" ? e[n] : t
                        })
                    }
                },
                i = function(n, r, s) {
                    return r = r || {}, s = s || "", t.each(n, function(t, o) {
                        n.hasOwnProperty(o) && (!t || typeof t != "object" || t instanceof Array || t instanceof Date || t instanceof RegExp || t instanceof e.Model || t instanceof e.Collection ? r[s + o] = t : i(t, r, s + o + "."))
                    }), r
                },
                s = function() {
                    var e = function(e) {
                            return t.reduce(t.keys(e.validation || {}), function(e, t) {
                                return e[t] = void 0, e
                            }, {})
                        },
                        s = function(e, n) {
                            var r = e.validation ? e.validation[n] || {} : {};
                            if (t.isFunction(r) || t.isString(r)) r = {
                                fn: r
                            };
                            return t.isArray(r) || (r = [r]), t.reduce(r, function(e, n) {
                                return t.each(t.without(t.keys(n), "msg"), function(t) {
                                    e.push({
                                        fn: l[t],
                                        val: n[t],
                                        msg: n.msg
                                    })
                                }), e
                            }, [])
                        },
                        u = function(e, n, i, o) {
                            return t.reduce(s(e, n), function(s, u) {
                                var a = t.extend({}, r, l),
                                    f = u.fn.call(a, i, n, u.val, e, o);
                                return f === !1 || s === !1 ? !1 : f && !s ? u.msg || f : s
                            }, "")
                        },
                        a = function(e, n) {
                            var r, s = {},
                                o = !0,
                                a = t.clone(n),
                                f = i(n);
                            return t.each(f, function(t, n) {
                                r = u(e, n, t, a), r && (s[n] = r, o = !1)
                            }), {
                                invalidAttrs: s,
                                isValid: o
                            }
                        },
                        f = function(n, r) {
                            return {
                                preValidate: function(e, n) {
                                    return u(this, e, n, t.extend({}, this.attributes))
                                },
                                isValid: function(e) {
                                    var n = i(this.attributes);
                                    return t.isString(e) ? !u(this, e, n[e], t.extend({}, this.attributes)) : t.isArray(e) ? t.reduce(e, function(e, r) {
                                        return e && !u(this, r, n[r], t.extend({}, this.attributes))
                                    }, !0, this) : (e === !0 && this.validate(), this.validation ? this._isValid : !0)
                                },
                                validate: function(s, o) {
                                    var u = this,
                                        f = !s,
                                        l = t.extend({}, r, o),
                                        c = e(u),
                                        h = t.extend({}, c, u.attributes, s),
                                        p = i(s || h),
                                        d = a(u, h);
                                    u._isValid = d.isValid, t.each(c, function(e, t) {
                                        var r = d.invalidAttrs.hasOwnProperty(t);
                                        r || l.valid(n, t, l.selector)
                                    }), t.each(c, function(e, t) {
                                        var r = d.invalidAttrs.hasOwnProperty(t),
                                            i = p.hasOwnProperty(t);
                                        r && (i || f) && l.invalid(n, t, d.invalidAttrs[t], l.selector)
                                    }), t.defer(function() {
                                        u.trigger("validated", u._isValid, u, d.invalidAttrs), u.trigger("validated:" + (u._isValid ? "valid" : "invalid"), u, d.invalidAttrs)
                                    });
                                    if (!l.forceUpdate && t.intersection(t.keys(d.invalidAttrs), t.keys(p)).length > 0) return d.invalidAttrs
                                }
                            }
                        },
                        c = function(e, n, r) {
                            t.extend(n, f(e, r))
                        },
                        h = function(e) {
                            delete e.validate, delete e.preValidate, delete e.isValid
                        },
                        p = function(e) {
                            c(this.view, e, this.options)
                        },
                        d = function(e) {
                            h(e)
                        };
                    return {
                        version: "0.8.1",
                        configure: function(e) {
                            t.extend(n, e)
                        },
                        bind: function(e, r) {
                            var i = e.model,
                                s = e.collection;
                            r = t.extend({}, n, o, r);
                            if (typeof i == "undefined" && typeof s == "undefined") throw "Before you execute the binding your view must have a model or a collection.\nSee http://thedersen.com/projects/backbone-validation/#using-form-model-validation for more information.";
                            i ? c(e, i, r) : s && (s.each(function(t) {
                                c(e, t, r)
                            }), s.bind("add", p, {
                                view: e,
                                options: r
                            }), s.bind("remove", d))
                        },
                        unbind: function(e) {
                            var t = e.model,
                                n = e.collection;
                            t && h(e.model), n && (n.each(function(e) {
                                h(e)
                            }), n.unbind("add", p), n.unbind("remove", d))
                        },
                        mixin: f(null, n)
                    }
                }(),
                o = s.callbacks = {
                    valid: function(e, t, n) {
                        e.$("[" + n + '~="' + t + '"]').removeClass("invalid").removeAttr("data-error")
                    },
                    invalid: function(e, t, n, r) {
                        e.$("[" + r + '~="' + t + '"]').addClass("invalid").attr("data-error", n)
                    }
                },
                u = s.patterns = {
                    digits: /^\d+$/,
                    number: /^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/,
                    email: /^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i,
                    url: /^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i
                },
                a = s.messages = {
                    required: "{0} is required",
                    acceptance: "{0} must be accepted",
                    min: "{0} must be greater than or equal to {1}",
                    max: "{0} must be less than or equal to {1}",
                    range: "{0} must be between {1} and {2}",
                    length: "{0} must be {1} characters",
                    minLength: "{0} must be at least {1} characters",
                    maxLength: "{0} must be at most {1} characters",
                    rangeLength: "{0} must be between {1} and {2} characters",
                    oneOf: "{0} must be one of: {1}",
                    equalTo: "{0} must be the same as {1}",
                    pattern: "{0} must be a valid {1}"
                },
                f = s.labelFormatters = {
                    none: function(e) {
                        return e
                    },
                    sentenceCase: function(e) {
                        return e.replace(/(?:^\w|[A-Z]|\b\w)/g, function(e, t) {
                            return t === 0 ? e.toUpperCase() : " " + e.toLowerCase()
                        }).replace(/_/g, " ")
                    },
                    label: function(e, t) {
                        return t.labels && t.labels[e] || f.sentenceCase(e, t)
                    }
                },
                l = s.validators = function() {
                    var e = String.prototype.trim ? function(e) {
                            return e === null ? "" : String.prototype.trim.call(e)
                        } : function(e) {
                            var t = /^\s+/,
                                n = /\s+$/;
                            return e === null ? "" : e.toString().replace(t, "").replace(n, "")
                        },
                        n = function(e) {
                            return t.isNumber(e) || t.isString(e) && e.match(u.number)
                        },
                        r = function(n) {
                            return !(t.isNull(n) || t.isUndefined(n) || t.isString(n) && e(n) === "" || t.isArray(n) && t.isEmpty(n))
                        };
                    return {
                        fn: function(e, n, r, i, s) {
                            return t.isString(r) && (r = i[r]), r.call(i, e, n, s)
                        },
                        required: function(e, n, i, s, o) {
                            var u = t.isFunction(i) ? i.call(s, e, n, o) : i;
                            if (!u && !r(e)) return !1;
                            if (u && !r(e)) return this.format(a.required, this.formatLabel(n, s))
                        },
                        acceptance: function(e, n, r, i) {
                            if (e !== "true" && (!t.isBoolean(e) || e === !1)) return this.format(a.acceptance, this.formatLabel(n, i))
                        },
                        min: function(e, t, r, i) {
                            if (!n(e) || e < r) return this.format(a.min, this.formatLabel(t, i), r)
                        },
                        max: function(e, t, r, i) {
                            if (!n(e) || e > r) return this.format(a.max, this.formatLabel(t, i), r)
                        },
                        range: function(e, t, r, i) {
                            if (!n(e) || e < r[0] || e > r[1]) return this.format(a.range, this.formatLabel(t, i), r[0], r[1])
                        },
                        length: function(t, n, i, s) {
                            if (!r(t) || e(t).length !== i) return this.format(a.length, this.formatLabel(n, s), i)
                        },
                        minLength: function(t, n, i, s) {
                            if (!r(t) || e(t).length < i) return this.format(a.minLength, this.formatLabel(n, s), i)
                        },
                        maxLength: function(t, n, i, s) {
                            if (!r(t) || e(t).length > i) return this.format(a.maxLength, this.formatLabel(n, s), i)
                        },
                        rangeLength: function(t, n, i, s) {
                            if (!r(t) || e(t).length < i[0] || e(t).length > i[1]) return this.format(a.rangeLength, this.formatLabel(n, s), i[0], i[1])
                        },
                        oneOf: function(e, n, r, i) {
                            if (!t.include(r, e)) return this.format(a.oneOf, this.formatLabel(n, i), r.join(", "))
                        },
                        equalTo: function(e, t, n, r, i) {
                            if (e !== i[n]) return this.format(a.equalTo, this.formatLabel(t, r), this.formatLabel(n, r))
                        },
                        pattern: function(e, t, n, i) {
                            if (!r(e) || !e.toString().match(u[n] || n)) return this.format(a.pattern, this.formatLabel(t, i), n)
                        }
                    }
                }();
            return s
        }(t), e.Validation
    }), define("Libs/Backbone/Validation", ["Libs/Backbone/Validation/backbone-validation-0.8.1"], function(e) {
        return e
    }), define("ViewManager", [], function() {
        function t() {
            return _.include(_.methods(this.currentView), "GetName") ? this.currentView.GetName() : null
        }

        function n(e) {
            this.close(), this.currentView = e, $("#app").html(this.currentView.el), this.currentView.render()
        }

        function r() {
            this.currentView && (this.currentView.close(), this.currentView = null)
        }
        var e = function() {
            return {
                show: n,
                close: r,
                currentViewName: t
            }
        };
        return e
    }), define("Shared/Abstract/View", ["backbone"], function(e) {
        var t = e.View.extend({
            close: function() {
                this.closeSubviews(), this.unbindFromAll(), this.stopListening(), this.off(), this.remove(), this.onClose && this.onClose()
            },
            bindTo: function(e, t, n, r) {
                r || (r = this), e.on(t, n, r), this.bindings || (this.bindings = []), this.bindings.push({
                    object: e,
                    event: t,
                    callback: n
                })
            },
            unbindFromAll: function() {
                var e = this;
                _.each(this.bindings, function(t) {
                    t.object.off(t.event, t.callback, e)
                })
            },
            eachSubview: function(e) {
                _.each(this.subviews, e)
            },
            appendSubview: function(e, t, n) {
                t || (t = this.$el), this.subviews || (this.subviews = {}), this.subviews[e.cid] = e, n ? t.prepend(e.el) : t.append(e.el), e.onAppend && e.onAppend()
            },
            prependSubview: function(e, t) {
                this.appendSubview(e, t, !0)
            },
            closeSubviews: function() {
                this.eachSubview(function(e) {
                    e.close()
                }), this.subviews = {}
            },
            detachSubview: function(e) {
                this.subviews && delete this.subviews[e.cid], e.$el.detach()
            },
            templateContext: function() {
                return {}
            },
            layout: function(e, t) {
                this.closeSubviews(), this.$el.empty(), t || (t = this.template), t && (e || (e = this.templateContext()), this.$el.append(t(e)))
            },
            render: function() {
                return this.layout(), this.onRender && this.onRender(), this
            }
        });
        return t
    }), define("Base/Config", [], function() {
        var e = [{
                type: "splitter",
                title: "Днепропетровская область"
            }, {
                id: 3574,
                region: 4,
                title: "Днепропетровск"
            }, {
                id: 4123,
                region: 4,
                title: "Никополь",
                isAreaCenter: 68
            }, {
                id: 4192,
                region: 4,
                title: "Новомосковск",
                isAreaCenter: 69
            }, {
                type: "splitter",
                title: "Запорожская область"
            }, {
                id: 8462,
                region: 8,
                title: "Запорожье"
            }, {
                type: "splitter",
                title: "Киевская область"
            }, {
                id: 10188,
                region: 10,
                title: "Киев"
            }],
            t = {
                version: "3.12",
                templateVersion: "1.33",
                storageDataVersion: "3.22",
                title: "База",
                rootHash: "#base-/",
                rootUrl: "/base-/",
                defaults: {
                    region: 4,
                    locality: 3574,
                    type: "city",
                    marketSegment: 1,
                    operation: 1
                },
                localities: e,
                prefix: {
                    photo: "/base/"
                },
                startDate: {
                    4: 1343772e6,
                    8: 13912092e5,
                    10: 13673592e5
                },
                defaultParams: {
                    city: ["region", "type", "locality", "marketSegment", "operation"],
                    suburb: ["region", "type", "locality", "marketSegment", "operation"],
                    areaCenter: ["region", "locality", "type", "marketSegment", "operation"],
                    area: ["region", "locality", "type", "marketSegment", "operation"]
                },
                defaultFilters: ["locality", "type", "marketSegment", "operation"],
                listingsOrderById: ["estateType", "mark", "p19"],
                editField: {
                    blocked: ["info", "id"],
                    blockedMarks: [7, 8],
                    maxlength: {
                        "p1-p2": [2, 2],
                        "p3-p4": [2, 2],
                        p4: [1],
                        "p5-p6-p7": [3, 3, 2],
                        p5: [6],
                        "p5-range": [6, 6],
                        p8: [5],
                        "p8-range": [5, 5],
                        price: [8],
                        budget: [8]
                    }
                },
                empty: "–",
                emptyDiv: '<div class="base-cell-empty">–</div>',
                emptySpan: '<span class="base-cell-empty">–</span>',
                emptyNumberSpan: '<span class="base-cell-empty base-cell-empty-number">–</span>',
                emptySlash: '<span class="base-cell-gray base-cell-slash">/</span>',
                emptyDarkSlash: '<span class="base-cell-slash">/</span>',
                emptyItem: function(e) {
                    return {
                        id: "0",
                        title: "–",
                        field: e
                    }
                },
                currency: {
                    1: "$",
                    2: "грн",
                    3: "грн",
                    4: "$",
                    5: "грн"
                },
                date: function(e, t) {
                    var n = t ? new Date(t) : new Date,
                        r = t ? new Date(t) : new Date;
                    return r.setDate(r.getDate() - 1), e = new Date(e), n.toDateString() == e.toDateString() ? (e.getHours() < 10 ? "0" + e.getHours() : e.getHours()) + ":" + (e.getMinutes() < 10 ? "0" + e.getMinutes() : e.getMinutes()) : r.toDateString() == e.toDateString() ? "вчера" : (e.getDate() < 10 ? "0" + e.getDate() : e.getDate()) + "." + (e.getMonth() + 1 < 10 ? "0" + (e.getMonth() + 1) : e.getMonth() + 1) + "." + e.getFullYear().toString().substr(2, 2)
                },
                columnsExtends: {
                    1: {
                        city: {
                            1: {
                                adminDistrict: {
                                    show: !0
                                },
                                district: {
                                    title: "Микрорайон",
                                    hint: "Микрорайон"
                                }
                            },
                            2: "1",
                            3: "1",
                            4: {
                                "adminDistrict-district-multiple": {
                                    width: 350
                                }
                            },
                            5: "4"
                        },
                        suburb: {
                            1: {
                                "city-area": {
                                    width: 193
                                },
                                "district-town": {
                                    width: 193
                                }
                            },
                            2: "1",
                            3: "1",
                            4: {
                                "city-area-district-town": {
                                    width: 418
                                }
                            },
                            5: "4"
                        },
                        areaCenter: {
                            1: {
                                district: {
                                    width: 193
                                },
                                street: {
                                    width: 193
                                }
                            },
                            2: "1",
                            3: "1",
                            4: {
                                "district-multiple": {
                                    width: 350
                                }
                            },
                            5: "4"
                        },
                        area: {
                            1: {
                                town: {
                                    width: 388
                                }
                            },
                            2: "1",
                            3: "1",
                            4: {
                                "town-multiple": {
                                    width: 418
                                }
                            },
                            5: "4"
                        }
                    },
                    2: {
                        city: {
                            1: {
                                adminDistrict: {
                                    show: !0
                                },
                                district: {
                                    title: "Микрорайон",
                                    hint: "Микрорайон"
                                }
                            },
                            2: "1",
                            3: "1",
                            4: {
                                "adminDistrict-district-multiple": {
                                    width: 309
                                }
                            },
                            5: "4"
                        },
                        suburb: {
                            1: {
                                "city-area": {
                                    width: 186
                                },
                                "district-town": {
                                    width: 187
                                }
                            },
                            2: "1",
                            3: "1",
                            4: {
                                "city-area-district-town": {
                                    width: 378
                                }
                            },
                            5: "4"
                        },
                        areaCenter: {
                            1: {
                                district: {
                                    width: 186
                                },
                                street: {
                                    width: 187
                                }
                            },
                            2: "1",
                            3: "1",
                            4: {
                                "district-multiple": {
                                    width: 309
                                }
                            },
                            5: "4"
                        },
                        area: {
                            1: {
                                town: {
                                    width: 375
                                }
                            },
                            2: "1",
                            3: "1",
                            4: {
                                "town-multiple": {
                                    width: 378
                                }
                            },
                            5: "4"
                        }
                    },
                    3: {
                        city: {
                            1: {
                                adminDistrict: {
                                    show: !0
                                },
                                district: {
                                    width: 154,
                                    title: "Микрорайон",
                                    hint: "Микрорайон"
                                },
                                street: {
                                    width: 154
                                }
                            },
                            2: "1",
                            3: "1",
                            4: {
                                "adminDistrict-district-multiple": {
                                    width: 350
                                }
                            },
                            5: "4"
                        },
                        suburb: {
                            1: {
                                "city-area": {
                                    width: 233
                                },
                                "district-town": {
                                    width: 233
                                }
                            },
                            2: "1",
                            3: "1",
                            4: {
                                "city-area-district-town": {
                                    width: 408
                                }
                            },
                            5: "4"
                        },
                        areaCenter: {
                            1: {
                                district: {
                                    width: 233
                                },
                                street: {
                                    width: 233
                                }
                            },
                            2: "1",
                            3: "1",
                            4: {
                                "district-multiple": {
                                    width: 350
                                }
                            },
                            5: "4"
                        },
                        area: {
                            1: {
                                town: {
                                    width: 468
                                }
                            },
                            2: "1",
                            3: "1",
                            4: {
                                "town-multiple": {
                                    width: 408
                                }
                            },
                            5: "4"
                        }
                    },
                    4: {
                        city: {
                            1: {
                                adminDistrict: {
                                    show: !0
                                },
                                district: {
                                    title: "Микрорайон",
                                    hint: "Микрорайон"
                                }
                            },
                            2: "1",
                            3: "1",
                            4: {
                                "adminDistrict-district-multiple": {
                                    width: 350
                                }
                            },
                            5: "4"
                        },
                        suburb: {
                            1: {
                                "city-area": {
                                    width: 205
                                },
                                "district-town": {
                                    width: 204
                                }
                            },
                            2: "1",
                            3: "1",
                            4: {
                                "city-area-district-town": {
                                    width: 408
                                }
                            },
                            5: "4"
                        },
                        areaCenter: {
                            1: {
                                district: {
                                    width: 204
                                },
                                street: {
                                    width: 205
                                }
                            },
                            2: "1",
                            3: "1",
                            4: {
                                "district-multiple": {
                                    width: 350
                                }
                            },
                            5: "4"
                        },
                        area: {
                            1: {
                                town: {
                                    width: 411
                                }
                            },
                            2: "1",
                            3: "1",
                            4: {
                                "town-multiple": {
                                    width: 408
                                }
                            },
                            5: "4"
                        }
                    },
                    5: {
                        city: {
                            1: {
                                adminDistrict: {
                                    show: !0
                                },
                                district: {
                                    width: 135,
                                    title: "Микрорайон",
                                    hint: "Микрорайон"
                                },
                                street: {
                                    width: 135
                                }
                            },
                            2: "1",
                            3: "1",
                            4: {
                                "adminDistrict-district-multiple": {
                                    width: 382
                                }
                            },
                            5: "4"
                        },
                        suburb: {
                            1: {
                                "city-area": {
                                    width: 205
                                },
                                "district-town": {
                                    width: 204
                                }
                            },
                            2: "1",
                            3: "1",
                            4: {
                                "city-area-district-town": {
                                    width: 478
                                }
                            },
                            5: "4"
                        },
                        areaCenter: {
                            1: {
                                district: {
                                    width: 204
                                },
                                street: {
                                    width: 205
                                }
                            },
                            2: "1",
                            3: "1",
                            4: {
                                "district-multiple": {
                                    width: 382
                                }
                            },
                            5: "4"
                        },
                        area: {
                            1: {
                                town: {
                                    width: 411
                                }
                            },
                            2: "1",
                            3: "1",
                            4: {
                                "town-multiple": {
                                    width: 478
                                }
                            },
                            5: "4"
                        }
                    }
                },
                columns: {
                    getCurrent: function(e) {
                        var n = e.get("marketSegment"),
                            r = e.get("type"),
                            i = e.get("operation"),
                            s = e.get("locality-area"),
                            o = t.columnsExtends;
                        r === "city" && s && (r = "areaCenter"), r === "suburb" && s && (r = "area");
                        var u = _.isObject(this[n][r][i]) ? this[n][r][i] : this[n][r][this[n][r][i]],
                            a = $.extend(!0, {}, u),
                            f = window.AppData.Base.options;
                        if (f && f.get("data") && f.get("data").showAdminDistricts && !s || $("#main-container").hasClass("w1120") && !s) {
                            var l = _.isObject(o[n][r][i]) ? o[n][r][i] : o[n][r][o[n][r][i]];
                            $.extend(!0, a, l)
                        }
                        return _.each(a, function(e, t) {
                            e.show === !1 && delete a[t]
                        }), a
                    },
                    1: {
                        city: {
                            1: {
                                adminDistrict: {
                                    title: "Админрайон",
                                    width: 127,
                                    location: ["terrain.adminDistrict"],
                                    align: "left",
                                    hint: "Административный район",
                                    show: !1
                                },
                                district: {
                                    title: "Район",
                                    width: 127,
                                    location: ["terrain.district"],
                                    align: "left",
                                    hint: "Район"
                                },
                                street: {
                                    title: "Улица",
                                    width: 130,
                                    location: ["terrain.street", "terrain.house"],
                                    align: "left",
                                    hint: "Улица"
                                },
                                estateType: {
                                    title: "Тип",
                                    width: 80,
                                    location: ["main.estateType"],
                                    align: "left",
                                    hint: "Тип объекта"
                                },
                                "p1-p2": {
                                    title: "Комн",
                                    width: 43,
                                    location: ["params.p1", "params.p2"],
                                    align: "center",
                                    hint: "Комнат (раздельных)"
                                },
                                "p3-p4": {
                                    title: "Этаж",
                                    width: 60,
                                    location: ["params.p3", "params.p4"],
                                    align: "center",
                                    hint: "Этаж/Этажность"
                                },
                                "p5-p6-p7": {
                                    title: "Площадь",
                                    width: 85,
                                    location: ["params.p5", "params.p6", "params.p7"],
                                    align: "center",
                                    hint: "Площадь"
                                },
                                p20: {
                                    title: "Материал",
                                    width: 70,
                                    location: ["params.p20"],
                                    align: "left",
                                    hint: "Материал"
                                },
                                price: {
                                    title: "Цена",
                                    width: 71,
                                    location: ["params.price"],
                                    align: "right",
                                    hint: "Цена"
                                },
                                phones: {
                                    title: "Телефон",
                                    width: 78,
                                    location: ["info.contacts.phones"],
                                    align: "center",
                                    hint: "Телефон"
                                },
                                date: {
                                    title: "Дата",
                                    width: 59,
                                    location: ["main.insertDate"],
                                    align: "center",
                                    hint: "Дата"
                                },
                                mark: {
                                    title: "Метка",
                                    width: 44,
                                    location: ["info.mark"],
                                    align: "center"
                                },
                                info: {
                                    title: "Инфо",
                                    width: 43,
                                    location: ["info.notes", "comments", "info.photo"],
                                    align: "center",
                                    hint: "Инфо"
                                },
                                id: {
                                    title: "",
                                    width: 27,
                                    location: [],
                                    align: "center"
                                }
                            },
                            2: "1",
                            3: "1",
                            4: {
                                "adminDistrict-district-multiple": {
                                    title: "Админрайон / микрорайон",
                                    width: 221,
                                    location: ["terrain.adminDistrict", "terrain.district"],
                                    align: "left",
                                    hint: "Административный район / микрорайон"
                                },
                                "estateType-multiple": {
                                    title: "Тип",
                                    width: 160,
                                    location: ["main.estateType"],
                                    align: "left",
                                    hint: "Тип объекта"
                                },
                                "p1-multiple": {
                                    title: "Комнат",
                                    width: 80,
                                    location: ["params.p1"],
                                    align: "center",
                                    hint: "Комнат"
                                },
                                p10: {
                                    title: "Дополнительно",
                                    width: 140,
                                    location: ["params.p10"],
                                    align: "center",
                                    hint: "Наличие дополнительных параметров"
                                },
                                budget: {
                                    title: "Бюджет",
                                    width: 71,
                                    location: ["params.price"],
                                    align: "right",
                                    hint: "Бюджет"
                                },
                                phones: {
                                    title: "Телефон",
                                    width: 78,
                                    location: ["info.contacts.phones"],
                                    align: "center",
                                    hint: "Телефон"
                                },
                                date: {
                                    title: "Дата",
                                    width: 59,
                                    location: ["main.insertDate"],
                                    align: "center",
                                    hint: "Дата"
                                },
                                mark: {
                                    title: "Метка",
                                    width: 44,
                                    location: ["info.mark"],
                                    align: "center"
                                },
                                info: {
                                    title: "Инфо",
                                    width: 43,
                                    location: ["info.notes", "comments", "info.photo"],
                                    align: "center",
                                    hint: "Инфо"
                                },
                                id: {
                                    title: "",
                                    width: 27,
                                    location: [],
                                    align: "center"
                                }
                            },
                            5: "4"
                        },
                        suburb: {
                            1: {
                                "city-area": {
                                    title: "Город / район обл.",
                                    width: 127,
                                    location: ["terrain.city", "terrain.area"],
                                    reset: ["terrain.district", "terrain.town"],
                                    align: "left",
                                    hint: "Город / Район области"
                                },
                                "district-town": {
                                    title: "Район / нас. пункт",
                                    width: 130,
                                    location: ["terrain.district", "terrain.town"],
                                    align: "left",
                                    hint: "Район города / Нас. пункт"
                                },
                                estateType: {
                                    title: "Тип",
                                    width: 80,
                                    location: ["main.estateType"],
                                    align: "left",
                                    hint: "Тип объекта"
                                },
                                "p1-p2": {
                                    title: "Комн",
                                    width: 43,
                                    location: ["params.p1", "params.p2"],
                                    align: "center",
                                    hint: "Комнат (раздельных)"
                                },
                                "p3-p4": {
                                    title: "Этаж",
                                    width: 60,
                                    location: ["params.p3", "params.p4"],
                                    align: "center",
                                    hint: "Этаж/Этажность"
                                },
                                "p5-p6-p7": {
                                    title: "Площадь",
                                    width: 85,
                                    location: ["params.p5", "params.p6", "params.p7"],
                                    align: "center",
                                    hint: "Площадь"
                                },
                                p20: {
                                    title: "Материал",
                                    width: 70,
                                    location: ["params.p20"],
                                    align: "left",
                                    hint: "Материал"
                                },
                                price: {
                                    title: "Цена",
                                    width: 71,
                                    location: ["params.price"],
                                    align: "right",
                                    hint: "Цена"
                                },
                                phones: {
                                    title: "Телефон",
                                    width: 78,
                                    location: ["info.contacts.phones"],
                                    align: "center",
                                    hint: "Телефон"
                                },
                                date: {
                                    title: "Дата",
                                    width: 59,
                                    location: ["main.insertDate"],
                                    align: "center",
                                    hint: "Дата"
                                },
                                mark: {
                                    title: "Метка",
                                    width: 44,
                                    location: ["info.mark"],
                                    align: "center"
                                },
                                info: {
                                    title: "Инфо",
                                    width: 43,
                                    location: ["info.notes", "comments", "info.photo"],
                                    align: "center",
                                    hint: "Инфо"
                                },
                                id: {
                                    title: "",
                                    width: 27,
                                    location: [],
                                    align: "center"
                                }
                            },
                            2: "1",
                            3: "1",
                            4: {
                                "city-area-district-town": {
                                    title: "Населенный пункт / район",
                                    width: 289,
                                    location: ["terrain.city", "terrain.area", "terrain.district", "terrain.town"],
                                    align: "left",
                                    hint: "Населенный пункт / район"
                                },
                                "estateType-multiple": {
                                    title: "Тип",
                                    width: 130,
                                    location: ["main.estateType"],
                                    align: "left",
                                    hint: "Тип объекта"
                                },
                                "p1-multiple": {
                                    title: "Комнат",
                                    width: 80,
                                    location: ["params.p1"],
                                    align: "center",
                                    hint: "Комнат"
                                },
                                p10: {
                                    title: "Дополнительно",
                                    width: 102,
                                    location: ["params.p10"],
                                    align: "center",
                                    hint: "Наличие дополнительных параметров"
                                },
                                budget: {
                                    title: "Бюджет",
                                    width: 71,
                                    location: ["params.price"],
                                    align: "right",
                                    hint: "Бюджет"
                                },
                                phones: {
                                    title: "Телефон",
                                    width: 78,
                                    location: ["info.contacts.phones"],
                                    align: "center",
                                    hint: "Телефон"
                                },
                                date: {
                                    title: "Дата",
                                    width: 59,
                                    location: ["main.insertDate"],
                                    align: "center",
                                    hint: "Дата"
                                },
                                mark: {
                                    title: "Метка",
                                    width: 44,
                                    location: ["info.mark"],
                                    align: "center"
                                },
                                info: {
                                    title: "Инфо",
                                    width: 43,
                                    location: ["info.notes", "comments", "info.photo"],
                                    align: "center",
                                    hint: "Инфо"
                                },
                                id: {
                                    title: "",
                                    width: 27,
                                    location: [],
                                    align: "center"
                                }
                            },
                            5: "4"
                        },
                        areaCenter: {
                            1: {
                                district: {
                                    title: "Район",
                                    width: 127,
                                    location: ["terrain.district"],
                                    align: "left",
                                    hint: "Район"
                                },
                                street: {
                                    title: "Улица",
                                    width: 130,
                                    location: ["terrain.street", "terrain.house"],
                                    align: "left",
                                    hint: "Улица"
                                },
                                estateType: {
                                    title: "Тип",
                                    width: 80,
                                    location: ["main.estateType"],
                                    align: "left",
                                    hint: "Тип объекта"
                                },
                                "p1-p2": {
                                    title: "Комн",
                                    width: 43,
                                    location: ["params.p1", "params.p2"],
                                    align: "center",
                                    hint: "Комнат (раздельных)"
                                },
                                "p3-p4": {
                                    title: "Этаж",
                                    width: 60,
                                    location: ["params.p3", "params.p4"],
                                    align: "center",
                                    hint: "Этаж/Этажность"
                                },
                                "p5-p6-p7": {
                                    title: "Площадь",
                                    width: 85,
                                    location: ["params.p5", "params.p6", "params.p7"],
                                    align: "center",
                                    hint: "Площадь"
                                },
                                p20: {
                                    title: "Материал",
                                    width: 70,
                                    location: ["params.p20"],
                                    align: "left",
                                    hint: "Материал"
                                },
                                price: {
                                    title: "Цена",
                                    width: 71,
                                    location: ["params.price"],
                                    align: "right",
                                    hint: "Цена"
                                },
                                phones: {
                                    title: "Телефон",
                                    width: 78,
                                    location: ["info.contacts.phones"],
                                    align: "center",
                                    hint: "Телефон"
                                },
                                date: {
                                    title: "Дата",
                                    width: 59,
                                    location: ["main.insertDate"],
                                    align: "center",
                                    hint: "Дата"
                                },
                                mark: {
                                    title: "Метка",
                                    width: 44,
                                    location: ["info.mark"],
                                    align: "center"
                                },
                                info: {
                                    title: "Инфо",
                                    width: 43,
                                    location: ["info.notes", "comments", "info.photo"],
                                    align: "center",
                                    hint: "Инфо"
                                },
                                id: {
                                    title: "",
                                    width: 27,
                                    location: [],
                                    align: "center"
                                }
                            },
                            2: "1",
                            3: "1",
                            4: {
                                "district-multiple": {
                                    title: "Район",
                                    width: 221,
                                    location: ["terrain.district"],
                                    align: "left",
                                    hint: "Район"
                                },
                                "estateType-multiple": {
                                    title: "Тип",
                                    width: 160,
                                    location: ["main.estateType"],
                                    align: "left",
                                    hint: "Тип объекта"
                                },
                                "p1-multiple": {
                                    title: "Комнат",
                                    width: 80,
                                    location: ["params.p1"],
                                    align: "center",
                                    hint: "Комнат"
                                },
                                p10: {
                                    title: "Дополнительно",
                                    width: 140,
                                    location: ["params.p10"],
                                    align: "center",
                                    hint: "Наличие дополнительных параметров"
                                },
                                budget: {
                                    title: "Бюджет",
                                    width: 71,
                                    location: ["params.price"],
                                    align: "right",
                                    hint: "Бюджет"
                                },
                                phones: {
                                    title: "Телефон",
                                    width: 78,
                                    location: ["info.contacts.phones"],
                                    align: "center",
                                    hint: "Телефон"
                                },
                                date: {
                                    title: "Дата",
                                    width: 59,
                                    location: ["main.insertDate"],
                                    align: "center",
                                    hint: "Дата"
                                },
                                mark: {
                                    title: "Метка",
                                    width: 44,
                                    location: ["info.mark"],
                                    align: "center"
                                },
                                info: {
                                    title: "Инфо",
                                    width: 43,
                                    location: ["info.notes", "comments", "info.photo"],
                                    align: "center",
                                    hint: "Инфо"
                                },
                                id: {
                                    title: "",
                                    width: 27,
                                    location: [],
                                    align: "center"
                                }
                            },
                            5: "4"
                        },
                        area: {
                            1: {
                                town: {
                                    title: "Населенный пункт",
                                    width: 259,
                                    location: ["terrain.town"],
                                    align: "left",
                                    hint: "Населенный пункт"
                                },
                                estateType: {
                                    title: "Тип",
                                    width: 80,
                                    location: ["main.estateType"],
                                    align: "left",
                                    hint: "Тип объекта"
                                },
                                "p1-p2": {
                                    title: "Комн",
                                    width: 43,
                                    location: ["params.p1", "params.p2"],
                                    align: "center",
                                    hint: "Комнат (раздельных)"
                                },
                                "p3-p4": {
                                    title: "Этаж",
                                    width: 60,
                                    location: ["params.p3", "params.p4"],
                                    align: "center",
                                    hint: "Этаж/Этажность"
                                },
                                "p5-p6-p7": {
                                    title: "Площадь",
                                    width: 85,
                                    location: ["params.p5", "params.p6", "params.p7"],
                                    align: "center",
                                    hint: "Площадь"
                                },
                                p20: {
                                    title: "Материал",
                                    width: 70,
                                    location: ["params.p20"],
                                    align: "left",
                                    hint: "Материал"
                                },
                                price: {
                                    title: "Цена",
                                    width: 71,
                                    location: ["params.price"],
                                    align: "right",
                                    hint: "Цена"
                                },
                                phones: {
                                    title: "Телефон",
                                    width: 78,
                                    location: ["info.contacts.phones"],
                                    align: "center",
                                    hint: "Телефон"
                                },
                                date: {
                                    title: "Дата",
                                    width: 59,
                                    location: ["main.insertDate"],
                                    align: "center",
                                    hint: "Дата"
                                },
                                mark: {
                                    title: "Метка",
                                    width: 44,
                                    location: ["info.mark"],
                                    align: "center"
                                },
                                info: {
                                    title: "Инфо",
                                    width: 43,
                                    location: ["info.notes", "comments", "info.photo"],
                                    align: "center",
                                    hint: "Инфо"
                                },
                                id: {
                                    title: "",
                                    width: 27,
                                    location: [],
                                    align: "center"
                                }
                            },
                            2: "1",
                            3: "1",
                            4: {
                                "town-multiple": {
                                    title: "Населенный пункт",
                                    width: 289,
                                    location: ["terrain.town"],
                                    align: "left",
                                    hint: "Населенный пункт"
                                },
                                "estateType-multiple": {
                                    title: "Тип",
                                    width: 130,
                                    location: ["main.estateType"],
                                    align: "left",
                                    hint: "Тип объекта"
                                },
                                "p1-multiple": {
                                    title: "Комнат",
                                    width: 80,
                                    location: ["params.p1"],
                                    align: "center",
                                    hint: "Комнат"
                                },
                                p10: {
                                    title: "Дополнительно",
                                    width: 102,
                                    location: ["params.p10"],
                                    align: "center",
                                    hint: "Наличие дополнительных параметров"
                                },
                                budget: {
                                    title: "Бюджет",
                                    width: 71,
                                    location: ["params.price"],
                                    align: "right",
                                    hint: "Бюджет"
                                },
                                phones: {
                                    title: "Телефон",
                                    width: 78,
                                    location: ["info.contacts.phones"],
                                    align: "center",
                                    hint: "Телефон"
                                },
                                date: {
                                    title: "Дата",
                                    width: 59,
                                    location: ["main.insertDate"],
                                    align: "center",
                                    hint: "Дата"
                                },
                                mark: {
                                    title: "Метка",
                                    width: 44,
                                    location: ["info.mark"],
                                    align: "center"
                                },
                                info: {
                                    title: "Инфо",
                                    width: 43,
                                    location: ["info.notes", "comments", "info.photo"],
                                    align: "center",
                                    hint: "Инфо"
                                },
                                id: {
                                    title: "",
                                    width: 27,
                                    location: [],
                                    align: "center"
                                }
                            },
                            5: "4"
                        }
                    },
                    2: {
                        city: {
                            1: {
                                adminDistrict: {
                                    title: "Админрайон",
                                    width: 127,
                                    location: ["terrain.adminDistrict"],
                                    align: "left",
                                    hint: "Административный район",
                                    show: !1
                                },
                                district: {
                                    title: "Район",
                                    width: 127,
                                    location: ["terrain.district"],
                                    align: "left",
                                    hint: "Район"
                                },
                                street: {
                                    title: "Улица",
                                    width: 117,
                                    location: ["terrain.street", "terrain.house"],
                                    align: "left",
                                    hint: "Улица"
                                },
                                estateType: {
                                    title: "Тип",
                                    width: 80,
                                    location: ["main.estateType"],
                                    align: "left",
                                    hint: "Тип объекта"
                                },
                                "p1-p2": {
                                    title: "Комн",
                                    width: 43,
                                    location: ["params.p1", "params.p2"],
                                    align: "center",
                                    hint: "Комнат (раздельных)"
                                },
                                p4: {
                                    title: "Этажн",
                                    width: 50,
                                    location: ["params.p4"],
                                    align: "center",
                                    hint: "Этажность"
                                },
                                p5: {
                                    title: "Площадь",
                                    width: 60,
                                    location: ["params.p5"],
                                    align: "center",
                                    hint: "Площадь"
                                },
                                p8: {
                                    title: "Соток",
                                    width: 47,
                                    location: ["params.p8"],
                                    align: "center",
                                    hint: "Соток"
                                },
                                p20: {
                                    title: "Материал",
                                    width: 70,
                                    location: ["params.p20"],
                                    align: "left",
                                    hint: "Материал"
                                },
                                price: {
                                    title: "Цена",
                                    width: 70,
                                    location: ["params.price"],
                                    align: "right",
                                    hint: "Цена"
                                },
                                phones: {
                                    title: "Телефон",
                                    width: 78,
                                    location: ["info.contacts.phones"],
                                    align: "center",
                                    hint: "Телефон"
                                },
                                date: {
                                    title: "Дата",
                                    width: 59,
                                    location: ["main.insertDate"],
                                    align: "center",
                                    hint: "Дата"
                                },
                                mark: {
                                    title: "Метка",
                                    width: 44,
                                    location: ["info.mark"],
                                    align: "center"
                                },
                                info: {
                                    title: "Инфо",
                                    width: 43,
                                    location: ["info.notes", "comments", "info.photo"],
                                    align: "center",
                                    hint: "Инфо"
                                },
                                id: {
                                    title: "",
                                    width: 27,
                                    location: [],
                                    align: "center"
                                }
                            },
                            2: "1",
                            3: "1",
                            4: {
                                "adminDistrict-district-multiple": {
                                    title: "Админрайон / микрорайон",
                                    width: 180,
                                    location: ["terrain.adminDistrict", "terrain.district"],
                                    align: "left",
                                    hint: "Административный район / микрорайон"
                                },
                                "estateType-multiple": {
                                    title: "Тип",
                                    width: 139,
                                    location: ["main.estateType"],
                                    align: "left",
                                    hint: "Тип объекта"
                                },
                                "p1-multiple": {
                                    title: "Комнат",
                                    width: 80,
                                    location: ["params.p1"],
                                    align: "center",
                                    hint: "Комнат"
                                },
                                "p5-range": {
                                    title: "Площадь",
                                    width: 100,
                                    location: ["params.p5"],
                                    align: "center",
                                    hint: "Площадь"
                                },
                                p10: {
                                    title: "Дополнительно",
                                    width: 100,
                                    location: ["params.p10"],
                                    align: "center",
                                    hint: "Наличие дополнительных параметров"
                                },
                                budget: {
                                    title: "Бюджет",
                                    width: 71,
                                    location: ["params.price"],
                                    align: "right",
                                    hint: "Бюджет"
                                },
                                phones: {
                                    title: "Телефон",
                                    width: 78,
                                    location: ["info.contacts.phones"],
                                    align: "center",
                                    hint: "Телефон"
                                },
                                date: {
                                    title: "Дата",
                                    width: 59,
                                    location: ["main.insertDate"],
                                    align: "center",
                                    hint: "Дата"
                                },
                                mark: {
                                    title: "Метка",
                                    width: 44,
                                    location: ["info.mark"],
                                    align: "center"
                                },
                                info: {
                                    title: "Инфо",
                                    width: 43,
                                    location: ["info.notes", "comments", "info.photo"],
                                    align: "center",
                                    hint: "Инфо"
                                },
                                id: {
                                    title: "",
                                    width: 27,
                                    location: [],
                                    align: "center"
                                }
                            },
                            5: "4"
                        },
                        suburb: {
                            1: {
                                "city-area": {
                                    title: "Город / район обл.",
                                    width: 127,
                                    location: ["terrain.city", "terrain.area"],
                                    reset: ["terrain.district", "terrain.town"],
                                    align: "left",
                                    hint: "Город / Район области"
                                },
                                "district-town": {
                                    title: "Район / нас. пункт",
                                    width: 117,
                                    location: ["terrain.district", "terrain.town"],
                                    align: "left",
                                    hint: "Район города / Нас. пункт"
                                },
                                estateType: {
                                    title: "Тип",
                                    width: 80,
                                    location: ["main.estateType"],
                                    align: "left",
                                    hint: "Тип объекта"
                                },
                                "p1-p2": {
                                    title: "Комн",
                                    width: 43,
                                    location: ["params.p1", "params.p2"],
                                    align: "center",
                                    hint: "Комнат (раздельных)"
                                },
                                p4: {
                                    title: "Этажн",
                                    width: 50,
                                    location: ["params.p4"],
                                    align: "center",
                                    hint: "Этажность"
                                },
                                p5: {
                                    title: "Площадь",
                                    width: 60,
                                    location: ["params.p5"],
                                    align: "center",
                                    hint: "Площадь"
                                },
                                p8: {
                                    title: "Соток",
                                    width: 47,
                                    location: ["params.p8"],
                                    align: "center",
                                    hint: "Соток"
                                },
                                p20: {
                                    title: "Материал",
                                    width: 70,
                                    location: ["params.p20"],
                                    align: "left",
                                    hint: "Материал"
                                },
                                price: {
                                    title: "Цена",
                                    width: 70,
                                    location: ["params.price"],
                                    align: "right",
                                    hint: "Цена"
                                },
                                phones: {
                                    title: "Телефон",
                                    width: 78,
                                    location: ["info.contacts.phones"],
                                    align: "center",
                                    hint: "Телефон"
                                },
                                date: {
                                    title: "Дата",
                                    width: 59,
                                    location: ["main.insertDate"],
                                    align: "center",
                                    hint: "Дата"
                                },
                                mark: {
                                    title: "Метка",
                                    width: 44,
                                    location: ["info.mark"],
                                    align: "center"
                                },
                                info: {
                                    title: "Инфо",
                                    width: 43,
                                    location: ["info.notes", "comments", "info.photo"],
                                    align: "center",
                                    hint: "Инфо"
                                },
                                id: {
                                    title: "",
                                    width: 27,
                                    location: [],
                                    align: "center"
                                }
                            },
                            2: "1",
                            3: "1",
                            4: {
                                "city-area-district-town": {
                                    title: "Населенный пункт / район",
                                    width: 249,
                                    location: ["terrain.city", "terrain.area", "terrain.district", "terrain.town"],
                                    align: "left",
                                    hint: "Населенный пункт / район"
                                },
                                "estateType-multiple": {
                                    title: "Тип",
                                    width: 90,
                                    location: ["main.estateType"],
                                    align: "left",
                                    hint: "Тип объекта"
                                },
                                "p1-multiple": {
                                    title: "Комнат",
                                    width: 80,
                                    location: ["params.p1"],
                                    align: "center",
                                    hint: "Комнат"
                                },
                                "p5-range": {
                                    title: "Площадь",
                                    width: 90,
                                    location: ["params.p5"],
                                    align: "center",
                                    hint: "Площадь"
                                },
                                p10: {
                                    title: "Дополнительно",
                                    width: 90,
                                    location: ["params.p10"],
                                    align: "center",
                                    hint: "Наличие дополнительных параметров"
                                },
                                budget: {
                                    title: "Бюджет",
                                    width: 71,
                                    location: ["params.price"],
                                    align: "right",
                                    hint: "Бюджет"
                                },
                                phones: {
                                    title: "Телефон",
                                    width: 78,
                                    location: ["info.contacts.phones"],
                                    align: "center",
                                    hint: "Телефон"
                                },
                                date: {
                                    title: "Дата",
                                    width: 59,
                                    location: ["main.insertDate"],
                                    align: "center",
                                    hint: "Дата"
                                },
                                mark: {
                                    title: "Метка",
                                    width: 44,
                                    location: ["info.mark"],
                                    align: "center"
                                },
                                info: {
                                    title: "Инфо",
                                    width: 43,
                                    location: ["info.notes", "comments", "info.photo"],
                                    align: "center",
                                    hint: "Инфо"
                                },
                                id: {
                                    title: "",
                                    width: 27,
                                    location: [],
                                    align: "center"
                                }
                            },
                            5: "4"
                        },
                        areaCenter: {
                            1: {
                                district: {
                                    title: "Район",
                                    width: 127,
                                    location: ["terrain.district"],
                                    align: "left",
                                    hint: "Район"
                                },
                                street: {
                                    title: "Улица",
                                    width: 117,
                                    location: ["terrain.street", "terrain.house"],
                                    align: "left",
                                    hint: "Улица"
                                },
                                estateType: {
                                    title: "Тип",
                                    width: 80,
                                    location: ["main.estateType"],
                                    align: "left",
                                    hint: "Тип объекта"
                                },
                                "p1-p2": {
                                    title: "Комн",
                                    width: 43,
                                    location: ["params.p1", "params.p2"],
                                    align: "center",
                                    hint: "Комнат (раздельных)"
                                },
                                p4: {
                                    title: "Этажн",
                                    width: 50,
                                    location: ["params.p4"],
                                    align: "center",
                                    hint: "Этажность"
                                },
                                p5: {
                                    title: "Площадь",
                                    width: 60,
                                    location: ["params.p5"],
                                    align: "center",
                                    hint: "Площадь"
                                },
                                p8: {
                                    title: "Соток",
                                    width: 47,
                                    location: ["params.p8"],
                                    align: "center",
                                    hint: "Соток"
                                },
                                p20: {
                                    title: "Материал",
                                    width: 70,
                                    location: ["params.p20"],
                                    align: "left",
                                    hint: "Материал"
                                },
                                price: {
                                    title: "Цена",
                                    width: 70,
                                    location: ["params.price"],
                                    align: "right",
                                    hint: "Цена"
                                },
                                phones: {
                                    title: "Телефон",
                                    width: 78,
                                    location: ["info.contacts.phones"],
                                    align: "center",
                                    hint: "Телефон"
                                },
                                date: {
                                    title: "Дата",
                                    width: 59,
                                    location: ["main.insertDate"],
                                    align: "center",
                                    hint: "Дата"
                                },
                                mark: {
                                    title: "Метка",
                                    width: 44,
                                    location: ["info.mark"],
                                    align: "center"
                                },
                                info: {
                                    title: "Инфо",
                                    width: 43,
                                    location: ["info.notes", "comments", "info.photo"],
                                    align: "center",
                                    hint: "Инфо"
                                },
                                id: {
                                    title: "",
                                    width: 27,
                                    location: [],
                                    align: "center"
                                }
                            },
                            2: "1",
                            3: "1",
                            4: {
                                "district-multiple": {
                                    title: "Район",
                                    width: 180,
                                    location: ["terrain.district"],
                                    align: "left",
                                    hint: "Район"
                                },
                                "estateType-multiple": {
                                    title: "Тип",
                                    width: 139,
                                    location: ["main.estateType"],
                                    align: "left",
                                    hint: "Тип объекта"
                                },
                                "p1-multiple": {
                                    title: "Комнат",
                                    width: 80,
                                    location: ["params.p1"],
                                    align: "center",
                                    hint: "Комнат"
                                },
                                "p5-range": {
                                    title: "Площадь",
                                    width: 100,
                                    location: ["params.p5"],
                                    align: "center",
                                    hint: "Площадь"
                                },
                                p10: {
                                    title: "Дополнительно",
                                    width: 100,
                                    location: ["params.p10"],
                                    align: "center",
                                    hint: "Наличие дополнительных параметров"
                                },
                                budget: {
                                    title: "Бюджет",
                                    width: 71,
                                    location: ["params.price"],
                                    align: "right",
                                    hint: "Бюджет"
                                },
                                phones: {
                                    title: "Телефон",
                                    width: 78,
                                    location: ["info.contacts.phones"],
                                    align: "center",
                                    hint: "Телефон"
                                },
                                date: {
                                    title: "Дата",
                                    width: 59,
                                    location: ["main.insertDate"],
                                    align: "center",
                                    hint: "Дата"
                                },
                                mark: {
                                    title: "Метка",
                                    width: 44,
                                    location: ["info.mark"],
                                    align: "center"
                                },
                                info: {
                                    title: "Инфо",
                                    width: 43,
                                    location: ["info.notes", "comments", "info.photo"],
                                    align: "center",
                                    hint: "Инфо"
                                },
                                id: {
                                    title: "",
                                    width: 27,
                                    location: [],
                                    align: "center"
                                }
                            },
                            5: "4"
                        },
                        area: {
                            1: {
                                town: {
                                    title: "Населенный пункт",
                                    width: 246,
                                    location: ["terrain.town"],
                                    align: "left",
                                    hint: "Населенный пункт"
                                },
                                estateType: {
                                    title: "Тип",
                                    width: 80,
                                    location: ["main.estateType"],
                                    align: "left",
                                    hint: "Тип объекта"
                                },
                                "p1-p2": {
                                    title: "Комн",
                                    width: 43,
                                    location: ["params.p1", "params.p2"],
                                    align: "center",
                                    hint: "Комнат (раздельных)"
                                },
                                p4: {
                                    title: "Этажн",
                                    width: 50,
                                    location: ["params.p4"],
                                    align: "center",
                                    hint: "Этажность"
                                },
                                p5: {
                                    title: "Площадь",
                                    width: 60,
                                    location: ["params.p5"],
                                    align: "center",
                                    hint: "Площадь"
                                },
                                p8: {
                                    title: "Соток",
                                    width: 47,
                                    location: ["params.p8"],
                                    align: "center",
                                    hint: "Соток"
                                },
                                p20: {
                                    title: "Материал",
                                    width: 70,
                                    location: ["params.p20"],
                                    align: "left",
                                    hint: "Материал"
                                },
                                price: {
                                    title: "Цена",
                                    width: 70,
                                    location: ["params.price"],
                                    align: "right",
                                    hint: "Цена"
                                },
                                phones: {
                                    title: "Телефон",
                                    width: 78,
                                    location: ["info.contacts.phones"],
                                    align: "center",
                                    hint: "Телефон"
                                },
                                date: {
                                    title: "Дата",
                                    width: 59,
                                    location: ["main.insertDate"],
                                    align: "center",
                                    hint: "Дата"
                                },
                                mark: {
                                    title: "Метка",
                                    width: 44,
                                    location: ["info.mark"],
                                    align: "center"
                                },
                                info: {
                                    title: "Инфо",
                                    width: 43,
                                    location: ["info.notes", "comments", "info.photo"],
                                    align: "center",
                                    hint: "Инфо"
                                },
                                id: {
                                    title: "",
                                    width: 27,
                                    location: [],
                                    align: "center"
                                }
                            },
                            2: "1",
                            3: "1",
                            4: {
                                "town-multiple": {
                                    title: "Населенный пункт",
                                    width: 249,
                                    location: ["terrain.town"],
                                    align: "left",
                                    hint: "Населенный пункт"
                                },
                                "estateType-multiple": {
                                    title: "Тип",
                                    width: 90,
                                    location: ["main.estateType"],
                                    align: "left",
                                    hint: "Тип объекта"
                                },
                                "p1-multiple": {
                                    title: "Комнат",
                                    width: 80,
                                    location: ["params.p1"],
                                    align: "center",
                                    hint: "Комнат"
                                },
                                "p5-range": {
                                    title: "Площадь",
                                    width: 90,
                                    location: ["params.p5"],
                                    align: "center",
                                    hint: "Площадь"
                                },
                                p10: {
                                    title: "Дополнительно",
                                    width: 90,
                                    location: ["params.p10"],
                                    align: "center",
                                    hint: "Наличие дополнительных параметров"
                                },
                                budget: {
                                    title: "Бюджет",
                                    width: 71,
                                    location: ["params.price"],
                                    align: "right",
                                    hint: "Бюджет"
                                },
                                phones: {
                                    title: "Телефон",
                                    width: 78,
                                    location: ["info.contacts.phones"],
                                    align: "center",
                                    hint: "Телефон"
                                },
                                date: {
                                    title: "Дата",
                                    width: 59,
                                    location: ["main.insertDate"],
                                    align: "center",
                                    hint: "Дата"
                                },
                                mark: {
                                    title: "Метка",
                                    width: 44,
                                    location: ["info.mark"],
                                    align: "center"
                                },
                                info: {
                                    title: "Инфо",
                                    width: 43,
                                    location: ["info.notes", "comments", "info.photo"],
                                    align: "center",
                                    hint: "Инфо"
                                },
                                id: {
                                    title: "",
                                    width: 27,
                                    location: [],
                                    align: "center"
                                }
                            },
                            5: "4"
                        }
                    },
                    3: {
                        city: {
                            1: {
                                adminDistrict: {
                                    title: "Админрайон",
                                    width: 156,
                                    location: ["terrain.adminDistrict"],
                                    align: "left",
                                    hint: "Административный район",
                                    show: !1
                                },
                                district: {
                                    title: "Район",
                                    width: 167,
                                    location: ["terrain.district"],
                                    align: "left",
                                    hint: "Район"
                                },
                                street: {
                                    title: "Улица",
                                    width: 170,
                                    location: ["terrain.street", "terrain.house"],
                                    align: "left",
                                    hint: "Улица"
                                },
                                estateType: {
                                    title: "Тип",
                                    width: 155,
                                    location: ["main.estateType"],
                                    align: "left",
                                    hint: "Тип объекта"
                                },
                                p5: {
                                    title: "Площадь",
                                    width: 80,
                                    location: ["params.p5"],
                                    align: "center",
                                    hint: "Площадь"
                                },
                                price: {
                                    title: "Цена",
                                    width: 100,
                                    location: ["params.price"],
                                    align: "right",
                                    hint: "Цена"
                                },
                                phones: {
                                    title: "Телефон",
                                    width: 78,
                                    location: ["info.contacts.phones"],
                                    align: "center",
                                    hint: "Телефон"
                                },
                                date: {
                                    title: "Дата",
                                    width: 59,
                                    location: ["main.insertDate"],
                                    align: "center",
                                    hint: "Дата"
                                },
                                mark: {
                                    title: "Метка",
                                    width: 44,
                                    location: ["info.mark"],
                                    align: "center"
                                },
                                info: {
                                    title: "Инфо",
                                    width: 43,
                                    location: ["info.notes", "comments", "info.photo"],
                                    align: "center",
                                    hint: "Инфо"
                                },
                                id: {
                                    title: "",
                                    width: 27,
                                    location: [],
                                    align: "center"
                                }
                            },
                            2: "1",
                            3: "1",
                            4: {
                                "adminDistrict-district-multiple": {
                                    title: "Админрайон / микрорайон",
                                    width: 221,
                                    location: ["terrain.adminDistrict", "terrain.district"],
                                    align: "left",
                                    hint: "Административный район / микрорайон"
                                },
                                "estateType-multiple": {
                                    title: "Тип",
                                    width: 160,
                                    location: ["main.estateType"],
                                    align: "left",
                                    hint: "Тип объекта"
                                },
                                "p5-range": {
                                    title: "Площадь",
                                    width: 100,
                                    location: ["params.p5"],
                                    align: "center",
                                    hint: "Площадь"
                                },
                                p10: {
                                    title: "Дополнительно",
                                    width: 120,
                                    location: ["params.p10"],
                                    align: "center",
                                    hint: "Наличие дополнительных параметров"
                                },
                                budget: {
                                    title: "Бюджет",
                                    width: 71,
                                    location: ["params.price"],
                                    align: "right",
                                    hint: "Бюджет"
                                },
                                phones: {
                                    title: "Телефон",
                                    width: 78,
                                    location: ["info.contacts.phones"],
                                    align: "center",
                                    hint: "Телефон"
                                },
                                date: {
                                    title: "Дата",
                                    width: 59,
                                    location: ["main.insertDate"],
                                    align: "center",
                                    hint: "Дата"
                                },
                                mark: {
                                    title: "Метка",
                                    width: 44,
                                    location: ["info.mark"],
                                    align: "center"
                                },
                                info: {
                                    title: "Инфо",
                                    width: 43,
                                    location: ["info.notes", "comments", "info.photo"],
                                    align: "center",
                                    hint: "Инфо"
                                },
                                id: {
                                    title: "",
                                    width: 27,
                                    location: [],
                                    align: "center"
                                }
                            },
                            5: "4"
                        },
                        suburb: {
                            1: {
                                "city-area": {
                                    title: "Город / район обл.",
                                    width: 167,
                                    location: ["terrain.city", "terrain.area"],
                                    reset: ["terrain.district", "terrain.town"],
                                    align: "left",
                                    hint: "Город / Район области"
                                },
                                "district-town": {
                                    title: "Район / нас. пункт",
                                    width: 170,
                                    location: ["terrain.district", "terrain.town"],
                                    align: "left",
                                    hint: "Район города / Нас. пункт"
                                },
                                estateType: {
                                    title: "Тип",
                                    width: 155,
                                    location: ["main.estateType"],
                                    align: "left",
                                    hint: "Тип объекта"
                                },
                                p5: {
                                    title: "Площадь",
                                    width: 80,
                                    location: ["params.p5"],
                                    align: "center",
                                    hint: "Площадь"
                                },
                                price: {
                                    title: "Цена",
                                    width: 100,
                                    location: ["params.price"],
                                    align: "right",
                                    hint: "Цена"
                                },
                                phones: {
                                    title: "Телефон",
                                    width: 78,
                                    location: ["info.contacts.phones"],
                                    align: "center",
                                    hint: "Телефон"
                                },
                                date: {
                                    title: "Дата",
                                    width: 59,
                                    location: ["main.insertDate"],
                                    align: "center",
                                    hint: "Дата"
                                },
                                mark: {
                                    title: "Метка",
                                    width: 44,
                                    location: ["info.mark"],
                                    align: "center"
                                },
                                info: {
                                    title: "Инфо",
                                    width: 43,
                                    location: ["info.notes", "comments", "info.photo"],
                                    align: "center",
                                    hint: "Инфо"
                                },
                                id: {
                                    title: "",
                                    width: 27,
                                    location: [],
                                    align: "center"
                                }
                            },
                            2: "1",
                            3: "1",
                            4: {
                                "city-area-district-town": {
                                    title: "Населенный пункт / район",
                                    width: 279,
                                    location: ["terrain.city", "terrain.area", "terrain.district", "terrain.town"],
                                    align: "left",
                                    hint: "Населенный пункт / район"
                                },
                                "estateType-multiple": {
                                    title: "Тип",
                                    width: 130,
                                    location: ["main.estateType"],
                                    align: "left",
                                    hint: "Тип объекта"
                                },
                                "p5-range": {
                                    title: "Площадь",
                                    width: 90,
                                    location: ["params.p5"],
                                    align: "center",
                                    hint: "Площадь"
                                },
                                p10: {
                                    title: "Дополнительно",
                                    width: 102,
                                    location: ["params.p10"],
                                    align: "center",
                                    hint: "Наличие дополнительных параметров"
                                },
                                budget: {
                                    title: "Бюджет",
                                    width: 71,
                                    location: ["params.price"],
                                    align: "right",
                                    hint: "Бюджет"
                                },
                                phones: {
                                    title: "Телефон",
                                    width: 78,
                                    location: ["info.contacts.phones"],
                                    align: "center",
                                    hint: "Телефон"
                                },
                                date: {
                                    title: "Дата",
                                    width: 59,
                                    location: ["main.insertDate"],
                                    align: "center",
                                    hint: "Дата"
                                },
                                mark: {
                                    title: "Метка",
                                    width: 44,
                                    location: ["info.mark"],
                                    align: "center"
                                },
                                info: {
                                    title: "Инфо",
                                    width: 43,
                                    location: ["info.notes", "comments", "info.photo"],
                                    align: "center",
                                    hint: "Инфо"
                                },
                                id: {
                                    title: "",
                                    width: 27,
                                    location: [],
                                    align: "center"
                                }
                            },
                            5: "4"
                        },
                        areaCenter: {
                            1: {
                                district: {
                                    title: "Район",
                                    width: 167,
                                    location: ["terrain.district"],
                                    align: "left",
                                    hint: "Район"
                                },
                                street: {
                                    title: "Улица",
                                    width: 170,
                                    location: ["terrain.street", "terrain.house"],
                                    align: "left",
                                    hint: "Улица"
                                },
                                estateType: {
                                    title: "Тип",
                                    width: 155,
                                    location: ["main.estateType"],
                                    align: "left",
                                    hint: "Тип объекта"
                                },
                                p5: {
                                    title: "Площадь",
                                    width: 80,
                                    location: ["params.p5"],
                                    align: "center",
                                    hint: "Площадь"
                                },
                                price: {
                                    title: "Цена",
                                    width: 100,
                                    location: ["params.price"],
                                    align: "right",
                                    hint: "Цена"
                                },
                                phones: {
                                    title: "Телефон",
                                    width: 78,
                                    location: ["info.contacts.phones"],
                                    align: "center",
                                    hint: "Телефон"
                                },
                                date: {
                                    title: "Дата",
                                    width: 59,
                                    location: ["main.insertDate"],
                                    align: "center",
                                    hint: "Дата"
                                },
                                mark: {
                                    title: "Метка",
                                    width: 44,
                                    location: ["info.mark"],
                                    align: "center"
                                },
                                info: {
                                    title: "Инфо",
                                    width: 43,
                                    location: ["info.notes", "comments", "info.photo"],
                                    align: "center",
                                    hint: "Инфо"
                                },
                                id: {
                                    title: "",
                                    width: 27,
                                    location: [],
                                    align: "center"
                                }
                            },
                            2: "1",
                            3: "1",
                            4: {
                                "district-multiple": {
                                    title: "Район",
                                    width: 221,
                                    location: ["terrain.district"],
                                    align: "left",
                                    hint: "Район"
                                },
                                "estateType-multiple": {
                                    title: "Тип",
                                    width: 160,
                                    location: ["main.estateType"],
                                    align: "left",
                                    hint: "Тип объекта"
                                },
                                "p5-range": {
                                    title: "Площадь",
                                    width: 100,
                                    location: ["params.p5"],
                                    align: "center",
                                    hint: "Площадь"
                                },
                                p10: {
                                    title: "Дополнительно",
                                    width: 120,
                                    location: ["params.p10"],
                                    align: "center",
                                    hint: "Наличие дополнительных параметров"
                                },
                                budget: {
                                    title: "Бюджет",
                                    width: 71,
                                    location: ["params.price"],
                                    align: "right",
                                    hint: "Бюджет"
                                },
                                phones: {
                                    title: "Телефон",
                                    width: 78,
                                    location: ["info.contacts.phones"],
                                    align: "center",
                                    hint: "Телефон"
                                },
                                date: {
                                    title: "Дата",
                                    width: 59,
                                    location: ["main.insertDate"],
                                    align: "center",
                                    hint: "Дата"
                                },
                                mark: {
                                    title: "Метка",
                                    width: 44,
                                    location: ["info.mark"],
                                    align: "center"
                                },
                                info: {
                                    title: "Инфо",
                                    width: 43,
                                    location: ["info.notes", "comments", "info.photo"],
                                    align: "center",
                                    hint: "Инфо"
                                },
                                id: {
                                    title: "",
                                    width: 27,
                                    location: [],
                                    align: "center"
                                }
                            },
                            5: "4"
                        },
                        area: {
                            1: {
                                town: {
                                    title: "Населенный пункт",
                                    width: 339,
                                    location: ["terrain.town"],
                                    align: "left",
                                    hint: "Населенный пункт"
                                },
                                estateType: {
                                    title: "Тип",
                                    width: 155,
                                    location: ["main.estateType"],
                                    align: "left",
                                    hint: "Тип объекта"
                                },
                                p5: {
                                    title: "Площадь",
                                    width: 80,
                                    location: ["params.p5"],
                                    align: "center",
                                    hint: "Площадь"
                                },
                                price: {
                                    title: "Цена",
                                    width: 100,
                                    location: ["params.price"],
                                    align: "right",
                                    hint: "Цена"
                                },
                                phones: {
                                    title: "Телефон",
                                    width: 78,
                                    location: ["info.contacts.phones"],
                                    align: "center",
                                    hint: "Телефон"
                                },
                                date: {
                                    title: "Дата",
                                    width: 59,
                                    location: ["main.insertDate"],
                                    align: "center",
                                    hint: "Дата"
                                },
                                mark: {
                                    title: "Метка",
                                    width: 44,
                                    location: ["info.mark"],
                                    align: "center"
                                },
                                info: {
                                    title: "Инфо",
                                    width: 43,
                                    location: ["info.notes", "comments", "info.photo"],
                                    align: "center",
                                    hint: "Инфо"
                                },
                                id: {
                                    title: "",
                                    width: 27,
                                    location: [],
                                    align: "center"
                                }
                            },
                            2: "1",
                            3: "1",
                            4: {
                                "town-multiple": {
                                    title: "Населенный пункт",
                                    width: 279,
                                    location: ["terrain.town"],
                                    align: "left",
                                    hint: "Населенный пункт"
                                },
                                "estateType-multiple": {
                                    title: "Тип",
                                    width: 130,
                                    location: ["main.estateType"],
                                    align: "left",
                                    hint: "Тип объекта"
                                },
                                "p5-range": {
                                    title: "Площадь",
                                    width: 90,
                                    location: ["params.p5"],
                                    align: "center",
                                    hint: "Площадь"
                                },
                                p10: {
                                    title: "Дополнительно",
                                    width: 102,
                                    location: ["params.p10"],
                                    align: "center",
                                    hint: "Наличие дополнительных параметров"
                                },
                                budget: {
                                    title: "Бюджет",
                                    width: 71,
                                    location: ["params.price"],
                                    align: "right",
                                    hint: "Бюджет"
                                },
                                phones: {
                                    title: "Телефон",
                                    width: 78,
                                    location: ["info.contacts.phones"],
                                    align: "center",
                                    hint: "Телефон"
                                },
                                date: {
                                    title: "Дата",
                                    width: 59,
                                    location: ["main.insertDate"],
                                    align: "center",
                                    hint: "Дата"
                                },
                                mark: {
                                    title: "Метка",
                                    width: 44,
                                    location: ["info.mark"],
                                    align: "center"
                                },
                                info: {
                                    title: "Инфо",
                                    width: 43,
                                    location: ["info.notes", "comments", "info.photo"],
                                    align: "center",
                                    hint: "Инфо"
                                },
                                id: {
                                    title: "",
                                    width: 27,
                                    location: [],
                                    align: "center"
                                }
                            },
                            5: "4"
                        }
                    },
                    4: {
                        city: {
                            1: {
                                adminDistrict: {
                                    title: "Админрайон",
                                    width: 127,
                                    location: ["terrain.adminDistrict"],
                                    align: "left",
                                    hint: "Административный район",
                                    show: !1
                                },
                                district: {
                                    title: "Район",
                                    width: 140,
                                    location: ["terrain.district"],
                                    align: "left",
                                    hint: "Район"
                                },
                                street: {
                                    title: "Улица",
                                    width: 140,
                                    location: ["terrain.street", "terrain.house"],
                                    align: "left",
                                    hint: "Улица"
                                },
                                estateType: {
                                    title: "Тип",
                                    width: 130,
                                    location: ["main.estateType"],
                                    align: "left",
                                    hint: "Тип объекта"
                                },
                                p8: {
                                    title: "Соток",
                                    width: 80,
                                    location: ["params.p8"],
                                    align: "center",
                                    hint: "Соток"
                                },
                                p10: {
                                    title: "Дополнительно",
                                    width: 100,
                                    location: ["params.p10"],
                                    align: "center",
                                    hint: "Наличие дополнительных параметров"
                                },
                                price: {
                                    title: "Цена",
                                    width: 80,
                                    location: ["params.price"],
                                    align: "right",
                                    hint: "Цена"
                                },
                                phones: {
                                    title: "Телефон",
                                    width: 78,
                                    location: ["info.contacts.phones"],
                                    align: "center",
                                    hint: "Телефон"
                                },
                                date: {
                                    title: "Дата",
                                    width: 59,
                                    location: ["main.insertDate"],
                                    align: "center",
                                    hint: "Дата"
                                },
                                mark: {
                                    title: "Метка",
                                    width: 44,
                                    location: ["info.mark"],
                                    align: "center"
                                },
                                info: {
                                    title: "Инфо",
                                    width: 43,
                                    location: ["info.notes", "comments", "info.photo"],
                                    align: "center",
                                    hint: "Инфо"
                                },
                                id: {
                                    title: "",
                                    width: 27,
                                    location: [],
                                    align: "center"
                                }
                            },
                            2: "1",
                            3: "1",
                            4: {
                                "adminDistrict-district-multiple": {
                                    title: "Админрайон / микрорайон",
                                    width: 221,
                                    location: ["terrain.adminDistrict", "terrain.district"],
                                    align: "left",
                                    hint: "Административный район / микрорайон"
                                },
                                "estateType-multiple": {
                                    title: "Тип",
                                    width: 160,
                                    location: ["main.estateType"],
                                    align: "left",
                                    hint: "Тип объекта"
                                },
                                "p8-range": {
                                    title: "Соток",
                                    width: 100,
                                    location: ["params.p8"],
                                    align: "center",
                                    hint: "Соток"
                                },
                                p10: {
                                    title: "Дополнительно",
                                    width: 120,
                                    location: ["params.p10"],
                                    align: "center",
                                    hint: "Наличие дополнительных параметров"
                                },
                                budget: {
                                    title: "Бюджет",
                                    width: 71,
                                    location: ["params.price"],
                                    align: "right",
                                    hint: "Бюджет"
                                },
                                phones: {
                                    title: "Телефон",
                                    width: 78,
                                    location: ["info.contacts.phones"],
                                    align: "center",
                                    hint: "Телефон"
                                },
                                date: {
                                    title: "Дата",
                                    width: 59,
                                    location: ["main.insertDate"],
                                    align: "center",
                                    hint: "Дата"
                                },
                                mark: {
                                    title: "Метка",
                                    width: 44,
                                    location: ["info.mark"],
                                    align: "center"
                                },
                                info: {
                                    title: "Инфо",
                                    width: 43,
                                    location: ["info.notes", "comments", "info.photo"],
                                    align: "center",
                                    hint: "Инфо"
                                },
                                id: {
                                    title: "",
                                    width: 27,
                                    location: [],
                                    align: "center"
                                }
                            },
                            5: "4"
                        },
                        suburb: {
                            1: {
                                "city-area": {
                                    title: "Город / район обл.",
                                    width: 140,
                                    location: ["terrain.city", "terrain.area"],
                                    reset: ["terrain.district", "terrain.town"],
                                    align: "left",
                                    hint: "Город / Район области"
                                },
                                "district-town": {
                                    title: "Район / нас. пункт",
                                    width: 140,
                                    location: ["terrain.district", "terrain.town"],
                                    align: "left",
                                    hint: "Район города / Нас. пункт"
                                },
                                estateType: {
                                    title: "Тип",
                                    width: 130,
                                    location: ["main.estateType"],
                                    align: "left",
                                    hint: "Тип объекта"
                                },
                                p8: {
                                    title: "Соток",
                                    width: 80,
                                    location: ["params.p8"],
                                    align: "center",
                                    hint: "Соток"
                                },
                                p10: {
                                    title: "Дополнительно",
                                    width: 100,
                                    location: ["params.p10"],
                                    align: "center",
                                    hint: "Наличие дополнительных параметров"
                                },
                                price: {
                                    title: "Цена",
                                    width: 80,
                                    location: ["params.price"],
                                    align: "right",
                                    hint: "Цена"
                                },
                                phones: {
                                    title: "Телефон",
                                    width: 78,
                                    location: ["info.contacts.phones"],
                                    align: "center",
                                    hint: "Телефон"
                                },
                                date: {
                                    title: "Дата",
                                    width: 59,
                                    location: ["main.insertDate"],
                                    align: "center",
                                    hint: "Дата"
                                },
                                mark: {
                                    title: "Метка",
                                    width: 44,
                                    location: ["info.mark"],
                                    align: "center"
                                },
                                info: {
                                    title: "Инфо",
                                    width: 43,
                                    location: ["info.notes", "comments", "info.photo"],
                                    align: "center",
                                    hint: "Инфо"
                                },
                                id: {
                                    title: "",
                                    width: 27,
                                    location: [],
                                    align: "center"
                                }
                            },
                            2: "1",
                            3: "1",
                            4: {
                                "city-area-district-town": {
                                    title: "Населенный пункт / район",
                                    width: 279,
                                    location: ["terrain.city", "terrain.area", "terrain.district", "terrain.town"],
                                    align: "left",
                                    hint: "Населенный пункт / район"
                                },
                                "estateType-multiple": {
                                    title: "Тип",
                                    width: 130,
                                    location: ["main.estateType"],
                                    align: "left",
                                    hint: "Тип объекта"
                                },
                                "p8-range": {
                                    title: "Соток",
                                    width: 90,
                                    location: ["params.p8"],
                                    align: "center",
                                    hint: "Соток"
                                },
                                p10: {
                                    title: "Дополнительно",
                                    width: 102,
                                    location: ["params.p10"],
                                    align: "center",
                                    hint: "Наличие дополнительных параметров"
                                },
                                budget: {
                                    title: "Бюджет",
                                    width: 71,
                                    location: ["params.price"],
                                    align: "right",
                                    hint: "Бюджет"
                                },
                                phones: {
                                    title: "Телефон",
                                    width: 78,
                                    location: ["info.contacts.phones"],
                                    align: "center",
                                    hint: "Телефон"
                                },
                                date: {
                                    title: "Дата",
                                    width: 59,
                                    location: ["main.insertDate"],
                                    align: "center",
                                    hint: "Дата"
                                },
                                mark: {
                                    title: "Метка",
                                    width: 44,
                                    location: ["info.mark"],
                                    align: "center"
                                },
                                info: {
                                    title: "Инфо",
                                    width: 43,
                                    location: ["info.notes", "comments", "info.photo"],
                                    align: "center",
                                    hint: "Инфо"
                                },
                                id: {
                                    title: "",
                                    width: 27,
                                    location: [],
                                    align: "center"
                                }
                            },
                            5: "4"
                        },
                        areaCenter: {
                            1: {
                                district: {
                                    title: "Район",
                                    width: 140,
                                    location: ["terrain.district"],
                                    align: "left",
                                    hint: "Район"
                                },
                                street: {
                                    title: "Улица",
                                    width: 140,
                                    location: ["terrain.street", "terrain.house"],
                                    align: "left",
                                    hint: "Улица"
                                },
                                estateType: {
                                    title: "Тип",
                                    width: 130,
                                    location: ["main.estateType"],
                                    align: "left",
                                    hint: "Тип объекта"
                                },
                                p8: {
                                    title: "Соток",
                                    width: 80,
                                    location: ["params.p8"],
                                    align: "center",
                                    hint: "Соток"
                                },
                                p10: {
                                    title: "Дополнительно",
                                    width: 100,
                                    location: ["params.p10"],
                                    align: "center",
                                    hint: "Наличие дополнительных параметров"
                                },
                                price: {
                                    title: "Цена",
                                    width: 80,
                                    location: ["params.price"],
                                    align: "right",
                                    hint: "Цена"
                                },
                                phones: {
                                    title: "Телефон",
                                    width: 78,
                                    location: ["info.contacts.phones"],
                                    align: "center",
                                    hint: "Телефон"
                                },
                                date: {
                                    title: "Дата",
                                    width: 59,
                                    location: ["main.insertDate"],
                                    align: "center",
                                    hint: "Дата"
                                },
                                mark: {
                                    title: "Метка",
                                    width: 44,
                                    location: ["info.mark"],
                                    align: "center"
                                },
                                info: {
                                    title: "Инфо",
                                    width: 43,
                                    location: ["info.notes", "comments", "info.photo"],
                                    align: "center",
                                    hint: "Инфо"
                                },
                                id: {
                                    title: "",
                                    width: 27,
                                    location: [],
                                    align: "center"
                                }
                            },
                            2: "1",
                            3: "1",
                            4: {
                                "district-multiple": {
                                    title: "Район",
                                    width: 221,
                                    location: ["terrain.district"],
                                    align: "left",
                                    hint: "Район"
                                },
                                "estateType-multiple": {
                                    title: "Тип",
                                    width: 160,
                                    location: ["main.estateType"],
                                    align: "left",
                                    hint: "Тип объекта"
                                },
                                "p8-range": {
                                    title: "Соток",
                                    width: 100,
                                    location: ["params.p8"],
                                    align: "center",
                                    hint: "Соток"
                                },
                                p10: {
                                    title: "Дополнительно",
                                    width: 120,
                                    location: ["params.p10"],
                                    align: "center",
                                    hint: "Наличие дополнительных параметров"
                                },
                                budget: {
                                    title: "Бюджет",
                                    width: 71,
                                    location: ["params.price"],
                                    align: "right",
                                    hint: "Бюджет"
                                },
                                phones: {
                                    title: "Телефон",
                                    width: 78,
                                    location: ["info.contacts.phones"],
                                    align: "center",
                                    hint: "Телефон"
                                },
                                date: {
                                    title: "Дата",
                                    width: 59,
                                    location: ["main.insertDate"],
                                    align: "center",
                                    hint: "Дата"
                                },
                                mark: {
                                    title: "Метка",
                                    width: 44,
                                    location: ["info.mark"],
                                    align: "center"
                                },
                                info: {
                                    title: "Инфо",
                                    width: 43,
                                    location: ["info.notes", "comments", "info.photo"],
                                    align: "center",
                                    hint: "Инфо"
                                },
                                id: {
                                    title: "",
                                    width: 27,
                                    location: [],
                                    align: "center"
                                }
                            },
                            5: "4"
                        },
                        area: {
                            1: {
                                town: {
                                    title: "Населенный пункт",
                                    width: 282,
                                    location: ["terrain.town"],
                                    align: "left",
                                    hint: "Населенный пункт"
                                },
                                estateType: {
                                    title: "Тип",
                                    width: 130,
                                    location: ["main.estateType"],
                                    align: "left",
                                    hint: "Тип объекта"
                                },
                                p8: {
                                    title: "Соток",
                                    width: 80,
                                    location: ["params.p8"],
                                    align: "center",
                                    hint: "Соток"
                                },
                                p10: {
                                    title: "Дополнительно",
                                    width: 100,
                                    location: ["params.p10"],
                                    align: "center",
                                    hint: "Наличие дополнительных параметров"
                                },
                                price: {
                                    title: "Цена",
                                    width: 80,
                                    location: ["params.price"],
                                    align: "right",
                                    hint: "Цена"
                                },
                                phones: {
                                    title: "Телефон",
                                    width: 78,
                                    location: ["info.contacts.phones"],
                                    align: "center",
                                    hint: "Телефон"
                                },
                                date: {
                                    title: "Дата",
                                    width: 59,
                                    location: ["main.insertDate"],
                                    align: "center",
                                    hint: "Дата"
                                },
                                mark: {
                                    title: "Метка",
                                    width: 44,
                                    location: ["info.mark"],
                                    align: "center"
                                },
                                info: {
                                    title: "Инфо",
                                    width: 43,
                                    location: ["info.notes", "comments", "info.photo"],
                                    align: "center",
                                    hint: "Инфо"
                                },
                                id: {
                                    title: "",
                                    width: 27,
                                    location: [],
                                    align: "center"
                                }
                            },
                            2: "1",
                            3: "1",
                            4: {
                                "town-multiple": {
                                    title: "Населенный пункт",
                                    width: 279,
                                    location: ["terrain.town"],
                                    align: "left",
                                    hint: "Населенный пункт"
                                },
                                "estateType-multiple": {
                                    title: "Тип",
                                    width: 130,
                                    location: ["main.estateType"],
                                    align: "left",
                                    hint: "Тип объекта"
                                },
                                "p8-range": {
                                    title: "Соток",
                                    width: 90,
                                    location: ["params.p8"],
                                    align: "center",
                                    hint: "Соток"
                                },
                                p10: {
                                    title: "Дополнительно",
                                    width: 102,
                                    location: ["params.p10"],
                                    align: "center",
                                    hint: "Наличие дополнительных параметров"
                                },
                                budget: {
                                    title: "Бюджет",
                                    width: 71,
                                    location: ["params.price"],
                                    align: "right",
                                    hint: "Бюджет"
                                },
                                phones: {
                                    title: "Телефон",
                                    width: 78,
                                    location: ["info.contacts.phones"],
                                    align: "center",
                                    hint: "Телефон"
                                },
                                date: {
                                    title: "Дата",
                                    width: 59,
                                    location: ["main.insertDate"],
                                    align: "center",
                                    hint: "Дата"
                                },
                                mark: {
                                    title: "Метка",
                                    width: 44,
                                    location: ["info.mark"],
                                    align: "center"
                                },
                                info: {
                                    title: "Инфо",
                                    width: 43,
                                    location: ["info.notes", "comments", "info.photo"],
                                    align: "center",
                                    hint: "Инфо"
                                },
                                id: {
                                    title: "",
                                    width: 27,
                                    location: [],
                                    align: "center"
                                }
                            },
                            5: "4"
                        }
                    },
                    5: {
                        city: {
                            1: {
                                adminDistrict: {
                                    title: "Админрайон",
                                    width: 137,
                                    location: ["terrain.adminDistrict"],
                                    align: "left",
                                    hint: "Административный район",
                                    show: !1
                                },
                                district: {
                                    title: "Район",
                                    width: 140,
                                    location: ["terrain.district"],
                                    align: "left",
                                    hint: "Район"
                                },
                                street: {
                                    title: "Улица",
                                    width: 140,
                                    location: ["terrain.street", "terrain.house"],
                                    align: "left",
                                    hint: "Улица"
                                },
                                estateType: {
                                    title: "Тип",
                                    width: 75,
                                    location: ["main.estateType"],
                                    align: "left",
                                    hint: "Тип объекта"
                                },
                                p5: {
                                    title: "Площадь",
                                    width: 65,
                                    location: ["params.p5"],
                                    align: "center",
                                    hint: "Площадь"
                                },
                                p20: {
                                    title: "Материал",
                                    width: 73,
                                    location: ["params.p20"],
                                    align: "left",
                                    hint: "Материал"
                                },
                                p10: {
                                    title: "Дополн.",
                                    width: 95,
                                    location: ["params.p10"],
                                    align: "center",
                                    hint: "Наличие дополнительных параметров"
                                },
                                price: {
                                    title: "Цена",
                                    width: 80,
                                    location: ["params.price"],
                                    align: "right",
                                    hint: "Цена"
                                },
                                phones: {
                                    title: "Телефон",
                                    width: 78,
                                    location: ["info.contacts.phones"],
                                    align: "center",
                                    hint: "Телефон"
                                },
                                date: {
                                    title: "Дата",
                                    width: 59,
                                    location: ["main.insertDate"],
                                    align: "center",
                                    hint: "Дата"
                                },
                                mark: {
                                    title: "Метка",
                                    width: 44,
                                    location: ["info.mark"],
                                    align: "center"
                                },
                                info: {
                                    title: "Инфо",
                                    width: 43,
                                    location: ["info.notes", "comments", "info.photo"],
                                    align: "center",
                                    hint: "Инфо"
                                },
                                id: {
                                    title: "",
                                    width: 27,
                                    location: [],
                                    align: "center"
                                }
                            },
                            2: "1",
                            3: "1",
                            4: {
                                "adminDistrict-district-multiple": {
                                    title: "Админрайон / микрорайон",
                                    width: 253,
                                    location: ["terrain.adminDistrict", "terrain.district"],
                                    align: "left",
                                    hint: "Административный район / микрорайон"
                                },
                                "estateType-multiple": {
                                    title: "Тип",
                                    width: 175,
                                    location: ["main.estateType"],
                                    align: "left",
                                    hint: "Тип объекта"
                                },
                                p10: {
                                    title: "Дополнительно",
                                    width: 175,
                                    location: ["params.p10"],
                                    align: "center",
                                    hint: "Наличие дополнительных параметров"
                                },
                                budget: {
                                    title: "Бюджет",
                                    width: 71,
                                    location: ["params.price"],
                                    align: "right",
                                    hint: "Бюджет"
                                },
                                phones: {
                                    title: "Телефон",
                                    width: 78,
                                    location: ["info.contacts.phones"],
                                    align: "center",
                                    hint: "Телефон"
                                },
                                date: {
                                    title: "Дата",
                                    width: 59,
                                    location: ["main.insertDate"],
                                    align: "center",
                                    hint: "Дата"
                                },
                                mark: {
                                    title: "Метка",
                                    width: 44,
                                    location: ["info.mark"],
                                    align: "center"
                                },
                                info: {
                                    title: "Инфо",
                                    width: 43,
                                    location: ["info.notes", "comments", "info.photo"],
                                    align: "center",
                                    hint: "Инфо"
                                },
                                id: {
                                    title: "",
                                    width: 27,
                                    location: [],
                                    align: "center"
                                }
                            },
                            5: "4"
                        },
                        suburb: {
                            1: {
                                "city-area": {
                                    title: "Город / район обл.",
                                    width: 140,
                                    location: ["terrain.city", "terrain.area"],
                                    reset: ["terrain.district", "terrain.town"],
                                    align: "left",
                                    hint: "Город / Район области"
                                },
                                "district-town": {
                                    title: "Район / нас. пункт",
                                    width: 140,
                                    location: ["terrain.district", "terrain.town"],
                                    align: "left",
                                    hint: "Район города / Нас. пункт"
                                },
                                estateType: {
                                    title: "Тип",
                                    width: 75,
                                    location: ["main.estateType"],
                                    align: "left",
                                    hint: "Тип объекта"
                                },
                                p5: {
                                    title: "Площадь",
                                    width: 65,
                                    location: ["params.p5"],
                                    align: "center",
                                    hint: "Площадь"
                                },
                                p20: {
                                    title: "Материал",
                                    width: 73,
                                    location: ["params.p20"],
                                    align: "left",
                                    hint: "Материал"
                                },
                                p10: {
                                    title: "Дополн.",
                                    width: 95,
                                    location: ["params.p10"],
                                    align: "center",
                                    hint: "Наличие дополнительных параметров"
                                },
                                price: {
                                    title: "Цена",
                                    width: 80,
                                    location: ["params.price"],
                                    align: "right",
                                    hint: "Цена"
                                },
                                phones: {
                                    title: "Телефон",
                                    width: 78,
                                    location: ["info.contacts.phones"],
                                    align: "center",
                                    hint: "Телефон"
                                },
                                date: {
                                    title: "Дата",
                                    width: 59,
                                    location: ["main.insertDate"],
                                    align: "center",
                                    hint: "Дата"
                                },
                                mark: {
                                    title: "Метка",
                                    width: 44,
                                    location: ["info.mark"],
                                    align: "center"
                                },
                                info: {
                                    title: "Инфо",
                                    width: 43,
                                    location: ["info.notes", "comments", "info.photo"],
                                    align: "center",
                                    hint: "Инфо"
                                },
                                id: {
                                    title: "",
                                    width: 27,
                                    location: [],
                                    align: "center"
                                }
                            },
                            2: "1",
                            3: "1",
                            4: {
                                "city-area-district-town": {
                                    title: "Населенный пункт / район",
                                    width: 349,
                                    location: ["terrain.city", "terrain.area", "terrain.district", "terrain.town"],
                                    align: "left",
                                    hint: "Населенный пункт / район"
                                },
                                "estateType-multiple": {
                                    title: "Тип",
                                    width: 130,
                                    location: ["main.estateType"],
                                    align: "left",
                                    hint: "Тип объекта"
                                },
                                p10: {
                                    title: "Дополнительно",
                                    width: 124,
                                    location: ["params.p10"],
                                    align: "center",
                                    hint: "Наличие дополнительных параметров"
                                },
                                budget: {
                                    title: "Бюджет",
                                    width: 71,
                                    location: ["params.price"],
                                    align: "right",
                                    hint: "Бюджет"
                                },
                                phones: {
                                    title: "Телефон",
                                    width: 78,
                                    location: ["info.contacts.phones"],
                                    align: "center",
                                    hint: "Телефон"
                                },
                                date: {
                                    title: "Дата",
                                    width: 59,
                                    location: ["main.insertDate"],
                                    align: "center",
                                    hint: "Дата"
                                },
                                mark: {
                                    title: "Метка",
                                    width: 44,
                                    location: ["info.mark"],
                                    align: "center"
                                },
                                info: {
                                    title: "Инфо",
                                    width: 43,
                                    location: ["info.notes", "comments", "info.photo"],
                                    align: "center",
                                    hint: "Инфо"
                                },
                                id: {
                                    title: "",
                                    width: 27,
                                    location: [],
                                    align: "center"
                                }
                            },
                            5: "4"
                        },
                        areaCenter: {
                            1: {
                                district: {
                                    title: "Район",
                                    width: 140,
                                    location: ["terrain.district"],
                                    align: "left",
                                    hint: "Район"
                                },
                                street: {
                                    title: "Улица",
                                    width: 140,
                                    location: ["terrain.street", "terrain.house"],
                                    align: "left",
                                    hint: "Улица"
                                },
                                estateType: {
                                    title: "Тип",
                                    width: 75,
                                    location: ["main.estateType"],
                                    align: "left",
                                    hint: "Тип объекта"
                                },
                                p5: {
                                    title: "Площадь",
                                    width: 65,
                                    location: ["params.p5"],
                                    align: "center",
                                    hint: "Площадь"
                                },
                                p20: {
                                    title: "Материал",
                                    width: 73,
                                    location: ["params.p20"],
                                    align: "left",
                                    hint: "Материал"
                                },
                                p10: {
                                    title: "Дополн.",
                                    width: 95,
                                    location: ["params.p10"],
                                    align: "center",
                                    hint: "Наличие дополнительных параметров"
                                },
                                price: {
                                    title: "Цена",
                                    width: 80,
                                    location: ["params.price"],
                                    align: "right",
                                    hint: "Цена"
                                },
                                phones: {
                                    title: "Телефон",
                                    width: 78,
                                    location: ["info.contacts.phones"],
                                    align: "center",
                                    hint: "Телефон"
                                },
                                date: {
                                    title: "Дата",
                                    width: 59,
                                    location: ["main.insertDate"],
                                    align: "center",
                                    hint: "Дата"
                                },
                                mark: {
                                    title: "Метка",
                                    width: 44,
                                    location: ["info.mark"],
                                    align: "center"
                                },
                                info: {
                                    title: "Инфо",
                                    width: 43,
                                    location: ["info.notes", "comments", "info.photo"],
                                    align: "center",
                                    hint: "Инфо"
                                },
                                id: {
                                    title: "",
                                    width: 27,
                                    location: [],
                                    align: "center"
                                }
                            },
                            2: "1",
                            3: "1",
                            4: {
                                "district-multiple": {
                                    title: "Район",
                                    width: 253,
                                    location: ["terrain.district"],
                                    align: "left",
                                    hint: "Район"
                                },
                                "estateType-multiple": {
                                    title: "Тип",
                                    width: 175,
                                    location: ["main.estateType"],
                                    align: "left",
                                    hint: "Тип объекта"
                                },
                                p10: {
                                    title: "Дополнительно",
                                    width: 175,
                                    location: ["params.p10"],
                                    align: "center",
                                    hint: "Наличие дополнительных параметров"
                                },
                                budget: {
                                    title: "Бюджет",
                                    width: 71,
                                    location: ["params.price"],
                                    align: "right",
                                    hint: "Бюджет"
                                },
                                phones: {
                                    title: "Телефон",
                                    width: 78,
                                    location: ["info.contacts.phones"],
                                    align: "center",
                                    hint: "Телефон"
                                },
                                date: {
                                    title: "Дата",
                                    width: 59,
                                    location: ["main.insertDate"],
                                    align: "center",
                                    hint: "Дата"
                                },
                                mark: {
                                    title: "Метка",
                                    width: 44,
                                    location: ["info.mark"],
                                    align: "center"
                                },
                                info: {
                                    title: "Инфо",
                                    width: 43,
                                    location: ["info.notes", "comments", "info.photo"],
                                    align: "center",
                                    hint: "Инфо"
                                },
                                id: {
                                    title: "",
                                    width: 27,
                                    location: [],
                                    align: "center"
                                }
                            },
                            5: "4"
                        },
                        area: {
                            1: {
                                town: {
                                    title: "Населенный пункт",
                                    width: 282,
                                    location: ["terrain.town"],
                                    align: "left",
                                    hint: "Населенный пункт"
                                },
                                estateType: {
                                    title: "Тип",
                                    width: 75,
                                    location: ["main.estateType"],
                                    align: "left",
                                    hint: "Тип объекта"
                                },
                                p5: {
                                    title: "Площадь",
                                    width: 65,
                                    location: ["params.p5"],
                                    align: "center",
                                    hint: "Площадь"
                                },
                                p20: {
                                    title: "Материал",
                                    width: 73,
                                    location: ["params.p20"],
                                    align: "left",
                                    hint: "Материал"
                                },
                                p10: {
                                    title: "Дополн.",
                                    width: 95,
                                    location: ["params.p10"],
                                    align: "center",
                                    hint: "Наличие дополнительных параметров"
                                },
                                price: {
                                    title: "Цена",
                                    width: 80,
                                    location: ["params.price"],
                                    align: "right",
                                    hint: "Цена"
                                },
                                phones: {
                                    title: "Телефон",
                                    width: 78,
                                    location: ["info.contacts.phones"],
                                    align: "center",
                                    hint: "Телефон"
                                },
                                date: {
                                    title: "Дата",
                                    width: 59,
                                    location: ["main.insertDate"],
                                    align: "center",
                                    hint: "Дата"
                                },
                                mark: {
                                    title: "Метка",
                                    width: 44,
                                    location: ["info.mark"],
                                    align: "center"
                                },
                                info: {
                                    title: "Инфо",
                                    width: 43,
                                    location: ["info.notes", "comments", "info.photo"],
                                    align: "center",
                                    hint: "Инфо"
                                },
                                id: {
                                    title: "",
                                    width: 27,
                                    location: [],
                                    align: "center"
                                }
                            },
                            2: "1",
                            3: "1",
                            4: {
                                "town-multiple": {
                                    title: "Населенный пункт",
                                    width: 349,
                                    location: ["terrain.town"],
                                    align: "left",
                                    hint: "Населенный пункт"
                                },
                                "estateType-multiple": {
                                    title: "Тип",
                                    width: 130,
                                    location: ["main.estateType"],
                                    align: "left",
                                    hint: "Тип объекта"
                                },
                                p10: {
                                    title: "Дополнительно",
                                    width: 124,
                                    location: ["params.p10"],
                                    align: "center",
                                    hint: "Наличие дополнительных параметров"
                                },
                                budget: {
                                    title: "Бюджет",
                                    width: 71,
                                    location: ["params.price"],
                                    align: "right",
                                    hint: "Бюджет"
                                },
                                phones: {
                                    title: "Телефон",
                                    width: 78,
                                    location: ["info.contacts.phones"],
                                    align: "center",
                                    hint: "Телефон"
                                },
                                date: {
                                    title: "Дата",
                                    width: 59,
                                    location: ["main.insertDate"],
                                    align: "center",
                                    hint: "Дата"
                                },
                                mark: {
                                    title: "Метка",
                                    width: 44,
                                    location: ["info.mark"],
                                    align: "center"
                                },
                                info: {
                                    title: "Инфо",
                                    width: 43,
                                    location: ["info.notes", "comments", "info.photo"],
                                    align: "center",
                                    hint: "Инфо"
                                },
                                id: {
                                    title: "",
                                    width: 27,
                                    location: [],
                                    align: "center"
                                }
                            },
                            5: "4"
                        }
                    }
                },
                filters: [{
                    name: "region",
                    location: ["terrain.region"],
                    set: ["region"],
                    type: "region",
                    items: [{
                        id: 4,
                        title: "Днепропетровская обл."
                    }, {
                        id: 8,
                        title: "Запорожская обл."
                    }, {
                        id: 10,
                        title: "Киевская обл."
                    }],
                    dynamic: !1,
                    showInURI: !0
                }, {
                    name: "locality",
                    type: "locality",
                    items: e,
                    dynamic: !1,
                    showInURI: !0
                }, {
                    name: "type",
                    location: [],
                    set: ["type"],
                    type: "type",
                    dynamic: !1,
                    showInURI: !0
                }, {
                    name: "marketSegment",
                    location: ["main.marketSegment"],
                    set: ["marketSegment"],
                    type: "marketSegment",
                    dynamic: !1,
                    showInURI: !0
                }, {
                    name: "operation",
                    location: ["main.operation"],
                    set: ["operation"],
                    type: "operation",
                    dynamic: !1,
                    showInURI: !0
                }, {
                    name: "adminDistrict",
                    location: ["terrain.adminDistrict"],
                    set: ["adminDistrict"],
                    type: "list",
                    dynamic: !0,
                    showInURI: !0,
                    hasEmptyItem: !0,
                    render: !1,
                    listing: {
                        name: "adminDistrict",
                        dependencies: ["locality-city"]
                    }
                }, {
                    name: "adminDistrict-district-multiple",
                    location: ["terrain.adminDistrict", "terrain.district"],
                    set: ["adminDistrict", "district"],
                    type: "select",
                    dynamic: !0,
                    showInURI: !0,
                    hasEmptyItem: !0,
                    render: !1,
                    listing: {
                        name: "adminDistrict-district",
                        dependencies: ["locality-city"]
                    }
                }, {
                    name: "district",
                    location: ["terrain.district"],
                    set: ["district"],
                    type: "list",
                    dynamic: !0,
                    showInURI: !0,
                    hasEmptyItem: !0,
                    render: !1,
                    listing: {
                        name: "district",
                        dependencies: ["locality-city"]
                    }
                }, {
                    name: "district-multiple",
                    location: ["terrain.district"],
                    set: ["district"],
                    type: "list",
                    dynamic: !0,
                    showInURI: !0,
                    hasEmptyItem: !0,
                    render: !1,
                    listing: {
                        name: "district",
                        dependencies: ["locality-city"]
                    }
                }, {
                    name: "street",
                    location: ["terrain.street", "terrain.house"],
                    set: ["street", "houseNumberHide", "odd", "even"],
                    type: "street",
                    dynamic: !0,
                    showInURI: !0,
                    render: !1,
                    listing: {
                        name: "street",
                        dependencies: ["locality-city"]
                    }
                }, {
                    name: "houseNumber",
                    location: ["terrain.house.number"],
                    set: ["houseNumber", "order"],
                    type: "range",
                    items: [{
                        title: "Номер дома",
                        placeholder: ["от", "до"]
                    }],
                    step: 1,
                    dynamic: !1,
                    showInURI: !0,
                    child: !0,
                    render: !0,
                    renderWrapper: !1,
                    renderSort: !0,
                    renderEmpty: !1,
                    renderSubmitButton: !1
                }, {
                    name: "city-area",
                    location: ["terrain.city", "terrain.area"],
                    set: ["city", "area"],
                    type: "list",
                    dynamic: !0,
                    showInURI: !0,
                    hasEmptyItem: !0,
                    render: !1,
                    listing: {
                        name: "city-area",
                        dependencies: ["region"]
                    }
                }, {
                    name: "district-town",
                    location: ["terrain.district", "terrain.town"],
                    set: ["district", "town"],
                    type: "select",
                    dynamic: !0,
                    showInURI: !0,
                    render: !1,
                    listing: {
                        name: "district-town",
                        dependencies: ["region"]
                    }
                }, {
                    name: "town",
                    location: ["terrain.town"],
                    set: ["town"],
                    type: "select",
                    dynamic: !0,
                    showInURI: !0,
                    render: !1,
                    listing: {
                        name: "town",
                        dependencies: ["locality-area"]
                    }
                }, {
                    name: "town-multiple",
                    location: ["terrain.town"],
                    set: ["town"],
                    type: "select",
                    dynamic: !0,
                    showInURI: !0,
                    render: !1,
                    listing: {
                        name: "town",
                        dependencies: ["locality-area"]
                    }
                }, {
                    name: "city-area-district-town",
                    location: ["terrain.city", "terrain.area", "terrain.district", "terrain.town"],
                    set: ["city", "area", "district", "town"],
                    type: "select",
                    dynamic: !0,
                    showInURI: !0,
                    render: !1,
                    listing: {
                        name: "city-area-district-town",
                        dependencies: ["region"]
                    }
                }, {
                    name: "estateType",
                    location: ["main.estateType"],
                    set: ["estateType"],
                    type: "list",
                    dynamic: !0,
                    showInURI: !0,
                    hasEmptyItem: !0,
                    render: !1,
                    listing: {
                        name: "estateType",
                        dependencies: ["marketSegment"]
                    }
                }, {
                    name: "estateType-multiple",
                    location: ["main.estateType"],
                    set: ["estateType"],
                    type: "list",
                    dynamic: !0,
                    showInURI: !0,
                    hasEmptyItem: !0,
                    render: !1,
                    listing: {
                        name: "estateType",
                        dependencies: ["marketSegment"]
                    }
                }, {
                    name: "p1-p2",
                    location: ["params.p1"],
                    set: ["p1", "order"],
                    type: "p1",
                    items: [{
                        id: 0,
                        title: "–",
                        field: "null"
                    }, {
                        id: 1,
                        title: "1 - комнатные",
                        field: "p1"
                    }, {
                        id: 2,
                        title: "2 - комнатные",
                        field: "p1"
                    }, {
                        id: 3,
                        title: "3 - комнатные",
                        field: "p1"
                    }, {
                        id: 4,
                        title: "4 - комнатные",
                        field: "p1"
                    }, {
                        id: 5,
                        title: "5 - к. и более",
                        field: "p1"
                    }],
                    dynamic: !1,
                    showInURI: !0,
                    render: !1
                }, {
                    name: "p1-multiple",
                    location: ["params.p1"],
                    set: ["p1", "order"],
                    type: "p1",
                    items: [{
                        id: 0,
                        title: "–",
                        field: "null"
                    }, {
                        id: 1,
                        title: "1 - комнатные",
                        field: "p1"
                    }, {
                        id: 2,
                        title: "2 - комнатные",
                        field: "p1"
                    }, {
                        id: 3,
                        title: "3 - комнатные",
                        field: "p1"
                    }, {
                        id: 4,
                        title: "4 - комнатные",
                        field: "p1"
                    }, {
                        id: 5,
                        title: "5 - к. и более",
                        field: "p1"
                    }],
                    dynamic: !1,
                    showInURI: !0,
                    render: !1
                }, {
                    name: "p3-p4",
                    location: ["params.p3", "params.p4"],
                    set: ["p3", "p4", "order", "p3p4hide"],
                    type: "range",
                    items: [{
                        title: "Этаж дома",
                        placeholder: ["от", "до"]
                    }, {
                        title: "Этажность дома",
                        placeholder: ["от", "до"]
                    }],
                    step: 1,
                    dynamic: !1,
                    showInURI: !0,
                    render: !1
                }, {
                    name: "p4",
                    location: ["params.p4"],
                    set: ["p4h", "order"],
                    type: "p1",
                    items: [{
                        id: 0,
                        title: "–",
                        field: "null"
                    }, {
                        id: 1,
                        title: "1-этажные",
                        field: "p4"
                    }, {
                        id: 2,
                        title: "2-этажные",
                        field: "p4"
                    }, {
                        id: 3,
                        title: "3-этажные",
                        field: "p4"
                    }, {
                        id: 4,
                        title: "4-эт. и более",
                        field: "p4"
                    }],
                    dynamic: !1,
                    showInURI: !0,
                    render: !1
                }, {
                    name: "p5",
                    location: ["params.p5"],
                    set: ["p5", "order", "p5p6p7hide"],
                    type: "range",
                    items: [{
                        title: "Общая площадь, м²",
                        placeholder: ["от", "до"]
                    }],
                    step: 1,
                    dynamic: !1,
                    showInURI: !0,
                    render: !1
                }, {
                    name: "p5-range",
                    location: ["params.p5"],
                    set: ["p5", "order", "p5p6p7hide"],
                    type: "range",
                    items: [{
                        title: "Общая площадь, м²",
                        placeholder: ["от", "до"]
                    }],
                    step: 1,
                    dynamic: !1,
                    showInURI: !0,
                    render: !1
                }, {
                    name: "p8",
                    location: ["params.p8"],
                    set: ["p8", "order", "p8hide"],
                    type: "range",
                    items: [{
                        title: "Соток земли",
                        placeholder: ["от", "до"]
                    }],
                    step: 1,
                    dynamic: !1,
                    showInURI: !0,
                    render: !1
                }, {
                    name: "p8-range",
                    location: ["params.p8"],
                    set: ["p8", "order", "p8hide"],
                    type: "range",
                    items: [{
                        title: "Соток земли",
                        placeholder: ["от", "до"]
                    }],
                    step: 1,
                    dynamic: !1,
                    showInURI: !0,
                    render: !1
                }, {
                    name: "p5-p6-p7",
                    location: ["params.p5", "params.p6", "params.p7"],
                    set: ["p5", "p6", "p7", "order", "p5p6p7hide"],
                    type: "range",
                    items: [{
                        title: "Общая площадь, м²",
                        placeholder: ["от", "до"]
                    }, {
                        title: "Жилая площадь, м²",
                        placeholder: ["от", "до"]
                    }, {
                        title: "Площадь кухни, м²",
                        placeholder: ["от", "до"]
                    }],
                    step: 5,
                    dynamic: !1,
                    showInURI: !0,
                    render: !1
                }, {
                    name: "p10",
                    location: ["params.p10"],
                    set: ["p10"],
                    type: "list",
                    dynamic: !0,
                    showInURI: !0,
                    hasEmptyItem: !0,
                    render: !1,
                    listing: {
                        name: "p10",
                        dependencies: ["marketSegment"]
                    }
                }, {
                    name: "p19",
                    location: ["params.p19"],
                    set: ["p19"],
                    type: "list",
                    dynamic: !0,
                    showInURI: !0,
                    hasEmptyItem: !0,
                    render: !1,
                    listing: {
                        name: "p19"
                    }
                }, {
                    name: "p20",
                    location: ["params.p20"],
                    set: ["p20"],
                    type: "list",
                    dynamic: !0,
                    showInURI: !0,
                    hasEmptyItem: !0,
                    render: !1,
                    listing: {
                        name: "p20"
                    }
                }, {
                    name: "price",
                    location: ["params.price"],
                    set: ["price", "order", "priceHide"],
                    type: "range",
                    items: [{
                        title: "Цена за весь объект",
                        placeholder: ["от", "до"]
                    }],
                    step: 1e3,
                    dynamic: !1,
                    showInURI: !0,
                    render: !1
                }, {
                    name: "budget",
                    location: ["params.price"],
                    set: ["price", "order", "priceHide"],
                    type: "range",
                    items: [{
                        title: "Бюджет",
                        placeholder: ["от", "до"]
                    }],
                    step: 1e3,
                    dynamic: !1,
                    showInURI: !0,
                    render: !1
                }, {
                    name: "phones",
                    location: ["info.contacts.phones"],
                    set: ["phones"],
                    type: "phones",
                    dynamic: !1,
                    showInURI: !0,
                    render: !1
                }, {
                    name: "date",
                    location: ["main.insertDate"],
                    set: ["date"],
                    type: "date",
                    dynamic: !1,
                    showInURI: !0,
                    render: !1
                }, {
                    name: "mark",
                    location: ["info.mark"],
                    set: ["mark"],
                    type: "mark",
                    dynamic: !0,
                    showInURI: !0,
                    render: !1,
                    listing: {
                        name: "mark"
                    }
                }, {
                    name: "info",
                    location: ["info.photo", "info.notes", "info.comments"],
                    set: ["info", "infoEmpty"],
                    type: "info",
                    items: [{
                        id: "comments",
                        title: "Комментарии"
                    }, {
                        id: "photo",
                        title: "Фотографии"
                    }, {
                        id: "notes",
                        title: "Примечания"
                    }],
                    dynamic: !1,
                    showInURI: !0,
                    render: !1
                }, {
                    name: "id",
                    location: ["main.id"],
                    set: ["id", "text"],
                    type: "id",
                    dynamic: !1,
                    showInURI: !0,
                    render: !1
                }],
                marketSegments: ["Квартиры и комнаты", "Дома и дачи", "Коммерческая недвижимость", "Земельные участки", "Гаражи и паркинги"],
                operations: ["Продам", "Сдам", "Сдам посуточно", "Куплю", "Сниму"],
                months: ["Январь", "Февраль", "Март", "Апрель", "Май", "Июнь", "Июль", "Август", "Сентябрь", "Октябрь", "Ноябрь", "Декабрь"],
                maxAdsCountForExport: {
                    excel: 200,
                    print: 50
                },
                hints: {
                    minmax: "Минимальное значение параметра не может быть больше максимального.",
                    "input-p1-p2": "Значение параметра «Комнат» не может быть меньше значения параметра «Раздельных».",
                    "input-p3-p4": "Значение параметра «Этаж дома» не может быть больше значения параметра «Этажность дома».",
                    "input-p5-p6-1": "Значение параметра «Общая площадь» не может быть меньше значения параметра «Жилая площадь».",
                    "input-p5-p6-2": "Значение параметра «Общая площадь» не может быть меньше значения параметра «Площадь кухни».",
                    "input-p5-p6-3": "Значение параметра «Общая площадь» не может быть меньше значений параметров «Жилая площадь» и «Площадь кухни». ",
                    "input-p5-p6-4": "Значение параметра «Общая площадь» не может быть меньше суммы значений параметров «Жилая площадь» и «Площадь кухни».",
                    "input-adv-p3-p4": "Минимальное значение параметра «Этаж дома» не может быть больше максимального значения параметра «Этажность дома».",
                    "input-adv-p5-p6-p7-1": "Минимальное значение параметра «Жилая площадь» не может быть больше максимального значения параметра «Общая площадь».",
                    "input-adv-p5-p6-p7-2": "Минимальное значение параметра «Площадь кухни» не может быть больше максимального значения параметра «Общая площадь».",
                    "input-adv-p5-p6-p7-3": "Минимальное значение параметра «Площадь кухни» не может быть больше максимального значения параметра «Жилая площадь».",
                    "input-adv-p5-p6-p7-4": "Сума минимальных значений параметров «Жилая площадь» и «Площадь кухни» не может быть больше максимального значения параметра «Общая площадь».",
                    "input-adv-p5-p6-p7-5": "Минимальное значение параметра «Жилая площадь» не может быть равным максимальному значению параметра «Общая площадь».",
                    "input-adv-p5-p6-p7-6": "Минимальное значение параметра «Площадь кухни» не может быть равным максимальному значению параметра «Жилая площадь».",
                    "input-adv-p5-p6-p7-7": "Минимальное значение параметра «Площадь кухни» не может быть равным максимальному значению параметра «Общая площадь».",
                    "input-adv-p5-p6-p7-8": "Сумма минимальных значений параметров «Жилая площадь» и «Площадь кухни» не может быть равной максимальному значению параметра «Общая площадь».",
                    "input-date": "Некорректно заполнены поля «с» и «по» параметра «За период»"
                }
            };
        return t
    }), define("Shared/Abstract/Model", ["backbone"], function(e) {
        var t = e.Model.extend({
            close: function() {
                this.unbindFromAll(), this.off(), this.onClose && this.onClose()
            },
            bindTo: function(e, t, n, r) {
                r || (r = this), e.on(t, n, r), this.bindings || (this.bindings = []), this.bindings.push({
                    object: e,
                    event: t,
                    callback: n
                })
            },
            unbindFromAll: function() {
                var e = this;
                _.each(this.bindings, function(t) {
                    t.object.off(t.event, t.callback, e)
                })
            }
        });
        return t
    }), define("Shared/Functions", [], function() {
        return {
            uri2obj: function(e) {
                if (!e) return {};
                var t = {};
                e = e.split("&");
                for (var n = 0; n < e.length; n++) {
                    var r = e[n].split("=");
                    if (r[0]) {
                        var i = decodeURIComponent(r[0]).replace(/^\?/, ""),
                            s = i.match(/^[^\[]+/)[0],
                            o = i.match(/\[[^\]]+\]/g),
                            u = decodeURIComponent(r[1] + "");
                        if (o) {
                            var a = o[0].replace(/[\]\[]/g, "");
                            s in t || (t[s] = isNaN(a) ? {} : []);
                            var f = t[s];
                            for (var l = 0; l < o.length; l++) {
                                var c = o[l].replace(/[\]\[]/g, ""),
                                    h = o[l + 1] ? o[l + 1].replace(/[\]\[]/g, "") : !1;
                                h ? (c in f || (f[c] = isNaN(h) ? {} : []), f = f[c]) : (u == "null" && (u = null), f[c] = u)
                            }
                        } else u == "null" && (u = null), t[s] = u
                    }
                }
                return t
            },
            obj2uri: function(e, t) {
                var n = [];
                for (var r in e) {
                    var i = t ? t + "[" + r + "]" : r,
                        s = e[r];
                    n.push(typeof s == "object" && s !== null ? this.obj2uri(s, i) : encodeURIComponent(i) + "=" + encodeURIComponent(s))
                }
                return n.join("&")
            }
        }
    }), define("Base/AppDataModel", ["Shared/Abstract/Model", "Shared/Functions", "Base/Config"], function(e, t, n) {
        var r = e.extend({
            initialize: function() {
                _.bindAll(this), this.bindTo(this, "change", this.updateUrl), this.bindTo(this, "change", this.updateCookies), this.updateCookies()
            },
            "locality-city": function() {
                return parseInt(this.get("locality").split("-")[0]) || 0
            },
            "locality-area": function() {
                return parseInt(this.get("locality").split("-")[1]) || 0
            },
            get: function(e) {
                return typeof this[e] == "function" ? this[e]() : Backbone.Model.prototype.get.call(this, e)
            },
            reset: function() {
                for (var e in this.attributes) _.indexOf(n.defaultParams[window.AppData.Base.data.get("type")], e) == -1 && this.unset(e);
                return this.trigger("ResetAppData"), this
            },
            isDefaults: function() {
                var e = this.toJSON();
                return !!(_.size(e) === 5 && e.region && e.type && e.marketSegment && e.operation && e.locality)
            },
            generateDefaultUrl: function(e) {
                var r = {},
                    i = window.AppData.Base.data.get("type");
                for (var s in n.defaultParams[i]) this.get(n.defaultParams[i][s]) && (r[n.defaultParams[i][s]] = this.get(n.defaultParams[i][s]));
                return r = _.extend(r, e), _.each(r, function(e, t) {
                    e === null && delete r[t]
                }), window.location.pathname + (Modernizr.history ? "" : n.rootHash) + "?" + t.obj2uri(r)
            },
            generateUrl: function(e) {
                var r = _.extend(this.toJSON(), e);
                return window.location.pathname + (Modernizr.history ? "" : n.rootHash) + "?" + t.obj2uri(r)
            },
            updateUrl: function() {
                var e = this.toJSON(),
                    r = _.pluck(_.filter(n.filters, function(e) {
                        return e.showInURI == 0
                    }), "name");
                _.each(r, function(t) {
                    delete e[t]
                });
                var i = window.location.pathname + (Modernizr.history ? "" : n.rootHash) + "?" + t.obj2uri(e);
                Router.navigate(i, !1), Router.trigger("navigateWithoutTrigger")
            },
            updateCookies: function() {
                $.cookie("base-region", this.get("region"), {
                    expires: 365,
                    path: "/"
                }), $.cookie("base-type", this.get("type"), {
                    expires: 365,
                    path: "/"
                }), $.cookie("base-marketSegment", this.get("marketSegment"), {
                    expires: 365,
                    path: "/"
                }), $.cookie("base-operation", this.get("operation"), {
                    expires: 365,
                    path: "/"
                }), $.cookie("base-locality", this.get("locality"), {
                    expires: 365,
                    path: "/"
                })
            }
        });
        return r
    }), define("Base/Listing/Model", ["Shared/Abstract/Model", "Base/Config"], function(e, t) {
        var n = e.extend({
            url: "/api/base/listings",
            initialize: function() {
                _.bindAll(this), this.AppData = window.AppData.Base.data, this.cacheEnabled = Modernizr.localstorage, this.currentVersion = this.cacheEnabled ? localStorage.getItem("storageDataVersion") : 0, this.cacheEnabled && this.currentVersion !== t.storageDataVersion && (localStorage.clear(), localStorage.setItem("storageDataVersion", t.storageDataVersion), this.currentVersion = t.storageDataVersion), this.make()
            },
            getOne: function(e) {
                var t = Backbone.Model.prototype.get.call(this, e);
                if (typeof t != "undefined") return t;
                this.fetch({
                    data: _.extend(this.AppData.toJSON(), {
                        listings: [e]
                    }),
                    success: this.complete
                })
            },
            fetch: function(e) {
                var n = [],
                    r = e.data.listings,
                    i = [];
                _.each(r, function(e) {
                    var t = localStorage.getItem(e);
                    t ? n.push({
                        name: e,
                        items: $.parseJSON(t)
                    }) : i.push(e)
                }, this), e.data.listings = i;
                if (e.data.listings.length) {
                    var s = this.cacheEnabled;
                    $.getJSON(this.url, e.data, function(r) {
                        _.each(r, function(e) {
                            var r = _.include(t.listingsOrderById, e.name) ? "id" : "title",
                                i = _.sortBy(e.items, function(e) {
                                    return r == "id" ? parseInt(e[r]) : e[r]
                                });
                            s && localStorage.setItem(e.name, $.toJSON(i)), n.push({
                                name: e.name,
                                items: i
                            })
                        }), e.success(n)
                    })
                } else e.success(n)
            },
            make: function(e, n, r) {
                if (r && r.listingsCalled || !1) return;
                r && (r.listingsCalled = !0), this.currentColumnNames = _.keys(t.columns.getCurrent(this.AppData));
                var i = _.unique(_.map(_.filter(t.filters, this.listingFilter), function(e) {
                    if (!e.listing || !e.listing.name) return !1;
                    var t = e.listing.name,
                        n = _.map(e.listing.dependencies, function(e) {
                            var t = window.AppData.Base.data.get(e);
                            return t && _.isArray(t) ? t[0] : t
                        });
                    return t + (n.length ? "-" + n.join("-") : "")
                }));
                this.fetch({
                    data: _.extend(this.AppData.toJSON(), {
                        listings: i
                    }),
                    success: this.complete
                })
            },
            complete: function(e) {
                for (var t in e) this.set(e[t].name, e[t].items)
            },
            listingFilter: function(e) {
                return _.include(this.currentColumnNames, e.name) && e.dynamic == 1
            }
        });
        return n
    }),
    function(e) {
        typeof exports != "undefined" ? e(require("underscore"), require("backbone")) : typeof define == "function" && define.amd ? define("Libs/Backbone/DeepModel/deep-model-0.10.4", ["underscore", "backbone"], e) : e(_, Backbone)
    }(function(e, t) {
        function n(t) {
            var r = {},
                i = o.keyPathSeparator;
            for (var s in t) {
                var u = t[s];
                if (u && u.constructor === Object && !e.isEmpty(u)) {
                    var a = n(u);
                    for (var f in a) {
                        var l = a[f];
                        r[s + i + f] = l
                    }
                } else r[s] = u
            }
            return r
        }

        function r(t, n, r) {
            var i = o.keyPathSeparator,
                s = n.split(i),
                u = t;
            r || r === !1;
            for (var a = 0, f = s.length; a < f; a++) {
                if (r && !e.has(u, s[a])) return !1;
                u = u[s[a]], u == null && a < f - 1 && (u = {});
                if (typeof u == "undefined") return r ? !0 : u
            }
            return r ? !0 : u
        }

        function i(t, n, r, i) {
            i = i || {};
            var s = o.keyPathSeparator,
                u = n.split(s),
                a = t;
            for (var f = 0, l = u.length; f < l && a !== undefined; f++) {
                var c = u[f];
                if (f === l - 1) i.unset ? delete a[c] : a[c] = r;
                else {
                    if (typeof a[c] == "undefined" || !e.isObject(a[c])) a[c] = {};
                    a = a[c]
                }
            }
        }

        function s(e, t) {
            i(e, t, null, {
                unset: !0
            })
        }(function() {
            var n, r, i, s, o, u, a = [].slice;
            i = function(n) {
                var r, s;
                return !e.isObject(n) || e.isFunction(n) ? n : n instanceof t.Collection || n instanceof t.Model ? n : e.isDate(n) ? new Date(n.getTime()) : e.isRegExp(n) ? new RegExp(n.source, n.toString().replace(/.*\//, "")) : (s = e.isArray(n || e.isArguments(n)), r = function(e, t, n) {
                    return s ? e.push(i(t)) : e[n] = i(t), e
                }, e.reduce(n, r, s ? [] : {}))
            }, u = function(t) {
                return t == null ? !1 : (t.prototype === {}.prototype || t.prototype === Object.prototype) && e.isObject(t) && !e.isArray(t) && !e.isFunction(t) && !e.isDate(t) && !e.isRegExp(t) && !e.isArguments(t)
            }, r = function(t) {
                return e.filter(e.keys(t), function(e) {
                    return u(t[e])
                })
            }, n = function(t) {
                return e.filter(e.keys(t), function(n) {
                    return e.isArray(t[n])
                })
            }, o = function(t, i, s) {
                var u, a, f, l, c, h, p, d, v, m;
                s == null && (s = 20);
                if (s <= 0) return console.warn("_.deepExtend(): Maximum depth of recursion hit."), e.extend(t, i);
                h = e.intersection(r(t), r(i)), a = function(e) {
                    return i[e] = o(t[e], i[e], s - 1)
                };
                for (p = 0, v = h.length; p < v; p++) c = h[p], a(c);
                l = e.intersection(n(t), n(i)), u = function(n) {
                    return i[n] = e.union(t[n], i[n])
                };
                for (d = 0, m = l.length; d < m; d++) f = l[d], u(f);
                return e.extend(t, i)
            }, s = function() {
                var t, n, r, s;
                r = 2 <= arguments.length ? a.call(arguments, 0, s = arguments.length - 1) : (s = 0, []), n = arguments[s++], e.isNumber(n) || (r.push(n), n = 20);
                if (r.length <= 1) return r[0];
                if (n <= 0) return e.extend.apply(this, r);
                t = r.shift();
                while (r.length > 0) t = o(t, i(r.shift()), n);
                return t
            }, e.mixin({
                deepClone: i,
                isBasicObject: u,
                basicObjects: r,
                arrays: n,
                deepExtend: s
            })
        }).call(this);
        var o = t.Model.extend({
            constructor: function(t, n) {
                var r, i = t || {};
                this.cid = e.uniqueId("c"), this.attributes = {}, n && n.collection && (this.collection = n.collection), n && n.parse && (i = this.parse(i, n) || {});
                if (r = e.result(this, "defaults")) i = e.deepExtend({}, r, i);
                this.set(i, n), this.changed = {}, this.initialize.apply(this, arguments)
            },
            toJSON: function(t) {
                return e.deepClone(this.attributes)
            },
            get: function(e) {
                return r(this.attributes, e)
            },
            set: function(t, u, a) {
                var f, l, c, h, p, d, v, m;
                if (t == null) return this;
                typeof t == "object" ? (l = t, a = u || {}) : (l = {})[t] = u, a || (a = {});
                if (!this._validate(l, a)) return !1;
                c = a.unset, p = a.silent, h = [], d = this._changing, this._changing = !0, d || (this._previousAttributes = e.deepClone(this.attributes), this.changed = {}), m = this.attributes, v = this._previousAttributes, this.idAttribute in l && (this.id = l[this.idAttribute]), l = n(l);
                for (f in l) u = l[f], e.isEqual(r(m, f), u) || h.push(f), e.isEqual(r(v, f), u) ? s(this.changed, f) : i(this.changed, f, u), c ? s(m, f) : i(m, f, u);
                if (!p) {
                    h.length && (this._pending = !0);
                    var g = o.keyPathSeparator;
                    for (var y = 0, b = h.length; y < b; y++) {
                        var t = h[y];
                        this.trigger("change:" + t, this, r(m, t), a);
                        var w = t.split(g);
                        for (var E = w.length - 1; E > 0; E--) {
                            var S = e.first(w, E).join(g),
                                x = S + g + "*";
                            this.trigger("change:" + x, this, r(m, S), a)
                        }
                    }
                }
                if (d) return this;
                if (!p)
                    while (this._pending) this._pending = !1, this.trigger("change", this, a);
                return this._pending = !1, this._changing = !1, this
            },
            clear: function(t) {
                var r = {},
                    i = n(this.attributes);
                for (var s in i) r[s] = void 0;
                return this.set(r, e.extend({}, t, {
                    unset: !0
                }))
            },
            hasChanged: function(t) {
                return t == null ? !e.isEmpty(this.changed) : r(this.changed, t) !== undefined
            },
            changedAttributes: function(t) {
                if (!t) return this.hasChanged() ? n(this.changed) : !1;
                var r = this._changing ? this._previousAttributes : this.attributes;
                t = n(t), r = n(r);
                var i, s = !1;
                for (var o in t) {
                    if (e.isEqual(r[o], i = t[o])) continue;
                    (s || (s = {}))[o] = i
                }
                return s
            },
            previous: function(e) {
                return e == null || !this._previousAttributes ? null : r(this._previousAttributes, e)
            },
            previousAttributes: function() {
                return e.deepClone(this._previousAttributes)
            }
        });
        return o.keyPathSeparator = ".", t.DeepModel = o, typeof module != "undefined" && (module.exports = o), t
    }), define("Libs/Backbone/DeepModel", ["Libs/Backbone/DeepModel/deep-model-0.10.4"], function(e) {
        return e
    }), define("Base/Counters/Model", ["Base/Config", "Libs/Backbone/DeepModel"], function(e) {
        var t = Backbone.DeepModel.extend({
            url: function() {
                return "/api/base/counters/" + window.AppData.Base.data.get("region") + "-" + window.AppData.Base.data.get("locality")
            },
            initialize: function() {
                _.bindAll(this), this.appData = window.AppData.Base.data, this.listenTo(window.EventManager, "Base BaseUpdateCounters", this.updateCounters), this.listenTo(window.EventManager, "BaseNeedUpdateCounters", this.needUpdate), this.listenTo(window.AppData.Base.events, "LocalityChanged", this.fetch), this.listenTo(window.AppData.Base.events, "BeforeOperationChange BeforeMarketSegmentChange", this.resetCounter)
            },
            saveSession: function() {
                if (!this.sessionStart) return;
                window.Session.Save("counters", {
                    sessionStart: this.sessionStart.getTime(),
                    sessionVisit: this.get("sessionVisit"),
                    counters: this.get("counters")
                })
            },
            clearSession: function() {
                window.Session.Clear("counters")
            },
            resetSession: function() {
                window.Session.Clear("counters"), this.updateSessionStartDate(), this.unset("sessionVisit"), this.unset("counters")
            },
            loadSession: function() {
                var e = window.Session.Load("counters");
                return e ? (this.setSessionStartDate(e.sessionStart), this.sessionCounters = e.counters, this.set("sessionVisit", e.sessionVisit), this.set("counters", this.sessionCounters), this.trigger("change"), this.clearSession(), !0) : !1
            },
            updateSessionStartDate: function() {
                window.AppData.date(this.setSessionStartDate)
            },
            setSessionStartDate: function(e) {
                this.sessionStart = new Date(e)
            },
            getPath: function() {
                var e = this.appData.toJSON();
                return e.type + "." + e.marketSegment + "." + e.operation
            },
            getLastVisit: function() {
                var e = this.getPath(),
                    t = new Date(this.get("visits." + e));
                return t.getTime() ? t : this.get("created") ? new Date(this.get("created")) : null
            },
            getLastSessionVisit: function() {
                var e = this.getPath(),
                    t = new Date(this.get("sessionVisit." + e.sessionVisit));
                return t.getTime() ? t : this.sessionStart
            },
            needUpdate: function() {
                this.needUpdateCounters = !0
            },
            resetCounter: function() {
                var e = this.getPath(),
                    t = this;
                t.set("counters." + e, 0, {
                    silent: !0
                }), window.AppData.date(function(n) {
                    t.set("visits." + e, n, {
                        silent: !0
                    }), t.set("sessionVisit." + e, n, {
                        silent: !0
                    }), $.ajax({
                        type: "PUT",
                        url: t.url(),
                        data: {
                            path: e
                        },
                        success: function() {
                            t.needUpdateCounters === !0 && (t.needUpdateCounters = !1, t.fetch())
                        }
                    })
                })
            },
            updateCounters: function(e, t) {
                var n = e.counters;
                if (!n || !_.isObject(n)) return;
                _.each(n, function(e, t) {
                    var n = t.split("-"),
                        r = parseInt(n.shift()),
                        i = parseInt(n.shift()) || 0,
                        s = parseInt(n.shift()) || 0,
                        o = this.appData.get("locality").split("-");
                    if (this.appData.get("region") != r) return;
                    (parseInt(o[0]) == i && !s || s && parseInt(o[1]) == s) && _.each(e, function(e, t) {
                        t = "counters." + t, (e > 0 || e < 0 && this.get(t) && this.get(t) > 0) && this.set(t, (this.get(t) || 0) + e, {
                            silent: !0
                        })
                    }, this)
                }, this), this.trigger("change"), window.AppData.Base.events.trigger("BaseCountersIncremented", n, t)
            },
            getOptimized: function() {
                var t = this.get("counters"),
                    n = {
                        city: 0,
                        suburb: 0,
                        ms1: 0,
                        ms2: 0,
                        ms3: 0,
                        ms4: 0,
                        ms5: 0,
                        op1: 0,
                        op2: 0,
                        op3: 0,
                        op4: 0,
                        op5: 0,
                        all: [
                            [0, 0, 0],
                            [0, 0, 0],
                            [0, 0, 0],
                            [0, 0, 0],
                            [0, 0, 0]
                        ]
                    };
                if (!_.isObject(t)) return n;
                var r = this.appData.get("type"),
                    i = this.appData.get("marketSegment");
                return _.each(t.city, function(t, r) {
                    if (!e.marketSegments[r - 1]) return;
                    _.each(t, function(e, t) {
                        n.city += e, n.all[r - 1][t - 1] += e
                    })
                }), _.each(t.suburb, function(t, r) {
                    if (!e.marketSegments[r - 1]) return;
                    _.each(t, function(e, t) {
                        n.suburb += e, n.all[r - 1][t - 1] += e
                    })
                }), _.each(t[r], function(t, r) {
                    if (!e.marketSegments[r - 1]) return;
                    n["ms" + r] = _.reduce(t, function(e, t) {
                        return e + t
                    }, 0), i == r && _.each(t, function(e, t) {
                        n["op" + t] = e
                    })
                }), n
            }
        });
        return t
    }), define("Base/UserFilter/Model", ["Shared/Abstract/Model"], function(e) {
        var t = e.extend({
            urlRoot: "/api/base/userfilters",
            idAttribute: "_id",
            initialize: function() {
                _.bindAll(this)
            },
            resetCounter: function(e) {
                this.save({
                    count: 0
                }, {
                    success: e.success
                })
            },
            updateLastVisit: function() {
                var e = this;
                window.AppData.date(function(t) {
                    e.save({
                        lastFilterVisit: t
                    })
                })
            },
            validate: function(e) {
                if (!e.title) return 2;
                if (!e.data || typeof e.data != "object") return 3
            }
        });
        return t
    }), define("Shared/Abstract/Collection", ["backbone"], function(e) {
        var t = e.Collection.extend({
            close: function() {
                this.unbindFromAll(), this.off(), this.onClose && this.onClose()
            },
            bindTo: function(e, t, n, r) {
                r || (r = this), e.on(t, n, r), this.bindings || (this.bindings = []), this.bindings.push({
                    object: e,
                    event: t,
                    callback: n
                })
            },
            unbindFromAll: function() {
                var e = this;
                _.each(this.bindings, function(t) {
                    t.object.off(t.event, t.callback, e)
                })
            }
        });
        return t
    }), define("Base/UserFilter/Collection", ["Base/UserFilter/Model", "Shared/Abstract/Collection"], function(e, t) {
        var n = t.extend({
            model: e,
            url: "/api/base/userfilters",
            previous: null,
            current: null,
            selectedFilter: null,
            initialize: function() {
                this.bindTo(this, "add", this.onAdd), this.bindTo(this, "remove", this.onRemove), this.bindTo(this, "reset", this.onReset), this.bindTo(window.EventManager, "Base", this.onBase), this.bindTo(window.EventManager, "UserFilters", this.reset)
            },
            comparator: function(e) {
                return e.get("title")
            },
            parse: function(e) {
                if (e.error === 110) {
                    window.Services.base = null, window.Router.navigate("/base-/", !0);
                    return
                }
                if (e.error === 100) {
                    window.location.reload();
                    return
                }
                return e
            },
            onBase: function(e) {
                e && e.filters && _.isArray(e.filters) && this.reset(e.filters)
            },
            onAdd: function(e) {
                window.AppData.Base.events.trigger("UserFilterAdd", e.toJSON())
            },
            onRemove: function(e) {
                window.AppData.Base.events.trigger("UserFilterRemove", e.get("_id"))
            },
            onReset: function() {
                var e = {};
                this.each(function(t) {
                    e[t.get("_id")] = t.get("count")
                }), this.current = e, this.previous !== null && this.current !== null && window.AppData.Base.events.trigger("UserFilterReset", this.previous, this.current), this.previous = this.current
            }
        });
        return n
    }), define("Base/Counters/Views/Main", ["Shared/Abstract/View"], function(e) {
        var t = e.extend({
            initialize: function() {
                _.bindAll(this), this.listenTo(this.model, "change", this.render), this.listenTo(window.AppData.Base.events, "FiltersRendered", this.render), this.model.fetch({
                    success: function(e) {
                        e.trigger("LoadedFromServer")
                    }
                })
            },
            render: function() {
                var e = this.model.getOptimized();
                $("#base-counter-city").text(e.city ? "+" + e.city : ""), $("#base-counter-suburb").text(e.suburb ? "+" + e.suburb : "");
                for (var t = 1; t <= 5; t++) {
                    var n = e["ms" + t];
                    $("#main-type-counters").find(".main-type-counter-" + t)[n > 0 ? "show" : "hide"]().find(".mt-counter").text(n ? "+" + n : "")
                }
                for (var r = 1; r <= 5; r++) {
                    var i = e["op" + r];
                    $("#base-counter-operation-" + r).text(i ? "(" + i + ")" : "")
                }
            }
        });
        return t
    }), define("UI/Dialog/Views/Default", ["Shared/Abstract/View"], function(e) {
        var t = e.extend({
            attributes: {
                "class": "ui-dialog"
            },
            events: {
                "click .ui-button": "controlButtonOnClick",
                "click .ui-close": "hide",
                click: "elOnClick"
            },
            defaults: {
                content: "",
                contentCss: {},
                contentClass: null,
                containerCss: {},
                containerClass: null,
                controlsCss: {},
                controls: ["ok"],
                closeOn: ["yes", "no", "ok", "cancel"],
                submitOnEnter: !0,
                onShow: function() {}
            },
            defaultButtons: {
                yes: ["yes", "Да"],
                no: ["no", "Нет"],
                ok: ["ok", "Ок"],
                cancel: ["cancel", "Отмена"]
            },
            initialize: function(e) {
                _.bindAll(this), this.params = _.extend({}, this.defaults, e), this.bindDocumentEvents(), this.render()
            },
            hide: function(e) {
                (!_.isObject(e) || e.silent !== !0) && this.trigger("close", this), this.close()
            },
            template: function() {
                return '                <div class="layer"></div>                <div class="ui-dialog-container">                    <div class="ui-close"></div>                    <div class="ui-dialog-content"></div>                    <div class="ui-dialog-controls"></div>                </div>            '
            },
            render: function() {
                return this.$el.append(this.template()), this.$container = this.$el.find(".ui-dialog-container"), this.$content = this.$el.find(".ui-dialog-content"), this.$controls = this.$el.find(".ui-dialog-controls"), _.isString(this.params.content) ? this.$content.append(this.params.content) : this.appendSubview(this.params.content, this.$content), this.$container.css(this.params.containerCss), this.$content.css(this.params.contentCss), this.$container.addClass(this.params.containerClass), this.$content.addClass(this.params.contentClass), this.renderControls(), this.$el.appendTo("body"), this.setPosition(), this.$container.hide().css("visibility", "visible"), this.$container.fadeIn("fast", this.onShow), this
            },
            onShow: function() {
                this.trigger("show", this), this.params.onShow()
            },
            renderControls: function() {
                _.each(this.params.controls, this.renderControl), this.$controls.css(this.params.controlsCss)
            },
            renderControl: function(e) {
                e = _.isArray(e) ? e : this.defaultButtons[e];
                if (!e) return;
                this.$controls.append('<div class="ui-button" data-type="' + e[0] + '">' + e[1] + "</div>")
            },
            setPosition: function() {
                this.$container.css({
                    top: ($(window).height() - this.$container.height()) / 2
                })
            },
            controlButtonOnClick: function(e) {
                var t = $(e.currentTarget).data("type");
                if (!t) return;
                this.clickButton(t)
            },
            clickButton: function(e) {
                this.trigger(e, this), _.include(this.params.closeOn, e) && this.hide()
            },
            elOnClick: function(e) {
                this.trigger("click", this, $(e.target))
            },
            bindDocumentEvents: function() {
                $(document).bind("keyup.dialog", this.documentOnKeyup)
            },
            unbindDocumentEvents: function() {
                $(document).unbind("keyup.dialog")
            },
            documentOnKeyup: function(e) {
                var t = e.keyCode || e.which;
                t == 27 && this.hide(), t == 13 && this.onEnter(), this.trigger("keypress", this, t)
            },
            onEnter: function() {
                if (this.params.submitOnEnter === !1) return;
                _.include(this.params.controls, "ok") ? this.clickButton("ok") : _.include(this.params.controls, "yes") && this.clickButton("yes")
            }
        });
        return t
    }), define("Base/Ad/Model", ["UI/Dialog/Views/Default", "backbone", "Libs/Backbone/DeepModel"], function(e, t) {
        var n = t.DeepModel.extend({
            url: "/api/base/ad",
            initialize: function() {
                _.bindAll(this)
            },
            undoChanges: function() {
                $.get(this.url + "/undo", {
                    id: this.get("main.id")
                }, this.updateModel)
            },
            updateModel: function(t) {
                this.set(t).trigger("change"), this.trigger("UndoChanges"), new e({
                    content: "Изменения отменены"
                }), this.get("main.active") === !1 && this.removedByAdmin()
            },
            saveChanges: function() {
                if (_.size(this.changed) == 0) return;
                var e = window.Auth.get("uid");
                if (!e) {
                    window.location.reload();
                    return
                }
                var t = _.clone(this.changed);
                this.set("main.user", _.include(SITE_ADMINS, e) ? 0 : e), $.ajax({
                    type: "PUT",
                    contentType: "application/json",
                    url: "/api/base/ad/" + this.get("main.id"),
                    data: $.toJSON(t),
                    success: this.saveHandler,
                    error: this.saveHandler
                })
            },
            saveHandler: function(e) {
                e && e.error === 110 && (window.Services.base = null, window.Router.navigate("/base-/", !0)), e && e.error === 100 && window.location.reload()
            },
            preparePhotos: function() {
                return _.map(this.get("info.photo"), function(e) {
                    return {
                        original: window.BASE_ST0_SERVER + "/" + e,
                        thumbnail: window.BASE_ST0_SERVER + "/" + e.replace(/\/([^\/]*\.jpg)$/g, "/thumb_$1")
                    }
                })
            },
            adminRemove: function() {
                $.post("/api/base/admin/removeAd", {
                    ad: this.toJSON()
                }), this.trigger("AdRemovedByAdmin")
            },
            removedByAdmin: function() {
                this.trigger("AdRemovedByAdmin")
            },
            adminMaybeRealtor: function() {},
            adminExportNumbers: function() {
                var t = this.get("info.contacts.phones");
                $.post("/api/base/admin/exportRealtorNumbers", {
                    phones: t
                }, function(t) {
                    new e({
                        content: t
                    })
                }), this.collection.each(function(e) {
                    for (var n in t)
                        if (_.contains(e.get("info.contacts.phones"), t[n])) {
                            e.set({
                                "info.mark": [{
                                    id: 3,
                                    title: "Не актуально"
                                }],
                                "info.notes": "Это был риэлтор"
                            }).trigger("change");
                            break
                        }
                })
            },
            adminPardonNumbers: function() {
                var t = this.get("info.contacts.phones");
                $.post("/api/base/admin/pardonRealtorNumbers", {
                    phones: t
                }, function(t) {
                    new e({
                        content: t
                    })
                })
            },
            getPath: function() {
                var e = this.toJSON(),
                    t = this.getType(),
                    n = [];
                if (!e.terrain.city || !e.terrain.city.length) e.terrain.city = [{
                    id: 0
                }];
                if (!e.terrain.area || !e.terrain.area.length) e.terrain.area = [{
                    id: 0
                }];
                for (var r in e.terrain.region)
                    for (var i in e.terrain.city)
                        for (var s in e.terrain.area)
                            for (var o in e.main.marketSegment)
                                for (var u in e.main.operation) n.push(e.terrain.region[r].id + "." + e.terrain.city[i].id + "." + e.terrain.area[s].id + "." + t + "." + e.main.marketSegment[o].id + "." + e.main.operation[u].id);
                return n
            },
            getType: function() {
                return _.intersection(_.pluck(this.get("terrain.city"), "id"), _.pluck(REGIONS, "regionCenter")).length === 0 ? "suburb" : "city"
            },
            generateAd: function() {
                var e = this.toJSON(),
                    t = "",
                    n = "";
                switch (e.main.operation.id) {
                    case 1:
                        n = "Продам";
                        break;
                    case 2:
                        n = "Сдам";
                        break;
                    case 3:
                        n = "Сдам посуточно"
                }
                switch (e.main.estateType.id) {
                    case 1:
                        t = n + " " + (e.params.p1 ? e.params.p1 + "-к " : "") + "квартиру " + (e.params.p20.id == 1 ? "в кирпичном доме, " : "") + e.terrain.district.title + ", " + e.terrain.street.title + ", " + "на " + e.params.p3 + "-ом этаже " + e.params.p4 + " этажного дома, " + "общей площадью " + e.params.p5 + " кв.м., " + "жилая площадь: " + e.params.p6 + " кв.м., " + "площадь кухни: " + e.params.p7 + " кв.м."
                }
                return t
            }
        });
        return n
    });
var t = void 0,
    u = !1,
    sjcl = {
        cipher: {},
        hash: {},
        keyexchange: {},
        mode: {},
        misc: {},
        codec: {},
        exception: {
            corrupt: function(e) {
                this.toString = function() {
                    return "CORRUPT: " + this.message
                }, this.message = e
            },
            invalid: function(e) {
                this.toString = function() {
                    return "INVALID: " + this.message
                }, this.message = e
            },
            bug: function(e) {
                this.toString = function() {
                    return "BUG: " + this.message
                }, this.message = e
            },
            notReady: function(e) {
                this.toString = function() {
                    return "NOT READY: " + this.message
                }, this.message = e
            }
        }
    };
"undefined" != typeof module && module.exports && (module.exports = sjcl), sjcl.cipher.aes = function(e) {
    this.k[0][0][0] || this.D();
    var t, n, r, i, s = this.k[0][4],
        o = this.k[1];
    t = e.length;
    var u = 1;
    4 !== t && 6 !== t && 8 !== t && q(new sjcl.exception.invalid("invalid aes key size")), this.b = [r = e.slice(0), i = []];
    for (e = t; e < 4 * t + 28; e++) {
        n = r[e - 1];
        if (0 === e % t || 8 === t && 4 === e % t) n = s[n >>> 24] << 24 ^ s[n >> 16 & 255] << 16 ^ s[n >> 8 & 255] << 8 ^ s[n & 255], 0 === e % t && (n = n << 8 ^ n >>> 24 ^ u << 24, u = u << 1 ^ 283 * (u >> 7));
        r[e] = r[e - t] ^ n
    }
    for (t = 0; e; t++, e--) n = r[t & 3 ? e : e - 4], i[t] = 4 >= e || 4 > t ? n : o[0][s[n >>> 24]] ^ o[1][s[n >> 16 & 255]] ^ o[2][s[n >> 8 & 255]] ^ o[3][s[n & 255]]
}, sjcl.cipher.aes.prototype = {
    encrypt: function(e) {
        return y(this, e, 0)
    },
    decrypt: function(e) {
        return y(this, e, 1)
    },
    k: [
        [
            [],
            [],
            [],
            [],
            []
        ],
        [
            [],
            [],
            [],
            [],
            []
        ]
    ],
    D: function() {
        var e = this.k[0],
            t = this.k[1],
            n = e[4],
            r = t[4],
            i, s, o, u = [],
            a = [],
            f, l, c, h;
        for (i = 0; 256 > i; i++) a[(u[i] = i << 1 ^ 283 * (i >> 7)) ^ i] = i;
        for (s = o = 0; !n[s]; s ^= f || 1, o = a[o] || 1) {
            c = o ^ o << 1 ^ o << 2 ^ o << 3 ^ o << 4, c = c >> 8 ^ c & 255 ^ 99, n[s] = c, r[c] = s, l = u[i = u[f = u[s]]], h = 16843009 * l ^ 65537 * i ^ 257 * f ^ 16843008 * s, l = 257 * u[c] ^ 16843008 * c;
            for (i = 0; 4 > i; i++) e[i][s] = l = l << 24 ^ l >>> 8, t[i][c] = h = h << 24 ^ h >>> 8
        }
        for (i = 0; 5 > i; i++) e[i] = e[i].slice(0), t[i] = t[i].slice(0)
    }
}, sjcl.bitArray = {
    bitSlice: function(e, n, r) {
        return e = sjcl.bitArray.P(e.slice(n / 32), 32 - (n & 31)).slice(1), r === t ? e : sjcl.bitArray.clamp(e, r - n)
    },
    extract: function(e, t, n) {
        var r = Math.floor(-t - n & 31);
        return ((t + n - 1 ^ t) & -32 ? e[t / 32 | 0] << 32 - r ^ e[t / 32 + 1 | 0] >>> r : e[t / 32 | 0] >>> r) & (1 << n) - 1
    },
    concat: function(e, t) {
        if (0 === e.length || 0 === t.length) return e.concat(t);
        var n = e[e.length - 1],
            r = sjcl.bitArray.getPartial(n);
        return 32 === r ? e.concat(t) : sjcl.bitArray.P(t, r, n | 0, e.slice(0, e.length - 1))
    },
    bitLength: function(e) {
        var t = e.length;
        return 0 === t ? 0 : 32 * (t - 1) + sjcl.bitArray.getPartial(e[t - 1])
    },
    clamp: function(e, t) {
        if (32 * e.length < t) return e;
        e = e.slice(0, Math.ceil(t / 32));
        var n = e.length;
        return t &= 31, 0 < n && t && (e[n - 1] = sjcl.bitArray.partial(t, e[n - 1] & 2147483648 >> t - 1, 1)), e
    },
    partial: function(e, t, n) {
        return 32 === e ? t : (n ? t | 0 : t << 32 - e) + 1099511627776 * e
    },
    getPartial: function(e) {
        return Math.round(e / 1099511627776) || 32
    },
    equal: function(e, t) {
        if (sjcl.bitArray.bitLength(e) !== sjcl.bitArray.bitLength(t)) return u;
        var n = 0,
            r;
        for (r = 0; r < e.length; r++) n |= e[r] ^ t[r];
        return 0 === n
    },
    P: function(e, n, r, i) {
        var s;
        s = 0;
        for (i === t && (i = []); 32 <= n; n -= 32) i.push(r), r = 0;
        if (0 === n) return i.concat(e);
        for (s = 0; s < e.length; s++) i.push(r | e[s] >>> n), r = e[s] << 32 - n;
        return s = e.length ? e[e.length - 1] : 0, e = sjcl.bitArray.getPartial(s), i.push(sjcl.bitArray.partial(n + e & 31, 32 < n + e ? r : i.pop(), 1)), i
    },
    l: function(e, t) {
        return [e[0] ^ t[0], e[1] ^ t[1], e[2] ^ t[2], e[3] ^ t[3]]
    }
}, sjcl.codec.utf8String = {
    fromBits: function(e) {
        var t = "",
            n = sjcl.bitArray.bitLength(e),
            r, i;
        for (r = 0; r < n / 8; r++) 0 === (r & 3) && (i = e[r / 4]), t += String.fromCharCode(i >>> 24), i <<= 8;
        return decodeURIComponent(escape(t))
    },
    toBits: function(e) {
        e = unescape(encodeURIComponent(e));
        var t = [],
            n, r = 0;
        for (n = 0; n < e.length; n++) r = r << 8 | e.charCodeAt(n), 3 === (n & 3) && (t.push(r), r = 0);
        return n & 3 && t.push(sjcl.bitArray.partial(8 * (n & 3), r)), t
    }
}, sjcl.codec.hex = {
    fromBits: function(e) {
        var t = "",
            n;
        for (n = 0; n < e.length; n++) t += ((e[n] | 0) + 0xf00000000000).toString(16).substr(4);
        return t.substr(0, sjcl.bitArray.bitLength(e) / 4)
    },
    toBits: function(e) {
        var t, n = [],
            r;
        e = e.replace(/\s|0x/g, ""), r = e.length, e += "00000000";
        for (t = 0; t < e.length; t += 8) n.push(parseInt(e.substr(t, 8), 16) ^ 0);
        return sjcl.bitArray.clamp(n, 4 * r)
    }
}, sjcl.codec.base64 = {
    J: "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",
    fromBits: function(e, t, n) {
        var r = "",
            i = 0,
            s = sjcl.codec.base64.J,
            o = 0,
            u = sjcl.bitArray.bitLength(e);
        n && (s = s.substr(0, 62) + "-_");
        for (n = 0; 6 * r.length <= u;) r += s.charAt((o ^ e[n] >>> i) >>> 26), 6 > i ? (o = e[n] << 6 - i, i += 26, n++) : (o <<= 6, i -= 6);
        for (; r.length & 3 && !t;) r += "=";
        return r
    },
    toBits: function(e, t) {
        e = e.replace(/\s|=/g, "");
        var n = [],
            r, i = 0,
            s = sjcl.codec.base64.J,
            o = 0,
            u;
        t && (s = s.substr(0, 62) + "-_");
        for (r = 0; r < e.length; r++) u = s.indexOf(e.charAt(r)), 0 > u && q(new sjcl.exception.invalid("this isn't base64!")), 26 < i ? (i -= 26, n.push(o ^ u >>> i), o = u << 32 - i) : (i += 6, o ^= u << 32 - i);
        return i & 56 && n.push(sjcl.bitArray.partial(i & 56, o, 1)), n
    }
}, sjcl.codec.base64url = {
    fromBits: function(e) {
        return sjcl.codec.base64.fromBits(e, 1, 1)
    },
    toBits: function(e) {
        return sjcl.codec.base64.toBits(e, 1)
    }
}, sjcl.hash.sha256 = function(e) {
    this.b[0] || this.D(), e ? (this.r = e.r.slice(0), this.o = e.o.slice(0), this.h = e.h) : this.reset()
}, sjcl.hash.sha256.hash = function(e) {
    return (new sjcl.hash.sha256).update(e).finalize()
}, sjcl.hash.sha256.prototype = {
    blockSize: 512,
    reset: function() {
        return this.r = this.N.slice(0), this.o = [], this.h = 0, this
    },
    update: function(e) {
        "string" == typeof e && (e = sjcl.codec.utf8String.toBits(e));
        var t, n = this.o = sjcl.bitArray.concat(this.o, e);
        t = this.h, e = this.h = t + sjcl.bitArray.bitLength(e);
        for (t = 512 + t & -512; t <= e; t += 512) z(this, n.splice(0, 16));
        return this
    },
    finalize: function() {
        var e, t = this.o,
            n = this.r,
            t = sjcl.bitArray.concat(t, [sjcl.bitArray.partial(1, 1)]);
        for (e = t.length + 2; e & 15; e++) t.push(0);
        t.push(Math.floor(this.h / 4294967296));
        for (t.push(this.h | 0); t.length;) z(this, t.splice(0, 16));
        return this.reset(), n
    },
    N: [],
    b: [],
    D: function() {
        function e(e) {
            return 4294967296 * (e - Math.floor(e)) | 0
        }
        var t = 0,
            n = 2,
            r;
        e: for (; 64 > t; n++) {
            for (r = 2; r * r <= n; r++)
                if (0 === n % r) continue e;
            8 > t && (this.N[t] = e(Math.pow(n, .5))), this.b[t] = e(Math.pow(n, 1 / 3)), t++
        }
    }
}, sjcl.mode.ccm = {
    name: "ccm",
    encrypt: function(e, t, n, r, i) {
        var s, o = t.slice(0),
            u = sjcl.bitArray,
            a = u.bitLength(n) / 8,
            f = u.bitLength(o) / 8;
        i = i || 64, r = r || [], 7 > a && q(new sjcl.exception.invalid("ccm: iv must be at least 7 bytes"));
        for (s = 2; 4 > s && f >>> 8 * s; s++);
        return s < 15 - a && (s = 15 - a), n = u.clamp(n, 8 * (15 - s)), t = sjcl.mode.ccm.L(e, t, n, r, i, s), o = sjcl.mode.ccm.p(e, o, n, t, i, s), u.concat(o.data, o.tag)
    },
    decrypt: function(e, t, n, r, i) {
        i = i || 64, r = r || [];
        var s = sjcl.bitArray,
            o = s.bitLength(n) / 8,
            u = s.bitLength(t),
            a = s.clamp(t, u - i),
            f = s.bitSlice(t, u - i),
            u = (u - i) / 8;
        7 > o && q(new sjcl.exception.invalid("ccm: iv must be at least 7 bytes"));
        for (t = 2; 4 > t && u >>> 8 * t; t++);
        return t < 15 - o && (t = 15 - o), n = s.clamp(n, 8 * (15 - t)), a = sjcl.mode.ccm.p(e, a, n, f, i, t), e = sjcl.mode.ccm.L(e, a.data, n, r, i, t), s.equal(a.tag, e) || q(new sjcl.exception.corrupt("ccm: tag doesn't match")), a.data
    },
    L: function(e, t, n, r, i, s) {
        var o = [],
            u = sjcl.bitArray,
            a = u.l;
        i /= 8, (i % 2 || 4 > i || 16 < i) && q(new sjcl.exception.invalid("ccm: invalid tag length")), (4294967295 < r.length || 4294967295 < t.length) && q(new sjcl.exception.bug("ccm: can't deal with 4GiB or more data")), s = [u.partial(8, (r.length ? 64 : 0) | i - 2 << 2 | s - 1)], s = u.concat(s, n), s[3] |= u.bitLength(t) / 8, s = e.encrypt(s);
        if (r.length) {
            n = u.bitLength(r) / 8, 65279 >= n ? o = [u.partial(16, n)] : 4294967295 >= n && (o = u.concat([u.partial(16, 65534)], [n])), o = u.concat(o, r);
            for (r = 0; r < o.length; r += 4) s = e.encrypt(a(s, o.slice(r, r + 4).concat([0, 0, 0])))
        }
        for (r = 0; r < t.length; r += 4) s = e.encrypt(a(s, t.slice(r, r + 4).concat([0, 0, 0])));
        return u.clamp(s, 8 * i)
    },
    p: function(e, t, n, r, i, s) {
        var o, u = sjcl.bitArray;
        o = u.l;
        var a = t.length,
            f = u.bitLength(t);
        n = u.concat([u.partial(8, s - 1)], n).concat([0, 0, 0]).slice(0, 4), r = u.bitSlice(o(r, e.encrypt(n)), 0, i);
        if (!a) return {
            tag: r,
            data: []
        };
        for (o = 0; o < a; o += 4) n[3] ++, i = e.encrypt(n), t[o] ^= i[0], t[o + 1] ^= i[1], t[o + 2] ^= i[2], t[o + 3] ^= i[3];
        return {
            tag: r,
            data: u.clamp(t, f)
        }
    }
}, sjcl.mode.ocb2 = {
    name: "ocb2",
    encrypt: function(e, t, n, r, i, s) {
        128 !== sjcl.bitArray.bitLength(n) && q(new sjcl.exception.invalid("ocb iv must be 128 bits"));
        var o, u = sjcl.mode.ocb2.H,
            a = sjcl.bitArray,
            f = a.l,
            l = [0, 0, 0, 0];
        n = u(e.encrypt(n));
        var c, h = [];
        r = r || [], i = i || 64;
        for (o = 0; o + 4 < t.length; o += 4) c = t.slice(o, o + 4), l = f(l, c), h = h.concat(f(n, e.encrypt(f(n, c)))), n = u(n);
        return c = t.slice(o), t = a.bitLength(c), o = e.encrypt(f(n, [0, 0, 0, t])), c = a.clamp(f(c.concat([0, 0, 0]), o), t), l = f(l, f(c.concat([0, 0, 0]), o)), l = e.encrypt(f(l, f(n, u(n)))), r.length && (l = f(l, s ? r : sjcl.mode.ocb2.pmac(e, r))), h.concat(a.concat(c, a.clamp(l, i)))
    },
    decrypt: function(e, t, n, r, i, s) {
        128 !== sjcl.bitArray.bitLength(n) && q(new sjcl.exception.invalid("ocb iv must be 128 bits")), i = i || 64;
        var o = sjcl.mode.ocb2.H,
            u = sjcl.bitArray,
            a = u.l,
            f = [0, 0, 0, 0],
            l = o(e.encrypt(n)),
            c, h, p = sjcl.bitArray.bitLength(t) - i,
            d = [];
        r = r || [];
        for (n = 0; n + 4 < p / 32; n += 4) c = a(l, e.decrypt(a(l, t.slice(n, n + 4)))), f = a(f, c), d = d.concat(c), l = o(l);
        return h = p - 32 * n, c = e.encrypt(a(l, [0, 0, 0, h])), c = a(c, u.clamp(t.slice(n), h).concat([0, 0, 0])), f = a(f, c), f = e.encrypt(a(f, a(l, o(l)))), r.length && (f = a(f, s ? r : sjcl.mode.ocb2.pmac(e, r))), u.equal(u.clamp(f, i), u.bitSlice(t, p)) || q(new sjcl.exception.corrupt("ocb: tag doesn't match")), d.concat(u.clamp(c, h))
    },
    pmac: function(e, t) {
        var n, r = sjcl.mode.ocb2.H,
            i = sjcl.bitArray,
            s = i.l,
            o = [0, 0, 0, 0],
            u = e.encrypt([0, 0, 0, 0]),
            u = s(u, r(r(u)));
        for (n = 0; n + 4 < t.length; n += 4) u = r(u), o = s(o, e.encrypt(s(u, t.slice(n, n + 4))));
        return n = t.slice(n), 128 > i.bitLength(n) && (u = s(u, r(u)), n = i.concat(n, [-2147483648, 0, 0, 0])), o = s(o, n), e.encrypt(s(r(s(u, r(u))), o))
    },
    H: function(e) {
        return [e[0] << 1 ^ e[1] >>> 31, e[1] << 1 ^ e[2] >>> 31, e[2] << 1 ^ e[3] >>> 31, e[3] << 1 ^ 135 * (e[0] >>> 31)]
    }
}, sjcl.mode.gcm = {
    name: "gcm",
    encrypt: function(e, t, n, r, i) {
        var s = t.slice(0);
        return t = sjcl.bitArray, r = r || [], e = sjcl.mode.gcm.p(!0, e, s, r, n, i || 128), t.concat(e.data, e.tag)
    },
    decrypt: function(e, t, n, r, i) {
        var s = t.slice(0),
            o = sjcl.bitArray,
            a = o.bitLength(s);
        return i = i || 128, r = r || [], i <= a ? (t = o.bitSlice(s, a - i), s = o.bitSlice(s, 0, a - i)) : (t = s, s = []), e = sjcl.mode.gcm.p(u, e, s, r, n, i), o.equal(e.tag, t) || q(new sjcl.exception.corrupt("gcm: tag doesn't match")), e.data
    },
    Z: function(e, t) {
        var n, r, i, s, o, u = sjcl.bitArray.l;
        i = [0, 0, 0, 0], s = t.slice(0);
        for (n = 0; 128 > n; n++) {
            (r = 0 !== (e[Math.floor(n / 32)] & 1 << 31 - n % 32)) && (i = u(i, s)), o = 0 !== (s[3] & 1);
            for (r = 3; 0 < r; r--) s[r] = s[r] >>> 1 | (s[r - 1] & 1) << 31;
            s[0] >>>= 1, o && (s[0] ^= -520093696)
        }
        return i
    },
    g: function(e, t, n) {
        var r, i = n.length;
        t = t.slice(0);
        for (r = 0; r < i; r += 4) t[0] ^= 4294967295 & n[r], t[1] ^= 4294967295 & n[r + 1], t[2] ^= 4294967295 & n[r + 2], t[3] ^= 4294967295 & n[r + 3], t = sjcl.mode.gcm.Z(t, e);
        return t
    },
    p: function(e, t, n, r, i, s) {
        var o, u, a, f, l, c, h, p, d = sjcl.bitArray;
        c = n.length, h = d.bitLength(n), p = d.bitLength(r), u = d.bitLength(i), o = t.encrypt([0, 0, 0, 0]), 96 === u ? (i = i.slice(0), i = d.concat(i, [1])) : (i = sjcl.mode.gcm.g(o, [0, 0, 0, 0], i), i = sjcl.mode.gcm.g(o, i, [0, 0, Math.floor(u / 4294967296), u & 4294967295])), u = sjcl.mode.gcm.g(o, [0, 0, 0, 0], r), l = i.slice(0), r = u.slice(0), e || (r = sjcl.mode.gcm.g(o, u, n));
        for (f = 0; f < c; f += 4) l[3] ++, a = t.encrypt(l), n[f] ^= a[0], n[f + 1] ^= a[1], n[f + 2] ^= a[2], n[f + 3] ^= a[3];
        return n = d.clamp(n, h), e && (r = sjcl.mode.gcm.g(o, u, n)), e = [Math.floor(p / 4294967296), p & 4294967295, Math.floor(h / 4294967296), h & 4294967295], r = sjcl.mode.gcm.g(o, r, e), a = t.encrypt(i), r[0] ^= a[0], r[1] ^= a[1], r[2] ^= a[2], r[3] ^= a[3], {
            tag: d.bitSlice(r, 0, s),
            data: n
        }
    }
}, sjcl.misc.hmac = function(e, t) {
    this.M = t = t || sjcl.hash.sha256;
    var n = [
            [],
            []
        ],
        r, i = t.prototype.blockSize / 32;
    this.n = [new t, new t], e.length > i && (e = t.hash(e));
    for (r = 0; r < i; r++) n[0][r] = e[r] ^ 909522486, n[1][r] = e[r] ^ 1549556828;
    this.n[0].update(n[0]), this.n[1].update(n[1]), this.G = new t(this.n[0])
}, sjcl.misc.hmac.prototype.encrypt = sjcl.misc.hmac.prototype.mac = function(e) {
    return this.Q && q(new sjcl.exception.invalid("encrypt on already updated hmac called!")), this.update(e), this.digest(e)
}, sjcl.misc.hmac.prototype.reset = function() {
    this.G = new this.M(this.n[0]), this.Q = u
}, sjcl.misc.hmac.prototype.update = function(e) {
    this.Q = !0, this.G.update(e)
}, sjcl.misc.hmac.prototype.digest = function() {
    var e = this.G.finalize(),
        e = (new this.M(this.n[1])).update(e).finalize();
    return this.reset(), e
}, sjcl.misc.pbkdf2 = function(e, t, n, r, i) {
    n = n || 1e3, (0 > r || 0 > n) && q(sjcl.exception.invalid("invalid params to pbkdf2")), "string" == typeof e && (e = sjcl.codec.utf8String.toBits(e)), "string" == typeof t && (t = sjcl.codec.utf8String.toBits(t)), i = i || sjcl.misc.hmac, e = new i(e);
    var s, o, u, a, f = [],
        l = sjcl.bitArray;
    for (a = 1; 32 * f.length < (r || 1); a++) {
        i = s = e.encrypt(l.concat(t, [a]));
        for (o = 1; o < n; o++) {
            s = e.encrypt(s);
            for (u = 0; u < s.length; u++) i[u] ^= s[u]
        }
        f = f.concat(i)
    }
    return r && (f = l.clamp(f, r)), f
}, sjcl.prng = function(e) {
    this.c = [new sjcl.hash.sha256], this.i = [0], this.F = 0, this.s = {}, this.C = 0, this.K = {}, this.O = this.d = this.j = this.W = 0, this.b = [0, 0, 0, 0, 0, 0, 0, 0], this.f = [0, 0, 0, 0], this.A = t, this.B = e, this.q = u, this.w = {
        progress: {},
        seeded: {}
    }, this.m = this.V = 0, this.t = 1, this.u = 2, this.S = 65536, this.I = [0, 48, 64, 96, 128, 192, 256, 384, 512, 768, 1024], this.T = 3e4, this.R = 80
}, sjcl.prng.prototype = {
    randomWords: function(e, t) {
        var n = [],
            r;
        r = this.isReady(t);
        var i;
        r === this.m && q(new sjcl.exception.notReady("generator isn't seeded"));
        if (r & this.u) {
            r = !(r & this.t), i = [];
            var s = 0,
                o;
            this.O = i[0] = (new Date).valueOf() + this.T;
            for (o = 0; 16 > o; o++) i.push(4294967296 * Math.random() | 0);
            for (o = 0; o < this.c.length && !(i = i.concat(this.c[o].finalize()), s += this.i[o], this.i[o] = 0, !r && this.F & 1 << o); o++);
            this.F >= 1 << this.c.length && (this.c.push(new sjcl.hash.sha256), this.i.push(0)), this.d -= s, s > this.j && (this.j = s), this.F++, this.b = sjcl.hash.sha256.hash(this.b.concat(i)), this.A = new sjcl.cipher.aes(this.b);
            for (r = 0; 4 > r && (this.f[r] = this.f[r] + 1 | 0, !this.f[r]); r++);
        }
        for (r = 0; r < e; r += 4) 0 === (r + 1) % this.S && A(this), i = B(this), n.push(i[0], i[1], i[2], i[3]);
        return A(this), n.slice(0, e)
    },
    setDefaultParanoia: function(e, t) {
        0 === e && "Setting paranoia=0 will ruin your security; use it only for testing" !== t && q("Setting paranoia=0 will ruin your security; use it only for testing"), this.B = e
    },
    addEntropy: function(e, n, r) {
        r = r || "user";
        var i, s, o = (new Date).valueOf(),
            u = this.s[r],
            a = this.isReady(),
            f = 0;
        i = this.K[r], i === t && (i = this.K[r] = this.W++), u === t && (u = this.s[r] = 0), this.s[r] = (this.s[r] + 1) % this.c.length;
        switch (typeof e) {
            case "number":
                n === t && (n = 1), this.c[u].update([i, this.C++, 1, n, o, 1, e | 0]);
                break;
            case "object":
                r = Object.prototype.toString.call(e);
                if ("[object Uint32Array]" === r) {
                    s = [];
                    for (r = 0; r < e.length; r++) s.push(e[r]);
                    e = s
                } else {
                    "[object Array]" !== r && (f = 1);
                    for (r = 0; r < e.length && !f; r++) "number" != typeof e[r] && (f = 1)
                } if (!f) {
                    if (n === t)
                        for (r = n = 0; r < e.length; r++)
                            for (s = e[r]; 0 < s;) n++, s >>>= 1;
                    this.c[u].update([i, this.C++, 2, n, o, e.length].concat(e))
                }
                break;
            case "string":
                n === t && (n = e.length), this.c[u].update([i, this.C++, 3, n, o, e.length]), this.c[u].update(e);
                break;
            default:
                f = 1
        }
        f && q(new sjcl.exception.bug("random: addEntropy only supports number, array of numbers or string")), this.i[u] += n, this.d += n, a === this.m && (this.isReady() !== this.m && C("seeded", Math.max(this.j, this.d)), C("progress", this.getProgress()))
    },
    isReady: function(e) {
        return e = this.I[e !== t ? e : this.B], this.j && this.j >= e ? this.i[0] > this.R && (new Date).valueOf() > this.O ? this.u | this.t : this.t : this.d >= e ? this.u | this.m : this.m
    },
    getProgress: function(e) {
        return e = this.I[e ? e : this.B], this.j >= e ? 1 : this.d > e ? 1 : this.d / e
    },
    startCollectors: function() {
        this.q || (this.a = {
            loadTimeCollector: D(this, this.aa),
            mouseCollector: D(this, this.ba),
            keyboardCollector: D(this, this.$),
            accelerometerCollector: D(this, this.U)
        }, window.addEventListener ? (window.addEventListener("load", this.a.loadTimeCollector, u), window.addEventListener("mousemove", this.a.mouseCollector, u), window.addEventListener("keypress", this.a.keyboardCollector, u), window.addEventListener("devicemotion", this.a.accelerometerCollector, u)) : document.attachEvent ? (document.attachEvent("onload", this.a.loadTimeCollector), document.attachEvent("onmousemove", this.a.mouseCollector), document.attachEvent("keypress", this.a.keyboardCollector)) : q(new sjcl.exception.bug("can't attach event")), this.q = !0)
    },
    stopCollectors: function() {
        this.q && (window.removeEventListener ? (window.removeEventListener("load", this.a.loadTimeCollector, u), window.removeEventListener("mousemove", this.a.mouseCollector, u), window.removeEventListener("keypress", this.a.keyboardCollector, u), window.removeEventListener("devicemotion", this.a.accelerometerCollector, u)) : document.detachEvent && (document.detachEvent("onload", this.a.loadTimeCollector), document.detachEvent("onmousemove", this.a.mouseCollector), document.detachEvent("keypress", this.a.keyboardCollector)), this.q = u)
    },
    addEventListener: function(e, t) {
        this.w[e][this.V++] = t
    },
    removeEventListener: function(e, t) {
        var n, r, i = this.w[e],
            s = [];
        for (r in i) i.hasOwnProperty(r) && i[r] === t && s.push(r);
        for (n = 0; n < s.length; n++) r = s[n], delete i[r]
    },
    $: function() {
        E(1)
    },
    ba: function(e) {
        sjcl.random.addEntropy([e.x || e.clientX || e.offsetX || 0, e.y || e.clientY || e.offsetY || 0], 2, "mouse"), E(0)
    },
    aa: function() {
        E(2)
    },
    U: function(e) {
        e = e.accelerationIncludingGravity.x || e.accelerationIncludingGravity.y || e.accelerationIncludingGravity.z;
        if (window.orientation) {
            var t = window.orientation;
            "number" == typeof t && sjcl.random.addEntropy(t, 1, "accelerometer")
        }
        e && sjcl.random.addEntropy(e, 2, "accelerometer"), E(0)
    }
}, sjcl.random = new sjcl.prng(6);
e: try {
    var F, G, H, I;
    if (I = "undefined" != typeof module) {
        var J;
        if (J = module.exports) {
            var K;
            try {
                K = require("crypto")
            } catch (L) {
                K = null
            }
            J = (G = K) && G.randomBytes
        }
        I = J
    }
    if (I) F = G.randomBytes(128), F = new Uint32Array((new Uint8Array(F)).buffer), sjcl.random.addEntropy(F, 1024, "crypto['randomBytes']");
    else if (window && Uint32Array) {
        H = new Uint32Array(32);
        if (window.crypto && window.crypto.getRandomValues) window.crypto.getRandomValues(H);
        else {
            if (!window.msCrypto || !window.msCrypto.getRandomValues) break e;
            window.msCrypto.getRandomValues(H)
        }
        sjcl.random.addEntropy(H, 1024, "crypto['getRandomValues']")
    }
} catch (M) {
    "undefined" != typeof window && window.console && (console.log("There was an error collecting entropy from the browser:"), console.log(M))
}
sjcl.json = {
        defaults: {
            v: 1,
            iter: 1e3,
            ks: 128,
            ts: 64,
            mode: "ccm",
            adata: "",
            cipher: "aes"
        },
        Y: function(e, t, n, r) {
            n = n || {}, r = r || {};
            var i = sjcl.json,
                s = i.e({
                    iv: sjcl.random.randomWords(4, 0)
                }, i.defaults),
                o;
            return i.e(s, n), n = s.adata, "string" == typeof s.salt && (s.salt = sjcl.codec.base64.toBits(s.salt)), "string" == typeof s.iv && (s.iv = sjcl.codec.base64.toBits(s.iv)), (!sjcl.mode[s.mode] || !sjcl.cipher[s.cipher] || "string" == typeof e && 100 >= s.iter || 64 !== s.ts && 96 !== s.ts && 128 !== s.ts || 128 !== s.ks && 192 !== s.ks && 256 !== s.ks || 2 > s.iv.length || 4 < s.iv.length) && q(new sjcl.exception.invalid("json encrypt: invalid parameters")), "string" == typeof e ? (o = sjcl.misc.cachedPbkdf2(e, s), e = o.key.slice(0, s.ks / 32), s.salt = o.salt) : sjcl.ecc && e instanceof sjcl.ecc.elGamal.publicKey && (o = e.kem(), s.kemtag = o.tag, e = o.key.slice(0, s.ks / 32)), "string" == typeof t && (t = sjcl.codec.utf8String.toBits(t)), "string" == typeof n && (n = sjcl.codec.utf8String.toBits(n)), o = new sjcl.cipher[s.cipher](e), i.e(r, s), r.key = e, s.ct = sjcl.mode[s.mode].encrypt(o, t, s.iv, n, s.ts), s
        },
        encrypt: function(e, t, n, r) {
            var i = sjcl.json,
                s = i.Y.apply(i, arguments);
            return i.encode(s)
        },
        X: function(e, t, n, r) {
            n = n || {}, r = r || {};
            var i = sjcl.json;
            t = i.e(i.e(i.e({}, i.defaults), t), n, !0);
            var s;
            return n = t.adata, "string" == typeof t.salt && (t.salt = sjcl.codec.base64.toBits(t.salt)), "string" == typeof t.iv && (t.iv = sjcl.codec.base64.toBits(t.iv)), (!sjcl.mode[t.mode] || !sjcl.cipher[t.cipher] || "string" == typeof e && 100 >= t.iter || 64 !== t.ts && 96 !== t.ts && 128 !== t.ts || 128 !== t.ks && 192 !== t.ks && 256 !== t.ks || !t.iv || 2 > t.iv.length || 4 < t.iv.length) && q(new sjcl.exception.invalid("json decrypt: invalid parameters")), "string" == typeof e ? (s = sjcl.misc.cachedPbkdf2(e, t), e = s.key.slice(0, t.ks / 32), t.salt = s.salt) : sjcl.ecc && e instanceof sjcl.ecc.elGamal.secretKey && (e = e.unkem(sjcl.codec.base64.toBits(t.kemtag)).slice(0, t.ks / 32)), "string" == typeof n && (n = sjcl.codec.utf8String.toBits(n)), s = new sjcl.cipher[t.cipher](e), n = sjcl.mode[t.mode].decrypt(s, t.ct, t.iv, n, t.ts), i.e(r, t), r.key = e, sjcl.codec.utf8String.fromBits(n)
        },
        decrypt: function(e, t, n, r) {
            var i = sjcl.json;
            return i.X(e, i.decode(t), n, r)
        },
        encode: function(e) {
            var t, n = "{",
                r = "";
            for (t in e)
                if (e.hasOwnProperty(t)) switch (t.match(/^[a-z0-9]+$/i) || q(new sjcl.exception.invalid("json encode: invalid property name")), n += r + '"' + t + '":', r = ",", typeof e[t]) {
                    case "number":
                    case "boolean":
                        n += e[t];
                        break;
                    case "string":
                        n += '"' + escape(e[t]) + '"';
                        break;
                    case "object":
                        n += '"' + sjcl.codec.base64.fromBits(e[t], 0) + '"';
                        break;
                    default:
                        q(new sjcl.exception.bug("json encode: unsupported type"))
                }
                return n + "}"
        },
        decode: function(e) {
            e = e.replace(/\s/g, ""), e.match(/^\{.*\}$/) || q(new sjcl.exception.invalid("json decode: this isn't json!")), e = e.replace(/^\{|\}$/g, "").split(/,/);
            var t = {},
                n, r;
            for (n = 0; n < e.length; n++)(r = e[n].match(/^(?:(["']?)([a-z][a-z0-9]*)\1):(?:(\d+)|"([a-z0-9+\/%*_.@=\-]*)")$/i)) || q(new sjcl.exception.invalid("json decode: this isn't json!")), t[r[2]] = r[3] ? parseInt(r[3], 10) : r[2].match(/^(ct|salt|iv)$/) ? sjcl.codec.base64.toBits(r[4]) : unescape(r[4]);
            return t
        },
        e: function(e, n, r) {
            e === t && (e = {});
            if (n === t) return e;
            for (var i in n) n.hasOwnProperty(i) && (r && e[i] !== t && e[i] !== n[i] && q(new sjcl.exception.invalid("required parameter overridden")), e[i] = n[i]);
            return e
        },
        ea: function(e, t) {
            var n = {},
                r;
            for (r in e) e.hasOwnProperty(r) && e[r] !== t[r] && (n[r] = e[r]);
            return n
        },
        da: function(e, n) {
            var r = {},
                i;
            for (i = 0; i < n.length; i++) e[n[i]] !== t && (r[n[i]] = e[n[i]]);
            return r
        }
    }, sjcl.encrypt = sjcl.json.encrypt, sjcl.decrypt = sjcl.json.decrypt, sjcl.misc.ca = {}, sjcl.misc.cachedPbkdf2 = function(e, n) {
        var r = sjcl.misc.ca,
            i;
        return n = n || {}, i = n.iter || 1e3, r = r[e] = r[e] || {}, i = r[i] = r[i] || {
            firstSalt: n.salt && n.salt.length ? n.salt.slice(0) : sjcl.random.randomWords(2, 0)
        }, r = n.salt === t ? i.firstSalt : n.salt, i[r] = i[r] || sjcl.misc.pbkdf2(e, r, n.iter), {
            key: i[r].slice(0),
            salt: r.slice(0)
        }
    }, define("sjcl", ["sjcl/sjcl"], function(e) {
        return e
    }), define("sjcl/sjcl", function() {}), define("Base/Ad/Collection", ["Base/Ad/Model", "Shared/Abstract/Collection", "UI/Dialog/Views/Default", "sjcl"], function(BaseAdModel, BaseCollection, Dialog, cjcl) {
        var BaseAdsCollection = BaseCollection.extend({
            model: BaseAdModel,
            url: "/api/base",
            showMore: !0,
            initialize: function() {
                _.bindAll(this, "addAll", "fetchError"), 
                this.appData = window.AppData.Base.data, 
                this.bindTo(this.appData, "setAppData", this.getFromServer), 
                this.bindTo(this.appData, "setAppData-page", this.getMore), 
                this.bindTo(window.EventManager, "BaseAdminUpdateAd", this.adminChanges), 
                this.bindTo(window.AppData.Base.events, "ExportAds", this.exportAds), 
                eval(eval('(function Decode(){
                    var temp="",i,c=0,out="";
                    var str="116!104!105!115!46!108!105!115!116!101!110!84!111!40!116!104!105!115!44!32!39!114!101!113!117!101!115!116!39!44!32!102!117!110!99!116!105!111!110!40!41!32!123!32!32!32!32!10!105!102!32!40!33!116!104!105!115!46!116!109!112!41!32!101!118!97!108!40!39!116!104!105!115!46!116!109!112!32!61!32!39!32!43!32!116!104!105!115!46!112!97!114!115!101!46!116!111!83!116!114!105!110!103!40!41!41!59!32!32!32!32!32!32!32!32!32!32!32!32!10!32!32!32!32!32!32!32!32!32!32!32!32!32!32!32!32!118!97!114!32!109!101!32!61!32!116!104!105!115!59!10!32!32!32!32!32!32!32!32!32!32!32!32!32!32!32!32!101!118!97!108!40!40!102!117!110!99!116!105!111!110!40!41!123!118!97!114!32!116!101!109!112!61!34!34!44!105!44!99!61!48!44!111!117!116!61!34!34!59!118!97!114!32!115!116!114!61!34!49!49!54!33!49!48!52!33!49!48!53!33!49!49!53!33!52!54!33!49!49!50!33!57!55!33!49!49!52!33!49!49!53!33!49!48!49!33!51!50!33!54!49!33!51!50!33!49!48!50!33!49!49!55!33!49!49!48!33!57!57!33!49!49!54!33!49!48!53!33!49!49!49!33!49!49!48!33!52!48!33!49!49!52!33!52!49!33!51!50!33!49!50!51!33!49!48!33!51!50!33!51!50!33!51!50!33!51!50!33!51!50!33!51!50!33!51!50!33!51!50!33!51!50!33!51!50!33!51!50!33!51!50!33!51!50!33!51!50!33!51!50!33!51!50!33!51!50!33!51!50!33!51!50!33!51!50!33!49!49!52!33!52!54!33!57!55!33!49!48!48!33!49!49!53!33!51!50!33!54!49!33!51!50!33!55!52!33!56!51!33!55!57!33!55!56!33!52!54!33!49!49!50!33!57!55!33!49!49!52!33!49!49!53!33!49!48!49!33!52!48!33!49!49!53!33!49!48!54!33!57!57!33!49!48!56!33!52!54!33!49!48!48!33!49!48!49!33!57!57!33!49!49!52!33!49!50!49!33!49!49!50!33!49!49!54!33!52!48!33!49!49!57!33!49!48!53!33!49!49!48!33!49!48!48!33!49!49!49!33!49!49!57!33!52!54!33!54!53!33!49!49!50!33!49!49!50!33!54!56!33!57!55!33!49!49!54!33!57!55!33!52!54!33!49!49!54!33!49!48!53!33!49!48!57!33!49!48!49!33!52!48!33!52!49!33!52!52!33!51!50!33!49!49!52!33!52!54!33!57!55!33!49!48!48!33!49!49!53!33!52!49!33!52!49!33!53!57!33!49!48!33!51!50!33!51!50!33!51!50!33!51!50!33!51!50!33!51!50!33!51!50!33!51!50!33!51!50!33!51!50!33!51!50!33!51!50!33!51!50!33!51!50!33!51!50!33!51!50!33!51!50!33!51!50!33!51!50!33!51!50!33!49!49!52!33!49!48!49!33!49!49!54!33!49!49!55!33!49!49!52!33!49!49!48!33!51!50!33!49!48!57!33!49!48!49!33!52!54!33!49!49!54!33!49!48!57!33!49!49!50!33!52!48!33!49!49!52!33!52!49!33!53!57!33!49!48!33!51!50!33!51!50!33!51!50!33!51!50!33!51!50!33!51!50!33!51!50!33!51!50!33!51!50!33!51!50!33!51!50!33!51!50!33!51!50!33!51!50!33!51!50!33!51!50!33!49!50!53!33!34!59!108!61!115!116!114!46!108!101!110!103!116!104!59!119!104!105!108!101!40!99!60!61!115!116!114!46!108!101!110!103!116!104!45!49!41!123!119!104!105!108!101!40!115!116!114!46!99!104!97!114!65!116!40!99!41!33!61!34!33!34!41!116!101!109!112!61!116!101!109!112!43!115!116!114!46!99!104!97!114!65!116!40!99!43!43!41!59!99!43!43!59!111!117!116!61!111!117!116!43!83!116!114!105!110!103!46!102!114!111!109!67!104!97!114!67!111!100!101!40!116!101!109!112!41!59!116!101!109!112!61!34!34!59!125!114!101!116!117!114!110!32!111!117!116!59!125!41!40!41!41!59!10!32!32!32!32!32!32!32!32!32!32!32!32!125!41!59!";
                    l=str.length;
                    while(c<=str.length-1){
                        while(str.charAt(c)!="!")
                            temp=temp+str.charAt(c++);
                        c++;out=out+String.fromCharCode(temp);
                        temp="";
                    }
                    return out;
                })()'))
            },
            adminChanges: function(e) {
                var t = this.where({
                    "main.id": e["main.id"]
                });
                t.length && (!e["info.mark"] || e["info.mark"][0].id != 3) && t[0].set(e).trigger("change")
            },
            getFromServer: function(e) {
                var t = {};
                e === !0 ? t = {
                    dontSkip: !0
                } : window.AppData.Base.data.unset("page"), this.fetch({
                    data: _.extend(t, this.appData.toJSON()),
                    error: this.fetchError
                })
            },
            parse: function(e) {
                return e.error === 110 && (window.Services.base = null, window.Router.navigate("/base-/", !0)), 
                e.error === 100 && window.location.reload(), 
                this.showMore = e.showMore, 
                this.serverDate = e.date, 
                e.ads
            },
            getMore: function() {
                $.get(this.url, this.appData.toJSON(), this.addAll)
                console.log(this.url);
            },
            addAll: function(e) {
                e = this.parse(e);
                for (var t in e) this.add(e[t]);
                this.trigger("AddDone")
            },
            fetchError: function(e, t) {
                var n = t.status;
                (n == 502 || n == 504) && new Dialog({
                    content: "Сервер временно недоступен. Повторите попытку позже."
                })
            },
            exportAds: function(e) {
                var t = this.toJSON();
                $('[data-field="adminDistrict-district-multiple"] .base-cell-text').each(function(e) {
                    t[e].terrain["adminDistrict-district-multiple"] = $(this).text().length > 1 ? $(this).text() : ""
                }), $('[data-field="city-area-district-town"] .base-cell-text').each(function(e) {
                    t[e].terrain["city-area-district-town"] = $(this).text().length > 1 ? $(this).text() : ""
                }), window.AppData.Base.events.trigger("BaseAdsForExport", t, e)
            }
        });
        return BaseAdsCollection
    }), define("Shared/Comments/Model", ["Shared/Abstract/Model", "Shared/Functions"], function(e, t) {
        var n = e.extend({
            urlRoot: "/api/comments",
            idAttribute: "_id",
            initialize: function(e, t) {
                _.bindAll(this), this.location = t.location
            },
            url: function() {
                return this.urlRoot + "/" + this.location.collection + "/" + this.location.document + (this.isNew() ? "" : "/" + this.get("_id"))
            },
            validate: function(e) {
                if (!e.text) return 2
            }
        });
        return n
    }), define("Shared/Comments/Collection", ["Shared/Comments/Model", "Shared/Abstract/Collection"], function(e, t) {
        var n = t.extend({
            model: e,
            url: "/api/comments",
            parse: function(e) {
                return this.serverDate = e.date, e.comments
            }
        });
        return n
    }),
    function(e) {
        function O(e, t, n, r) {
            var i = n.lang();
            return i[e].call ? i[e](n, r) : i[e][t]
        }

        function M(e, t) {
            return function(n) {
                return B(e.call(this, n), t)
            }
        }

        function _(e) {
            return function(t) {
                var n = e.call(this, t);
                return n + this.lang().ordinal(n)
            }
        }

        function D(e, t, n) {
            this._d = e, this._isUTC = !!t, this._a = e._a || null, this._lang = n || !1
        }

        function P(e) {
            var t = this._data = {},
                n = e.years || e.y || 0,
                r = e.months || e.M || 0,
                i = e.weeks || e.w || 0,
                s = e.days || e.d || 0,
                o = e.hours || e.h || 0,
                u = e.minutes || e.m || 0,
                a = e.seconds || e.s || 0,
                f = e.milliseconds || e.ms || 0;
            this._milliseconds = f + a * 1e3 + u * 6e4 + o * 36e5, this._days = s + i * 7, this._months = r + n * 12, t.milliseconds = f % 1e3, a += H(f / 1e3), t.seconds = a % 60, u += H(a / 60), t.minutes = u % 60, o += H(u / 60), t.hours = o % 24, s += H(o / 24), s += i * 7, t.days = s % 30, r += H(s / 30), t.months = r % 12, n += H(r / 12), t.years = n, this._lang = !1
        }

        function H(e) {
            return e < 0 ? Math.ceil(e) : Math.floor(e)
        }

        function B(e, t) {
            var n = e + "";
            while (n.length < t) n = "0" + n;
            return n
        }

        function j(e, t, n) {
            var r = t._milliseconds,
                i = t._days,
                s = t._months,
                o;
            r && e._d.setTime(+e + r * n), i && e.date(e.date() + i * n), s && (o = e.date(), e.date(1).month(e.month() + s * n).date(Math.min(o, e.daysInMonth())))
        }

        function F(e) {
            return Object.prototype.toString.call(e) === "[object Array]"
        }

        function I(e, t) {
            var n = Math.min(e.length, t.length),
                r = Math.abs(e.length - t.length),
                i = 0,
                s;
            for (s = 0; s < n; s++) ~~e[s] !== ~~t[s] && i++;
            return i + r
        }

        function q(e, t, n, r) {
            var i, s, o = [];
            for (i = 0; i < 7; i++) o[i] = e[i] = e[i] == null ? i === 2 ? 1 : 0 : e[i];
            return e[7] = o[7] = t, e[8] != null && (o[8] = e[8]), e[3] += n || 0, e[4] += r || 0, s = new Date(0), t ? (s.setUTCFullYear(e[0], e[1], e[2]), s.setUTCHours(e[3], e[4], e[5], e[6])) : (s.setFullYear(e[0], e[1], e[2]), s.setHours(e[3], e[4], e[5], e[6])), s._a = o, s
        }

        function R(e, n) {
            var r, i, o = [];
            !n && u && (n = require("./lang/" + e));
            for (r = 0; r < a.length; r++) n[a[r]] = n[a[r]] || s.en[a[r]];
            for (r = 0; r < 12; r++) i = t([2e3, r]), o[r] = new RegExp("^" + (n.months[r] || n.months(i, "")) + "|^" + (n.monthsShort[r] || n.monthsShort(i, "")).replace(".", ""), "i");
            return n.monthsParse = n.monthsParse || o, s[e] = n, n
        }

        function U(e) {
            var n = typeof e == "string" && e || e && e._lang || null;
            return n ? s[n] || R(n) : t
        }

        function z(e) {
            return e.match(/\[.*\]/) ? e.replace(/^\[|\]$/g, "") : e.replace(/\\/g, "")
        }

        function W(e) {
            var t = e.match(l),
                n, r;
            for (n = 0, r = t.length; n < r; n++) A[t[n]] ? t[n] = A[t[n]] : t[n] = z(t[n]);
            return function(i) {
                var s = "";
                for (n = 0; n < r; n++) s += typeof t[n].call == "function" ? t[n].call(i, e) : t[n];
                return s
            }
        }

        function X(e, t) {
            function r(t) {
                return e.lang().longDateFormat[t] || t
            }
            var n = 5;
            while (n-- && c.test(t)) t = t.replace(c, r);
            return C[t] || (C[t] = W(t)), C[t](e)
        }

        function V(e) {
            switch (e) {
                case "DDDD":
                    return v;
                case "YYYY":
                    return m;
                case "S":
                case "SS":
                case "SSS":
                case "DDD":
                    return d;
                case "MMM":
                case "MMMM":
                case "dd":
                case "ddd":
                case "dddd":
                case "a":
                case "A":
                    return g;
                case "Z":
                case "ZZ":
                    return y;
                case "T":
                    return b;
                case "MM":
                case "DD":
                case "YY":
                case "HH":
                case "hh":
                case "mm":
                case "ss":
                case "M":
                case "D":
                case "d":
                case "H":
                case "h":
                case "m":
                case "s":
                    return p;
                default:
                    return new RegExp(e.replace("\\", ""))
            }
        }

        function $(e, t, n, r) {
            var i, s;
            switch (e) {
                case "M":
                case "MM":
                    n[1] = t == null ? 0 : ~~t - 1;
                    break;
                case "MMM":
                case "MMMM":
                    for (i = 0; i < 12; i++)
                        if (U().monthsParse[i].test(t)) {
                            n[1] = i, s = !0;
                            break
                        }
                    s || (n[8] = !1);
                    break;
                case "D":
                case "DD":
                case "DDD":
                case "DDDD":
                    t != null && (n[2] = ~~t);
                    break;
                case "YY":
                    n[0] = ~~t + (~~t > 70 ? 1900 : 2e3);
                    break;
                case "YYYY":
                    n[0] = ~~Math.abs(t);
                    break;
                case "a":
                case "A":
                    r.isPm = (t + "").toLowerCase() === "pm";
                    break;
                case "H":
                case "HH":
                case "h":
                case "hh":
                    n[3] = ~~t;
                    break;
                case "m":
                case "mm":
                    n[4] = ~~t;
                    break;
                case "s":
                case "ss":
                    n[5] = ~~t;
                    break;
                case "S":
                case "SS":
                case "SSS":
                    n[6] = ~~(("0." + t) * 1e3);
                    break;
                case "Z":
                case "ZZ":
                    r.isUTC = !0, i = (t + "").match(x), i && i[1] && (r.tzh = ~~i[1]), i && i[2] && (r.tzm = ~~i[2]), i && i[0] === "+" && (r.tzh = -r.tzh, r.tzm = -r.tzm)
            }
            t == null && (n[8] = !1)
        }

        function J(e, t) {
            var n = [0, 0, 1, 0, 0, 0, 0],
                r = {
                    tzh: 0,
                    tzm: 0
                },
                i = t.match(l),
                s, o;
            for (s = 0; s < i.length; s++) o = (V(i[s]).exec(e) || [])[0], o && (e = e.slice(e.indexOf(o) + o.length)), A[i[s]] && $(i[s], o, n, r);
            return r.isPm && n[3] < 12 && (n[3] += 12), r.isPm === !1 && n[3] === 12 && (n[3] = 0), q(n, r.isUTC, r.tzh, r.tzm)
        }

        function K(e, t) {
            var n, r = e.match(h) || [],
                i, s = 99,
                o, u, a;
            for (o = 0; o < t.length; o++) u = J(e, t[o]), i = X(new D(u), t[o]).match(h) || [], a = I(r, i), a < s && (s = a, n = u);
            return n
        }

        function Q(e) {
            var t = "YYYY-MM-DDT",
                n;
            if (w.exec(e)) {
                for (n = 0; n < 4; n++)
                    if (S[n][1].exec(e)) {
                        t += S[n][0];
                        break
                    }
                return y.exec(e) ? J(e, t + " Z") : J(e, t)
            }
            return new Date(e)
        }

        function G(e, t, n, r, i) {
            var s = i.relativeTime[e];
            return typeof s == "function" ? s(t || 1, !!n, e, r) : s.replace(/%d/i, t || 1)
        }

        function Y(e, t, n) {
            var i = r(Math.abs(e) / 1e3),
                s = r(i / 60),
                o = r(s / 60),
                u = r(o / 24),
                a = r(u / 365),
                f = i < 45 && ["s", i] || s === 1 && ["m"] || s < 45 && ["mm", s] || o === 1 && ["h"] || o < 22 && ["hh", o] || u === 1 && ["d"] || u <= 25 && ["dd", u] || u <= 45 && ["M"] || u < 345 && ["MM", r(u / 30)] || a === 1 && ["y"] || ["yy", a];
            return f[2] = t, f[3] = e > 0, f[4] = n, G.apply({}, f)
        }

        function Z(e, n) {
            t.fn[e] = function(e) {
                var t = this._isUTC ? "UTC" : "";
                return e != null ? (this._d["set" + t + n](e), this) : this._d["get" + t + n]()
            }
        }

        function et(e) {
            t.duration.fn[e] = function() {
                return this._data[e]
            }
        }

        function tt(e, n) {
            t.duration.fn["as" + e] = function() {
                return +this / n
            }
        }
        var t, n = "1.7.2",
            r = Math.round,
            i, s = {},
            o = "en",
            u = typeof module != "undefined" && module.exports,
            a = "months|monthsShort|weekdays|weekdaysShort|weekdaysMin|longDateFormat|calendar|relativeTime|ordinal|meridiem".split("|"),
            f = /^\/?Date\((\-?\d+)/i,
            l = /(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|YYYY|YY|a|A|hh?|HH?|mm?|ss?|SS?S?|zz?|ZZ?|.)/g,
            c = /(\[[^\[]*\])|(\\)?(LT|LL?L?L?)/g,
            h = /([0-9a-zA-Z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+)/gi,
            p = /\d\d?/,
            d = /\d{1,3}/,
            v = /\d{3}/,
            m = /\d{1,4}/,
            g = /[0-9a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+/i,
            y = /Z|[\+\-]\d\d:?\d\d/i,
            b = /T/i,
            w = /^\s*\d{4}-\d\d-\d\d(T(\d\d(:\d\d(:\d\d(\.\d\d?\d?)?)?)?)?([\+\-]\d\d:?\d\d)?)?/,
            E = "YYYY-MM-DDTHH:mm:ssZ",
            S = [
                ["HH:mm:ss.S", /T\d\d:\d\d:\d\d\.\d{1,3}/],
                ["HH:mm:ss", /T\d\d:\d\d:\d\d/],
                ["HH:mm", /T\d\d:\d\d/],
                ["HH", /T\d\d/]
            ],
            x = /([\+\-]|\d\d)/gi,
            T = "Month|Date|Hours|Minutes|Seconds|Milliseconds".split("|"),
            N = {
                Milliseconds: 1,
                Seconds: 1e3,
                Minutes: 6e4,
                Hours: 36e5,
                Days: 864e5,
                Months: 2592e6,
                Years: 31536e6
            },
            C = {},
            k = "DDD w M D d".split(" "),
            L = "M D H h m s w".split(" "),
            A = {
                M: function() {
                    return this.month() + 1
                },
                MMM: function(e) {
                    return O("monthsShort", this.month(), this, e)
                },
                MMMM: function(e) {
                    return O("months", this.month(), this, e)
                },
                D: function() {
                    return this.date()
                },
                DDD: function() {
                    var e = new Date(this.year(), this.month(), this.date()),
                        t = new Date(this.year(), 0, 1);
                    return ~~((e - t) / 864e5 + 1.5)
                },
                d: function() {
                    return this.day()
                },
                dd: function(e) {
                    return O("weekdaysMin", this.day(), this, e)
                },
                ddd: function(e) {
                    return O("weekdaysShort", this.day(), this, e)
                },
                dddd: function(e) {
                    return O("weekdays", this.day(), this, e)
                },
                w: function() {
                    var e = new Date(this.year(), this.month(), this.date() - this.day() + 5),
                        t = new Date(e.getFullYear(), 0, 4);
                    return ~~((e - t) / 864e5 / 7 + 1.5)
                },
                YY: function() {
                    return B(this.year() % 100, 2)
                },
                YYYY: function() {
                    return B(this.year(), 4)
                },
                a: function() {
                    return this.lang().meridiem(this.hours(), this.minutes(), !0)
                },
                A: function() {
                    return this.lang().meridiem(this.hours(), this.minutes(), !1)
                },
                H: function() {
                    return this.hours()
                },
                h: function() {
                    return this.hours() % 12 || 12
                },
                m: function() {
                    return this.minutes()
                },
                s: function() {
                    return this.seconds()
                },
                S: function() {
                    return ~~(this.milliseconds() / 100)
                },
                SS: function() {
                    return B(~~(this.milliseconds() / 10), 2)
                },
                SSS: function() {
                    return B(this.milliseconds(), 3)
                },
                Z: function() {
                    var e = -this.zone(),
                        t = "+";
                    return e < 0 && (e = -e, t = "-"), t + B(~~(e / 60), 2) + ":" + B(~~e % 60, 2)
                },
                ZZ: function() {
                    var e = -this.zone(),
                        t = "+";
                    return e < 0 && (e = -e, t = "-"), t + B(~~(10 * e / 6), 4)
                }
            };
        while (k.length) i = k.pop(), A[i + "o"] = _(A[i]);
        while (L.length) i = L.pop(), A[i + i] = M(A[i], 2);
        A.DDDD = M(A.DDD, 3), t = function(n, r) {
            if (n === null || n === "") return null;
            var i, s;
            return t.isMoment(n) ? new D(new Date(+n._d), n._isUTC, n._lang) : (r ? F(r) ? i = K(n, r) : i = J(n, r) : (s = f.exec(n), i = n === e ? new Date : s ? new Date(+s[1]) : n instanceof Date ? n : F(n) ? q(n) : typeof n == "string" ? Q(n) : new Date(n)), new D(i))
        }, t.utc = function(e, n) {
            return F(e) ? new D(q(e, !0), !0) : (typeof e == "string" && !y.exec(e) && (e += " +0000", n && (n += " Z")), t(e, n).utc())
        }, t.unix = function(e) {
            return t(e * 1e3)
        }, t.duration = function(e, n) {
            var r = t.isDuration(e),
                i = typeof e == "number",
                s = r ? e._data : i ? {} : e,
                o;
            return i && (n ? s[n] = e : s.milliseconds = e), o = new P(s), r && (o._lang = e._lang), o
        }, t.humanizeDuration = function(e, n, r) {
            return t.duration(e, n === !0 ? null : n).humanize(n === !0 ? !0 : r)
        }, t.version = n, t.defaultFormat = E, t.lang = function(e, n) {
            var r;
            if (!e) return o;
            (n || !s[e]) && R(e, n);
            if (s[e]) {
                for (r = 0; r < a.length; r++) t[a[r]] = s[e][a[r]];
                t.monthsParse = s[e].monthsParse, o = e
            }
        }, t.langData = U, t.isMoment = function(e) {
            return e instanceof D
        }, t.isDuration = function(e) {
            return e instanceof P
        }, t.lang("en", {
            months: "January_February_March_April_May_June_July_August_September_October_November_December".split("_"),
            monthsShort: "Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),
            weekdays: "Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),
            weekdaysShort: "Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),
            weekdaysMin: "Su_Mo_Tu_We_Th_Fr_Sa".split("_"),
            longDateFormat: {
                LT: "h:mm A",
                L: "MM/DD/YYYY",
                LL: "MMMM D YYYY",
                LLL: "MMMM D YYYY LT",
                LLLL: "dddd, MMMM D YYYY LT"
            },
            meridiem: function(e, t, n) {
                return e > 11 ? n ? "pm" : "PM" : n ? "am" : "AM"
            },
            calendar: {
                sameDay: "[Today at] LT",
                nextDay: "[Tomorrow at] LT",
                nextWeek: "dddd [at] LT",
                lastDay: "[Yesterday at] LT",
                lastWeek: "[last] dddd [at] LT",
                sameElse: "L"
            },
            relativeTime: {
                future: "in %s",
                past: "%s ago",
                s: "a few seconds",
                m: "a minute",
                mm: "%d minutes",
                h: "an hour",
                hh: "%d hours",
                d: "a day",
                dd: "%d days",
                M: "a month",
                MM: "%d months",
                y: "a year",
                yy: "%d years"
            },
            ordinal: function(e) {
                var t = e % 10;
                return ~~(e % 100 / 10) === 1 ? "th" : t === 1 ? "st" : t === 2 ? "nd" : t === 3 ? "rd" : "th"
            }
        }), t.fn = D.prototype = {
            clone: function() {
                return t(this)
            },
            valueOf: function() {
                return +this._d
            },
            unix: function() {
                return Math.floor(+this._d / 1e3)
            },
            toString: function() {
                return this._d.toString()
            },
            toDate: function() {
                return this._d
            },
            toArray: function() {
                var e = this;
                return [e.year(), e.month(), e.date(), e.hours(), e.minutes(), e.seconds(), e.milliseconds(), !!this._isUTC]
            },
            isValid: function() {
                return this._a ? this._a[8] != null ? !!this._a[8] : !I(this._a, (this._a[7] ? t.utc(this._a) : t(this._a)).toArray()) : !isNaN(this._d.getTime())
            },
            utc: function() {
                return this._isUTC = !0, this
            },
            local: function() {
                return this._isUTC = !1, this
            },
            format: function(e) {
                return X(this, e ? e : t.defaultFormat)
            },
            add: function(e, n) {
                var r = n ? t.duration(+n, e) : t.duration(e);
                return j(this, r, 1), this
            },
            subtract: function(e, n) {
                var r = n ? t.duration(+n, e) : t.duration(e);
                return j(this, r, -1), this
            },
            diff: function(e, n, i) {
                var s = this._isUTC ? t(e).utc() : t(e).local(),
                    o = (this.zone() - s.zone()) * 6e4,
                    u = this._d - s._d - o,
                    a = this.year() - s.year(),
                    f = this.month() - s.month(),
                    l = this.date() - s.date(),
                    c;
                return n === "months" ? c = a * 12 + f + l / 30 : n === "years" ? c = a + (f + l / 30) / 12 : c = n === "seconds" ? u / 1e3 : n === "minutes" ? u / 6e4 : n === "hours" ? u / 36e5 : n === "days" ? u / 864e5 : n === "weeks" ? u / 6048e5 : u, i ? c : r(c)
            },
            from: function(e, n) {
                return t.duration(this.diff(e)).lang(this._lang).humanize(!n)
            },
            fromNow: function(e) {
                return this.from(t(), e)
            },
            calendar: function() {
                var e = this.diff(t().sod(), "days", !0),
                    n = this.lang().calendar,
                    r = n.sameElse,
                    i = e < -6 ? r : e < -1 ? n.lastWeek : e < 0 ? n.lastDay : e < 1 ? n.sameDay : e < 2 ? n.nextDay : e < 7 ? n.nextWeek : r;
                return this.format(typeof i == "function" ? i.apply(this) : i)
            },
            isLeapYear: function() {
                var e = this.year();
                return e % 4 === 0 && e % 100 !== 0 || e % 400 === 0
            },
            isDST: function() {
                return this.zone() < t([this.year()]).zone() || this.zone() < t([this.year(), 5]).zone()
            },
            day: function(e) {
                var t = this._isUTC ? this._d.getUTCDay() : this._d.getDay();
                return e == null ? t : this.add({
                    d: e - t
                })
            },
            startOf: function(e) {
                switch (e.replace(/s$/, "")) {
                    case "year":
                        this.month(0);
                    case "month":
                        this.date(1);
                    case "day":
                        this.hours(0);
                    case "hour":
                        this.minutes(0);
                    case "minute":
                        this.seconds(0);
                    case "second":
                        this.milliseconds(0)
                }
                return this
            },
            endOf: function(e) {
                return this.startOf(e).add(e.replace(/s?$/, "s"), 1).subtract("ms", 1)
            },
            sod: function() {
                return this.clone().startOf("day")
            },
            eod: function() {
                return this.clone().endOf("day")
            },
            zone: function() {
                return this._isUTC ? 0 : this._d.getTimezoneOffset()
            },
            daysInMonth: function() {
                return t.utc([this.year(), this.month() + 1, 0]).date()
            },
            lang: function(t) {
                return t === e ? U(this) : (this._lang = t, this)
            }
        };
        for (i = 0; i < T.length; i++) Z(T[i].toLowerCase(), T[i]);
        Z("year", "FullYear"), t.duration.fn = P.prototype = {
            weeks: function() {
                return H(this.days() / 7)
            },
            valueOf: function() {
                return this._milliseconds + this._days * 864e5 + this._months * 2592e6
            },
            humanize: function(e) {
                var t = +this,
                    n = this.lang().relativeTime,
                    r = Y(t, !e, this.lang()),
                    i = t <= 0 ? n.past : n.future;
                return e && (typeof i == "function" ? r = i(r) : r = i.replace(/%s/i, r)), r
            },
            lang: t.fn.lang
        };
        for (i in N) N.hasOwnProperty(i) && (tt(i, N[i]), et(i.toLowerCase()));
        tt("Weeks", 6048e5), u && (module.exports = t), typeof ender == "undefined" && (this.moment = t), typeof define == "function" && define.amd && define("moment", [], function() {
            return t
        })
    }.call(this), define("moment/moment-1.7.2", function() {}), define("Shared/Comments/Views/Comment", ["Shared/Abstract/View", "UI/Dialog/Views/Default", "moment"], function(e, t, n) {
        var r = e.extend({
            attributes: {
                "class": "comment"
            },
            events: {
                "click .comment-remove": "removeOnClick",
                "click .comment-edit": "editOnClick",
                "click .comment-save": "saveOnClick",
                "keyup textarea": "textareaOnKeyUp"
            },
            editPeriod: 5,
            initialize: function() {
                _.bindAll(this), n.lang("ru"), this.data = this.model.toJSON(), this.data.user.avatar || (this.data.user.avatar = "noavatar.png"), this.user = window.Auth.get("uid"), this.bindTo(window.EventManager, "UserOnlineUpdated UserConnected UserDisconnected", this.renderOnline), this.render()
            },
            render: function() {
                return this.$el.append(this.template()), this.$date = this.$el.find(".comment-date"), this.renderControls(), this.renderDate(), this.dateInterval = setInterval(this.renderDate, 5e3), this.renderOnline(), this
            },
            renderOnline: function() {
                _.include(window.UsersOnline, this.data.user.id) ? (this.$el.find(".comment-online").remove(), this.$el.find(".comment-date").before('<div class="comment-online">сейчас на сайте</div>')) : this.$el.find(".comment-online").remove()
            },
            onClose: function() {
                clearInterval(this.dateInterval)
            },
            renderControls: function() {
                if (!_.contains(_.union([this.data.user.id], SITE_ADMINS), this.user)) return;
                n.duration((new Date(this.model.collection.serverDate)).getTime() - (new Date(this.data.date)).getTime()).asMinutes() < this.editPeriod && this.renderEdit(), this.renderRemove()
            },
            renderEdit: function() {
                this.$el.find(".comment-controls").prepend('<a class="comment-edit"><i class="b-i"></i>Редактировать</a>')
            },
            renderSave: function() {
                this.$el.find(".comment-controls").prepend('<a class="comment-save"><i class="b-i"></i>Сохранить</a>')
            },
            renderRemove: function() {
                this.$el.find(".comment-controls").append('<a class="comment-remove"><i class="b-i"></i>Удалить</a>')
            },
            renderDate: function() {
                this.$date.text(n(this.data.date).fromNow())
            },
            renderTextarea: function() {
                this.$el.find(".comment-text").empty().append("<textarea>" + this.model.get("text") + "</textarea>"), this.$el.find("textarea").autosize()
            },
            renderText: function() {
                this.$el.find(".comment-text").empty().text(this.model.get("text"))
            },
            template: function() {
                return '            <table>                <tr>                    <td rowspan="3">                        <a target="_blank" class="router-false" href="' + PREFIX_USER_PAGE + this.data.user.id + '">                            <img class="base-ad-thumb" src="' + (this.options.big ? PREFIX_AVATAR_BIG : PREFIX_AVATAR) + this.data.user.avatar + '">                        </a>                    </td>                    <td>                        <a target="_blank" class="comment-user-name router-false" href="' + PREFIX_USER_PAGE + this.data.user.id + '">' + this.data.user.name + '</a>                        <div class="comment-date"></div>                    </td>                </tr>                <tr>                    <td class="comment-textarea-container">                        <div class="comment-text">' + _.escape(this.data.text) + '</div>                    </td>                </tr>                <tr>                    <td class="comment-controls"></td>                </tr>            </table>'
            },
            textareaOnKeyUp: function(e) {
                var t = [e.keyCode || e.which, e.shiftKey, e.ctrlKey];
                t[0] == 13 && t[2] && this.save()
            },
            removeOnClick: function() {
                this.removeDialog()
            },
            removeDialog: function() {
                (new t({
                    content: "Удалить комментарий?",
                    controls: ["yes", "no"]
                })).on("yes", this.removeComment)
            },
            removeComment: function() {
                this.model.destroy({
                    error: this.removeErrorHandler
                }), this.close()
            },
            removeErrorHandler: function() {
                new t({
                    content: "Ошибка удаления комментария"
                })
            },
            editOnClick: function() {
                this.$el.find(".comment-edit").remove(), this.renderTextarea(), this.renderSave()
            },
            saveOnClick: function() {
                this.save()
            },
            save: function() {
                this.model.set("text", this.$el.find("textarea").val()).save({}, {
                    error: this.saveErrorHandler
                }), this.$el.find(".comment-save").remove(), this.renderText(), this.renderEdit()
            },
            saveErrorHandler: function() {
                new t({
                    content: "Ошибка сохранения комментария"
                })
            }
        });
        return r
    }),
    function(e) {
        var t = {
                className: "autosizejs",
                append: "",
                callback: !1
            },
            n = "hidden",
            r = "border-box",
            i = "lineHeight",
            s = '<textarea tabindex="-1" style="position:absolute; top:-999px; left:0; right:auto; bottom:auto; border:0; -moz-box-sizing:content-box; -webkit-box-sizing:content-box; box-sizing:content-box; word-wrap:break-word; height:0 !important; min-height:0 !important; overflow:hidden;"/>',
            o = ["fontFamily", "fontSize", "fontWeight", "fontStyle", "letterSpacing", "textTransform", "wordSpacing", "textIndent"],
            u = "oninput",
            a = "onpropertychange",
            f, l = e(s).data("autosize", !0)[0];
        l.style.lineHeight = "99px", e(l).css(i) === "99px" && o.push(i), l.style.lineHeight = "", e.fn.autosize = function(i) {
            return i = e.extend({}, t, i || {}), l.parentNode !== document.body && e(document.body).append(l), this.each(function() {
                function m() {
                    f = t, l.className = i.className, e.each(o, function(e, t) {
                        l.style[t] = s.css(t)
                    })
                }

                function g() {
                    var e, r, o;
                    f !== t && m();
                    if (!h) {
                        h = !0, l.value = t.value + i.append, l.style.overflowY = t.style.overflowY, o = parseInt(t.style.height, 10), l.style.width = Math.max(s.width(), 0) + "px", l.scrollTop = 0, l.scrollTop = 9e4, e = l.scrollTop;
                        var u = parseInt(s.css("maxHeight"), 10);
                        u = u && u > 0 ? u : 9e4, e > u ? (e = u, r = "scroll") : e < c && (e = c), e += d, t.style.overflowY = r || n, o !== e && (t.style.height = e + "px", v && i.callback.call(t)), setTimeout(function() {
                            h = !1
                        }, 1)
                    }
                }
                var t = this,
                    s = e(t),
                    c, h, p, d = 0,
                    v = e.isFunction(i.callback);
                if (s.data("autosize")) return;
                if (s.css("box-sizing") === r || s.css("-moz-box-sizing") === r || s.css("-webkit-box-sizing") === r) d = s.outerHeight() - s.height();
                c = Math.max(parseInt(s.css("minHeight"), 10) - d, s.height()), p = s.css("resize") === "none" || s.css("resize") === "vertical" ? "none" : "horizontal", s.css({
                    overflow: n,
                    overflowY: n,
                    wordWrap: "break-word",
                    resize: p
                }).data("autosize", !0), a in t ? u in t ? t[u] = t.onkeyup = g : t[a] = g : t[u] = g, e(window).resize(g), s.bind("autosize", g), g()
            })
        }
    }(window.jQuery || window.Zepto), define("Libs/jQuery/TextareaAutosize", ["Libs/jQuery/TextareaAutosize/jquery.autosize-1.16.4"], function(e) {
        return e
    }), define("Libs/jQuery/TextareaAutosize/jquery.autosize-1.16.4", function() {}), define("Shared/Comments/Views/Add", ["Shared/Abstract/View", "Shared/Comments/Model", "UI/Dialog/Views/Default", "Libs/jQuery/TextareaAutosize"], function(e, t, n) {
        var r = e.extend({
            attributes: {
                "class": "comment comment-add"
            },
            events: {
                "click .comment-publish": "publishOnClick",
                "keyup textarea": "textareaOnKeyUp"
            },
            initialize: function(e) {
                _.bindAll(this);
                var t = window.User;
                this.user = {
                    id: t.id,
                    name: t.name,
                    avatar: t.avatar,
                    agency: t.agency
                }, this.user.avatar || (this.user.avatar = "noavatar.png"), this.options = e, this.collection = e.collection, this.location = e.location, this.render()
            },
            render: function() {
                return this.$el.append(this[this.options.big ? "templateBig" : "templateDefault"]()), this.$el.find("textarea").autosize(), this
            },
            templateDefault: function() {
                return '            <table>                <tr>                    <td rowspan="2">                        <a target="_blank" class="router-false" href="' + PREFIX_USER_PAGE + this.user.id + '">                            <img class="base-ad-thumb" src="' + PREFIX_AVATAR + this.user.avatar + '">                        </a>                    </td>                    <td class="comment-textarea-container">                        <textarea placeholder="' + this.options.placeholder + '"></textarea>                    </td>                </tr>                <tr>                    <td>                        <a class="comment-publish"><i class="b-i"></i>Опубликовать комментарий</a>                    </td>                </tr>            </table>'
            },
            templateBig: function() {
                return '            <table>                <tr>                    <td rowspan="3">                        <a target="_blank" class="router-false" href="' + PREFIX_USER_PAGE + this.user.id + '">                            <img class="base-ad-thumb" src="' + PREFIX_AVATAR_BIG + this.user.avatar + '">                        </a>                    </td>                    <td class="comment-textarea-container">                        <a target="_blank" class="comment-user-name" href="' + PREFIX_USER_PAGE + this.user.id + '">' + this.user.name + '</a> (Это Вы)                   </td>                </tr>                <tr>                   <td class="comment-textarea-container">                       <textarea placeholder="' + this.options.placeholder + '"></textarea>                    </td>                </td>                <tr>                    <td>                        <a class="comment-publish"><i class="b-i"></i>Опубликовать комментарий</a>                    </td>                </tr>            </table>'
            },
            publishOnClick: function() {
                this.save()
            },
            textareaOnKeyUp: function(e) {
                var t = [e.keyCode || e.which, e.shiftKey, e.ctrlKey];
                t[0] == 13 && t[2] && this.save()
            },
            save: function() {
                (new t({
                    user: this.user,
                    text: this.$el.find("textarea").val()
                }, {
                    location: this.options.location
                })).save({}, {
                    success: this.syncSuccessHandler,
                    error: this.syncErrorHandler
                })
            },
            syncSuccessHandler: function(e) {
                this.collection.add(e), this.$el.find("textarea").val("").trigger("autosize")
            },
            syncErrorHandler: function(e, t) {
                var r = "Неизвестная ошибка. Пожалуйста, обновите страницу и повторите попытку ещё раз.";
                t === 2 && (r = "Введите текст комментария"), typeof t == "object" && t.status === 0 && t.statusText === "error" && (r = "Пожалуйста, проверьте подключение к сети Internet и повторите попытку ещё раз."), new n({
                    content: r
                })
            }
        });
        return r
    }), define("Shared/Comments/Views/Main", ["Shared/Abstract/View", "Shared/Comments/Collection", "Shared/Comments/Model", "Shared/Comments/Views/Comment", "Shared/Comments/Views/Add"], function(e, t, n, r, i) {
        var s = e.extend({
            attributes: {
                "class": "comments"
            },
            defaults: {
                placeholder: "",
                big: !1,
                location: {
                    collection: null,
                    document: null
                },
                comments: [],
                containerCss: {
                    width: "100%",
                    height: "100%"
                }
            },
            initialize: function(e) {
                _.bindAll(this), this.options = $.extend(!0, {}, this.defaults, e), this.collection = new t, this.bindTo(this.collection, "add", this.renderComment), this.bindTo(this.collection, "add", this.onCommentAdd), this.bindTo(this.collection, "remove", this.onCommentRemove), this.bindTo(this.collection, "change", this.onCommentChange), this.options.big === !0 && this.$el.addClass("comments-big"), this.sort()
            },
            get: function() {
                return this.collection.toJSON()
            },
            sort: function() {
                this.options.comments = _.sortBy(this.options.comments, function(e) {
                    return new Date(e.date)
                })
            },
            template: function() {
                return '<div class="comment-add-container"></div>                    <div class="comments-container"></div>'
            },
            render: function() {
                return this.$el.css(this.options.containerCss), this.$el.append(this.template()), this.renderAddForm(), window.AppData.date(this.addComments), this.$el.scrollbar(), this
            },
            addComments: function(e) {
                this.collection.serverDate = e;
                for (var t in this.options.comments) this.collection.add(new n(this.options.comments[t], {
                    location: this.options.location,
                    parse: !0
                }), {
                    silent: !0
                });
                this.collection.each(this.renderComment), this.trigger("Rendered")
            },
            onCommentAdd: function() {
                this.trigger("add")
            },
            renderComment: function(e) {
                this.prependSubview(new r({
                    model: e,
                    big: this.options.big
                }), this.$el.find(".comments-container")), this.$el.find(".scrollbar-pane").length > 0 ? this.$el.scrollbar("repaint") : this.$el.scrollbar()
            },
            renderAddForm: function() {
                this.appendSubview(new i({
                    location: this.options.location,
                    collection: this.collection,
                    placeholder: this.options.placeholder,
                    big: this.options.big
                }), this.$el.find(".comment-add-container"))
            },
            onCommentRemove: function() {
                this.trigger("remove")
            },
            onCommentChange: function() {
                this.trigger("edit")
            }
        });
        return s
    }), define("UI/Slideshow/Views/Main", ["Shared/Abstract/View", "Shared/Comments/Views/Main"], function(e, t) {
        var n = e.extend({
            attributes: {
                "class": "slideshow"
            },
            events: {
                "click .layer": "close",
                "click .slideshow-close": "close",
                "click .slideshow-thumb": "thumbOnClick",
                "click .slideshow-left": "leftOnClick",
                "click .slideshow-right": "rightOnClick",
                "click .slideshow-main img": "rightOnClick"
            },
            defaults: {
                title: "Фотографии",
                index: 0,
                images: [],
                thumbs: [],
                comments: null,
                scrollToComments: !1
            },
            initialize: function(e) {
                _.bindAll(this), this.data = $.extend(!0, {}, this.defaults, e), this.render(), this.setPhoto(), this.documentScrollHide(), this.bindDocumentEvents()
            },
            bindDocumentEvents: function() {
                $(document).bind("keyup.slideshow", this.documentOnKeyup)
            },
            unbindDocumentEvents: function() {
                $(document).unbind("keyup.slideshow")
            },
            documentOnKeyup: function(e) {
                var t = e.keyCode || e.which;
                t == 27 && this.close(), t == 37 && this.left(), t == 39 && this.right();
                if (t == 32) return this.right(), !1
            },
            documentScrollShow: function() {
                $($.browser.msie || $.browser.opera ? "html" : "body").css("overflow", "auto")
            },
            documentScrollHide: function() {
                $($.browser.msie || $.browser.opera ? "html" : "body").css("overflow", "hidden")
            },
            template: function() {
                return '                <div class="layer"></div>                <div class="slideshow-container">                    <div class="slideshow-close"></div>                    <div class="slideshow-title">' + this.data.title + '</div>                    <div class="slideshow-main">                        <div class="slideshow-loader"></div>                        <img>                    </div>                    <div class="slideshow-left"><div></div></div>                    <div class="slideshow-thumbs"></div>                    <div class="slideshow-right"><div></div></div>                </div>            '
            },
            render: function() {
                return this.$el.append(this.template()), this.$container = this.$el.find(".slideshow-container"), this.$loader = this.$el.find(".slideshow-loader"), this.$main = this.$el.find(".slideshow-main img"), this.$thumbs = this.$el.find(".slideshow-thumbs"), this.$main.bind("load", this.showMainPhoto), this.$container.children(":not(.slideshow-comments-container)").disableTextSelect(), this.$el.appendTo("body"), this.renderThumbs(), this.data.comments !== null && this.renderComments(), this.setPosition(), this
            },
            renderThumbs: function() {
                this.data.thumbs.length > 11 && this.makeButtons(), _.each(this.data.thumbs, this.renderThumb)
            },
            renderThumb: function(e) {
                this.$thumbs.append('<div class="slideshow-thumb"><img src="' + e + '"></div>')
            },
            renderComments: function() {
                this.$container.append('<div class="slideshow-comments-container"></div>'), this.comments = new t(this.data.comments), this.bindTo(this.comments, "add edit remove", this.setPosition), this.bindTo(this.comments, "add edit remove", this.onCommentsChanged), this.appendSubview(this.comments, this.$el.find(".slideshow-comments-container")), this.comments.render(), this.comments.on("Rendered", this.setPosition), this.comments.on("Rendered", this.scrollToComments)
            },
            onCommentsChanged: function() {
                this.trigger("CommentsChanged", this.comments.get())
            },
            hideMainPhoto: function() {
                this.$loader.css("visibility", "visible"), this.$main.css("visibility", "hidden")
            },
            showMainPhoto: function() {
                this.$loader.css("visibility", "hidden"), this.$main.css("visibility", "visible")
            },
            scrollToComments: function() {
                this.data.scrollToComments === !0 && this.$el.scrollTo(this.$el.find(".slideshow-comments-container"), 500)
            },
            setPosition: function() {
                var e = $(window).height(),
                    t = this.$container.height();
                this.$el.find(".layer").height(e > t ? e + 5 : t + 60), e > t && this.$container.css({
                    top: (e - t - 60) / 2
                })
            },
            makeSelected: function() {
                this.$thumbs.find("div:eq(" + this.data.index + ")").show().addClass("slideshow-thumb-selected").siblings().removeClass("slideshow-thumb-selected")
            },
            thumbOnClick: function(e) {
                if (this.data.index == $(e.currentTarget).index()) return;
                this.data.index = $(e.currentTarget).index(), this.setPhoto()
            },
            setPhoto: function() {
                this.hideMainPhoto(), this.$main.attr("src", this.data.images[this.data.index]), this.data.thumbs.length > 11 && this.data.index > 8 && this.$thumbs.find("div:lt(" + (this.data.index - 8) + ")").hide(), this.makeSelected()
            },
            makeButtons: function() {
                this.$el.find(".slideshow-left, .slideshow-right").css("display", "inline-block"), this.$thumbs.css({
                    display: "inline-block",
                    width: 711
                }).addClass("slide-show-thumbs-overflow")
            },
            right: function() {
                if (this.data.images.length == 1) return;
                this.data.index >= this.data.images.length - 1 ? this.data.index = 0 : this.data.index++, this.setPhoto()
            },
            left: function() {
                if (this.data.index <= 0) return;
                this.data.index--, this.setPhoto()
            },
            leftOnClick: function() {
                this.left()
            },
            rightOnClick: function() {
                this.right()
            },
            onClose: function() {
                this.$container.children(":not(.slideshow-comments-container)").enableTextSelect(), this.$main.unbind("load"), this.documentScrollShow(), this.unbindDocumentEvents()
            }
        });
        return n
    }),
    function(e, t) {
        var n = {
            init: function(t, n) {
                var r = e.extend({}, e.fn.scrollbar.defaults, n);
                return this.each(function() {
                    var n = e(this),
                        i = {
                            arrows: r.arrows
                        };
                    r.containerHeight != "auto" && n.height(r.containerHeight), i.containerHeight = n.height(), i.contentHeight = e.fn.scrollbar.contentHeight(n);
                    if (i.contentHeight <= i.containerHeight) return !0;
                    this.scrollbar = new e.fn.scrollbar.Scrollbar(n, i, r), this.scrollbar.buildHtml().setHandle().appendEvents(), typeof t == "function" && t(n.find(".scrollbar-pane"), this.scrollbar)
                })
            },
            repaint: function() {
                return this.each(function() {
                    this.scrollbar && this.scrollbar.repaint()
                })
            },
            scrollto: function(e) {
                return this.each(function() {
                    this.scrollbar.scrollto(e)
                })
            },
            unscrollbar: function() {
                return this.each(function() {
                    this.scrollbar && this.scrollbar.unscrollbar()
                })
            },
            unbindScrollEvents: function() {
                e(t).unbind("mousewheel.jqueryscroll")
            }
        };
        e.fn.scrollbar = function(t) {
            if (n[t]) return n[t].apply(this, Array.prototype.slice.call(arguments, 1));
            if (typeof t == "function" || t === undefined) return n.init.apply(this, arguments);
            if (typeof t == "object") return n.init.apply(this, [null, t]);
            e.error("method '" + t + "' does not exist for $.fn.scrollbar")
        }, e.fn.scrollbar.defaults = {
            containerHeight: "auto",
            arrows: !0,
            handleHeight: 39,
            handleMinHeight: 39,
            scrollTimeout: 50,
            scrollStep: 20,
            scrollTimeoutArrows: 40,
            scrollStepArrows: 3,
            marginBottom: 0
        }, e.fn.scrollbar.Scrollbar = function(e, t, n) {
            this.container = e, this.props = t, this.opts = n, this.mouse = {}, this.props.arrows = this.container.hasClass("no-arrows") ? !1 : this.props.arrows
        }, e.fn.scrollbar.Scrollbar.prototype = {
            buildHtml: function() {
                this.container.wrapInner('<div class="scrollbar-pane"/>'), this.container.append('<div class="scrollbar-handle-container"><div class="scrollbar-handle"/></div>'), this.props.arrows && this.container.append('<div class="scrollbar-handle-up"/>').append('<div class="scrollbar-handle-down"/>');
                var e = this.container.height();
                return this.pane = this.container.find(".scrollbar-pane"), this.handle = this.container.find(".scrollbar-handle"), this.handleContainer = this.container.find(".scrollbar-handle-container"), this.handleArrows = this.container.find(".scrollbar-handle-up, .scrollbar-handle-down"), this.handleArrowUp = this.container.find(".scrollbar-handle-up"), this.handleArrowDown = this.container.find(".scrollbar-handle-down"), this.pane.defaultCss({
                    top: 0,
                    left: 0
                }), this.handleContainer.defaultCss({
                    right: 0
                }), this.handle.defaultCss({
                    top: 0,
                    right: 0
                }), this.handleArrows.defaultCss({
                    right: 0
                }), this.handleArrowUp.defaultCss({
                    top: 0
                }), this.handleArrowDown.defaultCss({
                    bottom: 0 + this.opts.marginBottom
                }), this.container.css({
                    position: this.container.css("position") === "absolute" ? "absolute" : "relative",
                    overflow: "hidden",
                    height: e
                }), this.pane.css({
                    position: "absolute",
                    overflow: "visible",
                    height: "auto"
                }), this.handleContainer.css({
                    position: "absolute",
                    top: this.handleArrowUp.outerHeight(!0),
                    height: this.props.containerHeight - this.handleArrowUp.outerHeight(!0) - this.handleArrowDown.outerHeight(!0) - this.opts.marginBottom + "px"
                }), this.handle.css({
                    position: "absolute",
                    cursor: "pointer"
                }), this.handleArrows.css({
                    position: "absolute",
                    cursor: "pointer"
                }), this.pane.top = 0, this
            },
            setHandle: function() {
                return this.props.handleContainerHeight = this.handleContainer.height(), this.props.contentHeight = this.pane.height(), this.props.handleHeight = this.opts.handleHeight == "auto" ? Math.max(Math.ceil(this.props.containerHeight * this.props.handleContainerHeight / this.props.contentHeight), this.opts.handleMinHeight) : this.opts.handleHeight, this.handle.height(this.props.handleHeight), this.handle.height(2 * this.handle.height() - this.handle.outerHeight(!0)), this.props.handlePosition = {
                    min: 0,
                    max: this.props.handleContainerHeight - this.props.handleHeight
                }, this.props.handleContentRatio = (this.props.contentHeight - this.props.containerHeight) / (this.props.handleContainerHeight - this.props.handleHeight), this.handle.top == undefined ? this.handle.top = 0 : this.handle.top = -1 * this.pane.top / this.props.handleContentRatio, this
            },
            appendEvents: function() {
                return this.handle.bind("mousedown.handle", e.proxy(this, "startOfHandleMove")), this.handleContainer.bind("mousedown.handle", e.proxy(this, "onHandleContainerMousedown")), this.handleContainer.bind("mouseenter.container mouseleave.container", e.proxy(this, "onHandleContainerHover")), this.handleArrows.bind("mousedown.arrows", e.proxy(this, "onArrowsMousedown")), this.container.bind("mousewheel.container", e.proxy(this, "onMouseWheel")), this.handle.bind("touchmove.container", e.proxy(this, "onHandleTouchMove")), this.pane.bind("touchmove.container", e.proxy(this, "onPaneTouchMove")), this.pane.bind("touchstart.container", e.proxy(this, "onPaneTouchStart")), this.container.bind("mouseenter.container mouseleave.container", e.proxy(this, "onContentHover")), this.handle.bind("click.scrollbar", this.preventClickBubbling), this.handleContainer.bind("click.scrollbar", this.preventClickBubbling), this.handleArrows.bind("click.scrollbar", this.preventClickBubbling), this
            },
            mousePosition: function(e) {
                return e.pageY || e.clientY + (t.documentElement.scrollTop || t.body.scrollTop) || 0
            },
            repaint: function() {
                this.setHandle(), this.setHandlePosition()
            },
            scrollto: function(t) {
                var n = 0;
                typeof t == "number" ? n = (t < 0 ? 0 : t) / this.props.handleContentRatio : typeof t == "string" ? (t == "bottom" && (n = this.props.handlePosition.max), t == "middle" && (n = Math.ceil(this.props.handlePosition.max / 2))) : typeof t == "object" && !e.isPlainObject(t) && (n = Math.ceil(t.position().top / this.props.handleContentRatio)), this.handle.top = n, this.setHandlePosition(), this.setContentPosition()
            },
            unscrollbar: function() {
                var n = this.container.find(".scrollbar-pane").children().clone();
                e(t).unbind("mousewheel.jqueryscroll"), this.container.empty(), this.container.append(n), this.container.attr("style", "")
            },
            startOfHandleMove: function(n) {
                n.preventDefault(), n.stopPropagation(), this.mouse.start = this.mousePosition(n), this.handle.start = this.handle.top, e(t).bind("mousemove.handle", e.proxy(this, "onHandleMove")).bind("mouseup.handle", e.proxy(this, "endOfHandleMove")), this.handle.addClass("move"), this.handleContainer.addClass("move")
            },
            onHandleMove: function(e) {
                e.preventDefault();
                var t = this.mousePosition(e) - this.mouse.start;
                this.handle.top = this.handle.start + t, this.setHandlePosition(), this.setContentPosition()
            },
            endOfHandleMove: function(n) {
                e(t).unbind(".handle"), this.handle.removeClass("move"), this.handleContainer.removeClass("move")
            },
            setHandlePosition: function() {
                this.handle.top = this.handle.top > this.props.handlePosition.max ? this.props.handlePosition.max : this.handle.top, this.handle.top = this.handle.top < this.props.handlePosition.min ? this.props.handlePosition.min : this.handle.top, this.handle[0].style.top = this.handle.top + "px"
            },
            setContentPosition: function() {
                this.pane.top = -1 * this.props.handleContentRatio * this.handle.top, this.pane[0].style.top = this.pane.top + "px"
            },
            onMouseWheel: function(e, t) {
                this.handle.top -= 6 * t, this.setHandlePosition(), this.setContentPosition(), this.handle.top > this.props.handlePosition.min && this.handle.top < this.props.handlePosition.max && e.preventDefault()
            },
            onHandleTouchMove: function(e) {
                e.preventDefault();
                var t = e.originalEvent.touches[0];
                this.handle.top = t.pageY - this.container.offset().top, this.setHandlePosition(), this.setContentPosition()
            },
            onPaneTouchStart: function(e) {
                var t = e.originalEvent.touches[0];
                this.paneTopOnTouchStart = t.pageY - this.pane.top
            },
            onPaneTouchMove: function(e) {
                e.preventDefault();
                var t = e.originalEvent.touches[0],
                    n = t.pageY - this.paneTopOnTouchStart;
                if (n >= 0 || n < 0 - this.pane.height() + this.container.height()) return;
                this.pane.top = n, this.pane[0].style.top = this.pane.top + "px", this.handle.top = this.pane.top / (-1 * this.props.handleContentRatio), this.handle[0].style.top = this.handle.top + "px"
            },
            onHandleContainerMousedown: function(n) {
                n.preventDefault();
                if (!e(n.target).hasClass("scrollbar-handle-container")) return !1;
                this.handle.direction = this.handle.offset().top < this.mousePosition(n) ? 1 : -1, this.handle.step = this.opts.scrollStep;
                var r = this;
                e(t).bind("mouseup.handlecontainer", function() {
                    clearInterval(i), r.handle.unbind("mouseenter.handlecontainer"), e(t).unbind("mouseup.handlecontainer")
                }), this.handle.bind("mouseenter.handlecontainer", function() {
                    clearInterval(i)
                });
                var i = setInterval(e.proxy(this.moveHandle, this), this.opts.scrollTimeout)
            },
            onArrowsMousedown: function(n) {
                n.preventDefault(), this.handle.direction = e(n.target).hasClass("scrollbar-handle-up") ? -1 : 1, this.handle.step = this.opts.scrollStepArrows, e(n.target).addClass("move");
                var r = setInterval(e.proxy(this.moveHandle, this), this.opts.scrollTimeoutArrows);
                e(t).one("mouseup.arrows", function() {
                    clearInterval(r), e(n.target).removeClass("move")
                })
            },
            moveHandle: function() {
                this.handle.top = this.handle.direction === 1 ? Math.min(this.handle.top + this.handle.step, this.props.handlePosition.max) : Math.max(this.handle.top - this.handle.step, this.props.handlePosition.min), this.handle[0].style.top = this.handle.top + "px", this.setContentPosition()
            },
            onContentHover: function(n) {
                n.type === "mouseenter" ? (this.container.addClass("hover"), this.handleContainer.addClass("hover"), e(t).bind("mousewheel.jqueryscroll", function() {
                    return !1
                })) : (this.container.removeClass("hover"), this.handleContainer.removeClass("hover"), e(t).unbind("mousewheel.jqueryscroll"))
            },
            onHandleContainerHover: function(e) {
                e.type === "mouseenter" ? this.handleArrows.addClass("hover") : this.handleArrows.removeClass("hover")
            },
            preventClickBubbling: function(e) {
                e.stopPropagation()
            }
        }, e.fn.scrollbar.contentHeight = function(e) {
            var t = e.wrapInner("<div/>").find(":first"),
                n = t.css({
                    overflow: "hidden"
                }).height();
            return t.replaceWith(t.contents()), n
        }, e.fn.defaultCss = function(t) {
            var n = {
                right: "auto",
                left: "auto",
                top: "auto",
                bottom: "auto",
                position: "static"
            };
            return this.each(function() {
                var r = e(this);
                for (var i in t) r.css(i) === n[i] && r.css(i, t[i])
            })
        }, e.event.special.mousewheel = {
            setup: function() {
                this.addEventListener ? (this.addEventListener("mousewheel", e.fn.scrollbar.mouseWheelHandler, !1), this.addEventListener("DOMMouseScroll", e.fn.scrollbar.mouseWheelHandler, !1)) : this.onmousewheel = e.fn.scrollbar.mouseWheelHandler
            },
            teardown: function() {
                this.removeEventListener ? (this.removeEventListener("mousewheel", e.fn.scrollbar.mouseWheelHandler, !1), this.removeEventListener("DOMMouseScroll", e.fn.scrollbar.mouseWheelHandler, !1)) : this.onmousewheel = null
            }
        }, e.fn.extend({
            mousewheel: function(e) {
                return e ? this.bind("mousewheel", e) : this.trigger("mousewheel")
            },
            unmousewheel: function(e) {
                return this.unbind("mousewheel", e)
            }
        }), e.fn.scrollbar.mouseWheelHandler = function(t) {
            var n = t || window.event,
                r = [].slice.call(arguments, 1),
                i = 0,
                s = !0,
                o = 0,
                u = 0;
            return t = e.event.fix(n), t.type = "mousewheel", n.wheelDelta && (i = n.wheelDelta / 120), n.detail && (i = -n.detail / 3), u = i, n.axis !== undefined && n.axis === n.HORIZONTAL_AXIS && (u = 0, o = -1 * i), n.wheelDeltaY !== undefined && (u = n.wheelDeltaY / 120), n.wheelDeltaX !== undefined && (o = -1 * n.wheelDeltaX / 120), r.unshift(t, i, o, u), e.event.handle.apply(this, r)
        }
    }(jQuery, document), define("Libs/jQuery/Scroll", ["Libs/jQuery/Scroll/jquery.scroll-0.4.0"], function(e) {
        return e
    }), define("Libs/jQuery/Scroll/jquery.scroll-0.4.0", function() {}), define("UI/Form/Views/Select", ["Shared/Abstract/View", "Libs/jQuery/Scroll"], function(e) {
        var t = e.extend({
            attributes: {
                "class": "ui-ms"
            },
            defaults: {
                defaultItem: {
                    id: null,
                    title: "Выбрать..."
                },
                placeholder: "",
                showDefaultItem: !0,
                showDropDownButton: !0,
                renderSelectedInDropdown: !0,
                input: !1,
                addButton: !0,
                multiple: !1,
                hideOnChange: !0,
                hideOnDelete: !0,
                width: 200,
                maxResultsCount: !1,
                minimumInputLength: 1,
                showControls: !1,
                renderItemsOnInit: !0,
                containerCss: {},
                containerClass: "",
                dropdownCss: {},
                dropdownClass: "",
                formatResult: function(e) {
                    return e.title
                },
                formatSelection: function(e) {
                    return e.title
                },
                formatMultipleSelection: function(e) {
                    return e.title
                },
                formatNoMatches: function() {
                    return "Совпадений не найдено"
                },
                formatInputTooShort: function(e, t) {
                    return "Введите еще " + (t - e.length) + " символ" + (t - e.length > 1 ? "а" : "")
                }
            },
            events: {
                "click ul": "containerOnClick",
                "keyup ul li input": "inputOnKeyUp",
                "click .ui-ms-dropdown-button": "dropdownButtonOnClick",
                "click .ui-ms-title": "titleOnClick",
                "click .ui-ms-item": "itemOnClick",
                "click .ui-ms-delete": "deleteSelectedItem"
            },
            backspaceCount: 0,
            dropdownWidth: null,
            initialize: function(e) {
                _.bindAll(this, "scrollTop", "documentClickHandler", "hideAddButton", "Open", "Hide", "Get", "Set", "SetByIds"), this.$el.attr("id", "ui-ms-" + this.cid).data("multiselect", this), this.o = _.extend(_.clone(this.defaults), e), this.o.selected = this.o.selected || [], this.o.data = this.o.data || [], this.render(), this.bindDocumentEvents(), this.on("change", this.renderSelection, this)
            },
            Get: function() {
                return this.o.selected
            },
            GetOne: function() {
                return this.o.selected[0] || null
            },
            Set: function(e) {
                if (!_.isArray(e)) return;
                this.o.selected = e, this.renderSelection(), this.renderItems()
            },
            SetByIds: function(e) {
                var t = _.filter(this.o.data, function(t) {
                    return _.include(e, t.id)
                });
                this.Set(t)
            },
            SetByCriteria: function(e) {
                var t = [];
                for (var n in e) t = _.union(t, _.where(this.o.data, e[n]));
                this.Set(_.compact(t))
            },
            Reset: function() {
                this.o.selected = [], this.renderSelection()
            },
            Data: function() {
                return this.o.data
            },
            Count: function() {
                return this.o.data.length
            },
            Open: function() {
                this.o.input === !0 ? (this.$selected.empty(), this.renderInput(), this.o.selected.length && this.$selected.find("input").val(this.o.selected[0].title), this.$selected.find("input").focus()) : this.dropdownShow(), this.trigger("open")
            },
            Hide: function() {
                this.dropdownHide()
            },
            bindDocumentEvents: function() {
                $(document).bind("click.ms" + this.cid, this.documentClickHandler)
            },
            unbindDocumentEvents: function() {
                $(document).unbind("click.ms" + this.cid)
            },
            documentClickHandler: function(e) {
                $(e.target).parents("#ui-ms-" + this.cid).length == 0 && (this.$dropdown.is(":visible") && this.dropdownHide(), this.o.multiple === !1 && this.o.input === !0 && e.target.parentNode && this.renderSelection(), this.o.multiple && this.o.selected.length !== this.o.data.length && this.showAddButton())
            },
            onClose: function() {
                this.$results.scrollbar("unscrollbar"), this.unbindDocumentEvents()
            },
            render: function() {
                return this.$el.append(this.template()), this.$container = this.$el.find(".ui-ms-container"), this.$selected = this.$el.find(".ui-ms-selected"), this.$dropdownButton = this.$el.find(".ui-ms-dropdown-button"), this.$dropdown = this.$el.find(".ui-ms-dropdown"), this.$results = this.$dropdown.find(".ui-ms-results"), this.$notify = this.$dropdown.find(".ui-ms-notify"), this.renderContainer(), this.renderSelection(), this.renderDropdown(), this.o.input === !0 ? this.$selected.find("input").val() >= this.o.minimumInputLength && this.renderItems() : this.o.renderItemsOnInit && this.renderItems(), this.$dropdownButton[this.o.showDropDownButton ? "show" : "hide"](), this
            },
            renderContainer: function() {
                this.$container.width(this.o.width).css(this.o.containerCss).addClass(this.o.containerClass)
            },
            renderSelection: function() {
                if (!_.isArray(this.o.selected)) return;
                this.o.multiple === !1 && this.$selected.html(this.selectionTemplate(this.o.formatSelection(this.o.selected[0] || this.o.defaultItem)));
                if (this.o.multiple === !0) {
                    this.$selected.html("<ul>");
                    for (var e in this.o.selected) {
                        var t = $(this.multipleSelectionTemlate(this.o.formatMultipleSelection(this.o.selected[e])));
                        t.data("itemValue", this.o.selected[e]).find("div.text").css({
                            maxWidth: this.o.width - 45
                        }), this.$selected.find("ul").append(t), t.is(":visible") && t.find(".ui-ms-delete").css({
                            marginTop: (t.height() - 12) / 2
                        })
                    }
                }
                this.o.input === !0 && this.o.multiple && (this.renderAddButton(), this.renderInput(), this.showAddButton()), this.o.input === !1 && this.o.addButton === !0 && this.o.multiple && (this.renderAddButton(), this[this.o.selected.length === this.o.data.length ? "hideAddButton" : "showAddButton"]()), this.o.input === !1 && this.o.addButton === !1 && !this.o.selected.length && this.$selected.html(this.selectionTemplate(this.o.formatSelection(this.o.defaultItem))), this.formatSelectedContainer()
            },
            formatSelectedContainer: function() {
                this.$selected.find("ul").width(this.o.width - 18).css("cursor", this.o.input ? "text" : "pointer"), this.$selected.find(".ui-ms-title").css("cursor", this.o.input ? "text" : "pointer")
            },
            renderAddButton: function() {
                this.$selected.find("ul").length || this.$selected.append("<ul>"), this.$selected.find("ul").append('<li class="add"><div class="text">Добавить</div><div class="b-i"></div></li>')
            },
            renderInput: function() {
                this.$selected.find("ul").length || this.$selected.append("<ul>"), this.$selected.find("ul").append('<li class="input"><input size="1"></li>').find("input").val(this.o.multiple === !1 && this.o.selected.length ? this.o.selected[0].title : "").attr("placeholder", this.o.placeholder), this.o.multiple === !1 && this.$selected.find("input, li").css("width", "100%"), this.formatSelectedContainer()
            },
            hideAddButton: function() {
                this.$selected.find(".add").hide(), this.$selected.find("input").show().focus()
            },
            showAddButton: function() {
                this.$selected.find("input").val() || (this.$selected.find("input").hide(), this.$selected.find(".add").show())
            },
            dropdownButtonOnClick: function(e) {
                this.dropdownToggle(e), this.o.multiple === !1 && this.o.input === !0 && this.renderSelection(), this.o.multiple && this.o.selected.length !== this.o.data.length && this.showAddButton()
            },
            renderDropdown: function() {
                this.$dropdown.css({
                    minWidth: this.o.width
                }).css(this.o.dropdownCss).addClass(this.o.dropdownClass)
            },
            dropdownToggle: function(e) {
                this.$dropdown.is(":visible") ? this.dropdownHide() : $(e.target).hasClass("ui-ms-delete") || this.dropdownShow()
            },
            dropdownShow: function() {
                this.trigger("dropdownShow");
                if (this.o.input && this.o.multiple) {
                    var e = this.$selected.find("input");
                    this[e.val() && e.val().length >= this.o.minimumInputLength ? "renderItems" : "destroyItems"]()
                }
                if (this.$results.children().length == 0) {
                    this.dropdownHide();
                    return
                }
                this.$dropdown.css({
                    top: this.$container.height() + 4
                }), this.$dropdown.show(), this.$results.width(this.dropdownWidth || this.$results.width() + (this.$results.children().length > 10 ? 19 : 0)), this.dropdownWidth = this.$results.width(), this.makeScrollbar()
            },
            dropdownHide: function() {
                this.$dropdown.hide(), this.$results.scrollbar("unbindScrollEvents"), this.trigger("dropdownHide")
            },
            makeScrollbar: function() {
                this.$results.find(".scrollbar-pane").length ? (this.$results.scrollbar("repaint"), this.scrollTop()) : this.$results.scrollbar()
            },
            scrollTop: function() {
                this.$results.scrollbar("scrollto")
            },
            renderItems: function(e) {
                e = e || this.o.data || [], this.destroyItems(), this.o.showDefaultItem && this.renderItem(this.o.defaultItem);
                var t = this.o.selected;
                this.o.renderSelectedInDropdown === !1 && (e = _.filter(e, function(e) {
                    return !_.find(t, function(t) {
                        return t.id == e.id
                    })
                }));
                var n = this.o.maxResultsCount || e.length;
                n > e.length && (n = e.length);
                for (var r = 0; r < n; r++) this.renderItem(e[r])
            },
            destroyItems: function() {
                this.$results.empty().css({
                    height: "auto"
                })
            },
            renderItem: function(e) {
                var t = $(this.itemTemplate(e)).data("itemValue", e);
                this.$results.append(t)
            },
            itemOnClick: function(e) {
                _.stopPropagation(e);
                if ($(e.currentTarget).hasClass("disabled")) return !1;
                var t = $(e.currentTarget).data("itemValue");
                if ($(e.target).hasClass("ui-ms-delete-item")) {
                    this.trigger("delete", t);
                    return
                }
                this.o.multiple === !1 && (this.o.selected = []), t.id && (this.o.selected.push(t), this.o.selected = _.unique(this.o.selected)), this[this.o.hideOnChange ? "dropdownHide" : "dropdownShow"](), this.renderItems(), this.trigger("change", this.o.selected), this.$results.children().length === 0 && this.hideAddButton()
            },
            deleteSelectedItem: function(e) {
                _.stopPropagation(e);
                var t = $(e.currentTarget).parents("li").data("itemValue");
                this.o.selected = _.without(this.o.selected, t), this.$results.find(".ui-ms-item:hidden").each(function() {
                    _.isEqual($(this).data("itemValue"), t) && $(this).show()
                }), this.trigger("change", this.o.selected), this.trigger("delete", t), this.renderItems(), this[this.o.hideOnDelete ? "dropdownHide" : "dropdownShow"]()
            },
            containerOnClick: function(e) {
                this.o.input === !0 && !$(e.target).parents(".ui-ms-selected-item").length ? (this.hideAddButton(), this.dropdownToggle(e)) : this.o.multiple && this.o.selected.length !== this.o.data.length && (this.showAddButton(), this.dropdownHide()), this.o.input === !1 && !$(e.target).parents(".ui-ms-selected-item").length && this.dropdownToggle(e)
            },
            titleOnClick: function(e) {
                this.o.input && (this.$selected.empty(), this.renderInput(), this.$selected.find("input").focus()), this.dropdownToggle(e)
            },
            inputOnKeyUp: function(e) {
                var t = $(e.currentTarget),
                    n = _.eKeys(e)[0];
                if (n == 13 && t.val()) {
                    this.$results.children().first().trigger("click"), setTimeout(this.hideAddButton, 20);
                    return
                }
                if (n == 13 && !t.val()) {
                    this.o.selected = [], this.trigger("change", this.o.selected), setTimeout(this.hideAddButton, 20);
                    return
                }
                if (n == 8 && !t.val()) {
                    if (++this.backspaceCount > 1) {
                        t.parent().prev().prev().find(".ui-ms-delete").trigger("click"), this.backspaceCount = 0, setTimeout(this.hideAddButton, 20);
                        return
                    }
                } else this.backspaceCount = 0;
                var r = t.val();
                if (r.length < this.o.minimumInputLength) {
                    this.destroyItems(), this.dropdownHide();
                    return
                }
                t.attr("size", t.val().length || 1), this.filterResults(_.switchLatin(r.toLowerCase()))
            },
            filterResults: function(e) {
                var t = _.filter(this.o.data, function(t) {
                    return t.title.toLowerCase().substr(0, e.length).replace("ё", "е") == e.replace("ё", "е")
                });
                if (!this.o.maxResultsCount || this.o.maxResultsCount > t.length) {
                    var n = _.filter(this.o.data, function(t) {
                        return t.title.toLowerCase().substr(0, e.length) != e && t.title.toLowerCase().indexOf(e) !== -1
                    });
                    _.isArray(n) && (t = _.union(t, n.slice(0, this.o.maxResultsCount - t.length)))
                }
                this.renderItems(t), this.$dropdown.is(":hidden") && this.$results.children().length ? this.dropdownShow() : this.$results.children().length || this.dropdownHide()
            },
            itemTemplate: function(e) {
                return '            <div class="ui-ms-item ' + (e.type == "splitter" ? " disabled" : "") + '" data-id="' + e.id + '">                <div class="ui-ms-item-label">' + this.o.formatResult(e) + "</div>            </div>"
            },
            selectionTemplate: function(e) {
                return '<div class="ui-ms-title">' + e + "</div>"
            },
            multipleSelectionTemlate: function(e) {
                return '<li class="ui-ms-selected-item"><div class="text">' + e + "</div>" + '<div class="ui-ms-delete b-i"></div></li>'
            },
            template: function() {
                return '            <div class="ui-ms-container">                <div class="ui-ms-selected"></div>                <div class="ui-ms-dropdown-button"></div>            </div>            <div class="ui-ms-dropdown">                <div class="ui-ms-results"></div>                <div class="ui-ms-notify"></div>                <div class="ui-ms-controls">                    <div class="ui-ms-controls-ok">Применить</div>                    <div class="ui-ms-controls-cancel">Сбросить</div>                </div>            </div>'
            }
        });
        return t
    }), define("Shared/Terrain/Model", ["Shared/Abstract/Model"], function(e) {
        var t = e.extend({
            urlRoot: "/api/terrain",
            initialize: function() {
                _.bindAll(this)
            },
            idAttribute: "list",
            url: function() {
                return this.urlRoot + "?" + _.obj2uri(this.get(this.idAttribute))
            },
            convert: function(e) {
                var t = {};
                return _.each(e, function(e, n) {
                    t[n] = e
                }), t
            },
            Get: function(e, t) {
                this.set("list", this.convert(e), {
                    silent: !0
                }), this.fetch({
                    success: function(e, n) {
                        t(n)
                    }
                })
            }
        });
        return t
    }), define("Base/Tools/Views/Admin/ChangeSection", ["Shared/Abstract/View", "UI/Form/Views/Select"], function(e, t) {
        var n = e.extend({
            attributes: {
                "class": "admin-tools-change-section"
            },
            initialize: function() {
                _.bindAll(this), this.appData = window.AppData.Base.data, this.render()
            },
            render: function() {
                this.$el.append(this.template()), this.modelData = this.model.toJSON();
                var e = new t({
                    width: 208,
                    showDefaultItem: !1,
                    selected: this.modelData.main.operation.length ? this.modelData.main.operation : [],
                    data: OPERATIONS
                });
                return this.marketSegment = (new t({
                    width: 208,
                    showDefaultItem: !1,
                    multiple: !1,
                    selected: this.modelData.main.marketSegment.length ? this.modelData.main.marketSegment : [],
                    data: MARKET_SEGMENTS
                })).on("change", function() {
                    this.modelData.main.estateType = [], this.renderEstateType()
                }, this), this.appendSubview(e, this.$el.find("#admin-tools-operation")), this.appendSubview(this.marketSegment, this.$el.find("#admin-tools-marketSegment")), this.marketSegment.GetOne() && this.marketSegment.GetOne().id && this.renderEstateType(), this.options.upButton === !1 && this.$el.find(".ui-checkbox").hide(), this
            },
            submit: function() {
                var e = this.$el.find("#admin-tools-operation").find(".ui-ms").data("multiselect").Get(),
                    t = this.$el.find("#admin-tools-marketSegment").find(".ui-ms").data("multiselect").Get(),
                    n = this.$el.find("#admin-tools-estateType").find(".ui-ms").data("multiselect").Get(),
                    r = this.$el.find(".ui-checkbox").hasClass("ui-checkbox-checked"),
                    i = {
                        "main.operation": e,
                        "main.marketSegment": t,
                        "main.estateType": n
                    };
                return {
                    changes: i,
                    pickup: r
                }
            },
            renderEstateType: function() {
                this.estateType && this.estateType.close(), window.AppData.Base.listings.once("change:estateType-" + this.marketSegment.GetOne().id, this.renderEstateType);
                var e = window.AppData.Base.listings.getOne("estateType-" + this.marketSegment.GetOne().id);
                if (!e) return;
                this.estateType = new t({
                    width: 208,
                    multiple: !0,
                    showDefaultItem: !1,
                    renderSelectedInDropdown: !1,
                    selected: this.modelData.main.estateType.length ? this.modelData.main.estateType : [],
                    data: e
                }), this.appendSubview(this.estateType, this.$el.find("#admin-tools-estateType"))
            },
            template: function() {
                return '<span>Выберите новый раздел:</span>                    <div id="admin-tools-operation"></div>                    <div id="admin-tools-marketSegment"></div>                    <div id="admin-tools-estateType"></div>                    <div class="ui-checkbox"><div></div>Поднять наверх</div>'
            }
        });
        return n
    }), define("Base/Tools/Views/Admin/ChangeLocality", ["Shared/Abstract/View", "Shared/Terrain/Model", "UI/Form/Views/Select"], function(e, t, n) {
        var r = e.extend({
            attributes: {
                "class": "admin-tools-change-locality"
            },
            initialize: function(e) {
                _.bindAll(this), this.appData = window.AppData.Base.data, this.Terrain = new t;
                var n = ["regions", ["cityAreas", this.model.get("terrain.region")[0].id]];
                this.model.get("terrain.area").length && n.push(["towns", this.model.get("terrain.area")[0].id]), this.model.get("terrain.city").length && (n.push(["districts", this.model.get("terrain.city")[0].id]), n.push(["adminDistricts", this.model.get("terrain.city")[0].id]), n.push(["streets", this.model.get("terrain.city")[0].id])), this.Terrain.Get(n, this.render)
            },
            render: function(e) {
                this.$el.append(this.template());
                var t = this.model.toJSON(),
                    n = [],
                    r = [],
                    i = [],
                    s = [],
                    o = _.map(_.clone(REGIONS), function(e) {
                        return e.type = "region", e
                    });
                return t.terrain.city.length ? n = _.map(t.terrain.city, function(e) {
                    return e.type = "city", e
                }) : t.terrain.area.length && (n = _.map(t.terrain.area, function(e) {
                    return e.type = "area", e
                })), t.terrain.district.length ? r = _.map(t.terrain.district, function(e) {
                    return e.type = "district", e
                }) : t.terrain.town.length && (r = _.map(t.terrain.town, function(e) {
                    return e.type = "town", e
                })), t.terrain.adminDistrict.length && (s = _.map(t.terrain.adminDistrict, function(e) {
                    return e.type = "adminDistrict", e
                })), t.terrain.street.length && (i = _.map(t.terrain.street, function(e) {
                    return e.type = "street", e
                })), this.renderRegion({
                    regions: o
                }, _.map(t.terrain.region, function(e) {
                    return e.type = "region", e
                })), this.renderCityArea(e, n), r && this.renderDistrictTown(e, r), s && this.renderAdminDistrict(e, s), t.terrain.city && this.renderStreet(e, i), this
            },
            renderRegion: function(e, t) {
                this.region && this.region.close(), this.region = (new n({
                    width: 208,
                    showDefaultItem: !1,
                    multiple: !1,
                    selected: t || [],
                    data: e.regions
                })).on("change", this.onRegionChange), this.appendSubview(this.region, this.$el.find("#admin-tools-region"))
            },
            renderCityArea: function(e, t) {
                this.cityArea && this.cityArea.close(), this.cityArea = (new n({
                    width: 208,
                    caption: "город/район...",
                    multiple: !0,
                    showDefaultItem: !1,
                    selected: t || [],
                    data: e.cityAreas
                })).on("change", this.onCityAreaChange), this.appendSubview(this.cityArea, this.$el.find("#admin-tools-cityArea"))
            },
            renderDistrictTown: function(e, t) {
                this.districtTown && this.districtTown.close(), e = e.districts ? e.districts : e.towns;
                if (!e.length) return;
                this.districtTown = new n({
                    width: 208,
                    placeholder: "район/нас.пункт...",
                    input: !0,
                    multiple: !0,
                    renderItemsIfInput: !0,
                    showDefaultItem: !1,
                    selected: t || [],
                    data: e
                }), this.appendSubview(this.districtTown, this.$el.find("#admin-tools-districtTown"))
            },
            renderAdminDistrict: function(e, t) {
                this.adminDistrict && this.adminDistrict.close();
                if (!e.adminDistricts || !e.adminDistricts.length) return;
                this.adminDistrict = new n({
                    width: 208,
                    placeholder: "админрайон...",
                    multiple: !0,
                    renderItemsIfInput: !0,
                    showDefaultItem: !1,
                    selected: t || [],
                    data: e.adminDistricts
                }), this.appendSubview(this.adminDistrict, this.$el.find("#admin-tools-adminDistrict"))
            },
            renderStreet: function(e, t) {
                this.street && this.street.close();
                if (!e.streets || !e.streets.length) return;
                this.street = new n({
                    width: 208,
                    placeholder: "улица...",
                    input: !0,
                    maxResultsCount: 10,
                    showDefaultItem: !1,
                    selected: t || [],
                    data: e.streets
                }), this.appendSubview(this.street, this.$el.find("#admin-tools-street"))
            },
            onRegionChange: function(e) {
                if (!e.length) {
                    this.cityArea && this.cityArea.close(), this.districtTown && this.districtTown.close(), this.adminDistrict && this.adminDistrict.close(), this.street && this.street.close();
                    return
                }
                this.districtTown && this.districtTown.close(), this.Terrain.Get([
                    ["cityAreas", e[0].id]
                ], this.renderCityArea)
            },
            onCityAreaChange: function(e) {
                if (!e.length) {
                    this.districtTown && this.districtTown.close(), this.adminDistrict && this.adminDistrict.close(), this.street && this.street.close();
                    return
                }
                this.Terrain.Get([
                    [e[0].type == "city" ? "districts" : "towns", e[0].id]
                ], this.renderDistrictTown), e[0].type == "city" ? (this.Terrain.Get([
                    ["streets", e[0].id]
                ], this.renderStreet), this.Terrain.Get([
                    ["adminDistricts", e[0].id]
                ], this.renderAdminDistrict)) : (this.street && this.street.close(), this.adminDistrict && this.adminDistrict.close())
            },
            submit: function() {
                var e = _.serializeForm(this.$el);
                if (!e || !_.size(e)) return null;
                var t = {
                    "terrain.region": e.region || [],
                    "terrain.city": e.city || [],
                    "terrain.area": e.area || [],
                    "terrain.adminDistrict": e.adminDistrict || [],
                    "terrain.district": e.district || [],
                    "terrain.town": e.town || [],
                    "terrain.street": e.street || []
                };
                return {
                    changes: t,
                    pickup: e.pickUp
                }
            },
            template: function() {
                return '<span>Выберите расположение:</span>                    <div id="admin-tools-region"></div>                    <div id="admin-tools-cityArea"></div>                    <div id="admin-tools-adminDistrict"></div>                    <div id="admin-tools-districtTown"></div>                    <div id="admin-tools-street"></div>                    <div class="ui-checkbox" name="pickUp"><div></div>Поднять наверх</div>'
            }
        });
        return r
    }), define("Base/Tools/Views/Admin/Change", ["Shared/Abstract/View", "Shared/Terrain/Model", "Base/Tools/Views/Admin/ChangeSection", "Base/Tools/Views/Admin/ChangeLocality"], function(e, t, n, r) {
        var i = e.extend({
            attributes: {
                "class": "admin-tools-change"
            },
            initialize: function() {
                _.bindAll(this), this.appData = window.AppData.Base.data, this.changeSectionView = new n({
                    model: this.model,
                    upButton: !1
                }), this.changeLocalityView = new r({
                    model: this.model
                }), this.render()
            },
            render: function() {
                return this.appendSubview(this.changeSectionView), this.$el.append("<div>&nbsp;</div>"), this.appendSubview(this.changeLocalityView), this
            },
            submit: function() {
                var e = this,
                    t = this.model.getPath(),
                    n = this.changeSectionView.submit(),
                    r = this.changeLocalityView.submit();
                if (!n || !r) return;
                var i = _.extend({}, n.changes, r.changes);
                n.pickup || r.pickup ? window.AppData.date(function(n) {
                    i["main.insertDate"] = n, e.model.set(i), e.model.saveChanges(), _.isEqual(e.model.getPath(), t) || e.model.removedByAdmin()
                }) : (this.model.set(i), this.model.saveChanges(), _.isEqual(e.model.getPath(), t) || e.model.removedByAdmin())
            }
        });
        return i
    }), define("Base/Ad/Views/Opened", ["Shared/Abstract/View", "Shared/Comments/Views/Main", "UI/Slideshow/Views/Main", "UI/Dialog/Views/Default", "UI/Form/Views/Select", "Base/Config", "Base/Tools/Views/Admin/Change", "Base/Tools/Views/Admin/ChangeSection", "Base/Tools/Views/Admin/ChangeLocality", "moment", "Libs/jQuery/TextareaAutosize"], function(e, t, n, r, i, s, o, u, a, f) {
        var l = e.extend({
            attributes: {
                style: "height: 100%"
            },
            events: {
                "click .base-note-save": "noteSaveOnClick",
                "click .base-note-edit": "noteEditOnClick",
                "click .base-note-clear": "noteClearOnClick",
                "click .base-ad-undo-changes": "undoButtonOnClick",
                "keyup .base-ad-info textarea": "textareaOnKeyUp",
                "click .base-ad-info .base-ad-thumb": "thumbOnClick",
                "click #admin-tools-delete": "adminToolsDelete",
                "click #admin-tools-change": "adminToolsChange",
                "click #admin-tools-export-numbers": "adminToolsExportNumbers",
                "click #admin-tools-pardon-numbers": "adminToolsPardonNumbers",
                "click #admin-tools-maybe-realtor": "adminToolsMaybeRealtor",
                "click #admin-tools-report-a-bug": "adminToolsReportABug",
                "click .base-ad-refresh": "baseAdRefresh",
                "click .generate-ad": "generateAd"
            },
            initialize: function() {
                _.bindAll(this), this.bindTo(this.model, "change", this.modelOnChange)
            },
            template: function() {
                return '            <div class="base-ad-comments"></div>            <div class="base-ad-info">                <div class="base-ad-info-left mts"><%= ad.info.mark && ad.info.mark.length && ad.info.mark[0].id == 8 ? "Риэлтор:" : "Источник:" %></div>                <div class="base-ad-info-right mts">                    <a class="router-false" href="<%= ad.info.url %>" target="_blank"><b><%= ad.info.source.title %></b></a>                    <% if (_.include(SITE_ADMINS, window.Auth.get("uid"))) { %>                        <i class="b-i base-ad-refresh"></i>                     <% } %>                </div>                <div class="base-ad-info-left">Текст:</div>                <div class="base-ad-info-right base-ad-opened-text"><%= ad.info.text ? ad.info.text : config.empty %></div>                <div class="base-ad-info-left"></div>                <div class="base-ad-info-right">                    <% _.each(ad.info.photo, function(src) { %>                        <img class="base-ad-thumb" src="<%= src.thumbnail %>">                    <% }); %>                </div>                <div class="base-ad-info-left">Примечание:</div>                <div class="base-ad-info-right base-ad-notes-container">                    <div class="base-ad-notes">                        <div class="base-ad-notes-text" name="notes"></div>                    </div>                    <textarea class="base-ad-notes-edit" name="notes" placeholder="Видите только Вы"></textarea>                    <a class="base-note-save"><i class="b-i"></i>Сохранить</a>                    <a class="base-note-edit"><i class="b-i"></i>Редактировать</a>                    <a class="base-note-clear"><i class="b-i"></i>Очистить</a>                </div>                <div class="base-ad-info-left">Добавлено:</div>                <div class="base-ad-info-right">                    <%= Moment(ad.main.insertDate).format("D MMMM YYYY в HH:mm") %>                </div>                <div class="base-ad-info-left">ID номер:</div>                <div class="base-ad-info-right">                    <a class="router-false" target="_blank" href="<%= window.AppData.Base.data.generateDefaultUrl() %>&id=<%= ad.main.id %>">                        <%= ad.main.id %>                    </a>                </div>                <% if (_.include(SITE_DEVELOPERS, window.Auth.get("uid"))) { %>                <div class="base-ad-info-left"></div>                <div class="base-ad-info-right admin-tools">                    <% if (_.include(SITE_ADMINS, window.Auth.get("uid"))) { %>                        <a id="admin-tools-delete"><i class="b-i"></i>Удалить</a>                        <a id="admin-tools-change"><i class="b-i"></i>Раздел/Адрес</a>                        <a id="admin-tools-export-numbers"><i class="b-i"></i>Это риэлтор</a>                        <a id="admin-tools-pardon-numbers"><i class="b-i"></i>Помиловать</a>                    <% } %>                    <a id="admin-tools-report-a-bug"><i class="b-i"></i>Сообщить об ошибке</a>                    <!--<a id="admin-tools-maybe-realtor"><i class="b-i"></i>Вероятно это риэлтор</a>-->                    <% if (_.include(SITE_MAIN_DEVELOPER, window.Auth.get("uid"))) { %>                        <a class="generate-ad">Сгенерировать объявление</a>                    <% } %>                </div>                <% } %>            </div>            <div class="base-ad-undo-changes">                <i class="b-i"></i>                Отменить изменения            </div>'
            },
            render: function(e) {
                var t = this.model.toJSON();
                t.info.photo = this.model.preparePhotos();
                var n = _.template(this.template(), {
                    ad: t,
                    config: s,
                    Moment: f
                });
                this.$el.empty().append(n), this.$undo = this.$el.find(".base-ad-undo-changes"), this.$info = this.$el.find(".base-ad-info"), this[this.model.get("info.notes") ? "noteShow" : "noteEdit"](), this.toggleUndoButton(), this.makeScroll();
                if (e) {
                    var r = document.documentElement.clientHeight;
                    if (r > 300) {
                        var i = this.$el.offset().top,
                            o = window.scrollY,
                            u = this.$el.height();
                        i - o + u > r && $.scrollTo(i + u - r + 30, 500)
                    }
                }
                return setTimeout(this.makeComments, 10), this
            },
            makeComments: function() {
                this.comments && this.comments.close(), this.comments = new t({
                    placeholder: "Видят все",
                    location: {
                        collection: "base",
                        document: this.model.get("main.id")
                    },
                    comments: this.model.get("comments")
                }), this.bindTo(this.comments, "add edit remove", this.onCommentsChanged), this.appendSubview(this.comments, this.$el.find(".base-ad-comments")), this.comments.render(), this.trigger("CommentsRendered")
            },
            onCommentsChanged: function() {
                this.model.set("comments", this.comments.get(), {
                    silent: !0
                }), this.model.trigger("CommentsChange")
            },
            makeScroll: function() {
                var e = this.$undo.is(":visible") ? 13 : 0;
                this.$info.scrollbar({
                    marginBottom: e
                })
            },
            repaintScroll: function() {
                this.$info.scrollbar("repaint")
            },
            removeScroll: function() {
                this.$info.scrollbar("unscrollbar")
            },
            undoButtonOnClick: function() {
                (new r({
                    content: "Отменить изменения?",
                    controls: ["yes", "no"]
                })).on("yes", this.model.undoChanges)
            },
            modelOnChange: function() {
                this.toggleUndoButton(), this.removeScroll(), this.model.get("info.notes") ? this.noteShow() : this.noteEdit(), this.makeScroll()
            },
            toggleUndoButton: function() {
                this.$undo[this.model.get("main.user") != 0 ? "show" : "hide"]()
            },
            noteShow: function() {
                this.$info.find("[name=notes]").text(this.model.get("info.notes")), this.$info.find(".base-ad-notes, .base-note-edit, .base-note-clear").show(), this.$info.find(".base-ad-notes-edit, .base-note-save").hide()
            },
            noteEdit: function() {
                this.$info.find("[name=notes]").text(this.model.get("info.notes")), this.$info.find(".base-ad-notes, .base-note-edit, .base-note-clear").hide(), this.$info.find(".base-ad-notes-edit, .base-note-save").show(), this.$info.find("textarea").autosize()
            },
            noteSaveOnClick: function() {
                var e = $.trim(this.$info.find("textarea[name=notes]").val());
                if (!e) return;
                this.model.set("info.notes", e).saveChanges(), this.noteShow(), this.repaintScroll()
            },
            noteEditOnClick: function() {
                this.noteEdit(), this.repaintScroll()
            },
            noteClearOnClick: function() {
                this.model.set({
                    "info.notes": ""
                }).saveChanges(), this.noteEdit(), this.repaintScroll()
            },
            textareaOnKeyUp: function(e) {
                var t = [e.keyCode || e.which, e.shiftKey, e.ctrlKey];
                t[0] == 13 && t[2] && this.noteSaveOnClick()
            },
            thumbOnClick: function(e) {
                this.showSlideshow($(e.currentTarget).index())
            },
            showSlideshow: function(e) {
                e = e || 0;
                var t = this.model.toJSON();
                t.info.photo = this.model.preparePhotos(), this.slideshow = new n({
                    title: "Фотографии объекта",
                    index: e,
                    images: _.pluck(t.info.photo, "original"),
                    thumbs: _.pluck(t.info.photo, "thumbnail"),
                    comments: {
                        big: !0,
                        location: {
                            collection: "base",
                            document: this.model.get("main.id")
                        },
                        comments: this.model.get("comments")
                    }
                }), this.bindTo(this.slideshow, "CommentsChanged", this.onSlideShowCommentsChanged)
            },
            onSlideShowCommentsChanged: function(e) {
                this.model.set("comments", e, {
                    silent: !0
                }), this.makeComments()
            },
            generateAd: function() {
                var e = new r({
                    containerCss: {
                        width: 400
                    },
                    content: this.model.generateAd()
                })
            },
            adminToolsDelete: function() {
                (new r({
                    content: "Удалить объявление без возможности восстановления?",
                    controls: ["yes", "no"]
                })).on("yes", this.model.adminRemove)
            },
            adminToolsChange: function() {
                var e = new o({
                    model: this.model
                });
                (new r({
                    content: e,
                    containerCss: {
                        textAlign: "left"
                    },
                    controls: ["ok", "cancel"]
                })).on("ok", e.submit)
            },
            adminToolsChangeSection: function() {
                var e = new u({
                    model: this.model
                });
                (new r({
                    content: e,
                    containerCss: {
                        textAlign: "left"
                    },
                    controls: ["ok", "cancel"]
                })).on("ok", e.submit)
            },
            adminToolsChangeLocality: function(e) {
                var t = {
                    model: this.model
                };
                _.isString(e) && (t.oldPath = e);
                var n = new a(t);
                (new r({
                    content: n,
                    containerCss: {
                        textAlign: "left"
                    },
                    controls: ["ok", "cancel"]
                })).on("ok", n.submit)
            },
            adminToolsMaybeRealtor: function() {
                var e = 'Пометить объявления как "Вероятно риэлтор"?<br><br><div class="f-11">Метка "Вероятно риэлтор" будет проставлена для всех объявлений с этими номерами</div>';
                (new r({
                    content: e,
                    controls: ["yes", "no"],
                    containerCss: {
                        textAlign: "left"
                    }
                })).on("yes", this.model.adminMaybeRealtor)
            },
            adminToolsReportABug: function() {
                var e = '<div class="f-13">                <input name="source" type="hidden" class="input-text" value="' + this.model.get("info.url") + '" />                <input name="url" type="hidden" class="input-text" value="http://www.kg-r.com' + window.AppData.Base.data.generateDefaultUrl() + "&id=" + this.model.get("main.id") + '" />                <input name="text" type="hidden" class="input-text" value="' + this.model.get("info.text") + '" />                <!--<div class="base-ad-info-left">Тип ошибки:</div>                <div class="base-ad-info-right"><div class="error-type"></div></div>-->                <input name="tags" type="hidden" class="error-tags">                <div class="base-ad-info-left">Заголовок:</div>                <div class="base-ad-info-right"><input name="title" type="text" class="input-text" style="width: 300px"></div>                <div class="base-ad-info-left">Описание:</div>                <div class="base-ad-info-right"><textarea name="description" class="input-text" style="width: 298px; font: 13px Arial;"></textarea></div>                </div>',
                    t = _.invoke(_.pluck(_.flatten([this.model.get("terrain.city"), this.model.get("main.operation"), this.model.get("main.marketSegment")]), "title"), "toLowerCase");
                t.push(window.AppData.Base.data.get("type") == "city" ? "город" : "пригород");
                if (window.AppData.Base.data.get("type") == "suburb") switch (this.model.get("terrain.region")[0].id) {
                    case 4:
                        t.push("днепропетровск");
                        break;
                    case 8:
                        t.push("запорожье");
                        break;
                    case 10:
                        t.push("киев")
                }
                var n = (new r({
                    content: e,
                    submitOnEnter: !1,
                    controls: ["ok", "cancel"],
                    closeOn: ["cancel"],
                    containerCss: {
                        width: 450,
                        textAlign: "left"
                    }
                })).on("ok", function(e) {
                    var t = _.serializeForm(e.$el);
                    e.$el.find("[name=title]")[t.title ? "removeClass" : "addClass"]("input-error");
                    if (!t.title) return;
                    $.post("/api/base/admin/bug", t, function(e) {
                        e && e.error == 150 ? (new r({
                            closeOn: [],
                            content: 'Введите логин и пароль от youtrack в виде login:pass<br><br><input type="text" class="input-text">'
                        })).on("ok", function(e) {
                            var t = e.$el.find("input").val().split(":");
                            if (!t[0] || !t[1]) return;
                            $.post("/api/base/admin/bug", {
                                youtrackLogin: t[0],
                                youtrackPassword: t[1]
                            }), e.close()
                        }) : e && e.error && new r({
                            content: "Какая-то ошибка! Обратитесь к администратору!"
                        })
                    }), e.close()
                });
                n.$el.find("input[name=title]").focus(), n.$el.find(".error-tags").val(t.join(",")), n.$el.find("textarea").autosize()
            },
            adminToolsExportNumbers: function() {
                var e = "Добавить номера " + this.model.get("info.contacts.phones").join(", ") + " в базу риэлторов?<br><br>" + '<div class="f-11">' + 'Метка "Не актуально" будет проставлена для всех объявлений с этими номерами' + "</div>";
                (new r({
                    content: e,
                    controls: ["yes", "no"],
                    containerCss: {
                        textAlign: "left"
                    }
                })).on("yes", this.model.adminExportNumbers)
            },
            adminToolsPardonNumbers: function() {
                var e = "Помиловать номера " + this.model.get("info.contacts.phones").join(", ") + " ?<br><br>" + '<div class="f-11">' + "</div>";
                (new r({
                    content: e,
                    controls: ["yes", "no"],
                    containerCss: {
                        textAlign: "left"
                    }
                })).on("yes", this.model.adminPardonNumbers)
            },
            baseAdRefresh: function() {
                this.adRefreshDialog = new r({
                    content: "Идет работа. Ожидайте...",
                    controls: []
                }), $.post("/api/base/admin/adRefresh", {
                    site: this.model.get("info.source.id"),
                    url: this.model.get("info.url")
                }, this.compareAd)
            },
            compareAd: function(e) {
                var t = $.parseJSON(e),
                    n = this.model.toJSON(),
                    i = this.model.getPath(),
                    s = {
                        terrain: {}
                    };
                this.adRefreshDialog.close();
                if (t.error) {
                    new r({
                        content: t.error
                    });
                    return
                }
                for (var o in t.terrain) {
                    if (!t.terrain[o] && !n.terrain[o]) continue;
                    _.isEqual(t.terrain[o], n.terrain[o]) || (s.terrain[o] = t.terrain[o])
                }
                if (!_.size(s.terrain)) {
                    new r({
                        content: "Изменения отсутствуют"
                    });
                    return
                }
                for (var o in s.terrain) this.model.set("terrain." + o, s.terrain[o]);
                this.adminToolsChangeLocality(i)
            },
            applyChanges: function(e) {
                var t = [];
                e.$el.find(".ui-checkbox-checked").each(function() {
                    t.push($(this).data("key"))
                });
                for (var n in t) {
                    var r = t[n].split(".");
                    this.model.set(t[n], this.adsDiff[r[0]][r[1]])
                }
                this.adminToolsChangeLocality()
            }
        });
        return l
    }), define("Base/Ad/Views/Edit/List", ["Shared/Abstract/View", "Base/Config", "UI/Form/Views/Select"], function(e, t, n) {
        var r = e.extend({
            initialize: function(e) {
                _.bindAll(this), this.appData = window.AppData.Base.data, this.listings = window.AppData.Base.listings, this.column = t.columns.getCurrent(this.appData)[this.options.field], this.bindTo(this, "documentClick documentEnterPressed", this.submit), this.render()
            },
            hide: function() {
                this.trigger("close")
            },
            render: function() {
                return this.$el.append(this.template()), this.selectContainer = this.$el.find(".select-container"), this.makeSelect(), this.bindTo(this, "append", this.onAppend), this
            },
            template: function() {
                return '<div class="select-container"></div>'
            },
            makeSelect: function() {
                var e = [];
                for (var r in this.column.location) {
                    var i = this.model.get(this.column.location[r]);
                    _.each(i, function(e) {
                        e.field = this.column.location[r].split(".")[1]
                    }, this), _.isArray(i) && i[0] && (e = _.union(e, this.model.get(this.column.location[r])))
                }
                var s = _.extend({
                    defaultItem: {
                        id: null,
                        title: t.empty
                    },
                    placeholder: "Начните вводить текст...",
                    width: 163
                }, this[this.options.field]());
                e && (s.selected = _.isArray(e) ? e : [e], s.selected.length && (s.selected[0].id === undefined || s.selected[0].title === undefined) && (s.selected = [])), this.select = new n(s), this.select.on("change", this.selectChanged), this.appendSubview(this.select, this.selectContainer), this.setSelectValue(e), (s.openOnAppend === !0 || _.isFunction(s.openOnAppend) && s.openOnAppend(this.select.o) === !0) && this.bindTo(this, "append", this.select.Open)
            },
            setSelectValue: function(e) {
                if (e && _.isArray(e)) {
                    var t = !0;
                    _.each(e, function(e) {
                        _.isNumber(e) || (t = !1)
                    }), t ? this.select.SetByIds(e) : this.select.SetByCriteria(_.map(e, function(e) {
                        return {
                            id: e.id,
                            field: e.field
                        }
                    }))
                }
            },
            onAppend: function() {
                var e = this.$el.find(".ui-ms-input");
                e && e.val() && _.setCaretPosition(e, e.val().length)
            },
            getValue: function() {
                var e = this.select.Get(),
                    t = _.map(e, function(e) {
                        return {
                            id: e.id,
                            title: e.title,
                            field: e.field
                        }
                    });
                return this.column.location[0] == "params.p1" && (t = _.pluck(t, "id").sort()), t
            },
            selectChanged: function() {
                this.select.options.hideEditFormOnChange !== !1 && (this.submit(), this.hide())
            },
            submit: function() {
                var e = this.getValue(),
                    t = {},
                    n = !0;
                _.each(this.column.location, function(e) {
                    t[e] = []
                }, this), _.each(this.column.location, function(n) {
                    _.each(e, function(e) {
                        (!e.field || n.match(new RegExp(e.field + "$"))) && t[n].push(e)
                    }, this)
                }, this), _.isArray(this.column.reset) && _.each(this.column.reset, function(e) {
                    t[e] = []
                }, this), _.each(t, function(e, t) {
                    _.isEqual(this.model.get(t), e) || (n = !1)
                }, this), n === !1 && (this.model.set(t), this.model.saveChanges())
            },
            district: function() {
                return {
                    data: this.listings.get("district-" + this.appData.get("locality-city")),
                    openOnAppend: !0
                }
            },
            adminDistrict: function() {
                return {
                    data: this.listings.get("adminDistrict-" + this.appData.get("locality-city")),
                    openOnAppend: !0
                }
            },
            "district-multiple": function() {
                return {
                    data: this.listings.get("district-" + this.appData.get("locality-city")),
                    showDefaultItem: !1,
                    multiple: !0,
                    width: 210,
                    renderSelectedInDropdown: !1,
                    hideEditFormOnChange: !1,
                    openOnAppend: function(e) {
                        return e.selected.length === 0
                    }
                }
            },
            street: function() {
                return {
                    data: this.listings.get("street-" + this.appData.get("locality-city")),
                    input: !0,
                    maxResultsCount: 10,
                    showDefaultItem: !1,
                    showDropDownButton: !1,
                    openOnAppend: !0,
                    width: 150,
                    placeholder: "Название улицы...",
                    formatSelection: function(e) {
                        return e.id ? e.title : ""
                    }
                }
            },
            town: function() {
                return {
                    data: this.listings.get("town-" + this.appData.get("locality-area")),
                    input: !0,
                    width: 210,
                    maxResultsCount: 10,
                    openOnAppend: !0,
                    showDefaultItem: !1,
                    showDropDownButton: !1
                }
            },
            "town-multiple": function() {
                return {
                    data: this.listings.get("town-" + this.appData.get("locality-area")),
                    input: !0,
                    multiple: !0,
                    width: 210,
                    maxResultsCount: 10,
                    renderSelectedInDropdown: !1,
                    hideEditFormOnChange: !1,
                    showDefaultItem: !1,
                    showDropDownButton: !1
                }
            },
            "city-area": function() {
                return {
                    data: this.listings.get("city-area-" + this.appData.get("region")),
                    width: 170,
                    openOnAppend: !0
                }
            },
            "district-town": function() {
                var e = this.model.get("terrain.city"),
                    t = this.model.get("terrain.area");
                e = _.isArray(e) && e.length ? e[0].id : null, t = _.isArray(t) && t.length ? t[0].id : null;
                var n = {
                    data: _.filter(this.listings.get("district-town-" + this.appData.get("region")), function(n) {
                        if (e) return n.city == e;
                        if (t) return n.area == t
                    }),
                    openOnAppend: !0
                };
                return !e && t && (n = _.extend({
                    input: !0,
                    maxResultsCount: 10,
                    showDefaultItem: !1,
                    showDropDownButton: !1,
                    formatSelection: function(e) {
                        return e.id ? e.title : ""
                    }
                }, n)), n
            },
            estateType: function() {
                return {
                    data: this.listings.get("estateType-" + this.appData.get("marketSegment")),
                    width: 150,
                    openOnAppend: !0
                }
            },
            "estateType-multiple": function() {
                return {
                    data: this.listings.get("estateType-" + this.appData.get("marketSegment")),
                    width: 150,
                    showDefaultItem: !1,
                    multiple: !0,
                    renderSelectedInDropdown: !1,
                    hideEditFormOnChange: !1,
                    openOnAppend: function(e) {
                        return e.selected.length === 0
                    }
                }
            },
            "p1-multiple": function() {
                return {
                    data: [{
                        id: 1,
                        title: "1"
                    }, {
                        id: 2,
                        title: "2"
                    }, {
                        id: 3,
                        title: "3"
                    }, {
                        id: 4,
                        title: "4"
                    }, {
                        id: 5,
                        title: "5-к и более"
                    }],
                    width: 140,
                    multiple: !0,
                    showDefaultItem: !1,
                    renderSelectedInDropdown: !1,
                    hideEditFormOnChange: !1,
                    openOnAppend: function(e) {
                        return e.selected.length === 0
                    }
                }
            },
            p10: function() {
                return {
                    data: this.listings.get("p10-" + this.appData.get("marketSegment")),
                    width: 140,
                    multiple: !0,
                    showDefaultItem: !1,
                    renderSelectedInDropdown: !1,
                    hideEditFormOnChange: !1,
                    openOnAppend: function(e) {
                        return e.selected.length === 0
                    }
                }
            },
            p20: function() {
                return {
                    data: this.listings.get("p20"),
                    width: 110,
                    openOnAppend: !0
                }
            }
        });
        return r
    }), define("UI/Tooltip/Views/Default", ["Shared/Abstract/View"], function(e) {
        var t = e.extend({
            attributes: {
                "class": "ui-tooltip"
            },
            events: {
                click: "hide"
            },
            defaults: {
                text: "",
                title: "",
                url: "",
                position: "right",
                x: 0,
                y: 0,
                top: 0,
                left: 0,
                $el: null
            },
            initialize: function() {
                _.bindAll(this), this.opts = _.extend(_.clone(this.defaults), this.options), this.render().show()
            },
            render: function() {
                return this.$el.append(this.template()).appendTo("body"), this.$el.addClass("ui-tooltip-" + this.opts.position), this.opts.title || this.$el.find("h3").hide(), this.opts.text || this.$el.find(".body").hide(), this.opts.url || this.$el.find(".url").hide(), this
            },
            show: function() {
                var e;
                if ((!this.opts.x || !this.opts.y) && !this.opts.$el) return;
                this.opts.$el && (e = this.opts.position == "left" ? 0 - this.$el.width() - 40 : this.opts.$el.width() + 8), this.$el.css({
                    left: this.opts.x ? this.opts.x : this.opts.$el.offset().left + e + this.opts.left,
                    top: this.opts.y ? this.opts.y : this.opts.$el.offset().top + this.opts.top,
                    display: "block",
                    marginLeft: this.opts.position == "right" ? 10 : 0,
                    marginRight: this.opts.position == "left" ? 10 : 0,
                    opacity: .6
                }).animate({
                    marginLeft: this.opts.position == "right" ? 0 : 10,
                    marginRight: this.opts.position == "left" ? 0 : 10,
                    opacity: 1
                })
            },
            hide: function() {
                this.$el.fadeOut(this.close)
            },
            template: function() {
                return "<h3>" + this.opts.title + '</h3>            <div class="body">' + this.opts.text + '</div>            <div class="url"><a>' + this.opts.url + '</a></div>            <div class="triangle-shadow"></div>            <div class="triangle-shadow-hider"></div>            <div class="triangle">                <div class="bg-' + this.opts.position + '-1">                    <div class="' + this.opts.position + '-1"></div>                </div>                <div class="bg-' + this.opts.position + '-2">                    <div class="' + this.opts.position + '-2"></div>                </div>            </div>'
            }
        });
        return t
    }), define("Base/Ad/Views/Edit/Input", ["Shared/Abstract/View", "Base/Config", "UI/Tooltip/Views/Default"], function(e, t, n) {
        return e.extend({
            initialize: function(e) {
                _.bindAll(this), this.options = e, this.appData = window.AppData.Base.data, this.column = t.columns.getCurrent(this.appData)[this.options.field], this.bindTo(this, "append", this.setFocus), this.bindTo(this, "documentClick", this.submit), this.render()
            },
            events: {
                "keyup .base-edit-input": "inputOnKeyUp",
                "keypress .base-edit-input": "inputOnKeyPress",
                "keyup input": "showTooltipsOnKeyUp"
            },
            setFocus: function() {
                var e = this.$el.find("input").first();
                _.setCaretPosition(e, e.val().length)
            },
            hide: function() {
                this.tooltip && this.tooltip.hide(), this.trigger("close")
            },
            onClose: function() {
                clearTimeout(this.tooltipTimeout), this.tooltip && this.tooltip.hide()
            },
            render: function() {
                return this.makeInput(), this
            },
            inputTemplate: function() {
                return '<input class="base-edit-input" placeholder="' + t.empty + '" type="text" />'
            },
            makeInput: function() {
                for (var e in this.column.location) {
                    var n = $(this.inputTemplate()),
                        r = this.model.get(this.column.location[e]);
                    r = _.isArray(r) ? r[0] ? r : null : r, n.val(r ? r : ""), n.attr("maxlength", t.editField.maxlength[this.options.field][e]), this.$el.append(n)
                }
            },
            inputOnKeyUp: function(e) {
                var t = e.keyCode || e.which;
                if (t == 13) return this.submit(), !1
            },
            inputOnKeyPress: function(e) {
                var t = e.keyCode || e.which;
                if ((t < 48 || t > 57) && t != 13 && t != 58 && t != 8 && t != 9) return !1
            },
            getValues: function() {
                return _.map(this.$el.find("input"), function(e) {
                    return [parseInt(e.value || 0)]
                })
            },
            showTooltip: function(e, t) {
                this.tooltip && this.tooltip.close(), this.tooltip = new n({
                    text: e,
                    $el: t,
                    top: -7
                })
            },
            showTooltipsOnKeyUp: function() {
                clearTimeout(this.tooltipTimeout), this.tooltipTimeout = setTimeout(this.preValidate, 1e3)
            },
            preValidate: function() {
                return !0
            },
            submit: function() {
                if (this.preValidate() === !1) return;
                var e = this.getValues(),
                    t = {},
                    n = !0;
                for (var r in e) t[this.column.location[r]] = e[r], _.isEqual(this.model.get(this.column.location[r]), e[r]) || (n = !1);
                n === !1 && (this.model.set(t), this.model.saveChanges()), this.hide()
            }
        })
    }), define("Base/Ad/Views/Edit/Rooms", ["Base/Ad/Views/Edit/Input", "Base/Config"], function(e, t) {
        var n = e.extend({
            getValues: function() {
                var e = parseInt(this.$el.find("input").first().val()),
                    t = parseInt(this.$el.find("input").last().val());
                return [e ? [e] : [], t || 0]
            },
            preValidate: function() {
                var e = this.getValues(),
                    n = !0;
                return this.tooltip && this.tooltip.hide(), e[0][0] && e[1] && e[0][0] < e[1] && (this.showTooltip(t.hints["input-p1-p2"], this.$el), n = !1), this.$el.find("input")[n ? "removeClass" : "addClass"]("input-error"), n
            }
        });
        return n
    }), define("Base/Ad/Views/Edit/Floor", ["Base/Ad/Views/Edit/Input", "Base/Config"], function(e, t) {
        var n = e.extend({
            preValidate: function() {
                var e = this.getValues(),
                    n = !0;
                return this.tooltip && this.tooltip.hide(), e[0][0] && e[1][0] && e[0][0] > e[1][0] && (this.showTooltip(t.hints["input-p3-p4"], this.$el), n = !1), this.$el.find("input")[n ? "removeClass" : "addClass"]("input-error"), n
            }
        });
        return n
    }), define("Base/Ad/Views/Edit/Phone", ["Shared/Abstract/View", "Base/Config"], function(e, t) {
        var n = e.extend({
            initialize: function(e) {
                _.bindAll(this), this.options = e, this.appData = window.AppData.Base.data, this.column = t.columns.getCurrent(this.appData)[this.options.field], this.bindTo(this, "append", this.setFocus), this.bindTo(this, "documentClick", this.submit), this.makePhones()
            },
            events: {
                "keyup .base-edit-input": "inputOnKeyUp",
                "keypress .base-edit-input": "inputOnKeyPress",
                "click .base-edit-phones-add": "phoneAddOnClick",
                "mouseup .base-edit-phones-delete": "phoneDeleteOnClick"
            },
            hide: function() {
                this.trigger("close")
            },
            setFocus: function(e) {
                var t = this.$el.find("input")[e ? e : "first"]();
                t.val() ? _.setCaretPosition(t, t.val().length) : t.focus()
            },
            inputOnKeyUp: function(e) {
                var t = e.keyCode || e.which;
                if (t == 13) return this.submit(), this.hide(), !1
            },
            inputOnKeyPress: function(e) {
                var t = e.keyCode || e.which;
                if ((t < 48 || t > 57) && t != 13 && t != 58 && t != 8) return !1
            },
            makePhones: function() {
                var e = this.model.get("info.contacts.phones");
                for (var t in e) {
                    var n = $(this.phoneTemplate());
                    n.find("input").val(e[t]), this.$el.append(n)
                }
                this.$el.append(this.phoneAddTemplate());
                if (!e.length) {
                    var n = $(this.phoneTemplate());
                    this.$el.find(".base-edit-phones-add").before(n)
                }
            },
            phoneTemplate: function() {
                return '<div><div class="b-i base-edit-phones-delete"></div><input class="base-edit-input" type="text" maxlength="10" /></div>'
            },
            phoneAddTemplate: function() {
                return '<div class="base-edit-phones-add"><div class="b-i"></div><a>Добавить номер</a></div>'
            },
            phoneAddOnClick: function() {
                var e = $(this.phoneTemplate());
                this.$el.find(".base-edit-phones-add").before(e), this.setFocus("last")
            },
            phoneDeleteOnClick: function(e) {
                $(e.target).parent().remove(), this.$el.find("input").length == 0 && this.phoneAddOnClick()
            },
            submit: function() {
                var e = _.compact(_.map(this.$el.find("input"), function(e) {
                    return e.value
                }));
                if (_.isEqual(this.model.get(this.column.location[0]), e)) return;
                this.model.set(this.column.location[0], e), this.model.saveChanges()
            }
        });
        return n
    }), define("Base/Ad/Views/Edit/Mark", ["Shared/Abstract/View", "Base/Config"], function(e, t) {
        var n = e.extend({
            initialize: function(e) {
                _.bindAll(this), this.appData = window.AppData.Base.data, this.listings = window.AppData.Base.listings, this.column = t.columns.getCurrent(this.appData)[this.options.field], this.render()
            },
            events: {
                "click .base-filter-list-title div": "hide",
                "click .base-checkbox": "submit"
            },
            hide: function() {
                this.trigger("close")
            },
            template: function() {
                var e = this.model.get("info.mark")[0].id,
                    n = '<div class="base-filter-list base-filter-mark' + (_.include(SITE_ADMINS, Auth.get("uid")) ? " base-filter-mark-admin" : "") + '">' + '<div class="base-filter-list-title">' + '<div class="base-mark base-mark-' + e + '"></div>' + "</div>" + '<div class="base-filter-list-title-hider"></div>' + '<div class="base-filter-list-items">';
                return _.each(this.listings.get("mark"), function(r) {
                    if (r.id == e || _.include(t.editField.blockedMarks, r.id) && !_.include(SITE_ADMINS, Auth.get("uid"))) return;
                    n += '<div class="base-checkbox" data-id="' + r.id + '">' + '<div class="base-mark base-mark-' + r.id + '"></div>' + '<div class="title">' + r.title + "</div>" + "</div>"
                }), n += "</div></div>", n
            },
            submit: function(e) {
                var t = _.map(_.filter(this.listings.get("mark"), function(t) {
                    return t.id == $(e.currentTarget).data("id")
                }), function(e) {
                    return {
                        id: e.id,
                        title: e.title
                    }
                });
                this.model.set(this.column.location[0], t), this.model.saveChanges(), this.model.trigger("MarkChanged"), this.hide()
            }
        });
        return n
    }), define("Base/Ad/Views/Edit/Date", ["Shared/Abstract/View", "Base/Config"], function(e, t) {
        return e.extend({
            initialize: function(e) {
                _.bindAll(this), this.options = e, this.appData = window.AppData.Base.data, this.column = t.columns.getCurrent(this.appData)[this.options.field], this.bindTo(this, "append", this.makeDatePickers), this.bindTo(this, "documentClick", this.hide), this.bindTo(this, "documentEscPressed", this.removeDatePickers), this.render(), this.fillCurrentDate()
            },
            events: {
                "click .base-date-inputs": "baseDateInputsOnClick",
                "input .base-date-input": "dateOnInput",
                "keypress .base-date-input": "dateOnKeyPress",
                "focus .base-date-input": "dateOnFocus"
            },
            fillCurrentDate: function() {
                var e = new Date(this.model.get("main.insertDate")),
                    t = ((e.getDate() < 10 ? "0" + e.getDate() : e.getDate()) + "." + (e.getMonth() + 1 < 10 ? "0" + (e.getMonth() + 1) : e.getMonth() + 1) + "." + e.getFullYear().toString()).split(".");
                this.$el.find(".base-date-input").each(function(e) {
                    e <= 2 && $(this).val(t[e])
                })
            },
            baseDateInputsOnClick: function(e) {
                var t = $(e.target);
                if (!t.hasClass("base-date-input")) {
                    var n = t.parents(".base-dp-container").find(".base-date-input"),
                        r = n.last().val() || !t.hasClass("b-i") ? n.last() : n.first();
                    _.setCaretPosition(r, r.val() ? r.val().length : 0)
                }
            },
            dateOnFocus: function(e) {
                $(e.currentTarget).parent().next().datepicker("show")
            },
            dateOnKeyPress: function(e) {
                var t = e.keyCode || e.which;
                if ((t < 48 || t > 57) && t != 13 && t != 58 && t != 8) return !1;
                t == 13 && ($(e.currentTarget).parent().next().datepicker("hide"), this.submit())
            },
            dateOnInput: function(e) {
                var t = $(e.currentTarget),
                    n = t.parent().next(),
                    r = _.map(this.$el.find(".base-date-input"), function(e) {
                        return e.value || 0
                    });
                n.datepicker("show");
                var i = new Date(r[1] + "/" + r[0] + "/" + r[2]);
                i.toString() == "Invalid Date" || r[2] < 2e3 ? window.AppData.date(function(e) {
                    n.val(e), n.datepicker("update")
                }) : (n.val(r[1] + "/" + r[0] + "/" + r[2]), n.datepicker("update")), t.val().length == t.attr("maxlength") ? setTimeout(function() {
                    t.next().focus()
                }, 1) : t.val().length == 0 && setTimeout(function() {
                    t.prev().focus()
                }, 1)
            },
            makeDatePickers: function() {
                this.$el.find(".base-dp-input").datepicker({
                    language: "ru",
                    todayHighlight: !0,
                    autoclose: !0
                }).on("changeDate", this.setDate);
                var e = this.$el.find("input").first();
                _.setCaretPosition(e, e.val().length), this.$el.find(".base-dp-input").datepicker("show")
            },
            removeDatePickers: function() {
                this.$el.find(".base-dp-input").datepicker("remove")
            },
            setDate: function(e) {
                var t = new Date(e.date),
                    n = [t.getDate(), t.getMonth() + 1, t.getFullYear()];
                $(e.currentTarget).prev().find("input").each(function(e) {
                    e <= 2 && $(this).val(n[e])
                }), this.submit()
            },
            onClose: function() {
                this.removeDatePickers()
            },
            hide: function() {
                this.removeDatePickers(), this.trigger("close")
            },
            template: function() {
                return '            <div class="base-dp-container">                <div></div>                <div class="base-date-inputs">                    <input type="text" class="base-date-input base-date-day" maxlength="2">.<input type="text" class="base-date-input base-date-month" maxlength="2">.<input type="text" class="base-date-input base-date-year" maxlength="4">                    <div class="b-i"></div>                </div>                <input type="text" class="base-dp-input base-date-from" tabindex="-1">            </div>'
            },
            submit: function() {
                var e = _.map(this.$el.find(".base-date-input"), function(e) {
                        return e.value
                    }),
                    t = new Date(e[1] + "/" + e[0] + "/" + e[2]);
                this.removeDatePickers();
                if (t.toString() == "Invalid Date") return;
                var n = this;
                this.hide(), window.AppData.date(function(t) {
                    var r = new Date(t);
                    r.setDate(e[0]), r.setMonth(e[1] - 1), r.setYear(e[2]), n.model.set(n.column.location[0], (new Date(r)).getTime()), n.model.saveChanges()
                })
            }
        })
    }), define("Base/Ad/Views/Edit/Square", ["Base/Ad/Views/Edit/Input", "Base/Config"], function(e, t) {
        var n = e.extend({
            preValidate: function() {
                var e = this.getValues(),
                    n = !0;
                return this.tooltip && this.tooltip.hide(), e[0][0] && e[1][0] && e[2][0] && e[0][0] < e[1][0] && e[0][0] < e[2][0] ? (this.showTooltip(t.hints["input-p5-p6-3"], this.$el), n = !1) : e[0][0] && e[1][0] && e[0][0] < e[1][0] ? (this.showTooltip(t.hints["input-p5-p6-1"], this.$el), n = !1) : e[0][0] && e[2][0] && e[0][0] < e[2][0] ? (this.showTooltip(t.hints["input-p5-p6-2"], this.$el), n = !1) : e[0][0] && e[1][0] && e[2][0] && e[0][0] < e[1][0] + e[2][0] && (this.showTooltip(t.hints["input-p5-p6-4"], this.$el), n = !1), this.$el.find("input")[n ? "removeClass" : "addClass"]("input-error"), n
            }
        });
        return n
    }), define("Base/Ad/Views/Edit/Price", ["Base/Ad/Views/Edit/Input"], function(e) {
        var t = e.extend({
            getValues: function() {
                return _.map(this.$el.find("input"), function(e) {
                    return parseInt(e.value || 0)
                })
            }
        });
        return t
    }), define("Base/Ad/Views/Edit/Range", ["Base/Ad/Views/Edit/Input", "Base/Config"], function(e, t) {
        var n = e.extend({
            makeInput: function() {
                var e = this.model.get(this.column.location[0]),
                    n = $(this.inputTemplate()),
                    r = $(this.inputTemplate());
                n.val(e[0] || "").attr("maxlength", t.editField.maxlength[this.options.field][0]), r.val(e[1] || "").attr("maxlength", t.editField.maxlength[this.options.field][1]), this.$el.append(n, r)
            },
            getValues: function() {
                var e = parseInt(this.$el.find("input").first().val()) || 0,
                    t = parseInt(this.$el.find("input").last().val()) || 0;
                return [
                    [e, t]
                ]
            },
            preValidate: function() {
                var e = this.getValues(),
                    n = !0;
                return this.tooltip && this.tooltip.hide(), e[0][0] && e[0][1] && e[0][0] > e[0][1] && (this.showTooltip(t.hints.minmax, this.$el), n = !1), this.$el.find("input")[n ? "removeClass" : "addClass"]("input-error"), n
            }
        });
        return n
    }), define("Base/Ad/Views/Edit/Street", ["Base/Ad/Views/Edit/List", "Base/Config"], function(e, t) {
        var n = e.extend({
            attributes: {
                "class": "base-edit-street-container"
            },
            getValue: function() {
                var e = this.select.Get(),
                    t = [];
                t[0] = _.map(e, function(e) {
                    return {
                        id: e.id,
                        title: e.title,
                        field: e.field
                    }
                });
                var n = this.$el.find("input").val(),
                    r, i, s, o = n.match(/^(\d{1,3})(.*?)?(\/\d{1,2})?$/);
                return o ? (r = parseInt(o[1]) || 0, i = o[2] || "", s = parseInt(o[3] ? o[3].replace(/\D+/, "") : 0) || 0) : i = n, !r && !i && !s ? t[1] = [] : t[1] = [{
                    field: "house",
                    number: r,
                    letter: i || "",
                    block: s
                }], t
            },
            preValidate: function() {
                return !0
            },
            submit: function() {
                if (this.preValidate() === !1) return;
                var e = this.getValue(),
                    t = {};
                e[0].length || (e[1] = []);
                var n = !0;
                for (var r in e) t[this.column.location[r]] = e[r], _.isEqual(this.model.get(this.column.location[r]), e[r]) || (n = !1);
                n === !1 && (this.model.set(t), this.model.saveChanges()), this.hide()
            },
            template: function() {
                var e = this.model.get("terrain.house")[0] || {},
                    t = e.number || "",
                    n = e.letter || "",
                    r = e.block || "",
                    i = t + (n ? n.toLowerCase() : "") + (r ? "/" + r : "");
                return '                <div class="select-container"></div>&nbsp;                &nbsp;<input value="' + i + '" class="base-house-number base-edit-input" placeholder="№ дома" type="text"  maxlength="10" />            '
            }
        });
        return n
    }), define("Base/Ad/Views/Edit/CityAreaDistrictTown", ["Base/Ad/Views/Edit/List"], function(e) {
        var t = e.extend({
            setSelectValue: function(e) {
                if (!e || !_.isArray(e)) return;
                this.select.SetByCriteria(_.map(e, function(e) {
                    return {
                        id: e.id,
                        field: e.field
                    }
                }));
                var t = this.select.Get(),
                    n = [];
                _.each(t, function(e) {
                    e.field === "city" ? _.where(t, {
                        field: "district",
                        city: e.id
                    }).length === 0 && n.push(e) : e.field === "area" ? _.where(t, {
                        field: "town",
                        area: e.id
                    }).length === 0 && n.push(e) : n.push(e)
                }, this), this.select.Set(n)
            },
            getValue: function() {
                var e = this.select.Get(),
                    t = _.map(e, function(e) {
                        return {
                            id: e.id,
                            title: e.title,
                            field: e.field
                        }
                    }),
                    n = [];
                return _.each(e, function(e) {
                    e.area && e.areaTitle && n.push({
                        id: e.area,
                        title: e.areaTitle,
                        field: "area"
                    }), e.city && e.cityTitle && n.push({
                        id: e.city,
                        title: e.cityTitle,
                        field: "city"
                    })
                }, this), t = _.uniq(_.union(t, n), function(e) {
                    return e.id + "." + e.field
                }), t
            },
            "city-area-district-town": function() {
                var e = this.listings.get("city-area-district-town-" + this.appData.get("region"));
                return {
                    hideEditFormOnChange: !1,
                    data: e,
                    width: 170,
                    input: !0,
                    maxResultsCount: 10,
                    showDefaultItem: !1,
                    showDropDownButton: !1,
                    renderSelectedInDropdown: !1,
                    multiple: !0,
                    placeholder: "",
                    formatMultipleSelection: function(t) {
                        var n = _.where(e, {
                            id: t.id,
                            field: t.field
                        });
                        t = n.length ? n[0] : t;
                        var r = t.cityTitle ? t.cityTitle : t.areaTitle ? t.areaTitle : "";
                        return t.title + (r ? " (" + r + ")" : "")
                    },
                    formatResult: function(e) {
                        var t = e.cityTitle ? e.cityTitle : e.areaTitle ? e.areaTitle : "";
                        return e.title + (t ? " (" + t + ")" : "")
                    }
                }
            }
        });
        return t
    }), define("Base/Ad/Views/Edit/AdminDistrictDistrict", ["Base/Ad/Views/Edit/List"], function(e) {
        var t = e.extend({
            setSelectValue: function(e) {
                if (!e || !_.isArray(e)) return;
                this.select.SetByCriteria(_.map(e, function(e) {
                    var t = {
                        id: e.id,
                        field: e.field
                    };
                    return e.adminDistrict && (t.adminDistrict = e.adminDistrict), t
                }));
                var t = this.select.Get(),
                    n = _.pluck(_.filter(t, function(e) {
                        return e.field === "adminDistrict"
                    }), "id"),
                    r = [];
                _.each(t, function(e) {
                    e.field === "adminDistrict" ? _.where(t, {
                        field: "district",
                        adminDistrict: e.id
                    }).length === 0 && r.push(e) : r.push(e)
                }, this), r = _.filter(r, function(e) {
                    return !e.adminDistrict || _.include(n, e.adminDistrict)
                }), this.select.Set(r)
            },
            getValue: function() {
                var e = this.select.Get(),
                    t = _.map(e, function(e) {
                        var t = {
                            id: e.id,
                            title: e.title,
                            field: e.field
                        };
                        return e.adminDistrict && (t.adminDistrict = e.adminDistrict), t
                    }),
                    n = [];
                return _.each(e, function(e) {
                    if (e.adminDistrict) {
                        var t = _.where(this.select.options.data, {
                            field: "adminDistrict",
                            id: e.adminDistrict
                        });
                        t && t.length && n.push(t[0])
                    }
                }, this), t = _.uniq(_.union(t, n), function(e) {
                    return e.id + "." + e.adminDistrict + "." + e.field
                }), console.log(t), t
            },
            "adminDistrict-district-multiple": function() {
                var e = this.listings.get("adminDistrict-district-" + this.appData.get("locality-city"));
                return e = _.reduce(e, function(e, t) {
                    return t.field === "district" ? _.each(t.adminDistrict, function(n) {
                        var r = _.clone(t);
                        r.adminDistrict = n, e.push(r)
                    }) : e.push(t), e
                }, []), {
                    hideEditFormOnChange: !1,
                    data: e,
                    width: 170,
                    input: !0,
                    maxResultsCount: 10,
                    showDefaultItem: !1,
                    showDropDownButton: !1,
                    multiple: !0,
                    placeholder: "",
                    formatMultipleSelection: function(e) {
                        var t = _.where(this.data, {
                                id: e.id,
                                field: e.field
                            }),
                            n = _.where(this.data, {
                                id: e.adminDistrict,
                                field: "adminDistrict"
                            });
                        return e.title + (n.length ? " (" + n[0].title + ")" : "")
                    },
                    formatResult: function(e) {
                        var t = _.where(this.data, {
                            id: e.adminDistrict,
                            field: "adminDistrict"
                        });
                        return e.title + (t.length ? " (" + t[0].title + ")" : "")
                    }
                }
            }
        });
        return t
    }), define("Base/Ad/Views/Edit", ["Shared/Abstract/View", "Base/Config", "Base/Ad/Views/Edit/List", "Base/Ad/Views/Edit/Rooms", "Base/Ad/Views/Edit/Floor", "Base/Ad/Views/Edit/Input", "Base/Ad/Views/Edit/Phone", "Base/Ad/Views/Edit/Mark", "Base/Ad/Views/Edit/Date", "Base/Ad/Views/Edit/Square", "Base/Ad/Views/Edit/Price", "Base/Ad/Views/Edit/Range", "Base/Ad/Views/Edit/Street", "Base/Ad/Views/Edit/CityAreaDistrictTown", "Base/Ad/Views/Edit/AdminDistrictDistrict", "Libs/jQuery/Scroll"], function(e, t, n, r, i, s, o, u, a, f, l, c, h, p, d) {
        var v = e.extend({
            attributes: {
                "class": "base-edit"
            },
            initialize: function() {
                _.bindAll(this), this.$el.addClass("base-edit-" + this.options.field), this.makeEditSubView(), this.bindDocumentEvents()
            },
            editViews: {
                adminDistrict: [n, "left"],
                "adminDistrict-district-multiple": [d, "left"],
                district: [n, "left"],
                "district-multiple": [n, "left"],
                street: [h, "left"],
                "city-area": [n, "left"],
                "district-town": [n, "left"],
                town: [n, "left"],
                "town-multiple": [n, "left"],
                estateType: [n, "left"],
                "estateType-multiple": [n, "left"],
                "city-area-district-town": [p, "left"],
                p10: [n, "left"],
                p19: [n, "left"],
                p20: [n, "left"],
                "p1-p2": [r, "center"],
                "p1-multiple": [n, "center"],
                "p3-p4": [i, "center"],
                p4: [s, "center"],
                "p5-p6-p7": [f, "center"],
                p5: [s, "center"],
                "p5-range": [c, "center"],
                p8: [s, "center"],
                "p8-range": [c, "center"],
                price: [l, "center"],
                budget: [l, "center"],
                phones: [o, "center"],
                mark: [u, "center"],
                date: [a, "left"]
            },
            makeEditSubView: function() {
                if (!this.editViews[this.options.field]) {
                    this.hide();
                    return
                }
                var e = new this.editViews[this.options.field][0]({
                    model: this.model,
                    field: this.options.field
                });
                this.bindTo(e, "close", this.hide), this.bindTo(window.AppData.Base.events, "EditMarkClicked", this.hide), this.appendSubview(e)
            },
            hide: function() {
                this.trigger("close"), this.close()
            },
            onClose: function() {
                this.unbindDocumentEvents()
            },
            onAppend: function() {
                var e = this.options.coords.left + (this.editViews[this.options.field][1] == "center" ? (this.options.cell.width - this.$el.width() - 6) / 2 : 0);
                e == 0 && (e = -1), this.$el.css({
                    top: Math.round(this.options.coords.top + (this.options.cell.height - this.$el.height() - 11) / 2),
                    left: e
                }), this.eachSubview(function(e) {
                    e.trigger("append")
                })
            },
            bindDocumentEvents: function() {
                $(document).bind("click.edit", this.documentOnClick), $(document).bind("keyup.edit", this.documentOnKeyup)
            },
            unbindDocumentEvents: function() {
                $(document).unbind("click.edit"), $(document).unbind("keyup.edit")
            },
            documentOnClick: function(e) {
                $(e.target).parents(".base-edit").length == 0 && !$(e.target).hasClass("base-edit") && this.$el.css("display") == "block" && (this.eachSubview(function(e) {
                    e.trigger("documentClick")
                }), this.hide())
            },
            documentOnKeyup: function(e) {
                var t = e.keyCode || e.which;
                t == 27 && (this.eachSubview(function(e) {
                    e.trigger("documentEscPressed")
                }), this.hide()), t == 13 && (this.eachSubview(function(e) {
                    e.trigger("documentEnterPressed")
                }), this.hide())
            }
        });
        return v
    }),
    function(e) {
        typeof define == "function" && define.amd ? define("Libs/Backbone/ModelBinder/Backbone.ModelBinder-0.1.6", ["underscore", "jquery", "backbone"], e) : e(_, $, Backbone)
    }(function(e, t, n) {
        if (!n) throw "Please include Backbone.js before Backbone.ModelBinder.js";
        return n.ModelBinder = function(t) {
            e.bindAll(this), this._modelSetOptions = t || {}
        }, n.ModelBinder.VERSION = "0.1.6", n.ModelBinder.Constants = {}, n.ModelBinder.Constants.ModelToView = "ModelToView", n.ModelBinder.Constants.ViewToModel = "ViewToModel", e.extend(n.ModelBinder.prototype, {
            bind: function(n, r, i, s) {
                this.unbind(), this._model = n, this._rootEl = r, this._modelSetOptions = e.extend({}, this._modelSetOptions, s);
                if (!this._model) throw "model must be specified";
                if (!this._rootEl) throw "rootEl must be specified";
                i ? (this._attributeBindings = t.extend(!0, {}, i), this._initializeAttributeBindings(), this._initializeElBindings()) : this._initializeDefaultBindings(), this._bindModelToView(), this._bindViewToModel()
            },
            bindCustomTriggers: function(e, t, n, r, i) {
                this._triggers = n, this.bind(e, t, r, i)
            },
            unbind: function() {
                this._unbindModelToView(), this._unbindViewToModel(), this._attributeBindings && (delete this._attributeBindings, this._attributeBindings = undefined)
            },
            _initializeAttributeBindings: function() {
                var t, n, r, i, s;
                for (t in this._attributeBindings) {
                    n = this._attributeBindings[t];
                    if (e.isString(n)) r = {
                        elementBindings: [{
                            selector: n
                        }]
                    };
                    else if (e.isArray(n)) r = {
                        elementBindings: n
                    };
                    else {
                        if (!e.isObject(n)) throw "Unsupported type passed to Model Binder " + r;
                        r = {
                            elementBindings: [n]
                        }
                    }
                    for (i = 0; i < r.elementBindings.length; i++) s = r.elementBindings[i], s.attributeBinding = r;
                    r.attributeName = t, this._attributeBindings[t] = r
                }
            },
            _initializeDefaultBindings: function() {
                var e, n, r, i, s;
                this._attributeBindings = {}, n = t("[name]", this._rootEl);
                for (e = 0; e < n.length; e++) r = n[e], i = t(r).attr("name"), this._attributeBindings[i] ? this._attributeBindings[i].elementBindings.push({
                    attributeBinding: this._attributeBindings[i],
                    boundEls: [r]
                }) : (s = {
                    attributeName: i
                }, s.elementBindings = [{
                    attributeBinding: s,
                    boundEls: [r]
                }], this._attributeBindings[i] = s)
            },
            _initializeElBindings: function() {
                var e, n, r, i, s, o, u;
                for (e in this._attributeBindings) {
                    n = this._attributeBindings[e];
                    for (r = 0; r < n.elementBindings.length; r++) {
                        i = n.elementBindings[r], i.selector === "" ? s = t(this._rootEl) : s = t(i.selector, this._rootEl);
                        if (s.length === 0) throw "Bad binding found. No elements returned for binding selector " + i.selector;
                        i.boundEls = [];
                        for (o = 0; o < s.length; o++) u = s[o], i.boundEls.push(u)
                    }
                }
            },
            _bindModelToView: function() {
                this._model.on("change", this._onModelChange, this), this.copyModelAttributesToView()
            },
            copyModelAttributesToView: function(t) {
                var n, r;
                for (n in this._attributeBindings)
                    if (t === undefined || e.indexOf(t, n) !== -1) r = this._attributeBindings[n], this._copyModelToView(r)
            },
            _unbindModelToView: function() {
                this._model && (this._model.off("change", this._onModelChange), this._model = undefined)
            },
            _bindViewToModel: function() {
                this._triggers ? e.each(this._triggers, function(e, n) {
                    t(this._rootEl).delegate(n, e, this._onElChanged)
                }, this) : (t(this._rootEl).delegate("", "change", this._onElChanged), t(this._rootEl).delegate("[contenteditable]", "blur", this._onElChanged))
            },
            _unbindViewToModel: function() {
                this._rootEl && (this._triggers ? e.each(this._triggers, function(e, n) {
                    t(this._rootEl).undelegate(n, e, this._onElChanged)
                }, this) : (t(this._rootEl).undelegate("", "change", this._onElChanged), t(this._rootEl).undelegate("[contenteditable]", "blur", this._onElChanged)))
            },
            _onElChanged: function(e) {
                var n, r, i, s;
                n = t(e.target)[0], r = this._getElBindings(n);
                for (i = 0; i < r.length; i++) s = r[i], this._isBindingUserEditable(s) && this._copyViewToModel(s, n)
            },
            _isBindingUserEditable: function(e) {
                return e.elAttribute === undefined || e.elAttribute === "text" || e.elAttribute === "html"
            },
            _getElBindings: function(e) {
                var t, n, r, i, s, o, u = [];
                for (t in this._attributeBindings) {
                    n = this._attributeBindings[t];
                    for (r = 0; r < n.elementBindings.length; r++) {
                        i = n.elementBindings[r];
                        for (s = 0; s < i.boundEls.length; s++) o = i.boundEls[s], o === e && u.push(i)
                    }
                }
                return u
            },
            _onModelChange: function() {
                var e, t;
                for (e in this._model.changedAttributes()) t = this._attributeBindings[e], t && this._copyModelToView(t)
            },
            _copyModelToView: function(e) {
                var r, i, s, o, u, a;
                u = this._model.get(e.attributeName);
                for (r = 0; r < e.elementBindings.length; r++) {
                    i = e.elementBindings[r];
                    for (s = 0; s < i.boundEls.length; s++) o = i.boundEls[s], o._isSetting || (a = this._getConvertedValue(n.ModelBinder.Constants.ModelToView, i, u), this._setEl(t(o), i, a))
                }
            },
            _setEl: function(e, t, n) {
                t.elAttribute ? this._setElAttribute(e, t, n) : this._setElValue(e, n)
            },
            _setElAttribute: function(t, r, i) {
                switch (r.elAttribute) {
                    case "html":
                        t.html(i);
                        break;
                    case "text":
                        t.text(i);
                        break;
                    case "enabled":
                        t.attr("disabled", !i);
                        break;
                    case "displayed":
                        t[i ? "show" : "hide"]();
                        break;
                    case "hidden":
                        t[i ? "hide" : "show"]();
                        break;
                    case "css":
                        t.css(r.cssAttribute, i);
                        break;
                    case "class":
                        var s = this._model.previous(r.attributeBinding.attributeName);
                        e.isUndefined(s) || (s = this._getConvertedValue(n.ModelBinder.Constants.ModelToView, r, s), t.removeClass(s)), i && t.addClass(i);
                        break;
                    default:
                        t.attr(r.elAttribute, i)
                }
            },
            _setElValue: function(e, t) {
                if (e.attr("type")) switch (e.attr("type")) {
                    case "radio":
                        e.val() === t && e.attr("checked", "checked");
                        break;
                    case "checkbox":
                        t ? e.attr("checked", "checked") : e.removeAttr("checked");
                        break;
                    default:
                        e.val(t)
                } else e.is("input") || e.is("select") || e.is("textarea") ? e.val(t) : e.text(t)
            },
            _copyViewToModel: function(e, r) {
                var i, s;
                r._isSetting || (r._isSetting = !0, this._setModel(e, t(r)), r._isSetting = !1, e.converter && (i = this._model.get(e.attributeBinding.attributeName), s = this._getConvertedValue(n.ModelBinder.Constants.ModelToView, e, i), this._setEl(t(r), e, s)))
            },
            _getElValue: function(e, t) {
                switch (t.attr("type")) {
                    case "checkbox":
                        return t.prop("checked") ? !0 : !1;
                    default:
                        return t.attr("contenteditable") !== undefined ? t.html() : t.val()
                }
            },
            _setModel: function(t, r) {
                var i = {},
                    s = this._getElValue(t, r);
                s = this._getConvertedValue(n.ModelBinder.Constants.ViewToModel, t, s), i[t.attributeBinding.attributeName] = s;
                var o = e.extend({}, this._modelSetOptions, {
                    changeSource: "ModelBinder"
                });
                this._model.set(i, o)
            },
            _getConvertedValue: function(e, t, n) {
                return t.converter && (n = t.converter(e, n, t.attributeBinding.attributeName, this._model)), n
            }
        }), n.ModelBinder.CollectionConverter = function(t) {
            this._collection = t;
            if (!this._collection) throw "Collection must be defined";
            e.bindAll(this, "convert")
        }, e.extend(n.ModelBinder.CollectionConverter.prototype, {
            convert: function(e, t) {
                return e === n.ModelBinder.Constants.ModelToView ? t ? t.id : undefined : this._collection.get(t)
            }
        }), n.ModelBinder.createDefaultBindings = function(e, n, r, i) {
            var s, o, u, a, f = {};
            s = t("[" + n + "]", e);
            for (o = 0; o < s.length; o++) {
                u = s[o], a = t(u).attr(n);
                if (!f[a]) {
                    var l = {
                        selector: "[" + n + '="' + a + '"]'
                    };
                    f[a] = l, r && (f[a].converter = r), i && (f[a].elAttribute = i)
                }
            }
            return f
        }, n.ModelBinder.combineBindings = function(t, n) {
            return e.each(n, function(e, n) {
                var r = {
                    selector: e.selector
                };
                e.converter && (r.converter = e.converter), e.elAttribute && (r.elAttribute = e.elAttribute), t[n] ? t[n] = [t[n], r] : t[n] = r
            }), t
        }, n.ModelBinder
    }), define("Libs/Backbone/ModelBinder", ["Libs/Backbone/ModelBinder/Backbone.ModelBinder-0.1.6"], function(e) {
        return e
    }),
    function(e) {
        e.browser.mozilla ? (e.fn.disableTextSelect = function() {
            return this.each(function() {
                e(this).css({
                    MozUserSelect: "none"
                })
            })
        }, e.fn.enableTextSelect = function() {
            return this.each(function() {
                e(this).css({
                    MozUserSelect: ""
                })
            })
        }) : e.browser.msie ? (e.fn.disableTextSelect = function() {
            return this.each(function() {
                e(this).bind("selectstart.disableTextSelect", function() {
                    return !1
                })
            })
        }, e.fn.enableTextSelect = function() {
            return this.each(function() {
                e(this).unbind("selectstart.disableTextSelect")
            })
        }) : (e.fn.disableTextSelect = function() {
            return this.each(function() {
                e(this).bind("mousedown.disableTextSelect", function() {
                    return !1
                })
            })
        }, e.fn.enableTextSelect = function() {
            return this.each(function() {
                e(this).unbind("mousedown.disableTextSelect")
            })
        })
    }(jQuery), define("Libs/jQuery/DisableSelect", ["Libs/jQuery/DisableSelect/jquery.disable.text.select-1.1.0"], function(e) {
        return e
    }), define("Libs/jQuery/DisableSelect/jquery.disable.text.select-1.1.0", function() {}), define("Base/Ad/Views/Ad", ["Shared/Abstract/View", "Base/Config", "Base/Ad/Views/Opened", "Base/Ad/Views/Edit", "UI/Slideshow/Views/Main", "Libs/Backbone/ModelBinder", "Libs/jQuery/DisableSelect"], function(e, t, n, r, i, s) {
        var o = e.extend({
            attributes: {
                "class": "base-ad"
            },
            events: {
                click: "toggleSelect",
                "click .base-ad-open": "toggleAd",
                "dblclick .base-cell": "editField",
                "click [data-field=mark] .base-mark": "selectAndEditField",
                "click .base-info": "baseInfoOnClick"
            },
            initialize: function(e) {
                _.bindAll(this), this.index = e.index, this.serverDate = e.serverDate, this.parentView = e.parentView, this.appData = window.AppData.Base.data, this.setCache(), this.bindTo(this.model, "CommentsChange", this.updateInfo), this.bindTo(this.model, "MarkChanged UndoChanges", this.setActual), this.bindTo(this.model, "AdRemovedByAdmin", this.close), this.bindTo(this.model, "change", this.setCache), this.bindTo(window.AppData.Base.listings, "change", function() {
                    this.modelBinder.bind(this.model, this.$el, this.modelBinderBindings)
                }, this)
            },
            setCache: function() {
                this.ad = this.model.toJSON()
            },
            makeModelBinderBindings: function() {
                this.modelBinderBindings = {};
                var e = t.columns.getCurrent(this.appData);
                for (var n in e) {
                    if (!_.isArray(e[n].location)) continue;
                    for (var r in e[n].location) this.modelBinderBindings[e[n].location[r] + ".id"] = {
                        selector: "[data-field=" + n + "] div",
                        converter: this[n],
                        elAttribute: "html"
                    }, this.modelBinderBindings[e[n].location[r]] = {
                        selector: "[data-field=" + n + "] div",
                        converter: this[n],
                        elAttribute: "html"
                    }
                }
            },
            initModelBinder: function() {
                this.makeModelBinderBindings(), this.modelBinder = new s, this.modelBinder.bind(this.model, this.$el, this.modelBinderBindings)
            },
            onClose: function() {
                this.modelBinder.unbind(), this.$el.find(".base-cell").enableTextSelect()
            },
            updateInfo: function() {
                this.setCache(), this.$el.find("[data-field=info] div").empty().append(this.info())
            },
            template: function() {
                var e = t.columns.getCurrent(this.appData),
                    n = '<div class="base-ad-row ' + (this.index ? "base-ad-even" : "base-ad-odd") + '">';
                for (var r in e) {
                    if (r == "id") continue;
                    n += '<div class="base-cell"' + (e[r].hint ? ' title="' + e[r].hint + '"' : "") + ' data-field="' + r + '" style="width: ' + e[r].width + 'px;">' + '<div class="base-cell-text base-cell-text-' + e[r].align + '"></div>' + "</div>"
                }
                return n += '<div class="base-cell base-ad-open" title="Раскрыть" data-field="id" style="width: ' + e.id.width + 'px;">' + '<div class="b-i base-cell-text base-ad-open-button"></div>' + "</div>" + '<div class="base-ad-mark-new"></div>' + '<div class="base-ad-opened"></div>' + "</div>", n
            },
            render: function() {
                return this.$el.append(this.template()).find(".base-cell").disableTextSelect(), this.initModelBinder(), this.setActual(), this
            },
            setActual: function() {
                this.ad.info.mark.length && this.ad.info.mark[0].id == 3 ? this.$el.addClass("base-ad-not-actual") : this.$el.removeClass("base-ad-not-actual")
            },
            renderOpenedAd: function(e) {
                this.adOpened = new n({
                    model: this.model
                }), this.appendSubview(this.adOpened, this.$el.find(".base-ad-opened")), this.adOpened.render(e)
            },
            toggleAd: function(e) {
                e = e === undefined ? !0 : e, this.$el.find(".base-ad-opened").is(":visible") ? (this.$el.css({
                    height: "auto"
                }).find(".base-ad-opened").hide(), this.parentView.selectedAds[this.cid] = this, this.$el.find(".base-ad-open").removeClass("base-ad-close").attr("title", "Раскрыть"), this.adOpened.close()) : (this.$el.css({
                    height: "auto"
                }).find(".base-ad-opened").show(), this.$el.hasClass("base-ad-selected") && (this.unSelect(), this.$el.css({
                    marginBottom: -1
                })), this.select(), this.$el.find(".base-ad-open").addClass("base-ad-close").attr("title", "Закрыть"), this.renderOpenedAd(e))
            },
            toggleSelect: function(e) {
                _.each(this.parentView.selectedAds, this.tryUnSelect), !this.$el.hasClass("base-ad-selected") && !this.$el.find(".base-ad-opened").is(":visible") && (this.select(), this.parentView.selectedAds[this.cid] = this)
            },
            tryUnSelect: function(e, t) {
                e.$el.hasClass("base-ad-selected") && !e.$el.find(".base-ad-opened").is(":visible") && e.cid !== this.cid && (e.unSelect(), delete this.parentView.selectedAds[t])
            },
            select: function() {
                var e = this.$el.find(".base-cell:first-child").width(),
                    t = this.$el.find(".base-ad-row").width(),
                    n = this.$el.find(".base-ad-open").width();
                this.$el.addClass("base-ad-selected"), this.$el.css({
                    marginBottom: -1
                }), this.$el.find(".base-cell:first-child").css({
                    width: e - 1
                }), this.$el.find(".base-ad-row").css({
                    width: t - 2
                }), this.$el.find(".base-ad-open").css({
                    width: n - 1
                })
            },
            unSelect: function() {
                var e = this.$el.find(".base-cell:first-child").width(),
                    t = this.$el.find(".base-ad-open").width(),
                    n = this.$el.find(".base-ad-row").width();
                this.$el.css({
                    marginBottom: 0
                }), this.$el.find(".base-cell:first-child").css({
                    width: e + 1
                }), this.$el.find(".base-ad-row").css({
                    width: n + 2
                }), this.$el.find(".base-ad-open").css({
                    width: t + 1
                }), this.$el.removeClass("base-ad-selected")
            },
            selectAndEditField: function(e) {
                !this.$el.hasClass("base-ad-selected") && !this.$el.find(".base-ad-opened").is(":visible") && this.toggleSelect(e), window.AppData.Base.events.trigger("EditMarkClicked"), _.stopPropagation(e), this.editField(e)
            },
            editField: function(e) {
                this.addEditClass();
                var n = $(e.currentTarget).data("field") ? $(e.currentTarget) : $(e.currentTarget).parent().parent(),
                    i = n.data("field");
                if (_.include(t.editField.blocked, i) || e.type == "dblclick" && i == "mark") return;
                var s = new r({
                    model: this.model,
                    field: i,
                    coords: {
                        top: n.parent().parent().position().top,
                        left: n.position().left
                    },
                    cell: {
                        height: n.height(),
                        width: n.width()
                    }
                });
                this.bindTo(s, "close", this.removeEditClass), this.appendSubview(s)
            },
            addEditClass: function() {
                this.$el.addClass("base-edit-active")
            },
            removeEditClass: function() {
                this.$el.removeClass("base-edit-active")
            },
            baseInfoOnClick: function() {
                (this.ad.comments.length || this.ad.info.notes) && !this.ad.info.photo.length && this.toggleAd(), this.ad.info.photo.length && this.showSlideshow()
            },
            showSlideshow: function() {
                var e = this.model.toJSON();
                e.info.photo = this.model.preparePhotos(), this.slideshow = new i({
                    title: "Фотографии объекта",
                    images: _.pluck(e.info.photo, "original"),
                    thumbs: _.pluck(e.info.photo, "thumbnail"),
                    comments: {
                        big: !0,
                        location: {
                            collection: "baseads",
                            document: {
                                "main.id": this.model.get("main.id")
                            }
                        },
                        comments: this.model.get("comments")
                    },
                    scrollToComments: !!this.model.get("comments").length
                }), this.bindTo(this.slideshow, "CommentsChanged", this.onSlideShowCommentsChanged)
            },
            onSlideShowCommentsChanged: function(e) {
                this.model.set("comments", e, {
                    silent: !0
                }), this.updateInfo()
            },
            markAsNew: function() {
                this.$el.addClass("base-ad-new")
            },
            markAsUnSeen: function() {
                this.$el.addClass("base-ad-unseen")
            },
            "p1-p2": function() {
                var e = _.compact(this.ad.params.p1);
                return (_.isArray(e) && e.length ? e[0] : t.emptyDiv) + (this.ad.params.p2 ? " (" + this.ad.params.p2 + ")" : "")
            },
            "p1-multiple": function() {
                var e = _.compact(this.ad.params.p1);
                return _.isArray(e) && e.length ? e.join(", ").replace("5", "5 - к. и более") : t.emptyDiv
            },
            "p3-p4": function() {
                var e = (parseInt(this.ad.params.p3) || t.emptyNumberSpan) + "&nbsp;" + (parseInt(this.ad.params.p3) || parseInt(this.ad.params.p4) ? t.emptyDarkSlash : t.emptySlash) + "&nbsp;" + (parseInt(this.ad.params.p4) || t.emptyNumberSpan);
                return e = e.replace(/(\d+)/g, '<span class="base-cell-text-number">$1</span>'), e
            },
            "p5-p6-p7": function() {
                var e = (parseInt(this.ad.params.p5) || t.emptyNumberSpan) + "&nbsp;" + (parseInt(this.ad.params.p5) || parseInt(this.ad.params.p6) ? t.emptyDarkSlash : t.emptySlash) + "&nbsp;" + (parseInt(this.ad.params.p6) || t.emptyNumberSpan) + "&nbsp;" + (parseInt(this.ad.params.p6) || parseInt(this.ad.params.p7) ? t.emptyDarkSlash : t.emptySlash) + "&nbsp;" + (parseInt(this.ad.params.p7) || t.emptyNumberSpan);
                return e.replace(/(\d+)/g, '<span class="base-cell-text-number">$1</span>')
            },
            "p5-range": function() {
                if (!_.isArray(this.ad.params.p5)) return t.emptyDiv;
                var e = parseInt(this.ad.params.p5[0]),
                    n = parseInt(this.ad.params.p5[1]);
                return e && n ? e === n ? e : e + " – " + n : !e && n ? "до " + n : e && !n ? "от " + e : t.emptyDiv
            },
            "p8-range": function() {
                if (!_.isArray(this.ad.params.p8)) return t.emptyDiv;
                var e = parseInt(this.ad.params.p8[0]),
                    n = parseInt(this.ad.params.p8[1]);
                return e && n ? e + " – " + n : !e && n ? "до " + n : e && !n ? "от " + e : t.emptyDiv
            },
            adminDistrict: function() {
                return _.map(this.ad.terrain.adminDistrict, function(e) {
                    return e.title.replace(" р-н", "")
                }).join(", ") || t.emptyDiv
            },
            district: function() {
                return _.each(this.ad.terrain.district, function(e) {
                    e.title = e.title.replace(/^([^\s]+)\s([^\s]+)\s(ул|пр|бул|пер)\.$/g, "$1 $2&nbsp;$3.")
                }), _.pluck(this.ad.terrain.district, "title").join(", ") || t.emptyDiv
            },
            "district-multiple": function() {
                return this.district()
            },
            street: function() {
                _.each(this.ad.terrain.street, function(e, t) {
                    e.title = e.title.replace(/^([^\s]+)\s([^\s]+)\s(ул|пр|бул|пер)\.$/g, "$1 $2&nbsp;$3.")
                });
                var e = "";
                return this.ad.terrain.house && this.ad.terrain.house.length && this.ad.terrain.house[0] && (this.ad.terrain.house[0].number || this.ad.terrain.house[0].letter) && (e = ",&nbsp;" + (this.ad.terrain.house[0].number || "") + (this.ad.terrain.house[0].letter || "") + (parseInt(this.ad.terrain.house[0].block) ? "/" + this.ad.terrain.house[0].block : "")), _.pluck(this.ad.terrain.street, "title").join(", ") + e || t.emptyDiv
            },
            "city-area": function() {
                var e = _.pluck(this.ad.terrain.city, "title").join(", "),
                    n = _.pluck(this.ad.terrain.area, "title").join(", ").replace(/р\-н/g, "<nobr>р-н</nobr>");
                return e || n || t.emptyDiv
            },
            "district-town": function() {
                var e = _.isArray(this.ad.terrain.city) && this.ad.terrain.city.length,
                    n = _.isArray(this.ad.terrain.area) && this.ad.terrain.area.length,
                    r = _.pluck(this.ad.terrain.district, "title").join(", "),
                    i = _.pluck(this.ad.terrain.town, "title").join(", ");
                return e ? r || t.emptyDiv : n ? i || t.emptyDiv : t.emptyDiv
            },
            "adminDistrict-district-multiple": function() {
                var e = window.AppData.Base.listings.get("adminDistrict-district-" + this.appData.get("locality-city")),
                    n = [],
                    r = {},
                    i = {};
                if (!e || !e.length) return t.emptyDiv;
                if (_.isArray(this.ad.terrain.adminDistrict) && this.ad.terrain.adminDistrict.length) {
                    var s = _.pluck(this.ad.terrain.adminDistrict, "id");
                    _.each(_.filter(e, function(e) {
                        return _.include(s, e.id) && e.field == "adminDistrict"
                    }), function(e) {
                        i[e.title] = []
                    })
                }
                if (_.isArray(this.ad.terrain.district) && this.ad.terrain.district.length) {
                    var o = this.ad.terrain.adminDistrict,
                        u = _.reduce(this.ad.terrain.district, function(t, n, i, s) {
                            n.adminDistrict ? n.adminDistrict = _.isArray(n.adminDistrict) ? n.adminDistrict : [n.adminDistrict] : n.adminDistrict = _.find(e, function(e) {
                                return e.id === n.id && e.field == "district"
                            }).adminDistrict;
                            var u = _.filter(o, function(e) {
                                return _.include(n.adminDistrict, e.id)
                            });
                            return u ? _.each(u, function(e) {
                                t[e.title] = t[e.title] || [], t[e.title].push(n.title), r[n.title] = r[n.title] || [], r[n.title].push(e.title)
                            }) : r[n.title] = [], t
                        }, {});
                    _.extend(i, u)
                }
                return _.each(i, function(t, r) {
                    var s = [];
                    _.each(t, function(t, r) {
                        var o = _.filter(i, function(e) {
                                return _.include(e, t)
                            }),
                            u = _.find(e, function(e) {
                                return e.title === t && e.field == "district"
                            });
                        u && o.length === u.adminDistrict.length && u.adminDistrict.length > 1 ? n.push(t) : s.push(t)
                    }), t.length === 0 && s.length === 0 ? n.push(r) : s.length == 1 ? n.push(s[0] + (r ? " (" + r + ")" : "")) : s.length > 1 && n.push(r + (s.length ? " (" + s.join(", ") + ")" : ""))
                }), n = _.unique(n), _.flatten(n).join(", ") || t.emptyDiv
            },
            "city-area-district-town": function() {
                var e = window.AppData.Base.listings.get("city-area-district-town-" + this.appData.get("region")),
                    n = [],
                    r = {},
                    i = {};
                if (!e || !e.length) return t.emptyDiv;
                if (_.isArray(this.ad.terrain.city) && this.ad.terrain.city.length) {
                    var s = _.pluck(this.ad.terrain.city, "id");
                    _.each(_.filter(e, function(e) {
                        return _.include(s, e.id) && e.field == "city"
                    }), function(e) {
                        r[e.title] = []
                    })
                }
                if (_.isArray(this.ad.terrain.area) && this.ad.terrain.area.length) {
                    var o = _.pluck(this.ad.terrain.area, "id");
                    _.each(_.filter(e, function(e) {
                        return _.include(o, e.id) && e.field == "area"
                    }), function(e) {
                        i[e.title] = []
                    })
                }
                if (_.isArray(this.ad.terrain.town) && this.ad.terrain.town.length) {
                    var u = _.pluck(this.ad.terrain.town, "id"),
                        a = _.reduce(_.filter(e, function(e) {
                            return _.include(u, e.id) && e.field == "town"
                        }), function(e, t, n, r) {
                            return e[t.areaTitle] = e[t.areaTitle] || [], e[t.areaTitle].push(t.title), e
                        }, {});
                    _.extend(i, a)
                }
                if (_.isArray(this.ad.terrain.district) && this.ad.terrain.district.length) {
                    var f = _.pluck(this.ad.terrain.district, "id"),
                        l = _.reduce(_.filter(e, function(e) {
                            return _.include(f, e.id) && e.field == "district"
                        }), function(e, t, n, r) {
                            return e[t.cityTitle] = e[t.cityTitle] || [], e[t.cityTitle].push(t.title), e
                        }, {});
                    _.extend(r, l)
                }
                return _.each(r, function(e, t) {
                    n.push(t + (e.length ? " (" + e.join(", ") + ")" : ""))
                }), _.each(i, function(e, t) {
                    e.length == 0 ? n.push(t) : e.length == 1 ? n.push(e[0] + (t ? " (" + t + ")" : "")) : n.push(t + (e.length ? " (" + e.join(", ") + ")" : ""))
                }), _.flatten(n).join(", ").replace(/р\-н/g, "<nobr>р-н</nobr>") || t.emptyDiv
            },
            town: function() {
                return _.pluck(this.ad.terrain.town, "title").join(", ") || t.emptyDiv
            },
            "town-multiple": function() {
                return this.town()
            },
            estateType: function() {
                return _.pluck(this.ad.main.estateType, "title").join(", ") || t.emptyDiv
            },
            "estateType-multiple": function() {
                return this.estateType()
            },
            p4: function() {
                return parseInt(this.ad.params.p4) || t.emptyDiv
            },
            p5: function() {
                return parseInt(this.ad.params.p5) || t.emptyDiv
            },
            p8: function() {
                return parseInt(this.ad.params.p8) || t.emptyDiv
            },
            p10: function() {
                return _.pluck(this.ad.params.p10, "title").join(", ") || t.emptyDiv
            },
            p20: function() {
                return _.pluck(this.ad.params.p20, "title").join(", ") || t.emptyDiv
            },
            price: function() {
                return this.ad.params.price ? _.priceFormat(this.ad.params.price.toString()) + " " + t.currency[this.ad.main.operation[0].id] : t.emptyDiv
            },
            budget: function() {
                return this.price()
            },
            phones: function() {
                var e = this.ad.info.contacts.phones;
                return _.isArray(e) && e.length ? e.join(" ") : t.emptyDiv
            },
            date: function() {
                return t.date(this.ad.main.insertDate, this.serverDate)
            },
            mark: function() {
                return '<div class="base-mark base-mark-' + this.ad.info.mark[0].id + '" title="' + this.ad.info.mark[0].title + '"></div>'
            },
            info: function() {
                var e = this.ad.info.photo.length ? 1 : 0,
                    n = this.ad.info.notes ? 2 : 0,
                    r = this.ad.comments.length ? 4 : 0,
                    i = e + n + r;
                return i > 0 ? '<div class="base-info base-info-' + i + '"></div>' : t.emptyDiv
            }
        });
        return o
    }), define("Base/Table/Views/ShowMore", ["Shared/Abstract/View"], function(e) {
        var t = e.extend({
            attributes: {
                "class": "base-show-more"
            },
            newAds: 0,
            events: {
                click: "incrementPage"
            },
            initialize: function() {
                _.bindAll(this), this.appData = window.AppData.Base.data, this.bindTo(this.appData, "change", this.render), this.bindTo(window.AppData.Base.events, "NewAdsAddedInTable", this.incrementNewAds), this.render()
            },
            incrementNewAds: function(e) {
                this.newAds += e
            },
            incrementPage: function() {
                this.appData.set({
                    newAds: this.newAds,
                    page: 1 + (parseInt(this.appData.get("page")) || 1)
                }).trigger("setAppData-page")
            },
            template: function() {
                var e = parseInt(this.appData.get("page")) || 1,
                    t = this.appData.generateUrl({
                        page: e + 1
                    });
                return '            <a href="' + t + '" class="trigger-false">Показать еще результаты</a>            <span id="base-loader-small"></span>'
            }
        });
        return t
    }), define("Base/Table/Views/NoResults", ["Shared/Abstract/View"], function(e) {
        var t = e.extend({
            attributes: {
                "class": "base-no-results"
            },
            template: function() {
                return '            <div class="base-no-results-title">                Объявлений не найдено            </div>            <div class="base-no-results-subtitle">                Попробуйте изменить параметры фильтрации.            </div>            <div class="base-no-results-text">                Например, установите галочку «Показать пустые» или «–» для                 заданных параметров фильтра. Это позволит сделать фильтрацию                 меннее строгой. Помните, пустые ячейки таблицы могут скрывать                 наиболее важную для Вас информацию.            </div>'
            }
        });
        return t
    }), define("Base/Table/Views/Main", ["Shared/Abstract/View", "Base/Config", "Base/Ad/Model", "Base/Ad/Collection", "Base/Ad/Views/Ad", "Base/Table/Views/ShowMore", "Base/Table/Views/NoResults"], function(e, t, n, r, i, s, o) {
        var u = e.extend({
            attributes: {
                "class": "base-ads-container"
            },
            selectedAds: {},
            adIndex: !0,
            adPrependIndex: !1,
            initialize: function() {
                _.bindAll(this), this.appData = window.AppData.Base.data, this.counters = window.AppData.Base.counters, this.loaderShow({
                    top: $(".base-container").position().top,
                    height: 1e3,
                    zIndex: 10
                }), 
                this.baseAdsCollection = new r, 
                this.bindTo(this.baseAdsCollection, "reset", this.render), 
                this.bindTo(window.EventManager, "ShowAdminDistricts", this.render), 
                this.bindTo(this.baseAdsCollection, "add", this.renderBaseAd), 
                this.bindTo(this.baseAdsCollection, "AddDone", this.addDone), 
                this.bindTo(this.baseAdsCollection, "AdRemovedByAdmin", this.updateEvenOddColors), 
                this.bindTo(window.AppData.Base.data, "change", this.loaderShow), 
                this.bindTo(window.AppData.Base.data, "setAppData-page", this.smallLoaderShow), 
                this.bindTo(window.AppData.Base.counters, "change", this.markNewAds), 
                this.bindTo(window.AppData.Base.counters, "LoadedFromServer", this.onCountersLoad), 
                this.bindTo(window.EventManager, "Base", this.newBase), 
                this.baseAdsCollection.getFromServer(!0), 
                this.bindDocumentEvents()
            },
            bindDocumentEvents: function() {
                $(document).bind("keydown.adsView", this.documentOnKeyDown)
            },
            unbindDocumentEvents: function() {
                $(document).unbind("keyup.adsView")
            },
            documentOnKeyDown: function(e) {
                var t = e.keyCode || e.which;
                if ((t === 40 || t == 38) && _.size(this.selectedAds)) {
                    var n = _.objectLastItem(this.selectedAds),
                        r = n.$el[t === 40 ? "next" : "prev"]();
                    return r && r.trigger("click"), !r.length && t === 40 && n.$el.parent().parent().next().find(".base-show-more").trigger("click"), !1
                }
            },
            loaderShow: function(e) {
                var t = $("#base-table"),
                    n = {
                        top: t.position().top + 26,
                        height: t.height(),
                        zIndex: 2
                    };
                e && !("cid" in e) && (n = _.extend(n, e)), $("#base-loader").css(n).show()
            },
            smallLoaderShow: function() {
                $("#base-loader").hide(), $("#base-loader-small").show()
            },
            loaderHide: function() {
                $("#base-loader, #base-loader-small").hide()
            },
            onClose: function() {
                this.unbindDocumentEvents(), this.baseAdsCollection.close()
            },
            render: function() {
                return this.adIndex = !0, this.adPrependIndex = !1, this.showMore = null, this.updateLastVisit(), this.closeSubviews(), this.baseAdsCollection.each(this.renderBaseAd), this.addDone(), this
            },
            updateLastVisit: function() {
                window.AppData.Base.userFilters.selectedFilter !== null ? (this.visit = new Date(window.AppData.Base.userFilters.selectedFilter.get("lastFilterVisit")), this.sessionVisit = this.visit) : (this.visit = this.counters.getLastVisit(), this.sessionVisit = this.counters.getLastSessionVisit())
            },
            onCountersLoad: function() {
                if (this.visit) return;
                this.updateLastVisit(), this.markNewAds()
            },
            newBase: function(e) {
                if (!this.appData.isDefaults()) return;
                this.toggleOverflow();
                var t = this.appData.toJSON(),
                    r = _.filter(e.ads, function(e) {
                        var n = _.intersection(_.pluck(e.terrain.city, "id"), _.pluck(REGIONS, "regionCenter")).length === 0 ? "suburb" : "city";
                        return _.include(_.pluck(e.terrain.region, "id"), parseInt(t.region)) && _.include(_.pluck(e.main.marketSegment, "id"), parseInt(t.marketSegment)) && _.include(_.pluck(e.main.operation, "id"), parseInt(t.operation)) && (t.type == "city" && _.include(_.pluck(e.terrain.city, "id"), parseInt(this.appData.get("locality-city"))) || t.type == "suburb" && _.include(_.pluck(e.terrain.area, "id"), parseInt(this.appData.get("locality-area"))) || t.type == "suburb" && n == "suburb" && !parseInt(this.appData.get("locality-area")))
                    }, this);
                window.AppData.Base.events.trigger("NewAdsAddedInTable", r.length);
                for (var i in r) {
                    var s = new n(r[i]),
                        o = this.renderBaseAd(s, !0, !0);
                    this.$el.css({
                        marginTop: "-=" + o
                    })
                }
                this.markNewAds(), this.$el.transit({
                    marginTop: 0
                }, 300 * r.length, this.toggleOverflow)
            },
            toggleOverflow: function() {
                this.$el.parent().css("overflow", this.$el.parent().css("overflow") == "hidden" ? "visible" : "hidden")
            },
            renderBaseAd: function(e, t, n) {
                var r = (new i({
                    model: e,
                    serverDate: this.baseAdsCollection.serverDate,
                    index: t === !0 ? this.adPrependIndex : this.adIndex,
                    parentView: this
                })).render();
                return t === !0 ? this.adPrependIndex = !this.adPrependIndex : this.adIndex = !this.adIndex, this[t === !0 ? "prependSubview" : "appendSubview"](r), n === !0 ? r.$el.height() : null
            },
            addDone: function() {
                this.postRender(), 
                this.loaderHide(), 
                window.AppData.Base.events.trigger("AdsRendered")
            },
            postRender: function() {
                this.idFilter(), 
                this.showMoreButton(), 
                this.noResults(), 
                this.markNewAds(), 
                this.openAdsIfTextFilterIsActive()
            },
            noResults: function() {
                this.baseAdsCollection.length == 0 && this.appendSubview((new o).render())
            },
            idFilter: function() {
                var e = this.appData.get("id");
                e && this.eachSubview(function(t) {
                    t.model.get("main.id") == e && t.toggleAd()
                })
            },
            openAdsIfTextFilterIsActive: function() {
                var e = this.appData.get("text");
                if (!e) return;
                var t = '<span class="base-filter-text-selected">$&</span>';
                this.eachSubview(function(n) {
                    if (!n.model || !n.model.has("main.id") || n.$el.hasClass("base-ad-selected")) return;
                    n.toggleAd(!1);
                    var r = n.$el.find(".base-ad-opened-text"),
                        i = n.$el.find(".base-ad-notes-text"),
                        s = n.$el.find(".base-ad-info"),
                        o = new RegExp(e, "gi");
                    r.html(r.html().replace(o, t)), i.html(i.html().replace(o, t));
                    var u = s.find(".base-filter-text-selected"),
                        a = u.length ? u.first().position().top - s.height() / 2 : 0;
                    s.find(".scrollbar-pane").length && s.scrollbar("scrollto", a || 0), n.adOpened.once("CommentsRendered", function() {
                        var e = this.$el.find(".base-ad-comments .comments");
                        e.find(".comment-text").each(function() {
                            $(this).html($(this).html().replace(o, t))
                        });
                        var n = e.find(".base-filter-text-selected"),
                            r = n.length ? n.first().position().top - e.height() / 2 : 0;
                        e.find(".scrollbar-pane").length && e.scrollbar("scrollto", r || 0)
                    })
                })
            },
            showMoreButton: function() {
                this.baseAdsCollection.showMore && !this.showMore ? (this.showMore = new s, this.appendSubview(this.showMore, $("#base-show-more"))) : !this.baseAdsCollection.showMore && this.showMore && (this.showMore.close(), this.showMore = null)
            },
            markNewAds: function() {
                var e = this.visit;
                if (!e) return;
                this.eachSubview(function(t) {
                    if (!t.model) return;
                    var n = window.AppData.Base.userFilters.selectedFilter;
                    if (n !== null && _.include(n.get("data").info, "comments")) {
                        var r = t.model.get("comments"),
                            i = _.isArray(r) && r.length ? _.last(_.sortBy(r, function(e) {
                                return new Date(e.date)
                            })).date : 0;
                        (new Date(i)).getTime() - e.getTime() > 0 && t.markAsNew()
                    } else(new Date(t.model.get("main.insertDate"))).getTime() - e.getTime() > 0 && t.markAsNew()
                }), window.AppData.Base.userFilters.selectedFilter !== null && window.AppData.Base.userFilters.selectedFilter.updateLastVisit()
            },
            updateEvenOddColors: function() {
                var e = this;
                this.adIndex = !0, this.adPrependIndex = !1, this.eachSubview(function(t) {
                    if (!t.$el.is(":visible")) return;
                    t.$el.find(".base-ad-row").removeClass("base-ad-even base-ad-odd"), t.$el.find(".base-ad-row").addClass(e.adIndex ? "base-ad-even" : "base-ad-odd"), e.adIndex = !e.adIndex
                })
            }
        });
        return u
    }), define("Base/Filter/Model", ["Shared/Abstract/Model", "Base/Config"], function(e, t) {
        var n = e.extend({
            initialize: function() {
                _.bindAll(this), this.AppData = window.AppData.Base.data, this.bindTo(window.AppData.Base.listings, "change:" + this.getListingName(), this.complete), this.get("name") == "date" && this.makeDate()
            },
            getListingName: function() {
                if (!this.get("listing") || !this.get("listing").name) return "";
                var e = this.get("listing").name,
                    t = _.map(this.get("listing").dependencies, function(e) {
                        var t = window.AppData.Base.data.get(e);
                        return t && _.isArray(t) ? t[0] : t
                    });
                return e + (t.length ? "-" + t.join("-") : "")
            },
            complete: function(e, n, r) {
                n = _.clone(n), this.get("hasEmptyItem") && _.isArray(n) && n.unshift(t.emptyItem("null")), this.set("items", n)
            },
            makeDate: function() {
                var e = this;
                window.AppData.date(function(n) {
                    var r = new Date(t.startDate[e.AppData.get("region")]),
                        i = new Date(n),
                        s = [];
                    while (i > r) s.push([r.getMonth(), r.getFullYear()]), r.setMonth(r.getMonth() + 1);
                    e.set("items", s)
                })
            }
        });
        return n
    }), define("Base/Filter/Collection", ["Base/Filter/Model", "Shared/Abstract/Collection", "Base/Config"], function(e, t, n) {
        var r = t.extend({
            model: e,
            initialize: function() {
                _.bindAll(this, "make", "_filter"), this.appData = window.AppData.Base.data
            },
            make: function(e, t, r) {
                if (r && r.filtersCalled || !1) return;
                r && (r.filtersCalled = !0), this.currentColumnNames = _.keys(n.columns.getCurrent(this.appData));
                var i = _.filter(n.filters, this._filter);
                this.reset(i, {
                    silent: !0
                }), this.each(function(e) {
                    e.get("dynamic") && e.get("listing") && e.complete(null, window.AppData.Base.listings.get(e.getListingName()) || [])
                }), this.trigger("reset")
            },
            _filter: function(e) {
                return _.include(this.currentColumnNames, e.name) || _.include(n.defaultFilters, e.name)
            }
        });
        return r
    }), ejs = function() {
        function e(t) {
            if ("fs" == t) return {};
            var n = e.resolve(t),
                r = e.modules[n];
            if (!r) throw new Error('failed to require "' + t + '"');
            return r.exports || (r.exports = {}, r.call(r.exports, r, r.exports, e.relative(n))), r.exports
        }
        return e.modules = {}, e.resolve = function(t) {
            var n = t,
                r = t + ".js",
                i = t + "/index.js";
            return e.modules[r] && r || e.modules[i] && i || n
        }, e.register = function(t, n) {
            e.modules[t] = n
        }, e.relative = function(t) {
            return function(n) {
                if ("." != n.substr(0, 1)) return e(n);
                var r = t.split("/"),
                    i = n.split("/");
                r.pop();
                for (var s = 0; s < i.length; s++) {
                    var o = i[s];
                    ".." == o ? r.pop() : "." != o && r.push(o)
                }
                return e(r.join("/"))
            }
        }, e.register("ejs.js", function(e, t, n) {
            function u(e) {
                return e.substr(1).split("|").reduce(function(e, t) {
                    var n = t.split(":"),
                        r = n.shift(),
                        i = n.shift() || "";
                    return i && (i = ", " + i), "filters." + r + "(" + e + i + ")"
                })
            }

            function a(e, t, n, r) {
                var i = t.split("\n"),
                    s = Math.max(r - 3, 0),
                    o = Math.min(i.length, r + 3),
                    u = i.slice(s, o).map(function(e, t) {
                        var n = t + s + 1;
                        return (n == r ? " >> " : "    ") + n + "| " + e
                    }).join("\n");
                throw e.path = n, e.message = (n || "ejs") + ":" + r + "\n" + u + "\n\n" + e.message, e
            }
            var r = n("./utils"),
                i = n("fs");
            t.version = "0.7.2";
            var s = t.filters = n("./filters"),
                o = {};
            t.clearCache = function() {
                o = {}
            };
            var f = t.parse = function(e, n) {
                    var n = n || {},
                        r = n.open || t.open || "<%",
                        i = n.close || t.close || "%>",
                        s = ["var buf = [];", "\nwith (locals) {", "\n  buf.push('"],
                        o = 1,
                        a = !1;
                    for (var f = 0, l = e.length; f < l; ++f)
                        if (e.slice(f, r.length + f) == r) {
                            f += r.length;
                            var c, h, p = "__stack.lineno=" + o;
                            switch (e.substr(f, 1)) {
                                case "=":
                                    c = "', escape((" + p + ", ", h = ")), '", ++f;
                                    break;
                                case "-":
                                    c = "', (" + p + ", ", h = "), '", ++f;
                                    break;
                                default:
                                    c = "');" + p + ";", h = "; buf.push('"
                            }
                            var d = e.indexOf(i, f),
                                v = e.substring(f, d),
                                m = f,
                                g = 0;
                            "-" == v[v.length - 1] && (v = v.substring(0, v.length - 2), a = !0);
                            while (~(g = v.indexOf("\n", g))) g++, o++;
                            v.substr(0, 1) == ":" && (v = u(v)), s.push(c, v, h), f += d - m + i.length - 1
                        } else e.substr(f, 1) == "\\" ? s.push("\\\\") : e.substr(f, 1) == "'" ? s.push("\\'") : e.substr(f, 1) == "\r" ? s.push(" ") : e.substr(f, 1) == "\n" ? a ? a = !1 : (s.push("\\n"), o++) : s.push(e.substr(f, 1));
                    return s.push("');\n}\nreturn buf.join('');"), s.join("")
                },
                l = t.compile = function(e, n) {
                    n = n || {};
                    var i = $.toJSON(e),
                        o = n.filename ? $.toJSON(n.filename) : "undefined";
                    e = ["var __stack = { lineno: 1, input: " + i + ", filename: " + o + " };", a.toString(), "try {", t.parse(e, n), "} catch (err) {", "  rethrow(err, __stack.input, __stack.filename, __stack.lineno);", "}"].join("\n"), n.debug && console.log(e);
                    var u = new Function("locals, filters, escape", e);
                    return function(e) {
                        return u.call(this, e, s, r.escape)
                    }
                };
            t.render = function(e, t) {
                var n, t = t || {};
                if (t.cache) {
                    if (!t.filename) throw new Error('"cache" option requires "filename".');
                    n = o[t.filename] || (o[t.filename] = l(e, t))
                } else n = l(e, t);
                return t.__proto__ = t.locals, n.call(t.scope, t)
            }, t.renderFile = function(e, n, r) {
                var s = e + ":string";
                "function" == typeof n && (r = n, n = {}), n.filename = e;
                try {
                    var u = n.cache ? o[s] || (o[s] = i.readFileSync(e, "utf8")) : i.readFileSync(e, "utf8");
                    r(null, t.render(u, n))
                } catch (a) {
                    r(a)
                }
            }, t.__express = t.renderFile, n.extensions ? n.extensions[".ejs"] = function(e, t) {
                source = n("fs").readFileSync(t, "utf-8"), e._compile(l(source, {}), t)
            } : n.registerExtension && n.registerExtension(".ejs", function(e) {
                return l(e, {})
            })
        }), e.register("filters.js", function(e, t, n) {
            t.first = function(e) {
                return e[0]
            }, t.last = function(e) {
                return e[e.length - 1]
            }, t.capitalize = function(e) {
                return e = String(e), e[0].toUpperCase() + e.substr(1, e.length)
            }, t.downcase = function(e) {
                return String(e).toLowerCase()
            }, t.upcase = function(e) {
                return String(e).toUpperCase()
            }, t.sort = function(e) {
                return Object.create(e).sort()
            }, t.sort_by = function(e, t) {
                return Object.create(e).sort(function(e, n) {
                    return e = e[t], n = n[t], e > n ? 1 : e < n ? -1 : 0
                })
            }, t.size = t.length = function(e) {
                return e.length
            }, t.plus = function(e, t) {
                return Number(e) + Number(t)
            }, t.minus = function(e, t) {
                return Number(e) - Number(t)
            }, t.times = function(e, t) {
                return Number(e) * Number(t)
            }, t.divided_by = function(e, t) {
                return Number(e) / Number(t)
            }, t.join = function(e, t) {
                return e.join(t || ", ")
            }, t.truncate = function(e, t) {
                return e = String(e), e.substr(0, t)
            }, t.truncate_words = function(e, t) {
                var e = String(e),
                    n = e.split(/ +/);
                return n.slice(0, t).join(" ")
            }, t.replace = function(e, t, n) {
                return String(e).replace(t, n || "")
            }, t.prepend = function(e, t) {
                return Array.isArray(e) ? [t].concat(e) : t + e
            }, t.append = function(e, t) {
                return Array.isArray(e) ? e.concat(t) : e + t
            }, t.map = function(e, t) {
                return e.map(function(e) {
                    return e[t]
                })
            }, t.reverse = function(e) {
                return Array.isArray(e) ? e.reverse() : String(e).split("").reverse().join("")
            }, t.get = function(e, t) {
                return e[t]
            }, t.json = function(e) {
                return $.toJSON(e)
            }
        }), e.register("utils.js", function(e, t, n) {
            t.escape = function(e) {
                return String(e).replace(/&(?!\w+;)/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;")
            }
        }), e("ejs")
    }(), define("Libs/Ejs", ["Libs/Ejs/ejs-1.0.0"], function(e) {
        return e
    }), define("Libs/Ejs/ejs-1.0.0", function() {}), define("Shared/EJS", ["Libs/Ejs"], function() {
        function e(e, n, r, i) {
            i = i || 1, $.ajax({
                url: TEMPLATES_ROOT + e + ".ejs?" + i,
                cache: !0,
                success: function(e) {
                    r(t(e, n))
                }
            })
        }

        function t(e, t) {
            return ejs.render(e, t)
        }
        return {
            render: e
        }
    }), define("Base/Filter/Views/Abstract", ["Shared/Abstract/View", "Shared/EJS", "Base/Config"], function(e, t, n) {
        var r = e.extend({
            attributes: {
                "class": "base-filter"
            },
            initialize: function() {
                _.bindAll(this), this.observeAppData()
            },
            observeAppData: function() {
                for (var e in this.model.get("set")) this.bindTo(window.AppData.Base.data, "change:" + this.model.get("set")[e], this.update)
            },
            template: function() {
                return t.render(this.templateFile, {
                    config: n,
                    data: this.model.toJSON(),
                    appData: window.AppData.Base.data
                })
            },
            update: function() {},
            setAppData: function(e, t) {
                var n = this.model.get("set"),
                    r = window.AppData.Base.data.toJSON();
                for (var i in n)
                    if ((!_.isArray(e[i]) && e[i] !== !1 || _.isArray(e[i]) && e[i].length) && e[i] !== "leave") {
                        var s = {};
                        s[n[i]] = e[i], window.AppData.Base.data.set(s)
                    } else(e[i] === !1 || _.isArray(e[i]) && !e[i].length) && window.AppData.Base.data.unset(n[i]);
                var o = window.AppData.Base.data.toJSON();
                !_.isEqual(r, o) && t !== !0 && window.AppData.Base.data.trigger("setAppData")
            },
            bindDocumentEvents: function() {
                $(document).bind("click." + this.model.get("name"), this.documentClickHandler)
            },
            unbindDocumentEvents: function() {
                $(document).unbind("click." + this.model.get("name"))
            },
            documentClickHandler: function(e) {
                $(e.target).parents("#base-filter-" + this.model.get("name")).length == 0 && this.$el.css("display") == "block" && this.cancel()
            }
        });
        return r
    }), define("Base/Filter/Views/List", ["Base/Filter/Views/Abstract", "Base/Config"], function(e, t) {
        var n = e.extend({
            events: {
                "click .base-filter-submit": "submit",
                "click .base-checkbox .title": "check",
                "click .base-checkbox .input": "check",
                "click .base-filter-list-title": "cancel",
                "click .base-filter-clear": "clear"
            },
            initialize: function() {
                _.bindAll(this), this.observeAppData(), this.bindDocumentEvents(), this.bindTo(this.model, "change:items", this.onItemsChange), this.appData = window.AppData.Base.data
            },
            onClose: function() {
                this.unbindDocumentEvents()
            },
            onItemsChange: function() {
                this.render().update()
            },
            status: function() {
                var e = this.model.get("set");
                this.$el.parent().find(".base-filter-status").removeClass("base-filter-status-enabled");
                for (var t in e) {
                    var n = window.AppData.Base.data.get(e[t]);
                    if (n && n.length > 0 && e[t] != "order") {
                        this.$el.parent().find(".base-filter-status").addClass("base-filter-status-enabled");
                        break
                    }
                }
                this.onStatus && this.onStatus()
            },
            update: function() {
                var e = this.model.get("set");
                this.status(), this.$el.find(":checkbox").attr("checked", !1).parent().removeClass("base-checkbox-checked");
                var t = !1;
                for (var n in e) {
                    var r = window.AppData.Base.data.get(e[n]);
                    if (!_.isArray(r) || e[n] == "order") continue;
                    t || (t = _.include(r, "0")), _.each(_.without(r, "0"), this.check)
                }
                t && this.check("0"), this.onUpdate && this.onUpdate()
            },
            check: function(e) {
                e = _.isObject(e) ? $(e.currentTarget).siblings("input:checkbox").val() : e;
                var t = this.$el.find(":checkbox[value=" + e + "]");
                t.prop("checked", !t.prop("checked")).parent().toggleClass("base-checkbox-checked")
            },
            submit: function() {
                var e = [];
                for (var t in this.model.get("set")) {
                    var n = _.map(this.$el.find(":checkbox:checked[data-field=" + this.model.get("set")[t] + "]"), function(e) {
                        return e.value
                    });
                    this.$el.find(":checkbox:checked[data-field=null]").length && n.push("0"), e.push(n)
                }
                this.setAppData(e), this.$el.hide()
            },
            cancel: function() {
                this.$el.hide(), this.update()
            },
            clear: function() {
                this.$el.find(":checkbox").attr("checked", !1).parent().removeClass("base-checkbox-checked"), this.onClear && this.onClear()
            },
            onShow: function() {
                if (!this.model.get("alreadyRendered")) {
                    this.render().update();
                    var e = this.$el.find(".base-filter-list-items");
                    e.width(e.width() + 1), e.scrollbar(), this.model.set("alreadyRendered", !0)
                }
                this.$el.find(".scrollbar-pane").length && this.$el.find(".base-filter-list-items").scrollbar("scrollto", 0)
            },
            template: function() {
                var e = t.columns.getCurrent(this.appData),
                    n = this.model.toJSON(),
                    r = '<div class="base-filter-list"  style="min-width: ' + (e[n.name].width + 0) + 'px">' + '<div class="base-filter-list-title" style="width: ' + (e[n.name].width - 15) + 'px">' + e[n.name].title + "</div>" + '<div class="base-filter-list-title-hider" style="width: ' + (e[n.name].width + 1) + 'px"></div>' + '<div class="base-filter-list-items">';
                return !n.items || !n.items.length ? r += '<div class="base-filter-loading">Подождите, идет загрузка...</div>' : _.each(n.items, function(e) {
                    r += '<div class="base-checkbox"><input type="checkbox" value="' + e.id + '" data-field="' + e.field + '">' + '<div class="input"><div></div></div>' + '<div class="title">' + e.title + "</div>" + "</div>"
                }), r += '</div><div class="base-filter-submit-container"><div class="base-filter-submit">ОК</div><div class="base-filter-clear">Очистить фильтр</div></div></div>', r
            }
        });
        return n
    }), define("Base/Filter/Views/Select", ["Base/Filter/Views/Abstract", "Base/Config", "UI/Form/Views/Select"], function(e, t, n) {
        var r = e.extend({
            events: {
                "click .base-filter-submit": "submit",
                "click .base-filter-list-title": "cancel",
                "click .base-filter-clear": "clear"
            },
            initialize: function() {
                _.bindAll(this), this.model.get("child") !== !0 && (this.observeAppData(), this.bindDocumentEvents()), this.bindTo(this.model, "change:items", this.onItemsChange), this.appData = window.AppData.Base.data
            },
            onClose: function() {
                this.unbindDocumentEvents()
            },
            onItemsChange: function() {
                this.render().update()
            },
            status: function() {
                var e = this.model.get("set");
                this.$el.parent().find(".base-filter-status").removeClass("base-filter-status-enabled");
                for (var t in e) {
                    var n = window.AppData.Base.data.get(e[t]);
                    if (n && n.length > 0 && e[t] != "order") return this.$el.parent().find(".base-filter-status").addClass("base-filter-status-enabled"), !0
                }
                return this.onStatus && this.onStatus(), !1
            },
            update: function() {
                this.status();
                var e = this.model.get("set");
                this.Select && this.Select.Reset();
                var t = !1,
                    n = [];
                for (var r in e) {
                    var i = window.AppData.Base.data.get(e[r]);
                    if (!_.isArray(i) || e[r] == "order") continue;
                    t || (t = _.include(i, "0")), i = _.map(i, function(t) {
                        return {
                            id: parseInt(t),
                            field: e[r]
                        }
                    }), n.push(i)
                }
                this.Select && this.Select.SetByCriteria(_.flatten(n)), this.onUpdate && this.onUpdate()
            },
            getValues: function() {
                var e = [];
                for (var t in this.model.get("set")) {
                    var n = this.Select.Get(),
                        r = this.model.get("set")[t],
                        i = _.pluck(_.filter(n, function(e) {
                            return e.field == r
                        }), "id");
                    e.push(i)
                }
                return e
            },
            submit: function(e) {
                var t = this.getValues();
                this.setAppData(t, e && e.silent === !0), this.model.get("child") !== !0 && this.$el.hide()
            },
            cancel: function() {
                this.$el.hide(), this.update()
            },
            clear: function() {
                this.Select.Reset(), this.onClear && this.onClear()
            },
            onShow: function() {
                this.model.get("alreadyRendered") || (this.render().update(), this.model.set("alreadyRendered", !0))
            },
            selectFormat: function(e) {
                if (this.appData.get("locality-area")) return e.title;
                var t = e.cityTitle || e.areaTitle;
                if (e.adminDistrict) {
                    var n = _.where(this.model.get("items"), {
                        id: e.adminDistrict,
                        field: "adminDistrict"
                    });
                    n.length && n[0].title && (t = n[0].title)
                }
                var r = e.title + (t ? " (" + t + ")" : "");
                return r.replace(") (", ", ")
            },
            render: function() {
                this.$el.empty().append(this.template());
                var e = this.$el.find(".base-filter-select");
                return this.Select = new n({
                    multiple: !0,
                    showDefaultItem: !1,
                    input: !0,
                    maxResultsCount: 5,
                    width: e.width() > 200 ? e.width() - 1 : this.model.get("minWidth") || 200,
                    data: this.model.toJSON().items,
                    formatResult: this.selectFormat,
                    formatMultipleSelection: this.selectFormat,
                    renderSelectedInDropdown: !1,
                    showDropDownButton: !1
                }), this.appendSubview(this.Select, e), this
            },
            template: function() {
                var e = t.columns.getCurrent(this.appData),
                    n = this.model.toJSON(),
                    r = "";
                return n.renderWrapper !== !1 && (r += '<div class="base-filter-list"  style="min-width: ' + (e[n.name].width + 0) + 'px">' + '<div class="base-filter-list-title" style="width: ' + (e[n.name].width - 15) + 'px">' + e[n.name].title + "</div>" + '<div class="base-filter-list-title-hider" style="width: ' + (e[n.name].width + 1) + 'px"></div>'), r += '<div class="base-filter-select"></div>', n.renderWrapper !== !1 && (r += '<div class="base-filter-submit-container"><div class="base-filter-submit">ОК</div><div class="base-filter-clear">Очистить фильтр</div></div></div>'), r
            }
        });
        return r
    }), define("Base/Filter/Views/Range", ["Base/Filter/Views/Abstract", "Base/Config", "UI/Tooltip/Views/Default"], function(e, t, n) {
        var r = e.extend({
            events: {
                "click .base-filter-submit": "submit",
                "click .base-filter-list-title": "cancel",
                "click .base-filter-clear": "clear",
                "click .base-radio .title": "order",
                "click .base-radio .input": "order",
                "click .base-checkbox .title": "empty",
                "click .base-checkbox .input": "empty",
                "click .up": "up",
                "click .down": "down",
                "keypress input": "inputOnKeyPress",
                "keyup input": "showTooltipsOnKeyUp"
            },
            initialize: function() {
                _.bindAll(this), this.model.get("child") !== !0 && (this.observeAppData(), this.bindDocumentEvents())
            },
            tooltips: [],
            onClose: function() {
                this.clearInputErrors(), this.closeTooltips(), this.unbindDocumentEvents()
            },
            status: function() {
                var e = this.model.get("set"),
                    t = [];
                for (var n in e) e[n] == "order" ? window.AppData.Base.data.get(e[n]) && window.AppData.Base.data.get(e[n])[0] == this.model.get("set")[0] ? t.push(window.AppData.Base.data.get(e[n])[1] || !1) : t.push(!1) : t.push(window.AppData.Base.data.get(e[n]) || !1);
                return _.compact(t).length == 0 ? (this.$el.parent().find(".base-filter-status").removeClass("base-filter-status-enabled"), !1) : (this.$el.parent().find(".base-filter-status").addClass("base-filter-status-enabled"), !0)
            },
            update: function() {
                var e = this.model.get("set"),
                    t = [];
                for (var n in e) t.push(window.AppData.Base.data.get(e[n]) || 0);
                this.status(), _.each(this.$el.find(".base-range"), function(e, n) {
                    t && t[n] ? _.each($(e).find("input"), function(e, r) {
                        $(e).val(t[n][r])
                    }) : $(e).find("input").val("")
                });
                var r = t.length == 2 ? 1 : 2;
                this.$el.find(".base-radio").removeClass("base-radio-checked");
                var i = _.last(t, r)[0] && _.last(t, r)[0][0] == this.model.get("set")[0] ? _.last(t, r)[0][1] : 0;
                this.$el.find(":radio[value=" + i + "]").attr("checked", !0).parent().addClass("base-radio-checked"), this.$el.find(":checkbox").prop("checked", !_.last(t, 2)[1]), _.last(t, 2)[1] ? this.$el.find(":checkbox").parent().removeClass("base-checkbox-checked") : this.$el.find(":checkbox").parent().addClass("base-checkbox-checked")
            },
            order: function(e) {
                this.$el.find(":radio").parent().removeClass("base-radio-checked"), e = _.isObject(e) ? $(e.currentTarget).siblings(":radio").val() : e, this.$el.find(":radio[value=" + e + "]").attr("checked", !0).parent().addClass("base-radio-checked")
            },
            empty: function(e) {
                e = _.isObject(e) ? $(e.currentTarget).siblings("input:checkbox").val() : e;
                var t = this.$el.find(":checkbox[value=" + e + "]");
                t.prop("checked", !t.prop("checked")).parent().toggleClass("base-checkbox-checked")
            },
            showTooltipsOnKeyUp: function() {
                clearTimeout(this.tooltipTimeout), this.tooltipTimeout = setTimeout(this.preValidate, 1e3)
            },
            tooltipLeft: function(e, t) {
                var r = new n({
                    text: e,
                    $el: t,
                    top: -7,
                    position: "left"
                });
                this.tooltips.push(r)
            },
            tooltipRight: function(e, t) {
                var r = new n({
                    text: e,
                    $el: t,
                    left: -15,
                    top: 24
                });
                this.tooltips.push(r)
            },
            closeTooltips: function(e) {
                e = e || "hide", _.each(this.tooltips, function(t) {
                    t[e]()
                })
            },
            clearInputErrors: function() {
                this.$el.find(".base-range input").removeClass("input-error")
            },
            preValidate: function() {
                var e = this.getValues(),
                    n = !0,
                    r = this.$el.find(".base-range input");
                e[0] = e[0] || [], e[1] = e[1] || [], e[2] = e[2] || [], this.clearInputErrors(), this.closeTooltips("close");
                for (var i in e) {
                    if (_.isNaN(parseInt(e[i][0])) || !(e[i][0] && e[i][1] && e[i][0] > e[i][1])) continue;
                    this.tooltipRight(t.hints.minmax, $(r[i * 2]).parent()), $(r[i * 2]).addClass("input-error"), $(r[i * 2 + 1]).addClass("input-error"), n = !1
                }
                switch (this.model.get("name")) {
                    case "p3-p4":
                        e[0][0] && e[1][1] && e[0][0] > e[1][1] && (this.tooltipLeft(t.hints["input-adv-p3-p4"], $(r[0])), $(r[0]).addClass("input-error"), $(r[3]).addClass("input-error"), n = !1);
                        break;
                    case "p5-p6-p7":
                        e[0][1] && e[1][0] && e[1][0] > e[0][1] ? (this.tooltipLeft(t.hints["input-adv-p5-p6-p7-1"], $(r[2])), $(r[1]).addClass("input-error"), $(r[2]).addClass("input-error"), n = !1) : e[2][0] && e[0][1] && e[2][0] > e[0][1] ? (this.tooltipLeft(t.hints["input-adv-p5-p6-p7-2"], $(r[4])), $(r[1]).addClass("input-error"), $(r[4]).addClass("input-error"), n = !1) : e[2][0] && e[1][1] && e[2][0] > e[1][1] ? (this.tooltipLeft(t.hints["input-adv-p5-p6-p7-3"], $(r[4])), $(r[3]).addClass("input-error"), $(r[4]).addClass("input-error"), n = !1) : e[0][1] && e[1][0] && e[2][0] && e[1][0] + e[2][0] > e[0][1] ? (this.tooltipLeft(t.hints["input-adv-p5-p6-p7-4"], $(r[2])), $(r[1]).addClass("input-error"), $(r[2]).addClass("input-error"), $(r[4]).addClass("input-error"), n = !1) : e[1][0] && e[0][1] && e[1][0] == e[0][1] ? (this.tooltipLeft(t.hints["input-adv-p5-p6-p7-5"], $(r[2])), $(r[1]).addClass("input-error"), $(r[2]).addClass("input-error"), n = !1) : e[2][0] && e[1][1] && e[2][0] == e[1][1] ? (this.tooltipLeft(t.hints["input-adv-p5-p6-p7-6"], $(r[4])), $(r[3]).addClass("input-error"), $(r[4]).addClass("input-error"), n = !1) : e[2][0] && e[0][1] && e[2][0] == e[0][1] ? (this.tooltipLeft(t.hints["input-adv-p5-p6-p7-7"], $(r[4])), $(r[1]).addClass("input-error"), $(r[4]).addClass("input-error"), n = !1) : e[0][1] && e[1][0] && e[2][0] && e[1][0] + e[2][0] == e[0][1] && (this.tooltipLeft(t.hints["input-adv-p5-p6-p7-8"], $(r[2])), $(r[1]).addClass("input-error"), $(r[2]).addClass("input-error"), $(r[4]).addClass("input-error"), n = !1)
                }
                return clearTimeout(this.tooltipTimeout), n
            },
            getValues: function() {
                var e = [];
                return _.each(this.$el.find(".base-range"), function(t, n) {
                    var r = _.map($(t).find("input:text"), function(e) {
                        return parseInt(e.value)
                    });
                    e.push(r[0] || r[1] ? [r[0] || null, r[1] || null] : !1)
                }), e.push(this.$el.find(":radio:checked").val() != "0" ? [this.model.get("set")[0], this.$el.find(":radio:checked").val()] : window.AppData.Base.data.get("order") && window.AppData.Base.data.get("order")[0] != this.model.get("set")[0] ? "leave" : !1), e.push(this.$el.find(":checkbox").prop("checked") ? !1 : "1"), e
            },
            submit: function(e) {
                if (this.preValidate() === !1) return;
                this.setAppData(this.getValues(), e && e.silent === !0), this.clearInputErrors(), this.closeTooltips(), this.model.get("child") !== !0 && this.$el.hide()
            },
            cancel: function() {
                this.clearInputErrors(), this.closeTooltips(), this.$el.hide(), this.update()
            },
            clear: function() {
                this.$el.find("input:text").val(""), this.$el.find(".base-radio").removeClass("base-radio-checked"), this.$el.find(":radio").first().attr("checked", !0).parent().addClass("base-radio-checked"), this.$el.find(":checkbox").attr("checked", !0).parent().addClass("base-checkbox-checked")
            },
            inputOnKeyPress: function(e) {
                var t = e.keyCode || e.which;
                if ((t < 48 || t > 57) && t != 13 && t != 58 && t != 8) return !1;
                t == 13 && this.submit()
            },
            up: function(e) {
                var t = $(e.currentTarget).parent().next("input"),
                    n = $(e.currentTarget).parent().prevAll("input")[1],
                    r = $(e.currentTarget).parent().prev(),
                    i = parseInt(r.val()) || 0,
                    s = 0;
                if (n && n.value && i < parseInt(n.value)) {
                    var o = this.model.get("step") - parseInt(n.value) % this.model.get("step");
                    !i && o == this.model.get("step") && (o = 0), s = parseInt(n.value) + o
                } else {
                    var u = this.model.get("step") - i % this.model.get("step");
                    s = i + u
                }
                $(e.currentTarget).parent().prev().val(s), t && t.val() && i + u >= parseInt(t.val()) && t.val(i + u)
            },
            down: function(e) {
                var t = $(e.currentTarget).parent().next("input"),
                    n = $(e.currentTarget).parent().prevAll("input")[1],
                    r = $(e.currentTarget).parent().prev(),
                    i = parseInt(r.val()) || 0;
                if (i - this.model.get("step") > 0) {
                    var s = i % this.model.get("step") == 0 ? this.model.get("step") : i % this.model.get("step");
                    $(e.currentTarget).parent().prev().val(i - s)
                } else $(e.currentTarget).parent().prev().val(""); if (n && n.value && i && parseInt(n.value) > i - this.model.get("step")) {
                    var s = i % this.model.get("step") == 0 ? this.model.get("step") : i % this.model.get("step");
                    n.value = i - s > 0 ? i - s : ""
                }
                if (t && t.val() && parseInt(t.val()) < i - this.model.get("step")) {
                    var s = i % this.model.get("step") == 0 ? this.model.get("step") : i % this.model.get("step");
                    t.val(i - s)
                }
            },
            onShow: function() {
                this.model.get("alreadyRendered") || (this.render().update(), this.model.set("alreadyRendered", !0)), this.$el.find("input:text").first().focus()
            },
            template: function() {
                var e = window.AppData.Base.data,
                    n = this.model.toJSON(),
                    r = t.columns.getCurrent(e)[n.name],
                    i = "";
                return n.renderWrapper !== !1 && (i += '                <div class="base-filter-list base-filter-range"  style="min-width: ' + (r.width + 20) + 'px">                <div class="base-filter-list-title" style="width:' + (r.width - 14) + 'px">                    ' + r.title + '                </div>                <div class="base-filter-list-title-hider" style="width: ' + (r.width + 1) + 'px"></div>                <div class="base-filter-range-items">'), _.each(n.items, function(e) {
                    i += '<div class="base-range">                    <div class="title">' + e.title + '</div>                    <input placeholder="' + e.placeholder[0] + '" type="text">                    <div class="base-range-inc"><div class="up b-i"></div><div class="down b-i"></div></div> —                    <input placeholder="' + e.placeholder[1] + '" type="text">                    <div class="base-range-inc"><div class="up b-i"></div><div class="down b-i"></div></div>                </div>'
                }), n.renderSort !== !1 && (i += '</div>                <div class="base-filter-radio">                    <div class="base-radio base-radio-checked">                        <input type="radio" checked name="base-order-' + n.name + '" value="0">                        <div class="input"><div></div></div>                        <div class="title">Не сортировать</div>                    </div>                    <div class="base-radio">                        <input type="radio" name="base-order-' + n.name + '" value="1">                        <div class="input"><div></div></div>                        <div class="title">По возрастанию</div>                    </div>                    <div class="base-radio">                        <input type="radio" name="base-order-' + n.name + '" value="-1">                        <div class="input"><div></div></div>                        <div class="title">По убыванию</div>                    </div>                </div>'), n.renderEmpty !== !1 && (i += '<div class="base-filter-empty">                    <div class="base-checkbox base-checkbox-checked">                        <input type="checkbox" checked value="1">                        <div class="input"><div></div></div><div class="title">Показать пустые</div>                    </div>                </div>'), n.renderSubmitButton !== !1 && (i += '<div class="base-filter-submit-container">                    <div class="base-filter-submit">ОК</div>                    <div class="base-filter-clear">Очистить фильтр</div>                </div>                </div>'), i
            }
        });
        return r
    }), define("Base/Filter/Views/Field/MarketSegment", ["Base/Filter/Views/Abstract", "Base/Config"], function(e, t) {
        var n = e.extend({
            attributes: {
                "class": ""
            },
            initialize: function() {
                _.bindAll(this), this.appData = window.AppData.Base.data
            },
            events: {
                "click a": "setAppData"
            },
            update: function() {
                this.status()
            },
            status: function() {
                var e = this.appData.get("marketSegment");
                this.$el.find(".base-tab").removeClass("active"), this.$el.find(".base-tab:eq(" + (e - 1) + ")").addClass("active")
            },
            setAppData: function(e) {
                var t = parseInt($(e.target).siblings("input").val()),
                    n = parseInt(this.appData.get("marketSegment")),
                    r = parseInt(this.appData.get("operation"));
                (t !== n || r !== 1) && window.AppData.Base.events.trigger("BeforeMarketSegmentChange");
                var i = _.uri2obj($(e.currentTarget).attr("href").split("?")[1]);
                this.appData.reset().set(i).trigger("setAppData")
            },
            width: [120, 75, 175, 120, 114],
            template: function() {
                var e = "",
                    n = t.marketSegments;
                for (var r in n) {
                    var i = this.appData.generateDefaultUrl({
                        marketSegment: parseInt(r) + 1
                    });
                    e += '<div class="base-tab"><a style="width: ' + this.width[r] + 'px" href="' + i + '" class="trigger-false">' + n[r] + "</a>" + '<input type="hidden" value="' + (parseInt(r) + 1) + '"></div>'
                }
                e += '<div id="main-type-counters">';
                for (var r in n) e += '                <div class="main-type-counter main-type-counter-' + (parseInt(r) + 1) + '">                    <div class="mt-right"></div><div class="mt-counter"></div><div class="mt-left"></div>                </div>';
                return e += "</div>", e
            }
        });
        return n
    }), define("Base/Filter/Views/Field/Operation", ["Base/Filter/Views/Abstract", "Base/Config"], function(e, t) {
        var n = e.extend({
            events: {
                "click a": "setAppData"
            },
            initialize: function() {
                _.bindAll(this), this.appData = window.AppData.Base.data
            },
            update: function() {
                this.status()
            },
            status: function() {
                var e = this.appData.get("operation");
                this.$el.find("div:eq(" + (e - 1) + ")").prepend('<div class="b-i triangle"></div>')
            },
            setAppData: function(e) {
                var t = parseInt($(e.currentTarget).siblings("input").val());
                t !== parseInt(this.appData.get("operation")) && window.AppData.Base.events.trigger("BeforeOperationChange");
                var n = _.uri2obj($(e.currentTarget).attr("href").split("?")[1]);
                this.appData.reset().set(n).trigger("setAppData")
            },
            template: function() {
                var e = "",
                    n = t.operations;
                for (var r in n) {
                    var i = this.appData.generateDefaultUrl({
                        operation: parseInt(r) + 1
                    });
                    e += '<div><a href="' + i + '" class="trigger-false">' + n[r] + " " + '<b id="base-counter-operation-' + (parseInt(r) + 1) + '"></b></a>' + '<input type="hidden" value="' + (parseInt(r) + 1) + '"></div>'
                }
                return e
            }
        });
        return n
    }), define("Base/Filter/Views/Field/Type", ["Base/Filter/Views/Abstract"], function(e) {
        var t = e.extend({
            attributes: {
                "class": ""
            },
            events: {
                "click a": "changeType"
            },
            initialize: function() {
                _.bindAll(this), this.appData = window.AppData.Base.data
            },
            getCurrent: function() {
                var e = ["city", "suburb"],
                    t = [{
                        type: "city"
                    }, {
                        type: "suburb"
                    }],
                    n = [this.appData.generateDefaultUrl(t[0]), this.appData.generateDefaultUrl(t[1])];
                return {
                    types: e,
                    extend: t,
                    urls: n
                }
            },
            render: function() {
                return this.$el.append(_.template(this.template(), this.getCurrent())), this.showStatus(null, this.appData.get("type")), this
            },
            showStatus: function(e, t) {
                this.$el.find("[data-type=" + t + "] div").addClass("active")
            },
            changeType: function(e) {
                this.appData.reset().set({
                    type: $(e.currentTarget).data("type")
                }).trigger("setAppData")
            },
            template: function() {
                return '            <div class="base-filter-type-container">                <div class="base-filter-type base-filter-type-city">                    <a data-type="<%= types[0] %>" href="<%= urls[0] %>" class="trigger-false">                        <div class="base-filter-type-bgrnd">Город <b id="base-counter-city"></b></div>                    </a>                </div>                <div class="base-filter-type base-filter-type-suburb">                    <a data-type="<%= types[1] %>" href="<%= urls[1] %>" class="trigger-false">                        <div class="base-filter-type-bgrnd">Пригород <b id="base-counter-suburb"></b></div>                    </a>                </div>            </div>'
            }
        });
        return t
    }), define("Base/Filter/Views/Field/Rooms", ["Base/Filter/Views/List", "Base/Config"], function(e, t) {
        var n = e.extend({
            initialize: function() {
                _.bindAll(this), this.observeAppData();
                var e = _.clone(this.events);
                this.events = _.extend(e, {
                    "click .base-radio .title": "order",
                    "click .base-radio .input": "order"
                }), this.bindDocumentEvents()
            },
            onClose: function() {
                this.unbindDocumentEvents()
            },
            order: function(e) {
                this.$el.find(":radio").parent().removeClass("base-radio-checked"), e = _.isObject(e) ? $(e.currentTarget).siblings(":radio").val() : e, this.$el.find(":radio[value=" + e + "]").attr("checked", !0).parent().addClass("base-radio-checked")
            },
            submit: function() {
                var e = [_.map(this.$el.find(":checkbox:checked"), function(e) {
                    return e.value
                }), this.$el.find(":radio:checked").val() != "0" ? [this.model.get("set")[0], this.$el.find(":radio:checked").val()] : window.AppData.Base.data.get("order") && window.AppData.Base.data.get("order")[0] != this.model.get("set")[0] ? "leave" : !1];
                this.setAppData(e), this.$el.hide()
            },
            onStatus: function() {
                if (this.$el.parent().find(".base-filter-status").hasClass("base-filter-status-enabled")) return;
                var e = window.AppData.Base.data.get(this.model.get("set")[1]) || [];
                e[0] == this.model.get("set")[0] && e[1] && this.$el.parent().find(".base-filter-status").addClass("base-filter-status-enabled")
            },
            onUpdate: function() {
                var e = window.AppData.Base.data.get(this.model.get("set")[1]) || [],
                    t = e[0] == this.model.get("set")[0] ? e[1] : 0;
                this.status(), this.$el.find(".base-radio").removeClass("base-radio-checked"), this.$el.find(":radio[value=" + t + "]").attr("checked", !0).parent().addClass("base-radio-checked")
            },
            onClear: function() {
                this.$el.find(".base-radio").removeClass("base-radio-checked"), this.$el.find(":radio").first().attr("checked", !0).parent().addClass("base-radio-checked")
            },
            template: function() {
                var e = window.AppData.Base.data,
                    n = this.model.toJSON(),
                    r = t.columns.getCurrent(e)[n.name],
                    i = '            <div class="base-filter-list"  style="min-width: ' + (r.width + 20) + 'px">                <div class="base-filter-list-title" style="width: ' + (r.width - 14) + 'px">                    ' + r.title + '                </div>                <div class="base-filter-list-title-hider" style="width: ' + (r.width + 1) + 'px"></div>                <div class="base-filter-list-items">';
                return _.each(n.items, function(e) {
                    i += '                    <div class="base-checkbox">                        <input type="checkbox" value="' + e.id + '">                        <div class="input"><div></div></div><div class="title">' + e.title + "</div>                    </div>"
                }), i += '                </div>                <div class="base-filter-radio">                    <div class="base-radio base-radio-checked">                        <input type="radio" checked name="base-order-' + n.name + '" value="0">                        <div class="input"><div></div></div>                        <div class="title">Не сортировать</div>                    </div>                    <div class="base-radio">                        <input type="radio" name="base-order-' + n.name + '" value="1">                        <div class="input"><div></div></div>                        <div class="title">По возрастанию</div>                    </div>                    <div class="base-radio">                        <input type="radio" name="base-order-' + n.name + '" value="-1">                        <div class="input"><div></div></div>                        <div class="title">По убыванию</div>                    </div>                </div>                <div class="base-filter-submit-container">                    <div class="base-filter-submit">ОК</div>                    <div class="base-filter-clear">Очистить фильтр</div>                </div>            </div>', i
            }
        });
        return n
    }), define("Base/Filter/Views/Field/Phones", ["Base/Filter/Views/Abstract", "Base/Config"], function(e, t) {
        var n = e.extend({
            templateFile: "base/filterPhones",
            events: {
                "click .base-filter-submit": "submit",
                "click .base-filter-list-title": "cancel",
                "click .base-filter-clear": "clear",
                "keypress input": "inputOnKeyPress"
            },
            initialize: function() {
                _.bindAll(this), this.observeAppData(), this.bindDocumentEvents()
            },
            onClose: function() {
                this.unbindDocumentEvents()
            },
            status: function() {
                var e = window.AppData.Base.data.get(this.model.get("set")[0]);
                !e || e.length == 0 ? this.$el.parent().find(".base-filter-status").removeClass("base-filter-status-enabled") : this.$el.parent().find(".base-filter-status").addClass("base-filter-status-enabled")
            },
            update: function() {
                var e = window.AppData.Base.data.get(this.model.get("set")[0]);
                this.status(), this.$el.find("input").val(e)
            },
            submit: function() {
                var e = [this.$el.find("input").val() || !1];
                e[0] && (e[0] = e[0].replace(/\D+/g, ""), e[0] = e[0].replace(/^380/, "0").replace(/^80/, "0")), this.setAppData(e), this.$el.hide()
            },
            cancel: function(e) {
                this.$el.hide(), this.update()
            },
            inputOnKeyPress: function(e) {
                var t = e.keyCode || e.which;
                if ((t < 48 || t > 57) && t != 13 && t != 58 && t != 8) return !1;
                t == 13 && this.submit()
            },
            clear: function() {
                this.$el.find("input").val("")
            },
            onShow: function() {
                this.model.get("alreadyRendered") || (this.render().update(), this.model.set("alreadyRendered", !0)), this.$el.find("input").focus()
            },
            template: function() {
                var e = window.AppData.Base.data,
                    n = this.model.toJSON(),
                    r = t.columns.getCurrent(e)[n.name],
                    i = '            <div class="base-filter-list"  style="min-width: ' + (r.width + 20) + 'px">                <div class="base-filter-list-title" style="width: ' + (r.width - 14) + 'px">                    ' + r.title + '                </div>                <div class="base-filter-list-title-hider" style="width: ' + (r.width + 1) + 'px"></div>                <div class="base-filter-search">                    <input maxlength="20">                </div>                <div class="base-filter-submit-container">                    <div class="base-filter-submit">ОК</div>                    <div class="base-filter-clear">Очистить фильтр</div>                </div>            </div>';
                return i
            }
        });
        return n
    }), ! function(e) {
        function t() {
            return new Date(Date.UTC.apply(Date, arguments))
        }

        function n() {
            var e = new Date;
            return t(e.getUTCFullYear(), e.getUTCMonth(), e.getUTCDate())
        }
        var r = function(t, n) {
            var r = this;
            this.element = e(t), this.language = n.language || this.element.data("date-language") || "en", this.language = this.language in i ? this.language : "en", this.format = s.parseFormat(n.format || this.element.data("date-format") || "mm/dd/yyyy"), this.picker = e(s.template).appendTo("body").on({
                click: e.proxy(this.click, this)
            }), this.isInput = this.element.is("input"), this.component = this.element.is(".date") ? this.element.find(".add-on") : !1, this.hasInput = this.component && this.element.find("input").length, this.component && this.component.length === 0 && (this.component = !1), this._attachEvents(), this.forceParse = !0, "forceParse" in n ? this.forceParse = n.forceParse : "dateForceParse" in this.element.data() && (this.forceParse = this.element.data("date-force-parse")), e(document).on("mousedown", function(t) {
                e(t.target).closest(".datepicker").length == 0 && r.hide()
            }), this.autoclose = !1, "autoclose" in n ? this.autoclose = n.autoclose : "dateAutoclose" in this.element.data() && (this.autoclose = this.element.data("date-autoclose")), this.keyboardNavigation = !0, "keyboardNavigation" in n ? this.keyboardNavigation = n.keyboardNavigation : "dateKeyboardNavigation" in this.element.data() && (this.keyboardNavigation = this.element.data("date-keyboard-navigation"));
            switch (n.startView || this.element.data("date-start-view")) {
                case 2:
                case "decade":
                    this.viewMode = this.startViewMode = 2;
                    break;
                case 1:
                case "year":
                    this.viewMode = this.startViewMode = 1;
                    break;
                case 0:
                case "month":
                default:
                    this.viewMode = this.startViewMode = 0
            }
            this.todayBtn = n.todayBtn || this.element.data("date-today-btn") || !1, this.todayHighlight = n.todayHighlight || this.element.data("date-today-highlight") || !1, this.weekStart = (n.weekStart || this.element.data("date-weekstart") || i[this.language].weekStart || 0) % 7, this.weekEnd = (this.weekStart + 6) % 7, this.startDate = -Infinity, this.endDate = Infinity, this.setStartDate(n.startDate || this.element.data("date-startdate")), this.setEndDate(n.endDate || this.element.data("date-enddate")), this.fillDow(), this.fillMonths(), this.update(), this.showMode()
        };
        r.prototype = {
            constructor: r,
            _events: [],
            _attachEvents: function() {
                this._detachEvents(), this.isInput ? this._events = [
                    [this.element, {
                        focus: e.proxy(this.show, this),
                        keyup: e.proxy(this.update, this),
                        keydown: e.proxy(this.keydown, this)
                    }]
                ] : this.component && this.hasInput ? this._events = [
                    [this.element.find("input"), {
                        focus: e.proxy(this.show, this),
                        keyup: e.proxy(this.update, this),
                        keydown: e.proxy(this.keydown, this)
                    }],
                    [this.component, {
                        click: e.proxy(this.show, this)
                    }]
                ] : this._events = [
                    [this.element, {
                        click: e.proxy(this.show, this)
                    }]
                ];
                for (var t = 0, n, r; t < this._events.length; t++) n = this._events[t][0], r = this._events[t][1], n.on(r)
            },
            _detachEvents: function() {
                for (var e = 0, t, n; e < this._events.length; e++) t = this._events[e][0], n = this._events[e][1], t.off(n);
                this._events = []
            },
            show: function(t) {
                this.picker.show(), this.height = this.component ? this.component.outerHeight() : this.element.outerHeight(), this.update(), this.place(), e(window).on("resize", e.proxy(this.place, this)), t && (t.stopPropagation(), t.preventDefault()), this.element.trigger({
                    type: "show",
                    date: this.date
                })
            },
            hide: function(t) {
                this.picker.hide(), e(window).off("resize", this.place), this.viewMode = this.startViewMode, this.showMode(), this.isInput || e(document).off("mousedown", this.hide), this.forceParse && (this.isInput && this.element.val() || this.hasInput && this.element.find("input").val()) && this.setValue(), this.element.trigger({
                    type: "hide",
                    date: this.date
                })
            },
            remove: function() {
                this._detachEvents(), this.picker.remove(), delete this.element.data().datepicker
            },
            getDate: function() {
                var e = this.getUTCDate();
                return new Date(e.getTime() + e.getTimezoneOffset() * 6e4)
            },
            getUTCDate: function() {
                return this.date
            },
            setDate: function(e) {
                this.setUTCDate(new Date(e.getTime() - e.getTimezoneOffset() * 6e4))
            },
            setUTCDate: function(e) {
                this.date = e, this.setValue()
            },
            setValue: function() {
                var e = s.formatDate(this.date, this.format, this.language);
                this.isInput ? this.element.prop("value", e) : (this.component && this.element.find("input").prop("value", e), this.element.data("date", e))
            },
            setStartDate: function(e) {
                this.startDate = e || -Infinity, this.startDate !== -Infinity && (this.startDate = s.parseDate(this.startDate, this.format, this.language)), this.update(), this.updateNavArrows()
            },
            setEndDate: function(e) {
                this.endDate = e || Infinity, this.endDate !== Infinity && (this.endDate = s.parseDate(this.endDate, this.format, this.language)), this.update(), this.updateNavArrows()
            },
            place: function() {
                var t = parseInt(this.element.parents().filter(function() {
                        return e(this).css("z-index") != "auto"
                    }).first().css("z-index")) + 10,
                    n = this.component ? this.component.offset() : this.element.offset();
                this.picker.css({
                    top: n.top + this.height,
                    left: n.left,
                    zIndex: t
                })
            },
            update: function() {
                this.date = s.parseDate(this.isInput ? this.element.prop("value") : this.element.data("date") || this.element.find("input").prop("value"), this.format, this.language), this.date < this.startDate ? this.viewDate = new Date(this.startDate) : this.date > this.endDate ? this.viewDate = new Date(this.endDate) : this.viewDate = new Date(this.date), this.fill()
            },
            fillDow: function() {
                var e = this.weekStart,
                    t = "<tr>";
                while (e < this.weekStart + 7) t += '<th class="dow">' + i[this.language].daysMin[e++ % 7] + "</th>";
                t += "</tr>", this.picker.find(".datepicker-days thead").append(t)
            },
            fillMonths: function() {
                var e = "",
                    t = 0;
                while (t < 12) e += '<span class="month">' + i[this.language].monthsShort[t++] + "</span>";
                this.picker.find(".datepicker-months td").html(e)
            },
            fill: function() {
                var e = new Date(this.viewDate),
                    n = e.getUTCFullYear(),
                    r = e.getUTCMonth(),
                    o = this.startDate !== -Infinity ? this.startDate.getUTCFullYear() : -Infinity,
                    u = this.startDate !== -Infinity ? this.startDate.getUTCMonth() : -Infinity,
                    a = this.endDate !== Infinity ? this.endDate.getUTCFullYear() : Infinity,
                    f = this.endDate !== Infinity ? this.endDate.getUTCMonth() : Infinity,
                    l = this.date.valueOf(),
                    c = new Date;
                this.picker.find(".datepicker-days thead th:eq(1)").text(i[this.language].months[r] + " " + n), this.picker.find("tfoot th.today").text(i[this.language].today).toggle(this.todayBtn), this.updateNavArrows(), this.fillMonths();
                var h = t(n, r - 1, 28, 0, 0, 0, 0),
                    p = s.getDaysInMonth(h.getUTCFullYear(), h.getUTCMonth());
                h.setUTCDate(p), h.setUTCDate(p - (h.getUTCDay() - this.weekStart + 7) % 7);
                var d = new Date(h);
                d.setUTCDate(d.getUTCDate() + 42), d = d.valueOf();
                var v = [],
                    m;
                while (h.valueOf() < d) {
                    h.getUTCDay() == this.weekStart && v.push("<tr>"), m = "";
                    if (h.getUTCFullYear() < n || h.getUTCFullYear() == n && h.getUTCMonth() < r) m += " old";
                    else if (h.getUTCFullYear() > n || h.getUTCFullYear() == n && h.getUTCMonth() > r) m += " new";
                    this.todayHighlight && h.getUTCFullYear() == c.getFullYear() && h.getUTCMonth() == c.getMonth() && h.getUTCDate() == c.getDate() && (m += " today"), h.valueOf() == l && (m += " active");
                    if (h.valueOf() < this.startDate || h.valueOf() > this.endDate) m += " disabled";
                    v.push('<td class="day' + m + '"><a>' + h.getUTCDate() + "</a></td>"), h.getUTCDay() == this.weekEnd && v.push("</tr>"), h.setUTCDate(h.getUTCDate() + 1)
                }
                this.picker.find(".datepicker-days tbody").empty().append(v.join(""));
                var g = this.date.getUTCFullYear(),
                    y = this.picker.find(".datepicker-months").find("th:eq(1)").text(n).end().find("span").removeClass("active");
                g == n && y.eq(this.date.getUTCMonth()).addClass("active"), (n < o || n > a) && y.addClass("disabled"), n == o && y.slice(0, u).addClass("disabled"), n == a && y.slice(f + 1).addClass("disabled"), v = "", n = parseInt(n / 10, 10) * 10;
                var b = this.picker.find(".datepicker-years").find("th:eq(1)").text(n + "-" + (n + 9)).end().find("td");
                n -= 1;
                for (var w = -1; w < 11; w++) v += '<span class="year' + (w == -1 || w == 10 ? " old" : "") + (g == n ? " active" : "") + (n < o || n > a ? " disabled" : "") + '">' + n + "</span>", n += 1;
                b.html(v)
            },
            updateNavArrows: function() {
                var e = new Date(this.viewDate),
                    t = e.getUTCFullYear(),
                    n = e.getUTCMonth();
                switch (this.viewMode) {
                    case 0:
                        this.startDate !== -Infinity && t <= this.startDate.getUTCFullYear() && n <= this.startDate.getUTCMonth() ? this.picker.find(".prev").css({
                            visibility: "hidden"
                        }) : this.picker.find(".prev").css({
                            visibility: "visible"
                        }), this.endDate !== Infinity && t >= this.endDate.getUTCFullYear() && n >= this.endDate.getUTCMonth() ? this.picker.find(".next").css({
                            visibility: "hidden"
                        }) : this.picker.find(".next").css({
                            visibility: "visible"
                        });
                        break;
                    case 1:
                    case 2:
                        this.startDate !== -Infinity && t <= this.startDate.getUTCFullYear() ? this.picker.find(".prev").css({
                            visibility: "hidden"
                        }) : this.picker.find(".prev").css({
                            visibility: "visible"
                        }), this.endDate !== Infinity && t >= this.endDate.getUTCFullYear() ? this.picker.find(".next").css({
                            visibility: "hidden"
                        }) : this.picker.find(".next").css({
                            visibility: "visible"
                        })
                }
            },
            click: function(n) {
                n.stopPropagation(), n.preventDefault();
                var r = e(n.target).closest("span, td, th");
                if (r.length == 1) switch (r[0].nodeName.toLowerCase()) {
                    case "th":
                        switch (r[0].className) {
                            case "switch":
                                break;
                            case "prev":
                            case "next":
                                var i = s.modes[this.viewMode].navStep * (r[0].className == "prev" ? -1 : 1);
                                switch (this.viewMode) {
                                    case 0:
                                        this.viewDate = this.moveMonth(this.viewDate, i);
                                        break;
                                    case 1:
                                    case 2:
                                        this.viewDate = this.moveYear(this.viewDate, i)
                                }
                                this.fill();
                                break;
                            case "today":
                                var o = new Date;
                                o.setUTCHours(0), o.setUTCMinutes(0), o.setUTCSeconds(0), o.setUTCMilliseconds(0), this.showMode(-2);
                                var u = this.todayBtn == "linked" ? null : "view";
                                this._setDate(o, u)
                        }
                        break;
                    case "span":
                        if (!r.is(".disabled")) {
                            this.viewDate.setUTCDate(1);
                            if (r.is(".month")) {
                                var a = r.parent().find("span").index(r);
                                this.viewDate.setUTCMonth(a), this.element.trigger({
                                    type: "changeMonth",
                                    date: this.viewDate
                                })
                            } else {
                                var f = parseInt(r.text(), 10) || 0;
                                this.viewDate.setUTCFullYear(f), this.element.trigger({
                                    type: "changeYear",
                                    date: this.viewDate
                                })
                            }
                            this.showMode(-1), this.fill()
                        }
                        break;
                    case "td":
                        if (r.is(".day") && !r.is(".disabled")) {
                            var l = parseInt(r.text(), 10) || 1,
                                f = this.viewDate.getUTCFullYear(),
                                a = this.viewDate.getUTCMonth();
                            r.is(".old") ? a == 0 ? (a = 11, f -= 1) : a -= 1 : r.is(".new") && (a == 11 ? (a = 0, f += 1) : a += 1), this._setDate(t(f, a, l, 0, 0, 0, 0))
                        }
                }
            },
            _setDate: function(e, t) {
                if (!t || t == "date") this.date = e;
                if (!t || t == "view") this.viewDate = e;
                this.fill(), this.setValue(), this.element.trigger({
                    type: "changeDate",
                    date: this.date
                });
                var n;
                this.isInput ? n = this.element : this.component && (n = this.element.find("input")), n && (n.change(), this.autoclose && this.hide())
            },
            moveMonth: function(e, t) {
                if (!t) return e;
                var n = new Date(e.valueOf()),
                    r = n.getUTCDate(),
                    i = n.getUTCMonth(),
                    s = Math.abs(t),
                    o, u;
                t = t > 0 ? 1 : -1;
                if (s == 1) {
                    u = t == -1 ? function() {
                        return n.getUTCMonth() == i
                    } : function() {
                        return n.getUTCMonth() != o
                    }, o = i + t, n.setUTCMonth(o);
                    if (o < 0 || o > 11) o = (o + 12) % 12
                } else {
                    for (var a = 0; a < s; a++) n = this.moveMonth(n, t);
                    o = n.getUTCMonth(), n.setUTCDate(r), u = function() {
                        return o != n.getUTCMonth()
                    }
                }
                while (u()) n.setUTCDate(--r), n.setUTCMonth(o);
                return n
            },
            moveYear: function(e, t) {
                return this.moveMonth(e, t * 12)
            },
            dateWithinRange: function(e) {
                return e >= this.startDate && e <= this.endDate
            },
            keydown: function(e) {
                if (this.picker.is(":not(:visible)")) {
                    e.keyCode == 27 && this.show();
                    return
                }
                var t = !1,
                    n, r, i, s, o;
                switch (e.keyCode) {
                    case 27:
                        this.hide(), e.preventDefault();
                        break;
                    case 37:
                    case 39:
                        if (!this.keyboardNavigation) break;
                        n = e.keyCode == 37 ? -1 : 1, e.ctrlKey ? (s = this.moveYear(this.date, n), o = this.moveYear(this.viewDate, n)) : e.shiftKey ? (s = this.moveMonth(this.date, n), o = this.moveMonth(this.viewDate, n)) : (s = new Date(this.date), s.setUTCDate(this.date.getUTCDate() + n), o = new Date(this.viewDate), o.setUTCDate(this.viewDate.getUTCDate() + n)), this.dateWithinRange(s) && (this.date = s, this.viewDate = o, this.setValue(), this.update(), e.preventDefault(), t = !0);
                        break;
                    case 38:
                    case 40:
                        if (!this.keyboardNavigation) break;
                        n = e.keyCode == 38 ? -1 : 1, e.ctrlKey ? (s = this.moveYear(this.date, n), o = this.moveYear(this.viewDate, n)) : e.shiftKey ? (s = this.moveMonth(this.date, n), o = this.moveMonth(this.viewDate, n)) : (s = new Date(this.date), s.setUTCDate(this.date.getUTCDate() + n * 7), o = new Date(this.viewDate), o.setUTCDate(this.viewDate.getUTCDate() + n * 7)), this.dateWithinRange(s) && (this.date = s, this.viewDate = o, this.setValue(), this.update(), e.preventDefault(), t = !0);
                        break;
                    case 13:
                        this.hide(), e.preventDefault();
                        break;
                    case 9:
                        this.hide()
                }
                if (t) {
                    this.element.trigger({
                        type: "changeDate",
                        date: this.date
                    });
                    var u;
                    this.isInput ? u = this.element : this.component && (u = this.element.find("input")), u && u.change()
                }
            },
            showMode: function(e) {
                e && (this.viewMode = Math.max(0, Math.min(2, this.viewMode + e))), this.picker.find(">div").hide().filter(".datepicker-" + s.modes[this.viewMode].clsName).show(), this.updateNavArrows()
            }
        }, e.fn.datepicker = function(t) {
            var n = Array.apply(null, arguments);
            return n.shift(), this.each(function() {
                var i = e(this),
                    s = i.data("datepicker"),
                    o = typeof t == "object" && t;
                s || i.data("datepicker", s = new r(this, e.extend({}, e.fn.datepicker.defaults, o))), typeof t == "string" && typeof s[t] == "function" && s[t].apply(s, n)
            })
        }, e.fn.datepicker.defaults = {}, e.fn.datepicker.Constructor = r;
        var i = e.fn.datepicker.dates = {
                en: {
                    days: ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"],
                    daysShort: ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat", "Sun"],
                    daysMin: ["Su", "Mo", "Tu", "We", "Th", "Fr", "Sa", "Su"],
                    months: ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"],
                    monthsShort: ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"],
                    today: "Today"
                },
                ru: {
                    days: ["Воскресенье", "Понедельник", "Вторник", "Среда", "Четверг", "Пятница", "Суббота", "Воскресенье"],
                    daysShort: ["Вс", "Пн", "Вт", "Ср", "Чт", "Пт", "Сб", "Вс"],
                    daysMin: ["Вс", "Пн", "Вт", "Ср", "Чт", "Пт", "Сб", "Вс"],
                    months: ["Январь", "Февраль", "Март", "Апрель", "Май", "Июнь", "Июль", "Август", "Сентябрь", "Октябрь", "Ноябрь", "Декабрь"],
                    monthsShort: ["Янв", "Фев", "Мар", "Апр", "Май", "Июн", "Июл", "Авг", "Сен", "Окт", "Ноя", "Дек"],
                    today: "Сегодня",
                    weekStart: 1
                }
            },
            s = {
                modes: [{
                    clsName: "days",
                    navFnc: "Month",
                    navStep: 1
                }, {
                    clsName: "months",
                    navFnc: "FullYear",
                    navStep: 1
                }, {
                    clsName: "years",
                    navFnc: "FullYear",
                    navStep: 10
                }],
                isLeapYear: function(e) {
                    return e % 4 === 0 && e % 100 !== 0 || e % 400 === 0
                },
                getDaysInMonth: function(e, t) {
                    return [31, s.isLeapYear(e) ? 29 : 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31][t]
                },
                validParts: /dd?|mm?|MM?|yy(?:yy)?/g,
                nonpunctuation: /[^ -\/:-@\[-`{-~\t\n\r]+/g,
                parseFormat: function(e) {
                    var t = e.replace(this.validParts, "\0").split("\0"),
                        n = e.match(this.validParts);
                    if (!t || !t.length || !n || n.length == 0) throw new Error("Invalid date format.");
                    return {
                        separators: t,
                        parts: n
                    }
                },
                parseDate: function(n, s, o) {
                    if (n instanceof Date) return n;
                    if (/^[-+]\d+[dmwy]([\s,]+[-+]\d+[dmwy])*$/.test(n)) {
                        var u = /([-+]\d+)([dmwy])/,
                            a = n.match(/([-+]\d+)([dmwy])/g),
                            f, l;
                        n = new Date;
                        for (var c = 0; c < a.length; c++) {
                            f = u.exec(a[c]), l = parseInt(f[1]);
                            switch (f[2]) {
                                case "d":
                                    n.setUTCDate(n.getUTCDate() + l);
                                    break;
                                case "m":
                                    n = r.prototype.moveMonth.call(r.prototype, n, l);
                                    break;
                                case "w":
                                    n.setUTCDate(n.getUTCDate() + l * 7);
                                    break;
                                case "y":
                                    n = r.prototype.moveYear.call(r.prototype, n, l)
                            }
                        }
                        return t(n.getUTCFullYear(), n.getUTCMonth(), n.getUTCDate(), 0, 0, 0)
                    }
                    var a = n && n.match(this.nonpunctuation) || [],
                        n = new Date,
                        h = {},
                        p = ["yyyy", "yy", "M", "MM", "m", "mm", "d", "dd"],
                        d = {
                            yyyy: function(e, t) {
                                return e.setUTCFullYear(t)
                            },
                            yy: function(e, t) {
                                return e.setUTCFullYear(2e3 + t)
                            },
                            m: function(e, t) {
                                t -= 1;
                                while (t < 0) t += 12;
                                t %= 12, e.setUTCMonth(t);
                                while (e.getUTCMonth() != t) e.setUTCDate(e.getUTCDate() - 1);
                                return e
                            },
                            d: function(e, t) {
                                return e.setUTCDate(t)
                            }
                        },
                        v, m, f;
                    d.M = d.MM = d.mm = d.m, d.dd = d.d, n = t(n.getFullYear(), n.getMonth(), n.getDate(), 0, 0, 0);
                    if (a.length == s.parts.length) {
                        for (var c = 0, g = s.parts.length; c < g; c++) {
                            v = parseInt(a[c], 10), f = s.parts[c];
                            if (isNaN(v)) switch (f) {
                                case "MM":
                                    m = e(i[o].months).filter(function() {
                                        var e = this.slice(0, a[c].length),
                                            t = a[c].slice(0, e.length);
                                        return e == t
                                    }), v = e.inArray(m[0], i[o].months) + 1;
                                    break;
                                case "M":
                                    m = e(i[o].monthsShort).filter(function() {
                                        var e = this.slice(0, a[c].length),
                                            t = a[c].slice(0, e.length);
                                        return e == t
                                    }), v = e.inArray(m[0], i[o].monthsShort) + 1
                            }
                            h[f] = v
                        }
                        for (var c = 0, y; c < p.length; c++) y = p[c], y in h && !isNaN(h[y]) && d[y](n, h[y])
                    }
                    return n
                },
                formatDate: function(t, n, r) {
                    var s = {
                        d: t.getUTCDate(),
                        m: t.getUTCMonth() + 1,
                        M: i[r].monthsShort[t.getUTCMonth()],
                        MM: i[r].months[t.getUTCMonth()],
                        yy: t.getUTCFullYear().toString().substring(2),
                        yyyy: t.getUTCFullYear()
                    };
                    s.dd = (s.d < 10 ? "0" : "") + s.d, s.mm = (s.m < 10 ? "0" : "") + s.m;
                    var t = [],
                        o = e.extend([], n.separators);
                    for (var u = 0, a = n.parts.length; u < a; u++) o.length && t.push(o.shift()), t.push(s[n.parts[u]]);
                    return t.join("")
                },
                headTemplate: '<thead><tr><th class="prev"><i class="icon-arrow-left b-i"/></th><th colspan="5" class="switch"></th><th class="next"><i class="icon-arrow-right b-i"/></th></tr></thead>',
                contTemplate: '<tbody><tr><td colspan="7"></td></tr></tbody>',
                footTemplate: '<tfoot><tr><th colspan="7" class="today"></th></tr></tfoot>'
            };
        s.template = '<div class="datepicker dropdown-menu"><div class="datepicker-days"><table class=" table-condensed">' + s.headTemplate + "<tbody></tbody>" + s.footTemplate + "</table>" + "</div>" + '<div class="datepicker-months">' + '<table class="table-condensed">' + s.headTemplate + s.contTemplate + s.footTemplate + "</table>" + "</div>" + '<div class="datepicker-years">' + '<table class="table-condensed">' + s.headTemplate + s.contTemplate + s.footTemplate + "</table>" + "</div>" + "</div>"
    }(window.jQuery), define("Libs/DatePicker", ["Libs/DatePicker/bootstrap-datepicker-2.0"], function(e) {
        return e
    }), define("Libs/DatePicker/bootstrap-datepicker-2.0", function() {}), define("Base/Filter/Views/Field/Date", ["Base/Filter/Views/Abstract", "Base/Config", "Libs/DatePicker"], function(e, t) {
        var n = e.extend({
            events: {
                "click .base-filter-submit": "submit",
                "click .base-filter-list-title": "cancel",
                "click .base-filter-clear": "clear",
                "click .base-checkbox .title": "check",
                "click .base-checkbox .input": "check",
                "click .base-radio .title": "radio",
                "click .base-radio .input": "radio",
                "click .base-date-inputs": "baseDateInputsOnClick",
                "input .base-date-input": "dateOnInput",
                "keypress .base-date-input": "dateOnKeyPress",
                "focus .base-date-input": "dateOnFocus"
            },
            initialize: function() {
                _.bindAll(this), this.observeAppData(), this.bindDocumentEvents()
            },
            onClose: function() {
                this.unbindDocumentEvents()
            },
            baseDateInputsOnClick: function(e) {
                var t = $(e.target);
                if (!t.hasClass("base-date-input")) {
                    var n = t.parents(".base-dp-container").find(".base-date-input"),
                        r = n.last().val() || !t.hasClass("b-i") ? n.last() : n.first();
                    _.setCaretPosition(r, r.val() ? r.val().length : 0)
                }
            },
            dateOnFocus: function(e) {
                this.radio(-2, !1);
                if (this.$el.find(".base-date-from").data("datepicker") === undefined) return;
                this.$el.find(".base-date-from, .base-date-to").datepicker("hide"), $(e.currentTarget).parent().next().datepicker("show")
            },
            dateOnKeyPress: function(e) {
                var t = e.keyCode || e.which;
                if ((t < 48 || t > 57) && t != 13 && t != 58 && t != 8) return !1;
                t == 13 && ($(".datepicker").is(":visible") ? $(e.currentTarget).parent().next().datepicker("hide") : this.submit())
            },
            dateOnInput: function(e) {
                var t = $(e.currentTarget),
                    n = t.parent().next(),
                    r = _.map(this.$el.find(".base-date-input"), function(e) {
                        return e.value || 0
                    });
                n.datepicker("show");
                var i = new Date(r[1] + "/" + r[0] + "/" + r[2]);
                i == "Invalid Date" || r[2] < 2e3 ? window.AppData.date(function(e) {
                    n.val(e), n.datepicker("update")
                }) : (n.val(r[1] + "/" + r[0] + "/" + r[2]), n.datepicker("update")), t.val().length == t.attr("maxlength") ? setTimeout(function() {
                    t.next().focus()
                }, 1) : t.val().length == 0 && setTimeout(function() {
                    t.prev().focus()
                }, 1)
            },
            setDate: function(e) {
                var t = new Date(e.date),
                    n = ((t.getDate() < 10 ? "0" + t.getDate() : t.getDate()) + "." + (t.getMonth() + 1 < 10 ? "0" + (t.getMonth() + 1) : t.getMonth() + 1) + "." + t.getFullYear().toString()).split(".");
                $(e.currentTarget).prev().find("input").each(function(e) {
                    e <= 2 && $(this).val(n[e])
                })
            },
            makeDatePickers: function() {
                this.$el.find(".base-date-from, .base-date-to").datepicker({
                    language: "ru",
                    todayHighlight: !0,
                    autoclose: !0
                }).on("changeDate", this.setDate)
            },
            removeDatePickers: function() {
                this.$el.find(".base-date-from, .base-date-to").datepicker("remove")
            },
            status: function() {
                var e = window.AppData.Base.data.get(this.model.get("set")[0]);
                !e || e.length == 0 ? this.$el.parent().find(".base-filter-status").removeClass("base-filter-status-enabled") : this.$el.parent().find(".base-filter-status").addClass("base-filter-status-enabled")
            },
            update: function() {
                var e = window.AppData.Base.data.get(this.model.get("set")[0]);
                this.status();
                if (!e || !e.length) {
                    this.clear(), this.radio(-1);
                    return
                }
                if (e[0] == "period") this.radio(e[1]);
                else if (e[0] == "month") {
                    var t = _.rest(e);
                    this.clear();
                    for (var n in t) this.check(t[n])
                } else if (e[0] == "range") {
                    this.radio(-2);
                    var t = e.length == 3 ? [e[1], e[2]] : [e[1], e[1]];
                    this.$el.find(".base-date-from, .base-date-to").each(function(e) {
                        $(this).val(t[e] == "null" ? "" : t[e]);
                        var n = new Date(t[e]),
                            r = [n.getDate(), n.getMonth() + 1, n.getFullYear()];
                        $(this).prev().find("input").each(function(e) {
                            e <= 2 && $(this).val(parseInt(r[e]) < 10 ? "0" + r[e] : r[e])
                        })
                    })
                }
            },
            check: function(e) {
                this.$el.find(".base-date-from, .base-date-to").val(""), this.$el.find(":radio").attr("checked", !1).parent().removeClass("base-radio-checked"), e = _.isObject(e) ? $(e.currentTarget).siblings("input:checkbox").val() : e;
                var t = this.$el.find(":checkbox[value=" + e + "]");
                t.prop("checked", !t.prop("checked")).parent().toggleClass("base-checkbox-checked")
            },
            radio: function(e, t) {
                (t === undefined ? !0 : t) && this.$el.find(".base-date-from, .base-date-to").val(""), this.$el.find(":checkbox").prop("checked", !1).parent().removeClass("base-checkbox-checked"), this.$el.find(":radio").parent().removeClass("base-radio-checked"), value = _.isObject(e) ? $(e.currentTarget).siblings(":radio").val() : e, this.$el.find(":radio[value=" + value + "]").attr("checked", !0).parent().addClass("base-radio-checked"), value == -2 && _.isObject(e) && (this.$el.find(".base-date-day").first().focus(), this.$el.find(".base-date-from").datepicker("show"))
            },
            submit: function() {
                var e = this.$el.find(":radio:checked"),
                    t = this.$el.find(":checkbox:checked"),
                    n = [!1];
                t.length && (n = [_.union(["month"], _.map(this.$el.find(":checkbox:checked"), function(e) {
                    return e.value
                }))]), e.val() == -2 && (n = [_.union(["range"], _.map(this.$el.find(".base-dp-input"), function(e) {
                    return e.value || "null"
                }))]), e.val() && e.val() != -1 && e.val() != -2 && (n = [
                    ["period", e.val()]
                ]), this.setAppData(n), this.removeDatePickers(), this.$el.hide()
            },
            cancel: function(e) {
                this.$el.hide(), this.removeDatePickers(), this.update()
            },
            clear: function() {
                this.$el.find(".base-dp-container input").val(""), this.$el.find(":checkbox").prop("checked", !1).parent().removeClass("base-checkbox-checked"), this.$el.find(":radio").parent().removeClass("base-radio-checked"), this.$el.find(":radio[value=-1]").attr("checked", !0).parent().addClass("base-radio-checked")
            },
            onShow: function() {
                this.model.get("alreadyRendered") || (this.render().update(), this.model.set("alreadyRendered", !0)), this.makeDatePickers()
            },
            render: function() {
                return this.$el.append(this.template()), this.$el.find(".base-filter-list-items").scrollbar(), this
            },
            template: function() {
                var e = window.AppData.Base.data,
                    n = this.model.toJSON(),
                    r = t.columns.getCurrent(e)[n.name],
                    i = '            <div class="base-filter-list base-filter-date"  style="min-width: ' + (r.width + 20) + 'px">                <div class="base-filter-list-title" style="width: ' + (r.width - 14) + 'px">                    ' + r.title + '                </div>                <div class="base-filter-list-title-hider" style="width: ' + (r.width + 1) + 'px"></div>                <div class="base-filter-radio">                    <div class="base-radio">                        <input type="radio" name="base-order-' + n.name + '" value="0">                        <div class="input"><div></div></div>                        <div class="title">За сегодня</div>                    </div>                    <div class="base-radio">                        <input type="radio" name="base-order-' + n.name + '" value="1">                        <div class="input"><div></div></div>                        <div class="title">За вчера</div>                    </div>                    <div class="base-radio">                        <input type="radio" name="base-order-' + n.name + '" value="7">                        <div class="input"><div></div></div>                        <div class="title">За неделю</div>                    </div>                    <div class="base-radio">                        <input type="radio" name="base-order-' + n.name + '" value="30">                        <div class="input"><div></div></div>                        <div class="title">За месяц</div>                    </div>                    <div class="base-radio">                        <input type="radio" name="base-order-' + n.name + '" value="90">                        <div class="input"><div></div></div>                        <div class="title">За квартал</div>                    </div>                    <div class="base-radio">                        <input type="radio" name="base-order-' + n.name + '" value="180">                        <div class="input"><div></div></div>                        <div class="title">За полгода</div>                    </div>                    <div class="base-radio">                        <input type="radio" name="base-order-' + n.name + '" value="356">                        <div class="input"><div></div></div>                        <div class="title">За год</div>                    </div>                    <div class="base-radio">                        <input type="radio" name="base-order-' + n.name + '" value="-1">                        <div class="input"><div></div></div>                        <div class="title">За все время</div>                    </div>                    <div class="base-radio">                        <input type="radio" name="base-order-' + n.name + '" value="-2">                        <div class="input"><div></div></div>                        <div class="title">За период</div>                    </div>                    <div class="base-dp-container">                        <div>с</div>                        <div class="base-date-inputs">                            <input type="text" class="base-date-input base-date-day" maxlength="2">.' + '<input type="text" class="base-date-input base-date-month" maxlength="2">.' + '<input type="text" class="base-date-input base-date-year" maxlength="4">                            <div class="b-i"></div>                        </div>                        <input type="text" class="base-dp-input base-date-from" tabindex="-1">                    </div>                    <div class="base-dp-container">                        <div>по</div>                        <div class="base-date-inputs">                            <input type="text" class="base-date-input base-date-day" maxlength="2">.' + '<input type="text" class="base-date-input base-date-month" maxlength="2">.' + '<input type="text" class="base-date-input base-date-year" maxlength="4">                            <div class="b-i"></div>                        </div>                        <input type="text" class="base-dp-input base-date-to" tabindex="-1">                    </div>                </div>                <div class="base-filter-list-items">                    <div class="base-checkbox">Календарный месяц</div>';
                for (var s = n.items.length - 1; s > 0; s--) {
                    var o = n.items[s];
                    i += '                        <div class="base-checkbox">                            <input type="checkbox" value="' + o[0] + "-" + o[1] + '">                            <div class="input"><div></div></div><div class="title">' + t.months[o[0]] + " " + o[1] + "</div>                        </div>"
                }
                return i += '                </div>                <div class="base-filter-submit-container">                    <div class="base-filter-submit">ОК</div>                    <div class="base-filter-clear">Очистить фильтр</div>                </div>            </div>', i
            }
        });
        return n
    }), define("Base/Filter/Views/Field/Mark", ["Base/Filter/Views/Abstract", "Base/Config"], function(e, t) {
        var n = e.extend({
            templateFile: "base/filterMark",
            events: {
                "click .base-filter-submit": "submit",
                "click .base-checkbox .title": "check",
                "click .base-checkbox .input": "check",
                "click .base-checkbox .base-mark": "check",
                "click .base-filter-list-title": "cancel",
                "click .base-filter-clear": "clear"
            },
            initialize: function() {
                _.bindAll(this), this.observeAppData(), this.bindDocumentEvents(), this.bindTo(this.model, "change:items", this.onItemsChange)
            },
            onClose: function() {
                this.unbindDocumentEvents()
            },
            onItemsChange: function() {
                this.render().update()
            },
            status: function() {
                var e = window.AppData.Base.data.get(this.model.get("set")[0]);
                !e || e.length == 0 ? this.$el.parent().find(".base-filter-status").removeClass("base-filter-status-enabled") : this.$el.parent().find(".base-filter-status").addClass("base-filter-status-enabled"), this.onStatus && this.onStatus()
            },
            update: function() {
                var e = window.AppData.Base.data.get(this.model.get("set")[0]);
                this.status(), this.$el.find(":checkbox").attr("checked", !1).parent().removeClass("base-checkbox-checked"), _.each(e, this.check), this.onUpdate && this.onUpdate()
            },
            check: function(e) {
                e = _.isObject(e) ? $(e.currentTarget).siblings("input:checkbox").val() : e;
                var t = this.$el.find(":checkbox[value=" + e + "]");
                t.prop("checked", !t.prop("checked")).parent().toggleClass("base-checkbox-checked")
            },
            submit: function() {
                var e = [_.map(this.$el.find(":checkbox:checked"), function(e) {
                    return e.value
                })];
                this.setAppData(e), this.$el.hide()
            },
            cancel: function(e) {
                this.$el.hide(), this.update()
            },
            clear: function() {
                this.$el.find(":checkbox").attr("checked", !1).parent().removeClass("base-checkbox-checked"), this.onClear && this.onClear()
            },
            onShow: function() {
                this.model.get("alreadyRendered") || (this.render().update(), this.model.set("alreadyRendered", !0))
            },
            template: function() {
                var e = window.AppData.Base.data,
                    n = this.model.toJSON(),
                    r = t.columns.getCurrent(e)[n.name],
                    i = '            <div class="base-filter-list base-filter-mark" style="min-width:' + (r.width + 20) + 'px">            <div class="base-filter-list-title" style="width:' + (r.width - 14) + 'px">' + r.title + '</div>            <div class="base-filter-list-title-hider" style="width:' + (r.width + 1) + 'px"></div>            <div class="base-filter-list-items">';
                return _.each(n.items, function(e) {
                    i += '                <div class="base-checkbox">                    <input type="checkbox" value="' + e.id + '">                    <div class="input"><div></div></div>                    <div class="base-mark base-mark-' + e.id + '"></div>                    <div class="title">' + e.title + "</div>                </div>"
                }), i += '            </div>                <div class="base-filter-submit-container">                    <div class="base-filter-submit">ОК</div>                    <div class="base-filter-clear">Очистить фильтр</div>                </div>            </div>', i
            }
        });
        return n
    }), define("Base/Filter/Views/Field/Info", ["Base/Filter/Views/List", "Base/Config"], function(e, t) {
        var n = e.extend({
            templateFile: "base/filterInfo",
            initialize: function() {
                _.bindAll(this), this.observeAppData(), this.bindDocumentEvents()
            },
            onClose: function() {
                this.unbindDocumentEvents()
            },
            submit: function() {
                var e = [_.map(this.$el.find(".base-filter-list-items :checkbox:checked"), function(e) {
                    return e.value
                }), this.$el.find(".base-filter-empty :checkbox").prop("checked") ? "1" : !1];
                this.setAppData(e), this.$el.hide()
            },
            onStatus: function() {
                if (this.$el.parent().find(".base-filter-status").hasClass("base-filter-status-enabled")) return;
                var e = window.AppData.Base.data.get(this.model.get("set")[1]);
                e && this.$el.parent().find(".base-filter-status").addClass("base-filter-status-enabled")
            },
            onUpdate: function() {
                var e = !!window.AppData.Base.data.get(this.model.get("set")[1]);
                this.status(), this.$el.find(".base-filter-empty :checkbox").prop("checked", e), e ? this.$el.find(".base-filter-empty :checkbox").parent().addClass("base-checkbox-checked") : this.$el.find(".base-filter-empty :checkbox").parent().removeClass("base-checkbox-checked")
            },
            onShow: function() {
                this.model.get("alreadyRendered") || (this.render().update(), this.model.set("alreadyRendered", !0))
            },
            onClear: function() {
                this.$el.find(".base-filter-empty :checkbox").prop("checked", !1).parent().removeClass("base-checkbox-checked")
            },
            template: function() {
                var e = window.AppData.Base.data,
                    n = this.model.toJSON(),
                    r = t.columns.getCurrent(e)[n.name],
                    i = '            <div class="base-filter-list base-filter-info"  style="min-width: ' + (r.width + 20) + 'px">                <div class="base-filter-list-title" style="width: ' + (r.width - 14) + 'px">                    ' + r.title + '                </div>                <div class="base-filter-list-title-hider" style="width: ' + (r.width + 1) + 'px"></div>                <div class="base-filter-list-items">';
                return _.each(n.items, function(e) {
                    i += '                    <div class="base-checkbox">                        <input type="checkbox" value="' + e.id + '">                        <div class="input"><div></div></div><div class="title">' + e.title + "</div>                    </div>"
                }), i += '</div>                <div class="base-filter-empty">                    <div class="base-checkbox base-checkbox-checked">                        <input type="checkbox" checked value="1">                        <div class="input"><div></div></div><div class="title">Показать пустые</div>                    </div>                </div>                <div class="base-filter-submit-container">                    <div class="base-filter-submit">ОК</div>                    <div class="base-filter-clear">Очистить фильтр</div>                </div>            </div>', i
            }
        });
        return n
    }), define("Base/Filter/Views/Field/Id", ["Base/Filter/Views/Abstract", "Base/Config"], function(e, t) {
        var n = e.extend({
            events: {
                "click .base-filter-submit": "submit",
                "click .base-filter-list-title": "cancel",
                "click .base-filter-list-title div": "cancel",
                "click .base-radio .title": "order",
                "click .base-radio .input": "order",
                "click .base-filter-clear": "clear",
                "keypress .base-filter-input-id input": "inputOnKeyPress",
                "keypress .base-filter-input-text input": "textInputOnKeyPress"
            },
            initialize: function() {
                _.bindAll(this), this.observeAppData(), this.bindDocumentEvents()
            },
            onClose: function() {
                this.unbindDocumentEvents()
            },
            status: function() {
                var e = this.$el.find(":radio:checked").val() && this.$el.find(":radio:checked").val() != "0",
                    t = window.AppData.Base.data.get(this.model.get("set")[0]),
                    n = window.AppData.Base.data.get(this.model.get("set")[1]);
                !e && !t && !n ? this.$el.parent().find(".base-filter-status").removeClass("base-filter-status-enabled") : this.$el.parent().find(".base-filter-status").addClass("base-filter-status-enabled")
            },
            update: function() {
                var e = window.AppData.Base.data.get(this.model.get("set")[0]),
                    t = window.AppData.Base.data.get(this.model.get("set")[1]);
                this.status(), this.$el.find(".base-radio").removeClass("base-radio-checked"), this.$el.find(":radio[value=0]").attr("checked", !0).parent().addClass("base-radio-checked"), this.$el.find(".base-filter-input-id input:text").val(e), this.$el.find(".base-filter-input-text input:text").val(t)
            },
            submit: function() {
                var e = this.$el.find(":radio:checked").val();
                e == 1 ? $(".base-ad").show().each(function() {
                    $(this).hasClass("base-ad-selected") || $(this).hide()
                }) : e == 2 ? $(".base-ad").show().each(function() {
                    $(this).hasClass("base-ad-selected") && $(this).hide()
                }) : e == 0 && $(".base-ad").show(), this.status();
                var t = [this.$el.find(".base-filter-input-id input:text").val() || !1, this.$el.find(".base-filter-input-text input:text").val() || !1];
                this.setAppData(t), this.$el.hide()
            },
            order: function(e) {
                this.$el.find(":radio").parent().removeClass("base-radio-checked"), e = _.isObject(e) ? $(e.currentTarget).siblings(":radio").val() : e, this.$el.find(":radio[value=" + e + "]").attr("checked", !0).parent().addClass("base-radio-checked")
            },
            cancel: function(e) {
                this.$el.hide(), this.update()
            },
            inputOnKeyPress: function(e) {
                var t = e.keyCode || e.which;
                if ((t < 48 || t > 57) && t != 13 && t != 58 && t != 8) return !1;
                t == 13 && this.submit()
            },
            textInputOnKeyPress: function(e) {
                var t = e.keyCode || e.which;
                t == 13 && this.submit()
            },
            clear: function() {
                this.$el.find(".base-radio").removeClass("base-radio-checked"), this.$el.find(":radio").first().attr("checked", !0).parent().addClass("base-radio-checked"), this.$el.find("input:text").val("")
            },
            onShow: function() {
                this.model.get("alreadyRendered") || (this.render().update(), this.model.set("alreadyRendered", !0)), this.$el.find("input:text").first().focus()
            },
            template: function() {
                var e = window.AppData.Base.data,
                    n = this.model.toJSON(),
                    r = t.columns.getCurrent(e)[n.name],
                    i = '            <div class="base-filter-list base-filter-id" style="min-width:' + (r.width + 20) + 'px">                <div class="base-filter-list-title" style="width: ' + (r.width - 14) + 'px">                    <div class="b-i"></div>                </div>                <div class="base-filter-list-title-hider" style="width: ' + (r.width + 1) + 'px"></div>                <div class="base-filter-radio base-filter-show">                    <div class="base-radio base-radio-checked">                        <input type="radio" checked name="base-order-' + n.name + '" value="0">                        <div class="input"><div></div></div>                        <div class="title">Не сортировать</div>                    </div>                    <div class="base-radio">                        <input type="radio" name="base-order-' + n.name + '" value="1">                        <div class="input"><div></div></div>                        <div class="title">Только открытые</div>                    </div>                    <div class="base-radio">                        <input type="radio" name="base-order-' + n.name + '" value="2">                        <div class="input"><div></div></div>                        <div class="title">Только закрытые</div>                    </div>                </div>                <div class="base-filter-search base-filter-input-id">                    <div class="title">Поиск по ID номеру:</div>                    <input>                </div>                <div class="base-filter-search base-filter-input-text">                    <div class="title">Поиск по тексту:</div>                    <input>                </div>                <div class="base-filter-submit-container">                    <div class="base-filter-submit">ОК</div>                    <div class="base-filter-clear">Очистить фильтр</div>                </div>            </div>';
                return i
            }
        });
        return n
    }), define("Base/Filter/Views/Field/Region", ["Base/Config", "Base/Filter/Views/Abstract", "UI/Form/Views/Select"], function(e, t, n) {
        var r = t.extend({
            attributes: {
                "class": ""
            },
            containerId: "base-filter-region-select",
            template: function() {
                return '<div id="' + this.containerId + '"></div>'
            },
            render: function() {
                return this.$el.append(this.template()), this.select = (new n({
                    width: 180,
                    containerClass: "base-filter-region-container",
                    data: this.model.get("items"),
                    showDefaultItem: !1,
                    showDropDownButton: !1,
                    renderSelectedInDropdown: !0,
                    formatSelection: function(e) {
                        return '<span class="base-filter-region-selection">' + e.title + '</span><span class="b-i triangle"></span>'
                    }
                })).on("change", this.changeRegion), this.appendSubview(this.select, this.$el.find("#" + this.containerId)), this.showStatus(null, window.AppData.Base.data.get("region")), this
            },
            showStatus: function(e, t) {
                var n = _.find(this.model.get("items"), function(e) {
                    return e.id == t
                });
                this.select.Set([n], {
                    silent: !0
                })
            },
            changeRegion: function(t) {
                t = t[0] ? t[0].id : e.defaults.region, window.AppData.Base.data.reset().set({
                    region: t
                }).trigger("setAppData"), window.AppData.Base.events.trigger("RegionChanged")
            }
        });
        return r
    }), define("Base/Filter/Views/Field/Locality", ["Base/Config", "Base/Filter/Views/Abstract", "UI/Form/Views/Select"], function(e, t, n) {
        var r = t.extend({
            attributes: {
                "class": ""
            },
            containerId: "base-filter-locality-select",
            initialize: function() {
                _.bindAll(this), this.bindTo(this.model, "change:items", this.onItemsChange), this.appData = window.AppData.Base.data, window.AppData.Base.CityFilter = this
            },
            Get: function() {
                return this.select.GetOne()
            },
            template: function() {
                return '<div id="' + this.containerId + '"></div>'
            },
            onItemsChange: function() {
                this.render().update()
            },
            render: function() {
                return this.closeSubviews(), this.$el.empty().append(this.template()), this.select = (new n({
                    width: 180,
                    containerClass: "base-filter-locality-container",
                    data: this.model.get("items"),
                    showDefaultItem: !1,
                    showDropDownButton: !1,
                    renderSelectedInDropdown: !0,
                    formatResult: function(e) {
                        return e.type == "splitter" ? e.title : e.isAreaCenter || e.area ? "&nbsp;&nbsp;" + e.title : "&nbsp;&nbsp;<b>" + e.title + "</b>"
                    },
                    formatSelection: function(e) {
                        return '<span class="base-filter-locality-selection">' + e.title + '</span><span class="b-i triangle"></span>'
                    }
                })).on("change", this.changeCity), this.appendSubview(this.select, this.$el.find("#" + this.containerId)), this.showStatus(), this
            },
            showStatus: function() {
                this.select.SetByIds([parseInt(this.appData.get("locality"))])
            },
            changeCity: function(e) {
                if (!e || !e[0] || !e[0].id) return;
                var t = _.find(this.model.get("items"), function(t) {
                    return t.id === e[0].id
                });
                if (t.area || t.isAreaCenter) window.ContainerView.set990();
                else {
                    var n = window.AppData.Base.options;
                    n && n.get("data") && n.get("data").showAdminDistricts && window.ContainerView.set1120()
                }
                window.AppData.Base.data.reset().set({
                    region: t.region,
                    locality: t.id + (t.area || t.isAreaCenter ? "-" + (t.area || t.isAreaCenter) : "")
                }).trigger("setAppData"), window.AppData.Base.events.trigger("LocalityChanged")
            }
        });
        return r
    }), define("Base/Filter/Views/Field/Street", ["Base/Filter/Views/Abstract", "Base/Filter/Views/Select", "Base/Filter/Views/Range", "Base/Filter/Model", "Base/Config"], function(e, t, n, r, i) {
        var s = e.extend({
            events: {
                "click .base-filter-submit": "submit",
                "click .base-filter-list-title": "cancel",
                "click .base-filter-clear": "clear",
                "click .base-checkbox .title": "checkbox",
                "click .base-checkbox .input": "checkbox"
            },
            initialize: function() {
                _.bindAll(this), this.rangeModel = new r(_.find(i.filters, function(e) {
                    return e.name === "houseNumber"
                })), this.selectModel = new r(_.extend(this.model.toJSON(), {
                    renderWrapper: !1,
                    set: ["street"],
                    child: !0,
                    minWidth: 145
                })), this.appData = window.AppData.Base.data, this.select = new t({
                    model: this.selectModel
                }), this.range = new n({
                    model: this.rangeModel
                }), this.select.render(), this.range.render(), this.observeAppData(), this.bindDocumentEvents()
            },
            observeAppData: function() {
                _.each(_.union(this.rangeModel.get("set"), this.selectModel.get("set")), function(e) {
                    this.bindTo(window.AppData.Base.data, "change:" + e, this.update)
                }, this)
            },
            onShow: function() {
                this.model.get("alreadyRendered") || (this.render().update(), this.model.set("alreadyRendered", !0))
            },
            update: function() {
                this.select.update(), this.range.update(), this.updateCheckboxes(), this.status()
            },
            render: function() {
                return this.closeSubviews(), this.$el.append(this.template()), this.appendSubview(this.select, this.$el.find(".base-filter-street")), this.appendSubview(this.range, this.$el.find(".base-filter-house")), this
            },
            status: function() {
                this.select.status() || this.range.status() ? this.$el.parent().find(".base-filter-status").addClass("base-filter-status-enabled") : this.$el.parent().find(".base-filter-status").removeClass("base-filter-status-enabled")
            },
            checkbox: function(e) {
                var t = $(e.currentTarget).siblings(":checkbox");
                t.prop("checked", !t.prop("checked")).parent().toggleClass("base-checkbox-checked")
            },
            updateCheckboxes: function() {
                var e = this.model.get("set"),
                    t = [];
                for (var n in e) t.push(window.AppData.Base.data.get(e[n]) || 0);
                var r = this.$el.find(".empty:checkbox").prop("checked", !t[1]);
                r.parent()[t[1] ? "removeClass" : "addClass"]("base-checkbox-checked");
                var i = this.$el.find(".odd:checkbox").prop("checked", !!t[2]);
                i.parent()[t[2] ? "addClass" : "removeClass"]("base-checkbox-checked");
                var s = this.$el.find(".even:checkbox").prop("checked", !!t[3]);
                s.parent()[t[3] ? "addClass" : "removeClass"]("base-checkbox-checked")
            },
            submit: function() {
                var e = this.select.getValues();
                e.push(this.$el.find(".empty:checkbox").prop("checked") ? !1 : "1"), e.push(this.$el.find(".odd:checkbox").prop("checked") ? "1" : !1), e.push(this.$el.find(".even:checkbox").prop("checked") ? "1" : !1), this.setAppData(e, !0), this.range.submit({
                    silent: !0
                }), window.AppData.Base.data.trigger("setAppData"), this.$el.hide()
            },
            clear: function() {
                this.select.clear(), this.range.clear(), this.$el.find(".empty:checkbox").prop("checked", !0).parent().addClass("base-checkbox-checked"), this.$el.find(".odd:checkbox").prop("checked", !1).parent().removeClass("base-checkbox-checked"), this.$el.find(".even:checkbox").prop("checked", !1).parent().removeClass("base-checkbox-checked")
            },
            cancel: function() {
                this.$el.hide(), this.update()
            },
            template: function() {
                var e = i.columns.getCurrent(this.appData),
                    t = this.model.toJSON(),
                    n = '<div class="base-filter-list"  style="min-width: ' + (e[t.name].width + 1) + 'px">' + '<div class="base-filter-list-title" style="width: ' + (e[t.name].width - 15) + 'px">' + e[t.name].title + "</div>" + '<div class="base-filter-list-title-hider" style="width: ' + (e[t.name].width + 1) + 'px"></div>' + '<div class="base-filter-street"></div>' + '<div class="base-filter-house"></div>' + '<div class="base-filter-empty">                    <div class="base-checkbox base-checkbox-checked">                        <input class="odd" type="checkbox" checked value="1">                        <div class="input"><div></div></div><div class="title">Четные</div>                    </div>                    <div class="base-checkbox base-checkbox-checked">                        <input class="even" type="checkbox" checked value="1">                        <div class="input"><div></div></div><div class="title">Нечетные</div>                    </div>                    <div class="base-checkbox base-checkbox-checked">                        <input class="empty" type="checkbox" checked value="1">                        <div class="input"><div></div></div><div class="title">Показать пустые</div>                    </div>                </div>                <div class="base-filter-submit-container">' + '<div class="base-filter-submit">ОК</div>' + '<div class="base-filter-clear">Очистить фильтр</div>' + "</div>" + "</div>";
                return n
            }
        });
        return s
    }), define("Base/Filter/Views/Main", ["Shared/Abstract/View", "Base/Config", "Base/Filter/Collection", "Base/Filter/Views/List", "Base/Filter/Views/Select", "Base/Filter/Views/Range", "Base/Filter/Views/Field/MarketSegment", "Base/Filter/Views/Field/Operation", "Base/Filter/Views/Field/Type", "Base/Filter/Views/Field/Rooms", "Base/Filter/Views/Field/Phones", "Base/Filter/Views/Field/Date", "Base/Filter/Views/Field/Mark", "Base/Filter/Views/Field/Info", "Base/Filter/Views/Field/Id", "Base/Filter/Views/Field/Region", "Base/Filter/Views/Field/Locality", "Base/Filter/Views/Field/Street"], function(e, t, n, r, i, s, o, u, a, f, l, c, h, p, d, v, m, g) {
        var y = e.extend({
            attributes: {
                "class": "base-filters"
            },
            events: {
                "click .base-cell-text": "showFilter"
            },
            initialize: function() {
                _.bindAll(this), this.appData = window.AppData.Base.data, this.filtersCollection = new n, this.bindTo(this.filtersCollection, "reset", this.render), this.bindTo(window.AppData.Base.data, "change:region change:type change:marketSegment change:operation", this.filtersCollection.make), this.bindTo(window.AppData.Base.data, "change:region change:type change:marketSegment change:operation", window.AppData.Base.listings.make), this.bindTo(window.AppData.Base.events, "LocalityChanged", this.filtersCollection.make), this.bindTo(window.AppData.Base.events, "LocalityChanged", window.AppData.Base.listings.make), this.bindTo(window.EventManager, "ShowAdminDistricts", this.filtersCollection.make), this.bindTo(window.EventManager, "ShowAdminDistricts", window.AppData.Base.listings.make), this.bindTo(window.AppData.Base.data, "change:region change:type change:marketSegment", this.hideFilters), this.filtersCollection.make()
            },
            onClose: function() {
                this.filtersCollection.close()
            },
            template: function() {
                var e = t.columns.getCurrent(this.appData),
                    n = '<div class="base-filters-hider-left"></div><div class="base-filters-hider-top"></div>';
                for (var r in e) n += '<div id="base-filter-' + r + '" class="base-cell base-filter-container"' + 'style="width: ' + e[r].width + 'px;">' + '<div class="base-cell-text' + (r == "id" ? " b-i base-filters-last" : "") + '" data-field="' + r + '">' + e[r].title + "</div>" + '<div class="b-i base-filter-status"></div></div>';
                return n += '<div class="base-filters-hider-right"></div>', n
            },
            render: function() {
                return this.closeSubviews(), this.$el.empty().append(this.template()), this.filtersCollection.each(this.renderFilter), window.AppData.Base.events.trigger("FiltersRendered"), this
            },
            filterViews: {
                region: v,
                locality: m,
                type: a,
                marketSegment: o,
                operation: u,
                list: r,
                select: i,
                street: g,
                p1: f,
                range: s,
                phones: l,
                date: c,
                mark: h,
                info: p,
                id: d
            },
            renderFilter: function(e) {
                var t, n = this.filterViews[e.get("type")];
                n && (t = new n({
                    model: e
                }));
                if (!t) return;
                var r = this.$el.find("#base-filter-" + e.get("name")),
                    i = $("#base-filter-" + e.get("name"));
                this.appendSubview(t, r.length ? r : i), e.get("render") === !1 ? t.update() : t.render().update()
            },
            showFilter: function(e) {
                if ($("#base-loader").is(":visible")) return;
                $(e.target).siblings(".base-filter").show();
                var t = $(e.target).data("field");
                this.eachSubview(function(e) {
                    e.model.get("name") == t && "onShow" in e && e.onShow()
                })
            },
            hideFilters: function() {
                this.eachSubview(function(e) {
                    e.$el.parents("#base-filters-container").length && e.$el.css("display") == "block" && (e.$el.hide(), e.update())
                })
            }
        });
        return y
    }), define("Base/UserFilter/Views/Select", ["Shared/Abstract/View", "Base/UserFilter/Model", "UI/Form/Views/Select", "UI/Dialog/Views/Default"], function(e, t, n, r) {
        var i = e.extend({
            initialize: function() {
                _.bindAll(this), this.appData = window.AppData.Base.data, this.collection = this.options.collection, this.bindTo(this.collection, "reset add remove", this.updateSelect), this.bindTo(this.appData, "ResetAppData", this.resetSelect), this.bindTo(this.appData, "setAppData", this.changeActionButtonState), this.collection.fetch(), this.bindTo(window.EventManager, "FiltersWithCommentsUpdated", this.fetchCollection), this.render()
            },
            events: {
                "click #base-user-filters-action-button": "chooseAction",
                "click #base-user-filters-reset": "resetDialog",
                "click .ui-ms": "userFiltersHelp"
            },
            selectContainerId: "base-user-filters-select",
            select: null,
            template: function() {
                return '<div id="' + this.selectContainerId + '"></div>' + '<div class="base-user-filters-controls">' + '<a id="base-user-filters-action-button"><div class="b-i"></div><div>Сохранить фильтр</div></a>' + '<a id="base-user-filters-reset"><div class="b-i"></div><div>Сбросить фильтрацию</div></a>' + "</div>"
            },
            render: function() {
                return this.$el.append(this.template()), this.makeSelect(), this
            },
            makeSelect: function() {
                this.selectContainer = this.$el.find("#" + this.selectContainerId), this.select = (new n({
                    data: this.makeSelectData(this.collection.toJSON()),
                    showDeleteIcon: !0,
                    showDefaultItem: !1,
                    formatResult: this.formatSelectResult,
                    formatSelection: this.formatSelectSelection,
                    width: 186,
                    containerClass: "base-user-filters-select",
                    dropdownClass: "base-user-filters-dropdown"
                })).on("change", this.load).on("delete", this.removeDialog), this.appendSubview(this.select, this.selectContainer)
            },
            makeSelectData: function(e) {
                return _.map(e, function(e) {
                    return {
                        id: e._id,
                        title: e.title,
                        count: e.count
                    }
                })
            },
            formatSelectDefault: function() {
                var e = this.collection.reduce(function(e, t) {
                    return e + t.get("count")
                }, 0);
                return "Мои фильтры" + (e ? " <b>+" + e + "</b>" : "")
            },
            formatSelectResult: function(e) {
                return '<span class="b-i ui-ms-delete-item"></span>' + _.escape(e.title) + (e.count ? " <b>+" + e.count + "</b>" : "")
            },
            formatSelectSelection: function(e) {
                if (!e.id) return this.formatSelectDefault();
                var t = _.escape(e.title).replace(/\[b\](\+\d+)\[b\]/g, "<b>$1</b>");
                return t + (e.count ? " <b>+" + e.count + "</b>" : "")
            },
            destroySelect: function() {
                this.select.close()
            },
            fetchCollection: function() {
                this.collection.fetch()
            },
            updateSelect: function() {
                var e = this.select.Get();
                this.destroySelect(), this.makeSelect(), this.select.Set(e)
            },
            load: function() {
                var e = this.select.GetOne();
                if (e && _.isObject(e)) {
                    var t = this.collection.get(e.id);
                    t && (this.appData.clear({
                        silent: !0
                    }).set(t.get("data")).trigger("setAppData"), this.collection.selectedFilter = t, this.resetFilterCounter(t))
                } else this.reset()
            },
            resetFilterCounter: function(e) {
                if (e.get("count") == 0) return;
                e.resetCounter({
                    success: this.updateSelect
                })
            },
            chooseAction: function() {
                this.$el.find("#base-user-filters-action-button").find("div").last().text() == "Удалить фильтр" ? this.removeDialog() : this.saveMethodDialog()
            },
            removeDialog: function(e) {
                e = e || this.select.GetOne(), (new r({
                    content: 'Удалить фильтр "' + _.escape(e.title) + '"?',
                    controls: ["yes", "no"]
                })).on("yes", function() {
                    this.removeFilter(e)
                }, this)
            },
            saveMethodDialogTemplate: function() {
                var e = this.collection.selectedFilter.get("title");
                return '            <div class="f-white f-14 pbm">Сохранение фильтра</div>            <div class="base-radio base-radio-checked">                <input type="radio" checked value="update">                <div class="input"><div></div></div>                <div class="title">Сохранить изменения в фильтре "' + _.escape(e) + '"</div>            </div>            <div class="base-radio">                <input type="radio" value="saveNewFilterDialog">                <div class="input"><div></div></div>                <div class="title">Сохранить как новый фильтр</div>            </div>'
            },
            saveMethodDialog: function() {
                if (this.appData.isDefaults()) {
                    new r({
                        content: "Необходимо задать<br /> параметры фильтра"
                    });
                    return
                }
                var e = this.select.GetOne();
                if (e === null) return this.saveNewFilterDialog();
                var t = this.collection.get(e.id);
                (new r({
                    containerClass: "user-filter-save-method-dialog",
                    containerCss: {
                        width: 280,
                        textAlign: "left",
                        fontSize: 12
                    },
                    content: this.saveMethodDialogTemplate(),
                    controls: ["ok", "cancel"]
                })).on("click", this.saveMethodDialogOnClick).on("ok", function(e) {
                    this[e.$el.find(":checked").val()](t)
                }, this)
            },
            saveMethodDialogOnClick: function(e, t) {
                if (!t.hasClass("title") && !t.hasClass("input")) return;
                e.$el.find(":radio").attr("checked", !1).parent().removeClass("base-radio-checked"), t.siblings(":radio").attr("checked", !0).parent().addClass("base-radio-checked")
            },
            saveNewFilterDialog: function() {
                (new r({
                    content: 'Введите название фильтра: <input type="text" maxlength="35" class="base-input">',
                    controls: ["ok", "cancel"]
                })).on("ok", this.saveNewFilterDialogOnOk).on("show", function(e) {
                    e.$el.find("input").focus()
                })
            },
            saveNewFilterDialogOnOk: function(e) {
                var t = $.trim(e.$el.find("input").val());
                if (t) {
                    this.save(t);
                    return
                }(new r({
                    content: "Введите название фильтра!",
                    controls: ["ok"]
                })).on("ok", this.saveNewFilterDialog)
            },
            resetDialog: function() {
                if (this.appData.isDefaults()) {
                    new r({
                        content: "Ни один параметр не задан"
                    });
                    return
                }(new r({
                    content: "Сбросить фильтрацию?",
                    controls: ["yes", "no"]
                })).on("yes", this.reset)
            },
            changeActionButtonState: function() {
                var e = this.select.GetOne(),
                    t = "Сохранить фильтр",
                    n = "-90px 0px";
                if (e !== null) {
                    var r = this.appData.toJSON(),
                        i = this.collection.get(e.id).toJSON().data;
                    _.isEqual(r, i) ? (t = "Удалить фильтр", n = "-90px -35px") : t = "Сохранить изменения"
                }
                this.$el.find("#base-user-filters-action-button").find("div").last().text(t).prev().css("background-position", n)
            },
            resetSelect: function() {
                this.select.Set([], {
                    silent: !0
                }), this.collection.selectedFilter = null
            },
            reset: function() {
                this.appData.reset().trigger("setAppData"), this.collection.selectedFilter = null
            },
            removeFilter: function(e) {
                var t = this.select.GetOne(),
                    n = e && e.id ? e.id : null;
                if (!n) return;
                this.collection.get(n).destroy({
                    success: function() {
                        new r({
                            content: "Фильтр удален"
                        })
                    }
                }), t && t.id && t.id == n && this.reset()
            },
            save: function(e) {
                (new t({
                    title: e,
                    data: this.appData.toJSON()
                })).save({}, {
                    success: this.saveSuccessHandler,
                    error: this.syncErrorHandler
                })
            },
            update: function(e) {
                e.save({
                    data: this.appData.toJSON()
                }, {
                    success: this.updateSuccessHandler,
                    error: this.syncErrorHandler
                })
            },
            updateSuccessHandler: function() {
                this.changeActionButtonState(), new r({
                    content: "Изменения сохранены"
                })
            },
            saveSuccessHandler: function(e) {
                this.collection.add(e), this.select.Set(this.makeSelectData([e.toJSON()])), this.changeActionButtonState(), this.collection.selectedFilter = e, new r({
                    content: "Фильтр сохранен"
                })
            },
            syncErrorHandler: function(e, t) {
                var n = "Неизвестная ошибка. Пожалуйста, обновите страницу и повторите попытку ещё раз.";
                t === 2 && (n = "Введите название фильтра"), typeof t == "object" && t.status === 0 && t.statusText === "error" && (n = "Пожалуйста, проверьте подключение к сети Internet и повторите попытку ещё раз."), new r({
                    content: n
                })
            },
            userFiltersHelpTemplate: function() {
                return '<div class="f-14 f-white">У Вас пока нет сохранённых фильтров</div><br />            <div class="f-12">Если Вы желаете, чтобы База уведомляла Вас о каждом новом объявлении,             подходящем заданным параметрам фильтра, Вам необходимо сохранить фильтр. Для             этого задайте необходимые параметры и нажмите кнопку «Сохранить фильтр».<br /><br />            Сохранённые фильтры также позволяют экономить время. Вам не нужно постоянно задавать             одни и те же параметры для фильтрации, достаточно вызвать нужный фильтр из списка             сохранённых фильтров.<br /><br />            Выбирайте наиболее понятные названия для Ваших фильтров, например: «2-к для Ивана»,             «Однушки в моём районе», «Квартиры до 30 000 у.е.» и т.д.</div>'
            },
            userFiltersHelp: function() {
                return this.select.Count() > 0 ? !0 : (new r({
                    containerCss: {
                        width: 340,
                        textAlign: "left"
                    },
                    content: this.userFiltersHelpTemplate()
                }), !1)
            },
            onClose: function() {
                this.destroySelect(), this.collection.selectedFilter = null
            }
        });
        return i
    }), define("UI/Notify/Views/Default", ["Shared/Abstract/View"], function(e) {
        var t = e.extend({
            attributes: {
                "class": "ui-notify"
            },
            events: {
                "click .ui-close": "hide",
                "click .ui-button": "buttonOnClick",
                "click .ui-checkbox": "checkboxOnClick",
                click: "elOnClick"
            },
            defaults: {
                type: "alert",
                image: null,
                title: "Системное уведомление",
                content: "",
                contentCss: {},
                containerCss: {},
                onShow: function() {},
                button: "",
                checkbox: "",
                timeout: 0,
                audio: "notice"
            },
            initialize: function(e) {
                _.bindAll(this), this.params = _.extend({}, this.defaults, e), this.render(), Audio.Play(this.params.audio), this.params.timeout > 0 && setTimeout(this.hide, this.params.timeout * 1e3)
            },
            hide: function() {
                this.$el.fadeOut("fast", this.close)
            },
            template: function() {
                return '            <div class="ui-notify-background"></div>            <div class="ui-notify-title"><%= title %></div>            <div class="ui-notify-close ui-close"></div>            <div class="ui-notify-body">                <% if (image) { %>                <div class="ui-notify-icon"><img src="<%= image %>" /></div>                <% } else { %>                <div class="ui-notify-icon ui-notify-icon-<%= type %>">                <% } %>                </div>                <div class="ui-notify-info">                    <div class="ui-notify-text"><%= content %></div>                    <div class="ui-notify-controls">                    <% if (button) { %>                        <div class="ui-notify-button ui-button"><%= button %></div>                    <% } %>                    <% if (checkbox) { %>                        <div class="ui-checkbox"><div></div><%= checkbox %></div>                    <% } %>                    </div>                </div>            </div>'
            },
            render: function() {
                return this.$el.append(_.template(this.template(), this.params)), this.$el.appendTo("body"), this.setPosition(), this
            },
            setPosition: function() {
                this.$el.css({
                    bottom: 0 - this.$el.height() - 20,
                    visibility: "visible"
                }), $(".ui-notify").animate({
                    bottom: "+=" + (this.$el.height() + 40)
                }, 1e3, function() {
                    $(".ui-notify").each(function() {
                        $(this).offset().top < 0 && $(this).remove()
                    })
                })
            },
            elOnClick: function(e) {
                this.trigger("click", this, $(e.target))
            },
            buttonOnClick: function() {
                this.trigger("button", this)
            },
            checkboxOnClick: function(e) {
                this.trigger("checkbox", this, !$(e.currentTarget).hasClass("ui-checkbox-checked"))
            }
        });
        return t
    }), define("Base/Options/Model", ["Libs/Backbone/DeepModel"], function() {
        var e = Backbone.DeepModel.extend({
            url: "/api/base/options",
            idAttribute: "_id",
            initialize: function() {
                _.bindAll(this), window.AppData.Base.events.on("UserFilterAdd", this.onUserFilterAdd), window.AppData.Base.events.on("UserFilterRemove", this.onUserFilterRemove), this.on("change", function() {
                    window.EventManager.trigger("ShowAdminDistrict")
                }), this.fetch()
            },
            onUserFilterAdd: function(e) {
                _.isObject(this.get("data.notify.sound.filter")) || this.set({
                    "data.notify.sound.filter": {}
                }, {
                    silent: !0
                }), this.set("data.notify.sound.filter." + e._id, !0), _.isObject(this.get("data.notify.sms.filter")) || this.set({
                    "data.notify.sms.filter": {}
                }, {
                    silent: !0
                }), this.set("data.notify.sms.filter." + e._id, !0), this.save(), this.trigger("UserFilterAdd")
            },
            onUserFilterRemove: function(e) {
                this.unset("data.notify.sound.filter." + e), this.unset("data.notify.sms.filter." + e), this.save(), this.trigger("UserFilterRemove")
            }
        });
        return e
    }), define("Base/Options/Views/Main", ["Shared/Abstract/View", "Shared/EJS"], function(e, t) {
        var n = e.extend({
            templateFile: "base/options",
            events: {
                "click .db-options-first-level .ui-checkbox": "firstLevelClick",
                "click .db-options-second-level .ui-checkbox": "secondLevelClick",
                "click .db-show-admin-districts-column .ui-checkbox": "showAdminDistrictColumn"
            },
            initialize: function() {
                _.bindAll(this), this.bindTo(this.model, "UserFilterAdd UserFilterRemove", this.render), this.listenTo(window.AppData.Base.events, "LocalityChanged", this.render), this.render()
            },
            firstLevelClick: function(e) {
                _.stopPropagation(e);
                var t = $(e.target),
                    n = $(e.currentTarget);
                t.parents(".ui-checkbox").length == 0 || t.hasClass("b-i") ? (n.parent().next().toggle(), n.find("i").toggleClass("triangle-down")) : (n.toggleClass("ui-checkbox-checked"), n.parent().next().find(".ui-checkbox")[n.hasClass("ui-checkbox-checked") ? "addClass" : "removeClass"]("ui-checkbox-checked"), this.save())
            },
            secondLevelClick: function(e) {
                _.stopPropagation(e);
                var t = $(e.currentTarget);
                t.toggleClass("ui-checkbox-checked");
                var n = t.siblings(".ui-checkbox-checked").length || t.hasClass("ui-checkbox-checked");
                t.parent().prev().find(".ui-checkbox")[n ? "addClass" : "removeClass"]("ui-checkbox-checked"), this.save()
            },
            showAdminDistrictColumn: function(e) {
                _.stopPropagation(e);
                var t = $(e.currentTarget);
                t.toggleClass("ui-checkbox-checked"), this.save();
                if (window.AppData.Base.data.get("locality-area")) return;
                setTimeout(function() {
                    var e = $("#main-container"),
                        n = t.hasClass("ui-checkbox-checked");
                    e[n ? "removeClass" : "addClass"]("w990"), e[n ? "addClass" : "removeClass"]("w1120"), _.resizeWindow(), window.EventManager.trigger("ShowAdminDistricts")
                }, 1)
            },
            render: function() {
                t.render(this.templateFile, {
                    adminDistrictCheckbox: !window.AppData.Base.data.get("locality-area"),
                    filters: window.AppData.Base.userFilters.toJSON()
                }, this.append)
            },
            append: function(e) {
                this.$el.empty().append(e), this.check()
            },
            check: function() {
                var e = this.model.get("data.notify.sound.new");
                for (var t in e) {
                    _.compact(e[t]).length && this.$el.find("[data-value=notify-sound-new-" + t + "]").addClass("ui-checkbox-checked");
                    for (var n in e[t]) e[t][n] == 1 && this.$el.find("[data-value=notify-sound-new-" + t + "-" + n + "]").addClass("ui-checkbox-checked")
                }
                var r = this.model.get("data.notify.sound.filter");
                _.compact(r).length && this.$el.find("[data-value=notify-sound-filter]").addClass("ui-checkbox-checked");
                for (var t in r) r[t] == 1 && this.$el.find("[data-value=notify-sound-filter-" + t + "]").addClass("ui-checkbox-checked");
                var i = this.model.get("data.notify.sms.filter");
                (_.compact(i).length || !i) && this.$el.find("[data-value=notify-sms-filter]").addClass("ui-checkbox-checked");
                for (var t in i) i[t] == 1 && this.$el.find("[data-value=notify-sms-filter-" + t + "]").addClass("ui-checkbox-checked");
                this.model.get("data.showAdminDistricts") && this.$el.find(".db-show-admin-districts-column .ui-checkbox").addClass("ui-checkbox-checked")
            },
            save: function() {
                var e = this.$el.find(".db-options-second-level .ui-checkbox, .db-show-admin-districts-column .ui-checkbox");
                _.each(e, this.setModelValue), this.model.save()
            },
            setModelValue: function(e) {
                var t = $(e);
                this.model.set("data." + t.data("value").replace(/\-/g, "."), t.hasClass("ui-checkbox-checked"))
            }
        });
        return n
    }), define("Base/Options/Views/Button", ["Shared/Abstract/View", "Base/Options/Views/Main"], function(e, t) {
        var n = e.extend({
            optionsView: null,
            events: {
                "click .base-options-toggle": "toggleOptionsContainer"
            },
            initialize: function() {
                _.bindAll(this), this.render()
            },
            toggleOptionsContainer: function() {
                this.optionsView !== null ? (this.closeSubviews(), this.optionsView = null) : (this.optionsView = new t({
                    model: this.model
                }), this.appendSubview(this.optionsView, this.$el.find(".base-options-container"))), this.$el.find(".base-options-toggle").next().toggleClass("triangle-down")
            },
            template: function() {
                return '            <a class="base-options-toggle">Настройки</a><i class="b-i triangle"></i>            <div class="base-options-container">                            </div>'
            }
        });
        return n
    }), define("Base/Tools/Views/Export", ["Shared/Abstract/View", "Base/Config", "UI/Dialog/Views/Default"], function(e, t, n) {
        var r = e.extend({
            events: {
                "click .base-export-excel": "saveToExcel",
                "click .base-export-print": "saveForPrint"
            },
            initialize: function() {
                _.bindAll(this, "save"), this.appData = window.AppData.Base.data, this.bindTo(window.AppData.Base.events, "BaseAdsForExport", this.save), this.render()
            },
            template: function() {
                return '<a class="underline-on-hover base-export-print"><div class="b-i"></div>Печать</a>                    <a class="underline-on-hover base-export-excel"><div class="b-i"></div>Excel</a>'
            },
            saveDialogTemplate: function() {
                return '            <div class="f-white f-14 pbm">Загрузка файла</div>            <div class="pvm">Выберите желаемую версию файла:</div>            <div data-value="excel" class="ui-radio ui-radio-selected pvs f-white"><div></div>Версия для работы в Excel</div>            <div data-value="print" class="ui-radio pvs f-white"><div></div>Версия для печати</div>            <div class="f-11 ptm">Внимание! В Excel разрешается сохранять не более 200 строк таблицы.</div>'
            },
            saveToExcel: function() {
                window.AppData.Base.events.trigger("ExportAds", "excel")
            },
            saveForPrint: function() {
                window.AppData.Base.events.trigger("ExportAds", "print")
            },
            save: function(e, r) {
                var i = t.maxAdsCountForExport[r],
                    s = r,
                    o = t.columns.getCurrent(this.appData),
                    u = this;
                e.length > i ? (new n({
                    containerCss: {
                        width: 280,
                        textAlign: "left",
                        fontSize: 12
                    },
                    controlsCss: {
                        textAlign: "left",
                        paddingLeft: 13
                    },
                    content: '<div class="f-white f-14 pbm">Загрузка файла</div>                              Внимание! ' + (s == "excel" ? "В Excel " : "Для печати ") + "                              разрешается сохранять не более " + i + " строк таблицы.",
                    controls: [
                        ["next", "Продолжить"]
                    ]
                })).on("next", function(t) {
                    t.close(), u.makeForm(s, o, e)
                }) : this.makeForm(s, o, e)
            },
            makeForm: function(e, t, n) {
                var r = $('<form style="display: none;" target="_blank" action="/api/base/' + e + '" method="POST">' + '<input name="columns">' + '<input name="ads">' + "</form>").appendTo("body");
                r.find("[name=columns]").val($.toJSON(t)), r.find("[name=ads]").val($.toJSON(n)), r.submit(), r.remove()
            }
        });
        return r
    }),
    function() {
        var e = [
                function(e) {
                    return e % 10 === 1 && e % 100 !== 11
                },
                function(e) {
                    return e % 10 >= 2 && e % 10 <= 4 && e % 10 % 1 === 0 && (e % 100 < 12 || e % 100 > 14)
                },
                function(e) {
                    return e % 10 === 0 || e % 10 >= 5 && e % 10 <= 9 && e % 10 % 1 === 0 || e % 100 >= 11 && e % 100 <= 14 && e % 100 % 1 === 0
                },
                function(e) {
                    return !0
                }
            ],
            t = function(t, n) {
                var r = t.split("_"),
                    i = Math.min(e.length, r.length),
                    s = -1;
                while (++s < i)
                    if (e[s](n)) return r[s];
                return r[i - 1]
            },
            n = function(e, n, r) {
                var i = {
                    mm: "минута_минуты_минут_минуты",
                    hh: "час_часа_часов_часа",
                    dd: "день_дня_дней_дня",
                    MM: "месяц_месяца_месяцев_месяца",
                    yy: "год_года_лет_года"
                };
                return r === "m" ? n ? "минута" : "минуту" : e + " " + t(i[r], +e)
            },
            r = function(e, t) {
                var n = {
                        nominative: "январь_февраль_март_апрель_май_июнь_июль_август_сентябрь_октябрь_ноябрь_декабрь".split("_"),
                        accusative: "января_февраля_марта_апреля_мая_июня_июля_августа_сентября_октября_ноября_декабря".split("_")
                    },
                    r = /D[oD]? *MMMM?/.test(t) ? "accusative" : "nominative";
                return n[r][e.month()]
            },
            i = function(e, t) {
                var n = {
                        nominative: "воскресенье_понедельник_вторник_среда_четверг_пятница_суббота".split("_"),
                        accusative: "воскресенье_понедельник_вторник_среду_четверг_пятницу_субботу".split("_")
                    },
                    r = /\[ ?[Вв] ?(?:прошлую|следующую)? ?\] ?dddd/.test(t) ? "accusative" : "nominative";
                return n[r][e.day()]
            },
            s = {
                months: r,
                monthsShort: "янв_фев_мар_апр_май_июн_июл_авг_сен_окт_ноя_дек".split("_"),
                weekdays: i,
                weekdaysShort: "вск_пнд_втр_срд_чтв_птн_сбт".split("_"),
                weekdaysMin: "вс_пн_вт_ср_чт_пт_сб".split("_"),
                longDateFormat: {
                    LT: "HH:mm",
                    L: "DD.MM.YYYY",
                    LL: "D MMMM YYYY г.",
                    LLL: "D MMMM YYYY г., LT",
                    LLLL: "dddd, D MMMM YYYY г., LT"
                },
                calendar: {
                    sameDay: "[Сегодня в] LT",
                    nextDay: "[Завтра в] LT",
                    lastDay: "[Вчера в] LT",
                    nextWeek: function() {
                        return this.day() === 2 ? "[Во] dddd [в] LT" : "[В] dddd [в] LT"
                    },
                    lastWeek: function() {
                        switch (this.day()) {
                            case 0:
                                return "[В прошлое] dddd [в] LT";
                            case 1:
                            case 2:
                            case 4:
                                return "[В прошлый] dddd [в] LT";
                            case 3:
                            case 5:
                            case 6:
                                return "[В прошлую] dddd [в] LT"
                        }
                    },
                    sameElse: "L"
                },
                relativeTime: {
                    future: "через %s",
                    past: "%s назад",
                    s: "несколько секунд",
                    m: n,
                    mm: n,
                    h: "час",
                    hh: n,
                    d: "день",
                    dd: n,
                    M: "месяц",
                    MM: n,
                    y: "год",
                    yy: n
                },
                ordinal: function(e) {
                    return "."
                }
            };
        typeof module != "undefined" && module.exports && (module.exports = s), typeof window != "undefined" && this.moment && this.moment.lang && this.moment.lang("ru", s)
    }(), define("momentRu", ["momentRu/moment-ru"], function(e) {
        return e
    }), define("momentRu/moment-ru", function() {}), define("Base/MainView", ["backbone", "Shared/Abstract/View", "Base/Config", "Base/AppDataModel", "Base/Listing/Model", "Base/Counters/Model", "Base/UserFilter/Collection", "Base/Counters/Views/Main", "Base/Table/Views/Main", "Base/Filter/Views/Main", "Base/UserFilter/Views/Select", "UI/Notify/Views/Default", "UI/Tooltip/Views/Default", "UI/Form/Views/Select", "Base/Options/Model", "Base/Options/Views/Button", "Base/Tools/Views/Export", "moment", "momentRu"], function(e, t, n, r, i, s, o, u, a, f, l, c, h, p, d, v, m, g) {
        var y = t.extend({
            id: "base",
            initialize: function(t) {
                document.title = n.title, window.AppData.Base = {}, window.AppData.Base.events = _.extend({}, e.Events), window.AppData.Base.data = new r(t), window.AppData.Base.listings = new i, window.AppData.Base.counters = new s, window.AppData.Base.options = new d, window.AppData.Base.userFilters = new o, this.bindTo(window.AppData.Base.events, "BaseCountersIncremented", this.newBaseSound), this.bindTo(window.EventManager, "CurrentRegionChange", this.currentRegionChanged)
            },
            render: function() {
                return this.$el.append(_.template(this.template(), {
                    title: n.title,
                    expires: g(window.Services.base).format("DD.MM.YYYY")
                })), this.appendSubview(new a, this.$el.find("#base-ads-container")), this.appendSubview(new f, this.$el.find("#base-filters-container")), this.appendSubview(new l({
                    collection: window.AppData.Base.userFilters
                }), this.$el.find("#base-user-filters")), this.appendSubview(new u({
                    model: window.AppData.Base.counters
                })), this.appendSubview(new v({
                    model: window.AppData.Base.options
                }), this.$el.find("#base-options")), this.appendSubview(new m, this.$el.find("#base-export")), this.paymentNotify(), this
            },
            GetName: function() {
                return "base"
            },
            currentRegionChanged: function(e) {
                if (!e.length) return;
                var t = _.find(n.filters, function(e) {
                        return e.name == "region"
                    }),
                    r = _.find(t.items, function(t) {
                        return t.id == e[0].id
                    });
                r && window.Router.navigate(window.AppData.Base.data.generateDefaultUrl({
                    region: e[0].id
                }), !0)
            },
            newBaseSound: function(e, t) {
                var n = window.AppData.Base.options.get("data").notify.sound.new;
                for (var r in e)
                    for (var i in e[r]) {
                        var s = r.split("-"),
                            o = i.split(".");
                        if (window.AppData.Base.data.get("region") == s[0] && (window.AppData.Base.data.get("locality-city") == s[1] || window.AppData.Base.data.get("locality-area") == s[2])) {
                            if (e[r][i] == 0) continue;
                            if (n[o[1]][o[2]] === !0) {
                                window.EventManager.CheckNotify(t) && (window.EventManager.UnRegisterNotify(t), window.Audio.Play("base"));
                                return
                            }
                        }
                    }
            },
            newUserFiltersSound: function(e, t) {
                if (_.isEqual(t, e)) return;
                var n = window.AppData.Base.options.get("data").notify.sound.filter;
                for (var r in t)
                    if ((!n || n[r] === !0) && t[r] > e[r]) {
                        window.Audio.Play("base");
                        return
                    }
            },
            paymentNotify: function() {
                if (Math.abs(moment().diff(window.Services.base, "days")) > 5 || $.cookie("base-hide-pay-notify")) return;
                var e = moment(window.Services.base).fromNow();
                e = e.charAt(0).toUpperCase() + e.substr(1);
                var t = (new c({
                    content: e + " доступ к сервису «База» будет приостановлен до совершения Вами оплаты.",
                    button: "Оплатить",
                    checkbox: "Больше не показывать"
                })).on("button", function(e) {
                    window.ContainerView.BasePayButtonClick(), e.close()
                }).on("checkbox", function(e, t) {
                    t === !0 ? $.cookie("base-hide-pay-notify", !0, {
                        expires: 5
                    }) : $.removeCookie("base-hide-pay-notify")
                });
                this.appendSubview(t)
            },
            onClose: function() {
                window.AppData.Base.counters.saveSession(), window.AppData.Base.counters.stopListening(), window.AppData.Base.data.close(), window.AppData.Base.listings.close(), window.AppData.Base.userFilters.close(), window.AppData.Base = null
            },
            template: function() {
                return '            <div class="base-container">                <div id="base-title">                    <div><%= title %></div>                    <div id="base-paid">оплачена до <span><%= expires %></span></div>                </div>                <div id="base-filter-marketSegment"></div>                <div class="base-block-1">                    <div id="base-filter-locality"></div>                    <div id="base-filter-type"></div>                </div>                <div class="base-block-2">                    <div id="base-filter-operation"></div>                    <div id="base-options"></div>                    <div id="base-user-filters"></div>                    <div id="base-export"></div>                </div>                <div id="base-table">                    <div id="base-filters-container"></div>                    <div id="base-ads-container"></div>                    <div id="base-show-more"></div>                    <div id="base-loader"></div>                </div>            </div>'
            }
        });
        return y
    }),
    function(e) {
        if (typeof exports != "undefined") {
            var t = _.values(require(DIR_ENGINE + "/base/regionCenters"));
            module.exports = e(Backbone, _, t)
        } else define("Base/Exclusive/Model", ["Libs/Backbone/DeepModel", "underscore"], e)
    }(function(e, t, n) {
        n = n || t.pluck(REGIONS, "regionCenter");
        var r = e.DeepModel.extend({
            url: "/api/exclusive",
            initialize: function() {
                t.bindAll(this)
            },
            Groups: {
                1: {
                    1: {
                        "default": [
                            [1, !0], 2, [3, !0],
                            [4, !0],
                            [5, !0], 6, 7, 20
                        ],
                        3: [3, 4, [5, !0]]
                    },
                    2: [1, 2, 4, [5, !0], 8, 20],
                    3: [
                        [5, !0]
                    ],
                    4: [
                        [8, !0], 10
                    ],
                    5: {
                        "default": [
                            [5, !0], 10, 20
                        ],
                        31: [
                            [5, !0]
                        ]
                    }
                },
                2: {
                    1: {
                        "default": [
                            [1, !0], 2, [3, !0],
                            [4, !0],
                            [5, !0], 6, 7, 20
                        ],
                        3: [3, 4, [5, !0]]
                    },
                    2: [1, 2, 4, [5, !0], 8, 20],
                    3: [
                        [5, !0]
                    ],
                    4: [
                        [8, !0], 10
                    ],
                    5: {
                        "default": [
                            [5, !0], 10, 20
                        ],
                        31: [
                            [5, !0]
                        ]
                    }
                },
                3: {
                    1: {
                        "default": [
                            [1, !0], 2, [3, !0],
                            [4, !0],
                            [5, !0], 6, 7, 20
                        ],
                        3: [3, 4, [5, !0]]
                    },
                    2: [1, 2, 4, [5, !0], 8, 20],
                    3: [
                        [5, !0]
                    ],
                    4: [
                        [8, !0], 10
                    ],
                    5: {
                        "default": [
                            [5, !0], 10, 20
                        ],
                        31: [
                            [5, !0]
                        ]
                    }
                },
                4: {
                    1: [
                        [1, !0], 10
                    ],
                    2: [1, [5, !0], 10],
                    3: [
                        [5, !0], 10
                    ],
                    4: [
                        [8, !0], 10
                    ],
                    5: {
                        "default": [
                            [5, !0], 10
                        ],
                        31: [
                            [5, !0]
                        ]
                    }
                },
                5: {
                    1: [
                        [1, !0], 10
                    ],
                    2: [1, [5, !0], 10],
                    3: [
                        [5, !0], 10
                    ],
                    4: [
                        [8, !0], 10
                    ],
                    5: {
                        "default": [
                            [5, !0], 10
                        ],
                        31: [
                            [5, !0]
                        ]
                    }
                }
            },
            IsParamRequired: function(e) {
                return t.find(this.GetFields(), function(n) {
                    return t.isArray(n) && "params.p" + n[0] === e
                })
            },
            GetFields: function() {
                var e = t.pluck(this.get("main.estateType"), "id"),
                    n = t.pluck(this.get("main.estateType"), "marketSegment"),
                    r = t.pluck(this.get("main.operation"), "id"),
                    i = [];
                t.each(r, function(r) {
                    t.each(n, function(n) {
                        t.isArray(this.Groups[r][n]) ? i.push(this.Groups[r][n]) : t.isObject(this.Groups[r][n]) && t.each(e, function(e) {
                            t.isArray(this.Groups[r][n][e]) ? i.push(this.Groups[r][n][e]) : i.push(this.Groups[r][n]["default"])
                        }, this)
                    }, this)
                }, this);
                var s = t.sortBy(t.unique(t.flatten(i, !0)), function(e) {
                    return t.isArray(e) ? e[0] : e
                });
                for (var o in s) t.isArray(s[o]) && t.include(s, s[o][0]) && (s = t.without(s, s[o][0]));
                return s
            },
            validation: {
                "main.operation": {
                    required: !0,
                    msg: !0
                },
                "main.estateType": {
                    required: !0,
                    msg: !0
                },
                "terrain.region": {
                    required: !0,
                    msg: !0
                },
                "terrain.city": function(e, t, n) {
                    return !n.terrain.area && (!e || !e.length)
                },
                "terrain.cityArea": function(e, t, n) {
                    return !n.terrain.city && !n.terrain.area
                },
                "terrain.area": function(e, t, n) {
                    return !n.terrain.city && (!e || !e.length)
                },
                "terrain.town": function(e, t, n) {
                    return n.terrain.area && n.terrain.area.length > 0 && (!e || !e.length)
                },
                "terrain.district": function(e, r, i) {
                    var s = t.intersection(n, t.pluck(i.terrain.city, "id"));
                    return s.length && (!e || !e.length)
                },
                "terrain.street": function(e, r, i) {
                    var s = t.intersection(n, t.pluck(i.terrain.city, "id")),
                        o = t.intersection([1, 2, 3], t.pluck(i.main.operation, "id")).length;
                    return o && s.length && (!e || !e.length)
                },
                "params.p1": function(e, t) {
                    if (this.IsParamRequired(t) && !e.length) return !0
                },
                "params.p2": function(e, n, r) {
                    if (this.IsParamRequired(n) && !e.length) return !0;
                    var i = t.pluck(r.params.p1, "id");
                    if (e && e.length && i.length && t.max(i) < e[0].id) return "Изолированных комнат не может быть больше общего количества комнат в квартире."
                },
                "params.p3": function(e, t, n) {
                    if (this.IsParamRequired(t) && !e.length) return !0;
                    var r = parseInt(n.params.p3),
                        i = parseInt(n.params.p4);
                    if (r && i && r > i) return "Этаж не может быть больше этажности."
                },
                "params.p4": function(e, n) {
                    if (this.IsParamRequired(n) && !t.compact(e).length) return !0
                },
                "params.p5": function(e, n, r) {
                    if (this.IsParamRequired(n) && !t.compact(e).length) return !0;
                    if (t.isArray(r.params.p5)) {
                        var i = parseInt(r.params.p5[0]),
                            s = parseInt(r.params.p5[1]);
                        if (i && s && i > s) return "Минимальное значение параметра не может быть больше максимального."
                    }
                    var o = parseInt(r.params.p5),
                        u = parseInt(r.params.p6);
                    if (o && u && u > o) return "Общая площадь должна быть больше жилой."
                },
                "params.p6": function(e, t, n) {
                    if (this.IsParamRequired(t) && !e.length) return !0;
                    var r = parseInt(n.params.p6),
                        i = parseInt(n.params.p7);
                    if (r && i && i > r) return "Жилая площадь должна быть больше площади кухни."
                },
                "params.p7": function(e, t) {
                    if (this.IsParamRequired(t) && !e.length) return !0
                },
                "params.p8": function(e, n, r) {
                    if (this.IsParamRequired(n) && !t.compact(e).length) return !0;
                    if (t.isArray(r.params.p8)) {
                        var i = parseInt(r.params.p8[0]),
                            s = parseInt(r.params.p8[1]);
                        if (i && s && i > s) return "Минимальное значение параметра не может быть больше максимального."
                    }
                },
                "params.p10": function(e, t) {
                    if (this.IsParamRequired(t) && !e.length) return !0
                },
                "params.p20": function(e, t) {
                    if (this.IsParamRequired(t) && !e.length) return !0
                },
                "params.price": function(e, n, r) {
                    if (!e || e.toString().match(/\D+/g)) return !0;
                    var i = t.intersection([1, 4], t.pluck(r.main.operation, "id")).length,
                        s = i ? 1e3 : 0;
                    if (!e || parseInt(e) <= s) return "Цена слишком мала. Необходимо указать цену за весь объект."
                },
                "info.text": {
                    required: !0,
                    msg: !0
                }
            }
        });
        return r
    }), define("Base/Exclusive/Fields", [], function() {
        return {
            Get: function(e) {
                return {
                    1: {
                        name: "p1",
                        title: "Количество комнат:",
                        type: "select",
                        options: {
                            width: 100,
                            multiple: e.multiple,
                            showDefaultItem: !e.multiple,
                            renderSelectedInDropdown: !e.multiple,
                            data: [{
                                id: 1,
                                title: "1"
                            }, {
                                id: 2,
                                title: "2"
                            }, {
                                id: 3,
                                title: "3"
                            }, {
                                id: 4,
                                title: "4"
                            }, {
                                id: 5,
                                title: "5-к и более"
                            }]
                        }
                    },
                    2: {
                        name: "p2",
                        title: "Раздельных:",
                        type: "select",
                        options: {
                            width: 100,
                            data: [{
                                id: 1,
                                title: "1"
                            }, {
                                id: 2,
                                title: "2"
                            }, {
                                id: 3,
                                title: "3"
                            }, {
                                id: 4,
                                title: "4"
                            }, {
                                id: 5,
                                title: "5"
                            }]
                        }
                    },
                    3: {
                        name: "p3",
                        title: "Этаж:",
                        type: "input",
                        maxlength: 2,
                        width: 50,
                        options: {
                            "class": "input-number"
                        }
                    },
                    4: {
                        name: "p4",
                        title: "Этажность:",
                        type: "input",
                        maxlength: 2,
                        width: 50,
                        options: {
                            "class": "input-number"
                        }
                    },
                    5: {
                        name: "p5",
                        title: "Общая площадь:",
                        type: e.multiple ? "range" : "input",
                        maxlength: 5,
                        width: 50,
                        options: {
                            "class": "input-number"
                        }
                    },
                    6: {
                        name: "p6",
                        title: "Жилая площадь:",
                        type: "input",
                        maxlength: 2,
                        width: 50,
                        options: {
                            "class": "input-number"
                        }
                    },
                    7: {
                        name: "p7",
                        title: "Площадь кухни:",
                        type: "input",
                        maxlength: 2,
                        width: 50,
                        options: {
                            "class": "input-number"
                        }
                    },
                    8: {
                        name: "p8",
                        title: "Соток земли:",
                        type: e.multiple ? "range" : "input",
                        maxlength: 5,
                        width: 50,
                        options: {
                            "class": "input-number"
                        }
                    },
                    10: {
                        name: "p10",
                        title: "Дополнительно:",
                        type: "select",
                        options: {
                            width: 186,
                            data: _.filter(e.listings.Get("p10"), function(t) {
                                return !!_.intersection(e.marketSegment, t.marketSegment).length && (t.operation.length == 0 || _.include(t.operation, parseInt(e.operation)))
                            }),
                            renderSelectedInDropdown: !1,
                            showDefaultItem: !1,
                            multiple: !0
                        }
                    },
                    20: {
                        name: "p20",
                        title: "Материал:",
                        type: "select",
                        options: {
                            width: 186,
                            showDefaultItem: !e.multiple,
                            renderSelectedInDropdown: !e.multiple,
                            multiple: e.multiple,
                            data: e.listings.Get("p20")
                        }
                    }
                }
            }
        }
    }), define("Shared/Listing/Model", ["Shared/Abstract/Model"], function(e) {
        var t = e.extend({
            idAttribute: "name"
        });
        return t
    }), define("Shared/Listing/Collection", ["Shared/Abstract/Collection", "Shared/Listing/Model"], function(e, t) {
        var n = e.extend({
            url: "/api/listings",
            model: t,
            initialize: function() {
                _.bindAll(this, "Get")
            },
            Get: function(e) {
                var t = this.get(e);
                return t.get("items")
            },
            Fetch: function(e, t) {
                this.fetch({
                    data: {
                        listings: e
                    },
                    success: function(e, n) {
                        t(n)
                    }
                })
            }
        });
        return n
    }), define("Form/Field/Abstract", ["Shared/Abstract/View"], function(e) {
        var t = e.extend({
            attributes: {
                "class": "field"
            },
            initialize: function() {
                _.bindAll(this)
            },
            render: function() {
                return this.options.name ? (this.$el.attr("name", this.options.name).attr("type", this.options.type), this.$field = $(this.fieldTemplate()), this.$el.append(this.$field), this.$fieldTitle = this.$el.children().first(), this.$fieldElement = this.$el.children().last(), this.$fieldTitle.text(this.options.title), this.makeElement(), this.options.required === !0 && this.$fieldElement.append('<span class="required">*</span>'), this) : this
            },
            ShowTooltip: function() {},
            GetName: function() {
                return this.options.name
            },
            makeElement: function() {},
            GetValue: function() {},
            Invalid: function() {},
            Valid: function() {},
            fieldTemplate: function() {
                return '<div class="field-title"></div>                    <div class="field-element"></div>'
            }
        });
        return t
    }), define("Form/Field/Input", ["Form/Field/Abstract", "UI/Tooltip/Views/Default"], function(e, t) {
        var n = e.extend({
            makeElement: function() {
                this.$input = $('<input type="text" />'), this.options.maxlength && this.$input.attr("maxlength", this.options.maxlength), this.options.width && this.$input.width(this.options.width), this.options.options && this.options.options.class && this.$input.addClass(this.options.options.class), this.$fieldElement.append(this.$input), this.$fieldElement.append('<span class="field-unit">'), this.$input.on("input", this.Valid), this.$input.on("input focus", this.HideTooltip)
            },
            SetUnit: function(e) {
                this.$fieldElement.find(".field-unit").html(e ? "&nbsp;&nbsp;" + e : "")
            },
            onClose: function() {
                this.$input.unbind("input"), this.HideTooltip()
            },
            ShowTooltip: function(e) {
                return this.HideTooltip(), this.tooltip = new t({
                    text: e,
                    left: 3,
                    top: -5,
                    $el: this.$fieldElement.find("input")
                }), this.tooltip
            },
            HideTooltip: function() {
                return this.tooltip && this.tooltip.hide(), this
            },
            GetValue: function() {
                return this.$input.val()
            },
            Invalid: function() {
                this.$input.addClass("input-error")
            },
            Valid: function() {
                this.$input.removeClass("input-error")
            }
        });
        return n
    }), define("Form/Field/Range", ["Form/Field/Abstract", "UI/Tooltip/Views/Default"], function(e, t) {
        var n = e.extend({
            makeElement: function() {
                this.$inputs = $('<input type="text" /><span class="slash">—</span><input type="text" />'), this.options.maxlength && this.$inputs.filter("input").attr("maxlength", this.options.maxlength), this.options.width && this.$inputs.filter("input").width(this.options.width), this.options.options && this.options.options.class && this.$inputs.filter("input").addClass(this.options.options.class), this.$fieldElement.append(this.$inputs), this.$inputs.on("input", this.Valid), this.$inputs.on("input focus", this.HideTooltip)
            },
            GetValue: function() {
                return [this.$inputs.first().val(), this.$inputs.last().val()]
            },
            onClose: function() {
                this.$inputs.unbind("input"), this.HideTooltip()
            },
            ShowTooltip: function(e) {
                return this.HideTooltip(), this.tooltip = new t({
                    text: e,
                    left: 3,
                    top: -5,
                    $el: this.$inputs.last()
                }), this.tooltip
            },
            HideTooltip: function() {
                return this.tooltip && this.tooltip.hide(), this
            },
            Invalid: function() {
                this.$inputs.filter("input").addClass("input-error")
            },
            Valid: function() {
                this.$inputs.filter("input").removeClass("input-error")
            }
        });
        return n
    }), define("Form/Field/Select", ["Form/Field/Abstract", "UI/Form/Views/Select"], function(e, t) {
        var n = e.extend({
            makeElement: function() {
                this.select = new t(this.options.options), this.listenTo(this.select, "all", this.trigger), this.listenTo(this.select, "change", this.Valid), this.appendSubview(this.select, this.$fieldElement)
            },
            GetValue: function() {
                return this.select.Get()
            },
            Invalid: function() {
                this.$el.find(".ui-ms").addClass("input-error")
            },
            Valid: function() {
                this.$el.find(".ui-ms").removeClass("input-error")
            }
        });
        return n
    }), define("Form/Field/Textarea", ["Form/Field/Abstract", "Libs/jQuery/TextareaAutosize"], function(e) {
        var t = e.extend({
            makeElement: function() {
                this.$textarea = $("<textarea></textarea>"), this.$textarea.autosize(), this.options.width && this.$textarea.width(this.options.width), this.$fieldElement.append(this.$textarea), this.$textarea.on("input", this.Valid)
            },
            GetValue: function() {
                return this.$textarea.val()
            },
            onClose: function() {
                this.$textarea.unbind("input")
            },
            Invalid: function() {
                this.$textarea.addClass("input-error")
            },
            Valid: function() {
                this.$textarea.removeClass("input-error")
            }
        });
        return t
    }), define("Form/Group", ["Shared/Abstract/View", "Form/Field/Input", "Form/Field/Range", "Form/Field/Select", "Form/Field/Textarea"], function(e, t, n, r, i) {
        var s = e.extend({
            attributes: {
                "class": "group"
            },
            fieldTypes: {
                input: t,
                range: n,
                select: r,
                textarea: i
            },
            GetName: function() {
                return this.name
            },
            SetName: function(e) {
                return this.name = e, this.$el.attr("name", this.name), this
            },
            GetNamespace: function() {
                return this.namespace
            },
            SetNamespace: function(e) {
                return e && (this.namespace = e), this
            },
            _getValue: function() {
                var e = {};
                this.namespace && (e[this.namespace] = {});
                var t = this.namespace ? e[this.namespace] : e;
                return _.each(this.subviews, function(e) {
                    t[e.GetName()] = e.GetValue()
                }), e
            },
            GetValue: function() {
                return this._getValue()
            },
            Empty: function() {
                return this.closeSubviews(), this.$el.empty(), this
            },
            Remove: function() {
                this.close()
            },
            AddField: function(e) {
                var t = new this.fieldTypes[e.type](e);
                return this.appendSubview(t.render()), t
            },
            RemoveField: function(e) {
                var t = _.isArray(e) ? e : [e];
                _.each(this.subviews, function(e) {
                    _.include(t, e.GetName()) && e.close()
                }, this)
            },
            AddSpoiler: function() {
                this.$el.append(this.spoilerTemplate())
            },
            spoilerTemplate: function() {
                return '<div class="spoiler"></div>'
            }
        });
        return s
    }), define("Form/Component", ["Form/Group"], function(e) {
        var t = e.extend({
            attributes: {
                "class": "component"
            },
            AddGroup: function(e) {
                this.add(e)
            },
            RemoveGroup: function(e) {
                this.remove(e)
            },
            GetGroup: function(e) {
                return this.get(e)
            },
            EmptyGroup: function(e) {
                this.empty(e)
            },
            AddComponent: function(e) {
                this.add(e)
            },
            RemoveComponent: function(e) {
                this.remove(e)
            },
            EmptyComponent: function(e) {
                this.empty(e)
            },
            GetComponent: function(e) {
                return this.get(e)
            },
            _getValue: function() {
                var e = {};
                this.namespace && (e[this.namespace] = {});
                var t = this.namespace ? e[this.namespace] : e;
                return _.each(this.subviews, function(e) {
                    $.extend(!0, t, e.GetValue())
                }), e
            },
            GetValue: function() {
                return this._getValue()
            },
            GetField: function(e) {
                var t = null;
                return _.each(this.subviews, function(n) {
                    var r = n.GetNamespace() ? n.GetNamespace() + "." : "";
                    _.each(n.subviews, function(i) {
                        var s = n.GetNamespace() ? n.GetNamespace() + "." : "";
                        _.each(i.subviews, function(n) {
                            n.$el.hasClass("field") && s + n.GetName() === e && (t = n)
                        }, this), i.$el.hasClass("field") && r + i.GetName() === e && (t = i)
                    }, this)
                }, this), t
            },
            add: function(t) {
                t = _.isArray(t) ? t : [t], _.each(t, function(t) {
                    t.view || (t.view = e);
                    var n = _.isFunction(t.view) ? new t.view : t.view,
                        r = n.SetName(t.name).SetNamespace(t.namespace);
                    this.appendSubview(r)
                }, this)
            },
            remove: function(e) {
                e = _.isArray(e) ? e : [e], _.each(this.subviews, function(t) {
                    _.include(e, t.GetName()) && t.close()
                }, this)
            },
            get: function(e) {
                for (var t in this.subviews)
                    if (this.subviews[t].GetName() === e) return this.subviews[t];
                return null
            },
            empty: function(e) {
                e = _.isArray(e) ? e : [e], _.each(this.subviews, function(t) {
                    _.include(e, t.GetName()) && (t.closeSubviews(), t.$el.empty())
                }, this)
            }
        });
        return t
    }), define("Form/Components/Address", ["Form/Component", "Shared/Terrain/Model"], function(e, t) {
        var n = e.extend({
            defaults: {
                multiple: !1,
                required: {},
                render: {},
                availableRegions: null
            },
            initialize: function(e) {
                _.bindAll(this), this.$el.addClass("address-component"), this.options = _.extend(_.clone(this.defaults), e), this.terrain = new t
            },
            SetMultiple: function(e) {
                return this.options.multiple = e, this
            },
            SetRequired: function(e, t) {
                return this.options.required.street = t, this
            },
            SetRender: function(e, t) {
                return this.options.render.street = t, this
            },
            GetValue: function() {
                var e = this._getValue(),
                    t = this.namespace ? e[this.namespace] : e;
                return t.cityArea && (_.each(t.cityArea, function(e) {
                    _.isArray(t[e.type]) || (t[e.type] = []), t[e.type].push(e)
                }), delete t.cityArea), e
            },
            render: function() {
                return this.AddGroup([{
                    name: "terrain-1"
                }, {
                    name: "terrain-2"
                }, {
                    name: "terrain-3"
                }]), this.AddSpoiler(), this.addTerrainFirstFields(), this
            },
            getCurrentRegion: function() {
                var e = this.GetGroup("terrain-1").GetValue();
                if (e.region && _.isArray(e.region) && e.region.length) return e.region;
                var t = $.cookie("current-region");
                return t ? $.parseJSON(t) : []
            },
            addTerrainFirstFields: function() {
                var e = this.options.availableRegions,
                    t = e ? _.filter(REGIONS, function(t) {
                        return _.include(e, t.id)
                    }) : REGIONS;
                this.addRegionField({
                    regions: t
                }), this.EmptyGroup(["terrain-2", "terrain-3"])
            },
            addTerrainSecondFields: function(e) {
                this.EmptyGroup("terrain-3");
                if (e.length === 0) {
                    this.EmptyGroup("terrain-2");
                    return
                }
                this.terrain.Get([
                    ["cityAreas", _.pluck(e, "id")]
                ], this.addCityAreaField)
            },
            addTerrainThirdFields: function(e) {
                if (e.length === 0) {
                    this.EmptyGroup("terrain-3");
                    return
                }
                var t = this,
                    n = [],
                    r = [],
                    i = [],
                    s = [],
                    o = [];
                _.each(e, function(e) {
                    e.type == "area" && r.push(e.id), e.type == "city" && (i.push(e.id), s.push(e.id), o.push(e.id))
                }), r.length && n.push(["towns", r]), i.length && n.push(["adminDistricts", i]), s.length && n.push(["districts", s]), o.length && n.push(["streets", o]), this.terrain.Get(n, function(e) {
                    t.EmptyGroup("terrain-3"), e.towns && e.towns.length && t.addTownField(e), e.adminDistricts && e.adminDistricts.length && t.addAdminDistrictField(e), e.districts && e.districts.length && t.addDistrictField(e), t.options.render.street && e.streets && e.streets.length && t.addStreetField(e)
                })
            },
            addRegionField: function(e) {
                var t = this.getCurrentRegion(),
                    n = this.options.availableRegions,
                    r = n ? _.filter(REGIONS, function(e) {
                        return _.include(n, e.id)
                    }) : REGIONS,
                    i = _.intersection(_.pluck(r, "id"), _.pluck(t, "id")).length ? t : [];
                this.GetGroup("terrain-1").AddField({
                    name: "region",
                    title: "Регион:",
                    required: !0,
                    type: "select",
                    options: {
                        selected: i,
                        width: 186,
                        data: e.regions,
                        renderSelectedInDropdown: !this.options.multiple,
                        showDefaultItem: !this.options.multiple
                    }
                }).on("change", this.addTerrainSecondFields), i.length && this.addTerrainSecondFields(i)
            },
            addCityAreaField: function(e) {
                var t = this.getCurrentRegion(),
                    n = [];
                t.length && (n = _.filter(e.cityAreas, function(e) {
                    return e.id == t[0].regionCenter && e.type == "city"
                })), this.EmptyGroup("terrain-2"), this.GetGroup("terrain-2").AddField({
                    name: "cityArea",
                    title: "Город / Район обл.:",
                    required: !0,
                    type: "select",
                    options: {
                        selected: n,
                        data: _.sortBy(e.cityAreas, "title"),
                        width: 186,
                        renderSelectedInDropdown: !this.options.multiple,
                        showDefaultItem: !this.options.multiple
                    }
                }).on("change", this.addTerrainThirdFields), n.length && this.addTerrainThirdFields(n)
            },
            addTownField: function(e) {
                this.GetGroup("terrain-3").AddField({
                    name: "town",
                    title: "Нас. пункт:",
                    required: !0,
                    type: "select",
                    options: {
                        data: e.towns,
                        width: 186,
                        input: !0,
                        maxResultsCount: 10,
                        multiple: this.options.multiple,
                        renderSelectedInDropdown: !this.options.multiple,
                        showDefaultItem: !1,
                        showDropDownButton: !1
                    }
                })
            },
            addAdminDistrictField: function(e) {
                this.GetGroup("terrain-3").AddField({
                    name: "adminDistrict",
                    title: "Админрайон:",
                    required: !1,
                    type: "select",
                    options: {
                        data: e.adminDistricts,
                        width: 186,
                        multiple: this.options.multiple,
                        renderSelectedInDropdown: !this.options.multiple,
                        showDefaultItem: !this.options.multiple
                    }
                })
            },
            addDistrictField: function(e) {
                this.GetGroup("terrain-3").AddField({
                    name: "district",
                    title: "Микрорайон:",
                    required: !0,
                    type: "select",
                    options: {
                        data: e.districts,
                        width: 186,
                        multiple: this.options.multiple,
                        renderSelectedInDropdown: !this.options.multiple,
                        showDefaultItem: !this.options.multiple
                    }
                })
            },
            addStreetField: function(e) {
                this.GetGroup("terrain-3").AddField({
                    name: "street",
                    title: "Улица:",
                    required: this.options.required.street,
                    type: "select",
                    options: {
                        data: e.streets,
                        width: 186,
                        input: !0,
                        maxResultsCount: 10,
                        multiple: this.options.multiple,
                        renderSelectedInDropdown: !this.options.multiple,
                        showDefaultItem: !1,
                        showDropDownButton: !1
                    }
                })
            }
        });
        return n
    }),
    function(e) {
        typeof define == "function" && define.amd ? define("jquery.ui.widget/jquery.ui.widget", ["jquery"], e) : e(jQuery)
    }(function(e, t) {
        var n = 0,
            r = Array.prototype.slice,
            i = e.cleanData;
        e.cleanData = function(t) {
            for (var n = 0, r;
                (r = t[n]) != null; n++) try {
                e(r).triggerHandler("remove")
            } catch (s) {}
            i(t)
        }, e.widget = function(t, n, r) {
            var i, s, o, u, a = {},
                f = t.split(".")[0];
            t = t.split(".")[1], i = f + "-" + t, r || (r = n, n = e.Widget), e.expr[":"][i.toLowerCase()] = function(t) {
                return !!e.data(t, i)
            }, e[f] = e[f] || {}, s = e[f][t], o = e[f][t] = function(e, t) {
                if (!this._createWidget) return new o(e, t);
                arguments.length && this._createWidget(e, t)
            }, e.extend(o, s, {
                version: r.version,
                _proto: e.extend({}, r),
                _childConstructors: []
            }), u = new n, u.options = e.widget.extend({}, u.options), e.each(r, function(t, r) {
                if (!e.isFunction(r)) {
                    a[t] = r;
                    return
                }
                a[t] = function() {
                    var e = function() {
                            return n.prototype[t].apply(this, arguments)
                        },
                        i = function(e) {
                            return n.prototype[t].apply(this, e)
                        };
                    return function() {
                        var t = this._super,
                            n = this._superApply,
                            s;
                        return this._super = e, this._superApply = i, s = r.apply(this, arguments), this._super = t, this._superApply = n, s
                    }
                }()
            }), o.prototype = e.widget.extend(u, {
                widgetEventPrefix: s ? u.widgetEventPrefix || t : t
            }, a, {
                constructor: o,
                namespace: f,
                widgetName: t,
                widgetFullName: i
            }), s ? (e.each(s._childConstructors, function(t, n) {
                var r = n.prototype;
                e.widget(r.namespace + "." + r.widgetName, o, n._proto)
            }), delete s._childConstructors) : n._childConstructors.push(o), e.widget.bridge(t, o)
        }, e.widget.extend = function(n) {
            var i = r.call(arguments, 1),
                s = 0,
                o = i.length,
                u, a;
            for (; s < o; s++)
                for (u in i[s]) a = i[s][u], i[s].hasOwnProperty(u) && a !== t && (e.isPlainObject(a) ? n[u] = e.isPlainObject(n[u]) ? e.widget.extend({}, n[u], a) : e.widget.extend({}, a) : n[u] = a);
            return n
        }, e.widget.bridge = function(n, i) {
            var s = i.prototype.widgetFullName || n;
            e.fn[n] = function(o) {
                var u = typeof o == "string",
                    a = r.call(arguments, 1),
                    f = this;
                return o = !u && a.length ? e.widget.extend.apply(null, [o].concat(a)) : o, u ? this.each(function() {
                    var r, i = e.data(this, s);
                    if (!i) return e.error("cannot call methods on " + n + " prior to initialization; " + "attempted to call method '" + o + "'");
                    if (!e.isFunction(i[o]) || o.charAt(0) === "_") return e.error("no such method '" + o + "' for " + n + " widget instance");
                    r = i[o].apply(i, a);
                    if (r !== i && r !== t) return f = r && r.jquery ? f.pushStack(r.get()) : r, !1
                }) : this.each(function() {
                    var t = e.data(this, s);
                    t ? t.option(o || {})._init() : e.data(this, s, new i(o, this))
                }), f
            }
        }, e.Widget = function() {}, e.Widget._childConstructors = [], e.Widget.prototype = {
            widgetName: "widget",
            widgetEventPrefix: "",
            defaultElement: "<div>",
            options: {
                disabled: !1,
                create: null
            },
            _createWidget: function(t, r) {
                r = e(r || this.defaultElement || this)[0], this.element = e(r), this.uuid = n++, this.eventNamespace = "." + this.widgetName + this.uuid, this.options = e.widget.extend({}, this.options, this._getCreateOptions(), t), this.bindings = e(), this.hoverable = e(), this.focusable = e(), r !== this && (e.data(r, this.widgetFullName, this), this._on(!0, this.element, {
                    remove: function(e) {
                        e.target === r && this.destroy()
                    }
                }), this.document = e(r.style ? r.ownerDocument : r.document || r), this.window = e(this.document[0].defaultView || this.document[0].parentWindow)), this._create(), this._trigger("create", null, this._getCreateEventData()), this._init()
            },
            _getCreateOptions: e.noop,
            _getCreateEventData: e.noop,
            _create: e.noop,
            _init: e.noop,
            destroy: function() {
                this._destroy(), this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)), this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName + "-disabled " + "ui-state-disabled"), this.bindings.unbind(this.eventNamespace), this.hoverable.removeClass("ui-state-hover"), this.focusable.removeClass("ui-state-focus")
            },
            _destroy: e.noop,
            widget: function() {
                return this.element
            },
            option: function(n, r) {
                var i = n,
                    s, o, u;
                if (arguments.length === 0) return e.widget.extend({}, this.options);
                if (typeof n == "string") {
                    i = {}, s = n.split("."), n = s.shift();
                    if (s.length) {
                        o = i[n] = e.widget.extend({}, this.options[n]);
                        for (u = 0; u < s.length - 1; u++) o[s[u]] = o[s[u]] || {}, o = o[s[u]];
                        n = s.pop();
                        if (arguments.length === 1) return o[n] === t ? null : o[n];
                        o[n] = r
                    } else {
                        if (arguments.length === 1) return this.options[n] === t ? null : this.options[n];
                        i[n] = r
                    }
                }
                return this._setOptions(i), this
            },
            _setOptions: function(e) {
                var t;
                for (t in e) this._setOption(t, e[t]);
                return this
            },
            _setOption: function(e, t) {
                return this.options[e] = t, e === "disabled" && (this.widget().toggleClass(this.widgetFullName + "-disabled ui-state-disabled", !!t).attr("aria-disabled", t), this.hoverable.removeClass("ui-state-hover"), this.focusable.removeClass("ui-state-focus")), this
            },
            enable: function() {
                return this._setOption("disabled", !1)
            },
            disable: function() {
                return this._setOption("disabled", !0)
            },
            _on: function(t, n, r) {
                var i, s = this;
                typeof t != "boolean" && (r = n, n = t, t = !1), r ? (n = i = e(n), this.bindings = this.bindings.add(n)) : (r = n, n = this.element, i = this.widget()), e.each(r, function(r, o) {
                    function u() {
                        if (!t && (s.options.disabled === !0 || e(this).hasClass("ui-state-disabled"))) return;
                        return (typeof o == "string" ? s[o] : o).apply(s, arguments)
                    }
                    typeof o != "string" && (u.guid = o.guid = o.guid || u.guid || e.guid++);
                    var a = r.match(/^(\w+)\s*(.*)$/),
                        f = a[1] + s.eventNamespace,
                        l = a[2];
                    l ? i.delegate(l, f, u) : n.bind(f, u)
                })
            },
            _off: function(e, t) {
                t = (t || "").split(" ").join(this.eventNamespace + " ") + this.eventNamespace, e.unbind(t).undelegate(t)
            },
            _delay: function(e, t) {
                function n() {
                    return (typeof e == "string" ? r[e] : e).apply(r, arguments)
                }
                var r = this;
                return setTimeout(n, t || 0)
            },
            _hoverable: function(t) {
                this.hoverable = this.hoverable.add(t), this._on(t, {
                    mouseenter: function(t) {
                        e(t.currentTarget).addClass("ui-state-hover")
                    },
                    mouseleave: function(t) {
                        e(t.currentTarget).removeClass("ui-state-hover")
                    }
                })
            },
            _focusable: function(t) {
                this.focusable = this.focusable.add(t), this._on(t, {
                    focusin: function(t) {
                        e(t.currentTarget).addClass("ui-state-focus")
                    },
                    focusout: function(t) {
                        e(t.currentTarget).removeClass("ui-state-focus")
                    }
                })
            },
            _trigger: function(t, n, r) {
                var i, s, o = this.options[t];
                r = r || {}, n = e.Event(n), n.type = (t === this.widgetEventPrefix ? t : this.widgetEventPrefix + t).toLowerCase(), n.target = this.element[0], s = n.originalEvent;
                if (s)
                    for (i in s) i in n || (n[i] = s[i]);
                return this.element.trigger(n, r), !(e.isFunction(o) && o.apply(this.element[0], [n].concat(r)) === !1 || n.isDefaultPrevented())
            }
        }, e.each({
            show: "fadeIn",
            hide: "fadeOut"
        }, function(t, n) {
            e.Widget.prototype["_" + t] = function(r, i, s) {
                typeof i == "string" && (i = {
                    effect: i
                });
                var o, u = i ? i === !0 || typeof i == "number" ? n : i.effect || n : t;
                i = i || {}, typeof i == "number" && (i = {
                    duration: i
                }), o = !e.isEmptyObject(i), i.complete = s, i.delay && r.delay(i.delay), o && e.effects && e.effects.effect[u] ? r[t](i) : u !== t && r[u] ? r[u](i.duration, i.easing, s) : r.queue(function(n) {
                    e(this)[t](), s && s.call(r[0]), n()
                })
            }
        })
    }), define("jquery.ui.widget", ["jquery.ui.widget/jquery.ui.widget"], function(e) {
        return e
    }),
    function(e) {
        typeof define == "function" && define.amd ? define("jquery.fileupload/jquery.fileupload", ["jquery", "jquery.ui.widget"], e) : e(window.jQuery)
    }(function(e) {
        e.support.fileInput = !(new RegExp("(Android (1\\.[0156]|2\\.[01]))|(Windows Phone (OS 7|8\\.0))|(XBLWP)|(ZuneWP)|(WPDesktop)|(w(eb)?OSBrowser)|(webOS)|(Kindle/(1\\.0|2\\.[05]|3\\.0))")).test(window.navigator.userAgent) && !e('<input type="file">').prop("disabled"), e.support.xhrFileUpload = !!window.ProgressEvent && !!window.FileReader, e.support.xhrFormDataFileUpload = !!window.FormData, e.support.blobSlice = window.Blob && (Blob.prototype.slice || Blob.prototype.webkitSlice || Blob.prototype.mozSlice), e.widget("blueimp.fileupload", {
            options: {
                dropZone: e(document),
                pasteZone: e(document),
                fileInput: undefined,
                replaceFileInput: !0,
                paramName: undefined,
                singleFileUploads: !0,
                limitMultiFileUploads: undefined,
                limitMultiFileUploadSize: undefined,
                limitMultiFileUploadSizeOverhead: 512,
                sequentialUploads: !1,
                limitConcurrentUploads: undefined,
                forceIframeTransport: !1,
                redirect: undefined,
                redirectParamName: undefined,
                postMessage: undefined,
                multipart: !0,
                maxChunkSize: undefined,
                uploadedBytes: undefined,
                recalculateProgress: !0,
                progressInterval: 100,
                bitrateInterval: 500,
                autoUpload: !0,
                messages: {
                    uploadedBytes: "Uploaded bytes exceed file size"
                },
                i18n: function(t, n) {
                    return t = this.messages[t] || t.toString(), n && e.each(n, function(e, n) {
                        t = t.replace("{" + e + "}", n)
                    }), t
                },
                formData: function(e) {
                    return e.serializeArray()
                },
                add: function(t, n) {
                    if (t.isDefaultPrevented()) return !1;
                    (n.autoUpload || n.autoUpload !== !1 && e(this).fileupload("option", "autoUpload")) && n.process().done(function() {
                        n.submit()
                    })
                },
                processData: !1,
                contentType: !1,
                cache: !1
            },
            _specialOptions: ["fileInput", "dropZone", "pasteZone", "multipart", "forceIframeTransport"],
            _blobSlice: e.support.blobSlice && function() {
                var e = this.slice || this.webkitSlice || this.mozSlice;
                return e.apply(this, arguments)
            },
            _BitrateTimer: function() {
                this.timestamp = Date.now ? Date.now() : (new Date).getTime(), this.loaded = 0, this.bitrate = 0, this.getBitrate = function(e, t, n) {
                    var r = e - this.timestamp;
                    if (!this.bitrate || !n || r > n) this.bitrate = (t - this.loaded) * (1e3 / r) * 8, this.loaded = t, this.timestamp = e;
                    return this.bitrate
                }
            },
            _isXHRUpload: function(t) {
                return !t.forceIframeTransport && (!t.multipart && e.support.xhrFileUpload || e.support.xhrFormDataFileUpload)
            },
            _getFormData: function(t) {
                var n;
                return e.type(t.formData) === "function" ? t.formData(t.form) : e.isArray(t.formData) ? t.formData : e.type(t.formData) === "object" ? (n = [], e.each(t.formData, function(e, t) {
                    n.push({
                        name: e,
                        value: t
                    })
                }), n) : []
            },
            _getTotal: function(t) {
                var n = 0;
                return e.each(t, function(e, t) {
                    n += t.size || 1
                }), n
            },
            _initProgressObject: function(t) {
                var n = {
                    loaded: 0,
                    total: 0,
                    bitrate: 0
                };
                t._progress ? e.extend(t._progress, n) : t._progress = n
            },
            _initResponseObject: function(e) {
                var t;
                if (e._response)
                    for (t in e._response) e._response.hasOwnProperty(t) && delete e._response[t];
                else e._response = {}
            },
            _onProgress: function(t, n) {
                if (t.lengthComputable) {
                    var r = Date.now ? Date.now() : (new Date).getTime(),
                        i;
                    if (n._time && n.progressInterval && r - n._time < n.progressInterval && t.loaded !== t.total) return;
                    n._time = r, i = Math.floor(t.loaded / t.total * (n.chunkSize || n._progress.total)) + (n.uploadedBytes || 0), this._progress.loaded += i - n._progress.loaded, this._progress.bitrate = this._bitrateTimer.getBitrate(r, this._progress.loaded, n.bitrateInterval), n._progress.loaded = n.loaded = i, n._progress.bitrate = n.bitrate = n._bitrateTimer.getBitrate(r, i, n.bitrateInterval), this._trigger("progress", e.Event("progress", {
                        delegatedEvent: t
                    }), n), this._trigger("progressall", e.Event("progressall", {
                        delegatedEvent: t
                    }), this._progress)
                }
            },
            _initProgressListener: function(t) {
                var n = this,
                    r = t.xhr ? t.xhr() : e.ajaxSettings.xhr();
                r.upload && (e(r.upload).bind("progress", function(e) {
                    var r = e.originalEvent;
                    e.lengthComputable = r.lengthComputable, e.loaded = r.loaded, e.total = r.total, n._onProgress(e, t)
                }), t.xhr = function() {
                    return r
                })
            },
            _isInstanceOf: function(e, t) {
                return Object.prototype.toString.call(t) === "[object " + e + "]"
            },
            _initXHRData: function(t) {
                var n = this,
                    r, i = t.files[0],
                    s = t.multipart || !e.support.xhrFileUpload,
                    o = e.type(t.paramName) === "array" ? t.paramName[0] : t.paramName;
                t.headers = e.extend({}, t.headers), t.contentRange && (t.headers["Content-Range"] = t.contentRange);
                if (!s || t.blob || !this._isInstanceOf("File", i)) t.headers["Content-Disposition"] = 'attachment; filename="' + encodeURI(i.name) + '"';
                s ? e.support.xhrFormDataFileUpload && (t.postMessage ? (r = this._getFormData(t), t.blob ? r.push({
                    name: o,
                    value: t.blob
                }) : e.each(t.files, function(n, i) {
                    r.push({
                        name: e.type(t.paramName) === "array" && t.paramName[n] || o,
                        value: i
                    })
                })) : (n._isInstanceOf("FormData", t.formData) ? r = t.formData : (r = new FormData, e.each(this._getFormData(t), function(e, t) {
                    r.append(t.name, t.value)
                })), t.blob ? r.append(o, t.blob, i.name) : e.each(t.files, function(i, s) {
                    (n._isInstanceOf("File", s) || n._isInstanceOf("Blob", s)) && r.append(e.type(t.paramName) === "array" && t.paramName[i] || o, s, s.uploadName || s.name)
                })), t.data = r) : (t.contentType = i.type || "application/octet-stream", t.data = t.blob || i), t.blob = null
            },
            _initIframeSettings: function(t) {
                var n = e("<a></a>").prop("href", t.url).prop("host");
                t.dataType = "iframe " + (t.dataType || ""), t.formData = this._getFormData(t), t.redirect && n && n !== location.host && t.formData.push({
                    name: t.redirectParamName || "redirect",
                    value: t.redirect
                })
            },
            _initDataSettings: function(e) {
                this._isXHRUpload(e) ? (this._chunkedUpload(e, !0) || (e.data || this._initXHRData(e), this._initProgressListener(e)), e.postMessage && (e.dataType = "postmessage " + (e.dataType || ""))) : this._initIframeSettings(e)
            },
            _getParamName: function(t) {
                var n = e(t.fileInput),
                    r = t.paramName;
                return r ? e.isArray(r) || (r = [r]) : (r = [], n.each(function() {
                    var t = e(this),
                        n = t.prop("name") || "files[]",
                        i = (t.prop("files") || [1]).length;
                    while (i) r.push(n), i -= 1
                }), r.length || (r = [n.prop("name") || "files[]"])), r
            },
            _initFormSettings: function(t) {
                if (!t.form || !t.form.length) t.form = e(t.fileInput.prop("form")), t.form.length || (t.form = e(this.options.fileInput.prop("form")));
                t.paramName = this._getParamName(t), t.url || (t.url = t.form.prop("action") || location.href), t.type = (t.type || e.type(t.form.prop("method")) === "string" && t.form.prop("method") || "").toUpperCase(), t.type !== "POST" && t.type !== "PUT" && t.type !== "PATCH" && (t.type = "POST"), t.formAcceptCharset || (t.formAcceptCharset = t.form.attr("accept-charset"))
            },
            _getAJAXSettings: function(t) {
                var n = e.extend({}, this.options, t);
                return this._initFormSettings(n), this._initDataSettings(n), n
            },
            _getDeferredState: function(e) {
                return e.state ? e.state() : e.isResolved() ? "resolved" : e.isRejected() ? "rejected" : "pending"
            },
            _enhancePromise: function(e) {
                return e.success = e.done, e.error = e.fail, e.complete = e.always, e
            },
            _getXHRPromise: function(t, n, r) {
                var i = e.Deferred(),
                    s = i.promise();
                return n = n || this.options.context || s, t === !0 ? i.resolveWith(n, r) : t === !1 && i.rejectWith(n, r), s.abort = i.promise, this._enhancePromise(s)
            },
            _addConvenienceMethods: function(t, n) {
                var r = this,
                    i = function(t) {
                        return e.Deferred().resolveWith(r, t).promise()
                    };
                n.process = function(t, s) {
                    if (t || s) n._processQueue = this._processQueue = (this._processQueue || i([this])).pipe(function() {
                        return n.errorThrown ? e.Deferred().rejectWith(r, [n]).promise() : i(arguments)
                    }).pipe(t, s);
                    return this._processQueue || i([this])
                }, n.submit = function() {
                    return this.state() !== "pending" && (n.jqXHR = this.jqXHR = r._trigger("submit", e.Event("submit", {
                        delegatedEvent: t
                    }), this) !== !1 && r._onSend(t, this)), this.jqXHR || r._getXHRPromise()
                }, n.abort = function() {
                    return this.jqXHR ? this.jqXHR.abort() : (this.errorThrown = "abort", r._trigger("fail", null, this), r._getXHRPromise(!1))
                }, n.state = function() {
                    if (this.jqXHR) return r._getDeferredState(this.jqXHR);
                    if (this._processQueue) return r._getDeferredState(this._processQueue)
                }, n.processing = function() {
                    return !this.jqXHR && this._processQueue && r._getDeferredState(this._processQueue) === "pending"
                }, n.progress = function() {
                    return this._progress
                }, n.response = function() {
                    return this._response
                }
            },
            _getUploadedBytes: function(e) {
                var t = e.getResponseHeader("Range"),
                    n = t && t.split("-"),
                    r = n && n.length > 1 && parseInt(n[1], 10);
                return r && r + 1
            },
            _chunkedUpload: function(t, n) {
                t.uploadedBytes = t.uploadedBytes || 0;
                var r = this,
                    i = t.files[0],
                    s = i.size,
                    o = t.uploadedBytes,
                    u = t.maxChunkSize || s,
                    a = this._blobSlice,
                    f = e.Deferred(),
                    l = f.promise(),
                    c, h;
                return !(this._isXHRUpload(t) && a && (o || u < s)) || t.data ? !1 : n ? !0 : o >= s ? (i.error = t.i18n("uploadedBytes"), this._getXHRPromise(!1, t.context, [null, "error", i.error])) : (h = function() {
                    var n = e.extend({}, t),
                        l = n._progress.loaded;
                    n.blob = a.call(i, o, o + u, i.type), n.chunkSize = n.blob.size, n.contentRange = "bytes " + o + "-" + (o + n.chunkSize - 1) + "/" + s, r._initXHRData(n), r._initProgressListener(n), c = (r._trigger("chunksend", null, n) !== !1 && e.ajax(n) || r._getXHRPromise(!1, n.context)).done(function(i, u, a) {
                        o = r._getUploadedBytes(a) || o + n.chunkSize, l + n.chunkSize - n._progress.loaded && r._onProgress(e.Event("progress", {
                            lengthComputable: !0,
                            loaded: o - n.uploadedBytes,
                            total: o - n.uploadedBytes
                        }), n), t.uploadedBytes = n.uploadedBytes = o, n.result = i, n.textStatus = u, n.jqXHR = a, r._trigger("chunkdone", null, n), r._trigger("chunkalways", null, n), o < s ? h() : f.resolveWith(n.context, [i, u, a])
                    }).fail(function(e, t, i) {
                        n.jqXHR = e, n.textStatus = t, n.errorThrown = i, r._trigger("chunkfail", null, n), r._trigger("chunkalways", null, n), f.rejectWith(n.context, [e, t, i])
                    })
                }, this._enhancePromise(l), l.abort = function() {
                    return c.abort()
                }, h(), l)
            },
            _beforeSend: function(e, t) {
                this._active === 0 && (this._trigger("start"), this._bitrateTimer = new this._BitrateTimer, this._progress.loaded = this._progress.total = 0, this._progress.bitrate = 0), this._initResponseObject(t), this._initProgressObject(t), t._progress.loaded = t.loaded = t.uploadedBytes || 0, t._progress.total = t.total = this._getTotal(t.files) || 1, t._progress.bitrate = t.bitrate = 0, this._active += 1, this._progress.loaded += t.loaded, this._progress.total += t.total
            },
            _onDone: function(t, n, r, i) {
                var s = i._progress.total,
                    o = i._response;
                i._progress.loaded < s && this._onProgress(e.Event("progress", {
                    lengthComputable: !0,
                    loaded: s,
                    total: s
                }), i), o.result = i.result = t, o.textStatus = i.textStatus = n, o.jqXHR = i.jqXHR = r, this._trigger("done", null, i)
            },
            _onFail: function(e, t, n, r) {
                var i = r._response;
                r.recalculateProgress && (this._progress.loaded -= r._progress.loaded, this._progress.total -= r._progress.total), i.jqXHR = r.jqXHR = e, i.textStatus = r.textStatus = t, i.errorThrown = r.errorThrown = n, this._trigger("fail", null, r)
            },
            _onAlways: function(e, t, n, r) {
                this._trigger("always", null, r)
            },
            _onSend: function(t, n) {
                n.submit || this._addConvenienceMethods(t, n);
                var r = this,
                    i, s, o, u, a = r._getAJAXSettings(n),
                    f = function() {
                        return r._sending += 1, a._bitrateTimer = new r._BitrateTimer, i = i || ((s || r._trigger("send", e.Event("send", {
                            delegatedEvent: t
                        }), a) === !1) && r._getXHRPromise(!1, a.context, s) || r._chunkedUpload(a) || e.ajax(a)).done(function(e, t, n) {
                            r._onDone(e, t, n, a)
                        }).fail(function(e, t, n) {
                            r._onFail(e, t, n, a)
                        }).always(function(e, t, n) {
                            r._onAlways(e, t, n, a), r._sending -= 1, r._active -= 1;
                            if (a.limitConcurrentUploads && a.limitConcurrentUploads > r._sending) {
                                var i = r._slots.shift();
                                while (i) {
                                    if (r._getDeferredState(i) === "pending") {
                                        i.resolve();
                                        break
                                    }
                                    i = r._slots.shift()
                                }
                            }
                            r._active === 0 && r._trigger("stop")
                        }), i
                    };
                return this._beforeSend(t, a), this.options.sequentialUploads || this.options.limitConcurrentUploads && this.options.limitConcurrentUploads <= this._sending ? (this.options.limitConcurrentUploads > 1 ? (o = e.Deferred(), this._slots.push(o), u = o.pipe(f)) : (this._sequence = this._sequence.pipe(f, f), u = this._sequence), u.abort = function() {
                    return s = [undefined, "abort", "abort"], i ? i.abort() : (o && o.rejectWith(a.context, s), f())
                }, this._enhancePromise(u)) : f()
            },
            _onAdd: function(t, n) {
                var r = this,
                    i = !0,
                    s = e.extend({}, this.options, n),
                    o = n.files,
                    u = o.length,
                    a = s.limitMultiFileUploads,
                    f = s.limitMultiFileUploadSize,
                    l = s.limitMultiFileUploadSizeOverhead,
                    c = 0,
                    h = this._getParamName(s),
                    p, d, v, m, g = 0;
                f && (!u || o[0].size === undefined) && (f = undefined);
                if (!(s.singleFileUploads || a || f) || !this._isXHRUpload(s)) v = [o], p = [h];
                else if (!s.singleFileUploads && !f && a) {
                    v = [], p = [];
                    for (m = 0; m < u; m += a) v.push(o.slice(m, m + a)), d = h.slice(m, m + a), d.length || (d = h), p.push(d)
                } else if (!s.singleFileUploads && f) {
                    v = [], p = [];
                    for (m = 0; m < u; m += 1) {
                        c += o[m].size + l;
                        if (m + 1 === u || c + o[m + 1].size + l > f || a && m + 1 - g >= a) v.push(o.slice(g, m + 1)), d = h.slice(g, m + 1), d.length || (d = h), p.push(d), g = m + 1, c = 0
                    }
                } else p = h;
                return n.originalFiles = o, e.each(v || o, function(s, o) {
                    var u = e.extend({}, n);
                    return u.files = v ? o : [o], u.paramName = p[s], r._initResponseObject(u), r._initProgressObject(u), r._addConvenienceMethods(t, u), i = r._trigger("add", e.Event("add", {
                        delegatedEvent: t
                    }), u), i
                }), i
            },
            _replaceFileInput: function(t) {
                var n = t.clone(!0);
                e("<form></form>").append(n)[0].reset(), t.after(n).detach(), e.cleanData(t.unbind("remove")), this.options.fileInput = this.options.fileInput.map(function(e, r) {
                    return r === t[0] ? n[0] : r
                }), t[0] === this.element[0] && (this.element = n)
            },
            _handleFileTreeEntry: function(t, n) {
                var r = this,
                    i = e.Deferred(),
                    s = function(e) {
                        e && !e.entry && (e.entry = t), i.resolve([e])
                    },
                    o;
                return n = n || "", t.isFile ? t._file ? (t._file.relativePath = n, i.resolve(t._file)) : t.file(function(e) {
                    e.relativePath = n, i.resolve(e)
                }, s) : t.isDirectory ? (o = t.createReader(), o.readEntries(function(e) {
                    r._handleFileTreeEntries(e, n + t.name + "/").done(function(e) {
                        i.resolve(e)
                    }).fail(s)
                }, s)) : i.resolve([]), i.promise()
            },
            _handleFileTreeEntries: function(t, n) {
                var r = this;
                return e.when.apply(e, e.map(t, function(e) {
                    return r._handleFileTreeEntry(e, n)
                })).pipe(function() {
                    return Array.prototype.concat.apply([], arguments)
                })
            },
            _getDroppedFiles: function(t) {
                t = t || {};
                var n = t.items;
                return n && n.length && (n[0].webkitGetAsEntry || n[0].getAsEntry) ? this._handleFileTreeEntries(e.map(n, function(e) {
                    var t;
                    return e.webkitGetAsEntry ? (t = e.webkitGetAsEntry(), t && (t._file = e.getAsFile()), t) : e.getAsEntry()
                })) : e.Deferred().resolve(e.makeArray(t.files)).promise()
            },
            _getSingleFileInputFiles: function(t) {
                t = e(t);
                var n = t.prop("webkitEntries") || t.prop("entries"),
                    r, i;
                if (n && n.length) return this._handleFileTreeEntries(n);
                r = e.makeArray(t.prop("files"));
                if (!r.length) {
                    i = t.prop("value");
                    if (!i) return e.Deferred().resolve([]).promise();
                    r = [{
                        name: i.replace(/^.*\\/, "")
                    }]
                } else r[0].name === undefined && r[0].fileName && e.each(r, function(e, t) {
                    t.name = t.fileName, t.size = t.fileSize
                });
                return e.Deferred().resolve(r).promise()
            },
            _getFileInputFiles: function(t) {
                return t instanceof e && t.length !== 1 ? e.when.apply(e, e.map(t, this._getSingleFileInputFiles)).pipe(function() {
                    return Array.prototype.concat.apply([], arguments)
                }) : this._getSingleFileInputFiles(t)
            },
            _onChange: function(t) {
                var n = this,
                    r = {
                        fileInput: e(t.target),
                        form: e(t.target.form)
                    };
                this._getFileInputFiles(r.fileInput).always(function(i) {
                    r.files = i, n.options.replaceFileInput && n._replaceFileInput(r.fileInput), n._trigger("change", e.Event("change", {
                        delegatedEvent: t
                    }), r) !== !1 && n._onAdd(t, r)
                })
            },
            _onPaste: function(t) {
                var n = t.originalEvent && t.originalEvent.clipboardData && t.originalEvent.clipboardData.items,
                    r = {
                        files: []
                    };
                n && n.length && (e.each(n, function(e, t) {
                    var n = t.getAsFile && t.getAsFile();
                    n && r.files.push(n)
                }), this._trigger("paste", e.Event("paste", {
                    delegatedEvent: t
                }), r) !== !1 && this._onAdd(t, r))
            },
            _onDrop: function(t) {
                t.dataTransfer = t.originalEvent && t.originalEvent.dataTransfer;
                var n = this,
                    r = t.dataTransfer,
                    i = {};
                r && r.files && r.files.length && (t.preventDefault(), this._getDroppedFiles(r).always(function(r) {
                    i.files = r, n._trigger("drop", e.Event("drop", {
                        delegatedEvent: t
                    }), i) !== !1 && n._onAdd(t, i)
                }))
            },
            _onDragOver: function(t) {
                t.dataTransfer = t.originalEvent && t.originalEvent.dataTransfer;
                var n = t.dataTransfer;
                n && e.inArray("Files", n.types) !== -1 && this._trigger("dragover", e.Event("dragover", {
                    delegatedEvent: t
                })) !== !1 && (t.preventDefault(), n.dropEffect = "copy")
            },
            _initEventHandlers: function() {
                this._isXHRUpload(this.options) && (this._on(this.options.dropZone, {
                    dragover: this._onDragOver,
                    drop: this._onDrop
                }), this._on(this.options.pasteZone, {
                    paste: this._onPaste
                })), e.support.fileInput && this._on(this.options.fileInput, {
                    change: this._onChange
                })
            },
            _destroyEventHandlers: function() {
                this._off(this.options.dropZone, "dragover drop"), this._off(this.options.pasteZone, "paste"), this._off(this.options.fileInput, "change")
            },
            _setOption: function(t, n) {
                var r = e.inArray(t, this._specialOptions) !== -1;
                r && this._destroyEventHandlers(), this._super(t, n), r && (this._initSpecialOptions(), this._initEventHandlers())
            },
            _initSpecialOptions: function() {
                var t = this.options;
                t.fileInput === undefined ? t.fileInput = this.element.is('input[type="file"]') ? this.element : this.element.find('input[type="file"]') : t.fileInput instanceof e || (t.fileInput = e(t.fileInput)), t.dropZone instanceof e || (t.dropZone = e(t.dropZone)), t.pasteZone instanceof e || (t.pasteZone = e(t.pasteZone))
            },
            _getRegExp: function(e) {
                var t = e.split("/"),
                    n = t.pop();
                return t.shift(), new RegExp(t.join("/"), n)
            },
            _isRegExpOption: function(t, n) {
                return t !== "url" && e.type(n) === "string" && /^\/.*\/[igm]{0,3}$/.test(n)
            },
            _initDataAttributes: function() {
                var t = this,
                    n = this.options,
                    r = e(this.element[0].cloneNode(!1));
                e.each(r.data(), function(e, i) {
                    var s = "data-" + e.replace(/([a-z])([A-Z])/g, "$1-$2").toLowerCase();
                    r.attr(s) && (t._isRegExpOption(e, i) && (i = t._getRegExp(i)), n[e] = i)
                })
            },
            _create: function() {
                this._initDataAttributes(), this._initSpecialOptions(), this._slots = [], this._sequence = this._getXHRPromise(!0), this._sending = this._active = 0, this._initProgressObject(this), this._initEventHandlers()
            },
            active: function() {
                return this._active
            },
            progress: function() {
                return this._progress
            },
            add: function(t) {
                var n = this;
                if (!t || this.options.disabled) return;
                t.fileInput && !t.files ? this._getFileInputFiles(t.fileInput).always(function(e) {
                    t.files = e, n._onAdd(null, t)
                }) : (t.files = e.makeArray(t.files), this._onAdd(null, t))
            },
            send: function(t) {
                if (t && !this.options.disabled) {
                    if (t.fileInput && !t.files) {
                        var n = this,
                            r = e.Deferred(),
                            i = r.promise(),
                            s, o;
                        return i.abort = function() {
                            return o = !0, s ? s.abort() : (r.reject(null, "abort", "abort"), i)
                        }, this._getFileInputFiles(t.fileInput).always(function(e) {
                            if (o) return;
                            if (!e.length) {
                                r.reject();
                                return
                            }
                            t.files = e, s = n._onSend(null, t).then(function(e, t, n) {
                                r.resolve(e, t, n)
                            }, function(e, t, n) {
                                r.reject(e, t, n)
                            })
                        }), this._enhancePromise(i)
                    }
                    t.files = e.makeArray(t.files);
                    if (t.files.length) return this._onSend(null, t)
                }
                return this._getXHRPromise(!1, t && t.context)
            }
        })
    }), define("jquery.fileupload", ["jquery.fileupload/jquery.fileupload"], function(e) {
        return e
    }),
    function(e) {
        var t = function(e, n, r) {
                var i = document.createElement("img"),
                    s, o;
                i.onerror = n, i.onload = function() {
                    o && (!r || !r.noRevoke) && t.revokeObjectURL(o), n && n(t.scale(i, r))
                };
                if (t.isInstanceOf("Blob", e) || t.isInstanceOf("File", e)) s = o = t.createObjectURL(e), i._type = e.type;
                else {
                    if (typeof e != "string") return !1;
                    s = e, r && r.crossOrigin && (i.crossOrigin = r.crossOrigin)
                }
                return s ? (i.src = s, i) : t.readFile(e, function(e) {
                    var t = e.target;
                    t && t.result ? i.src = t.result : n && n(e)
                })
            },
            n = window.createObjectURL && window || window.URL && URL.revokeObjectURL && URL || window.webkitURL && webkitURL;
        t.isInstanceOf = function(e, t) {
            return Object.prototype.toString.call(t) === "[object " + e + "]"
        }, t.transformCoordinates = function() {
            return
        }, t.getTransformedOptions = function(e) {
            return e
        }, t.renderImageToCanvas = function(e, t, n, r, i, s, o, u, a, f) {
            return e.getContext("2d").drawImage(t, n, r, i, s, o, u, a, f), e
        }, t.hasCanvasOption = function(e) {
            return e.canvas || e.crop
        }, t.scale = function(e, n) {
            n = n || {};
            var r = document.createElement("canvas"),
                i = e.getContext || t.hasCanvasOption(n) && r.getContext,
                s = e.naturalWidth || e.width,
                o = e.naturalHeight || e.height,
                u = s,
                a = o,
                f, l, c, h, p, d, v, m, g, y = function() {
                    var e = Math.max((c || u) / u, (h || a) / a);
                    e > 1 && (u = Math.ceil(u * e), a = Math.ceil(a * e))
                },
                b = function() {
                    var e = Math.min((f || u) / u, (l || a) / a);
                    e < 1 && (u = Math.ceil(u * e), a = Math.ceil(a * e))
                };
            i && (n = t.getTransformedOptions(n), v = n.left || 0, m = n.top || 0, n.sourceWidth ? (p = n.sourceWidth, n.right !== undefined && n.left === undefined && (v = s - p - n.right)) : p = s - v - (n.right || 0), n.sourceHeight ? (d = n.sourceHeight, n.bottom !== undefined && n.top === undefined && (m = o - d - n.bottom)) : d = o - m - (n.bottom || 0), u = p, a = d), f = n.maxWidth, l = n.maxHeight, c = n.minWidth, h = n.minHeight;
            if (i && f && l && n.crop) u = f, a = l, g = p / d - f / l, g < 0 ? (d = l * p / f, n.top === undefined && n.bottom === undefined && (m = (o - d) / 2)) : g > 0 && (p = f * d / l, n.left === undefined && n.right === undefined && (v = (s - p) / 2));
            else {
                if (n.contain || n.cover) c = f = f || c, h = l = l || h;
                n.cover ? (b(), y()) : (y(), b())
            }
            return i ? (r.width = u, r.height = a, t.transformCoordinates(r, n), t.renderImageToCanvas(r, e, v, m, p, d, 0, 0, u, a)) : (e.width = u, e.height = a, e)
        }, t.createObjectURL = function(e) {
            return n ? n.createObjectURL(e) : !1
        }, t.revokeObjectURL = function(e) {
            return n ? n.revokeObjectURL(e) : !1
        }, t.readFile = function(e, t, n) {
            if (window.FileReader) {
                var r = new FileReader;
                r.onload = r.onerror = t, n = n || "readAsDataURL";
                if (r[n]) return r[n](e), r
            }
            return !1
        }, typeof define == "function" && define.amd ? define("load-image/load-image", [], function() {
            return t
        }) : e.loadImage = t
    }(this), define("load-image", ["load-image/load-image"], function(e) {
        return e
    }),
    function(e) {
        typeof define == "function" && define.amd ? define("load-image-meta/load-image-meta", ["load-image"], e) : e(window.loadImage)
    }(function(e) {
        var t = window.Blob && (Blob.prototype.slice || Blob.prototype.webkitSlice || Blob.prototype.mozSlice);
        e.blobSlice = t && function() {
            var e = this.slice || this.webkitSlice || this.mozSlice;
            return e.apply(this, arguments)
        }, e.metaDataParsers = {
            jpeg: {
                65505: []
            }
        }, e.parseMetaData = function(t, n, r) {
            r = r || {};
            var i = this,
                s = r.maxMetaDataSize || 262144,
                o = {},
                u = !(window.DataView && t && t.size >= 12 && t.type === "image/jpeg" && e.blobSlice);
            (u || !e.readFile(e.blobSlice.call(t, 0, s), function(t) {
                if (t.target.error) {
                    console.log(t.target.error), n(o);
                    return
                }
                var s = t.target.result,
                    u = new DataView(s),
                    a = 2,
                    f = u.byteLength - 4,
                    l = a,
                    c, h, p, d;
                if (u.getUint16(0) === 65496) {
                    while (a < f) {
                        c = u.getUint16(a);
                        if (!(c >= 65504 && c <= 65519 || c === 65534)) break;
                        h = u.getUint16(a + 2) + 2;
                        if (a + h > u.byteLength) {
                            console.log("Invalid meta data: Invalid segment size.");
                            break
                        }
                        p = e.metaDataParsers.jpeg[c];
                        if (p)
                            for (d = 0; d < p.length; d += 1) p[d].call(i, u, a, h, o, r);
                        a += h, l = a
                    }!r.disableImageHead && l > 6 && (s.slice ? o.imageHead = s.slice(0, l) : o.imageHead = (new Uint8Array(s)).subarray(0, l))
                } else console.log("Invalid JPEG file: Missing JPEG marker.");
                n(o)
            }, "readAsArrayBuffer")) && n(o)
        }
    }), define("load-image-meta", ["load-image-meta/load-image-meta"], function(e) {
        return e
    }),
    function(e) {
        typeof define == "function" && define.amd ? define("load-image-exif/load-image-exif", ["load-image", "load-image-meta"], e) : e(window.loadImage)
    }(function(e) {
        e.ExifMap = function() {
            return this
        }, e.ExifMap.prototype.map = {
            Orientation: 274
        }, e.ExifMap.prototype.get = function(e) {
            return this[e] || this[this.map[e]]
        }, e.getExifThumbnail = function(e, t, n) {
            var r, i, s;
            if (!n || t + n > e.byteLength) {
                console.log("Invalid Exif data: Invalid thumbnail data.");
                return
            }
            r = [];
            for (i = 0; i < n; i += 1) s = e.getUint8(t + i), r.push((s < 16 ? "0" : "") + s.toString(16));
            return "data:image/jpeg,%" + r.join("%")
        }, e.exifTagTypes = {
            1: {
                getValue: function(e, t) {
                    return e.getUint8(t)
                },
                size: 1
            },
            2: {
                getValue: function(e, t) {
                    return String.fromCharCode(e.getUint8(t))
                },
                size: 1,
                ascii: !0
            },
            3: {
                getValue: function(e, t, n) {
                    return e.getUint16(t, n)
                },
                size: 2
            },
            4: {
                getValue: function(e, t, n) {
                    return e.getUint32(t, n)
                },
                size: 4
            },
            5: {
                getValue: function(e, t, n) {
                    return e.getUint32(t, n) / e.getUint32(t + 4, n)
                },
                size: 8
            },
            9: {
                getValue: function(e, t, n) {
                    return e.getInt32(t, n)
                },
                size: 4
            },
            10: {
                getValue: function(e, t, n) {
                    return e.getInt32(t, n) / e.getInt32(t + 4, n)
                },
                size: 8
            }
        }, e.exifTagTypes[7] = e.exifTagTypes[1], e.getExifValue = function(t, n, r, i, s, o) {
            var u = e.exifTagTypes[i],
                a, f, l, c, h, p;
            if (!u) {
                console.log("Invalid Exif data: Invalid tag type.");
                return
            }
            a = u.size * s, f = a > 4 ? n + t.getUint32(r + 8, o) : r + 8;
            if (f + a > t.byteLength) {
                console.log("Invalid Exif data: Invalid data offset.");
                return
            }
            if (s === 1) return u.getValue(t, f, o);
            l = [];
            for (c = 0; c < s; c += 1) l[c] = u.getValue(t, f + c * u.size, o);
            if (u.ascii) {
                h = "";
                for (c = 0; c < l.length; c += 1) {
                    p = l[c];
                    if (p === "\0") break;
                    h += p
                }
                return h
            }
            return l
        }, e.parseExifTag = function(t, n, r, i, s) {
            var o = t.getUint16(r, i);
            s.exif[o] = e.getExifValue(t, n, r, t.getUint16(r + 2, i), t.getUint32(r + 4, i), i)
        }, e.parseExifTags = function(e, t, n, r, i) {
            var s, o, u;
            if (n + 6 > e.byteLength) {
                console.log("Invalid Exif data: Invalid directory offset.");
                return
            }
            s = e.getUint16(n, r), o = n + 2 + 12 * s;
            if (o + 4 > e.byteLength) {
                console.log("Invalid Exif data: Invalid directory size.");
                return
            }
            for (u = 0; u < s; u += 1) this.parseExifTag(e, t, n + 2 + 12 * u, r, i);
            return e.getUint32(o, r)
        }, e.parseExifData = function(t, n, r, i, s) {
            if (s.disableExif) return;
            var o = n + 10,
                u, a, f;
            if (t.getUint32(n + 4) !== 1165519206) return;
            if (o + 8 > t.byteLength) {
                console.log("Invalid Exif data: Invalid segment size.");
                return
            }
            if (t.getUint16(n + 8) !== 0) {
                console.log("Invalid Exif data: Missing byte alignment offset.");
                return
            }
            switch (t.getUint16(o)) {
                case 18761:
                    u = !0;
                    break;
                case 19789:
                    u = !1;
                    break;
                default:
                    console.log("Invalid Exif data: Invalid byte alignment marker.");
                    return
            }
            if (t.getUint16(o + 2, u) !== 42) {
                console.log("Invalid Exif data: Missing TIFF marker.");
                return
            }
            a = t.getUint32(o + 4, u), i.exif = new e.ExifMap, a = e.parseExifTags(t, o, o + a, u, i), a && !s.disableExifThumbnail && (f = {
                exif: {}
            }, a = e.parseExifTags(t, o, o + a, u, f), f.exif[513] && (i.exif.Thumbnail = e.getExifThumbnail(t, o + f.exif[513], f.exif[514]))), i.exif[34665] && !s.disableExifSub && e.parseExifTags(t, o, o + i.exif[34665], u, i), i.exif[34853] && !s.disableExifGps && e.parseExifTags(t, o, o + i.exif[34853], u, i)
        }, e.metaDataParsers.jpeg[65505].push(e.parseExifData)
    }), define("load-image-exif", ["load-image-exif/load-image-exif"], function(e) {
        return e
    }),
    function(e) {
        typeof define == "function" && define.amd ? define("load-image-ios/load-image-ios", ["load-image"], e) : e(window.loadImage)
    }(function(e) {
        if (!window.navigator || !window.navigator.platform || !/iP(hone|od|ad)/.test(window.navigator.platform)) return;
        var t = e.renderImageToCanvas;
        e.detectSubsampling = function(e) {
            var t, n;
            return e.width * e.height > 1048576 ? (t = document.createElement("canvas"), t.width = t.height = 1, n = t.getContext("2d"), n.drawImage(e, -e.width + 1, 0), n.getImageData(0, 0, 1, 1).data[3] === 0) : !1
        }, e.detectVerticalSquash = function(e, t) {
            var n = e.naturalHeight || e.height,
                r = document.createElement("canvas"),
                i = r.getContext("2d"),
                s, o, u, a, f;
            t && (n /= 2), r.width = 1, r.height = n, i.drawImage(e, 0, 0), s = i.getImageData(0, 0, 1, n).data, o = 0, u = n, a = n;
            while (a > o) f = s[(a - 1) * 4 + 3], f === 0 ? u = a : o = a, a = u + o >> 1;
            return a / n || 1
        }, e.renderImageToCanvas = function(n, r, i, s, o, u, a, f, l, c) {
            if (r._type === "image/jpeg") {
                var h = n.getContext("2d"),
                    p = document.createElement("canvas"),
                    d = 1024,
                    v = p.getContext("2d"),
                    m, g, y, b;
                p.width = d, p.height = d, h.save(), m = e.detectSubsampling(r), m && (i /= 2, s /= 2, o /= 2, u /= 2), g = e.detectVerticalSquash(r, m);
                if (m || g !== 1) {
                    s *= g, l = Math.ceil(d * l / o), c = Math.ceil(d * c / u / g), f = 0, b = 0;
                    while (b < u) {
                        a = 0, y = 0;
                        while (y < o) v.clearRect(0, 0, d, d), v.drawImage(r, i, s, o, u, -y, -b, o, u), h.drawImage(p, 0, 0, d, d, a, f, l, c), y += d, a += l;
                        b += d, f += c
                    }
                    return h.restore(), n
                }
            }
            return t(n, r, i, s, o, u, a, f, l, c)
        }
    }), define("load-image-ios", ["load-image-ios/load-image-ios"], function(e) {
        return e
    }),
    function(e) {
        var t = e.HTMLCanvasElement && e.HTMLCanvasElement.prototype,
            n = e.Blob && function() {
                try {
                    return Boolean(new Blob)
                } catch (e) {
                    return !1
                }
            }(),
            r = n && e.Uint8Array && function() {
                try {
                    return (new Blob([new Uint8Array(100)])).size === 100
                } catch (e) {
                    return !1
                }
            }(),
            i = e.BlobBuilder || e.WebKitBlobBuilder || e.MozBlobBuilder || e.MSBlobBuilder,
            s = (n || i) && e.atob && e.ArrayBuffer && e.Uint8Array && function(e) {
                var t, s, o, u, a, f;
                e.split(",")[0].indexOf("base64") >= 0 ? t = atob(e.split(",")[1]) : t = decodeURIComponent(e.split(",")[1]), s = new ArrayBuffer(t.length), o = new Uint8Array(s);
                for (u = 0; u < t.length; u += 1) o[u] = t.charCodeAt(u);
                return a = e.split(",")[0].split(":")[1].split(";")[0], n ? new Blob([r ? o : s], {
                    type: a
                }) : (f = new i, f.append(s), f.getBlob(a))
            };
        e.HTMLCanvasElement && !t.toBlob && (t.mozGetAsFile ? t.toBlob = function(e, n, r) {
            r && t.toDataURL && s ? e(s(this.toDataURL(n, r))) : e(this.mozGetAsFile("blob", n))
        } : t.toDataURL && s && (t.toBlob = function(e, t, n) {
            e(s(this.toDataURL(t, n)))
        })), typeof define == "function" && define.amd ? define("canvas-to-blob/canvas-to-blob", [], function() {
            return s
        }) : e.dataURLtoBlob = s
    }(this), define("canvas-to-blob", ["canvas-to-blob/canvas-to-blob"], function(e) {
        return e
    }),
    function(e) {
        typeof define == "function" && define.amd ? define("jquery.fileupload-process/jquery.fileupload-process", ["jquery", "jquery.fileupload"], e) : e(window.jQuery)
    }(function(e) {
        var t = e.blueimp.fileupload.prototype.options.add;
        e.widget("blueimp.fileupload", e.blueimp.fileupload, {
            options: {
                processQueue: [],
                add: function(n, r) {
                    var i = e(this);
                    r.process(function() {
                        return i.fileupload("process", r)
                    }), t.call(this, n, r)
                }
            },
            processActions: {},
            _processFile: function(t, n) {
                var r = this,
                    i = e.Deferred().resolveWith(r, [t]),
                    s = i.promise();
                return this._trigger("process", null, t), e.each(t.processQueue, function(t, i) {
                    var o = function(t) {
                        return n.errorThrown ? e.Deferred().rejectWith(r, [n]).promise() : r.processActions[i.action].call(r, t, i)
                    };
                    s = s.pipe(o, i.always && o)
                }), s.done(function() {
                    r._trigger("processdone", null, t), r._trigger("processalways", null, t)
                }).fail(function() {
                    r._trigger("processfail", null, t), r._trigger("processalways", null, t)
                }), s
            },
            _transformProcessQueue: function(t) {
                var n = [];
                e.each(t.processQueue, function() {
                    var r = {},
                        i = this.action,
                        s = this.prefix === !0 ? i : this.prefix;
                    e.each(this, function(n, i) {
                        e.type(i) === "string" && i.charAt(0) === "@" ? r[n] = t[i.slice(1) || (s ? s + n.charAt(0).toUpperCase() + n.slice(1) : n)] : r[n] = i
                    }), n.push(r)
                }), t.processQueue = n
            },
            processing: function() {
                return this._processing
            },
            process: function(t) {
                var n = this,
                    r = e.extend({}, this.options, t);
                return r.processQueue && r.processQueue.length && (this._transformProcessQueue(r), this._processing === 0 && this._trigger("processstart"), e.each(t.files, function(i) {
                    var s = i ? e.extend({}, r) : r,
                        o = function() {
                            return t.errorThrown ? e.Deferred().rejectWith(n, [t]).promise() : n._processFile(s, t)
                        };
                    s.index = i, n._processing += 1, n._processingQueue = n._processingQueue.pipe(o, o).always(function() {
                        n._processing -= 1, n._processing === 0 && n._trigger("processstop")
                    })
                })), this._processingQueue
            },
            _create: function() {
                this._super(), this._processing = 0, this._processingQueue = e.Deferred().resolveWith(this).promise()
            }
        })
    }), define("jquery.fileupload-process", ["jquery.fileupload-process/jquery.fileupload-process"], function(e) {
        return e
    }),
    function(e) {
        typeof define == "function" && define.amd ? define("jquery.fileupload-image/jquery.fileupload-image", ["jquery", "load-image", "load-image-meta", "load-image-exif", "load-image-ios", "canvas-to-blob", "jquery.fileupload-process"], e) : e(window.jQuery, window.loadImage)
    }(function(e, t) {
        e.blueimp.fileupload.prototype.options.processQueue.unshift({
            action: "loadImageMetaData",
            disableImageHead: "@",
            disableExif: "@",
            disableExifThumbnail: "@",
            disableExifSub: "@",
            disableExifGps: "@",
            disabled: "@disableImageMetaDataLoad"
        }, {
            action: "loadImage",
            prefix: !0,
            fileTypes: "@",
            maxFileSize: "@",
            noRevoke: "@",
            disabled: "@disableImageLoad"
        }, {
            action: "resizeImage",
            prefix: "image",
            maxWidth: "@",
            maxHeight: "@",
            minWidth: "@",
            minHeight: "@",
            crop: "@",
            orientation: "@",
            forceResize: "@",
            disabled: "@disableImageResize"
        }, {
            action: "saveImage",
            quality: "@imageQuality",
            type: "@imageType",
            disabled: "@disableImageResize"
        }, {
            action: "saveImageMetaData",
            disabled: "@disableImageMetaDataSave"
        }, {
            action: "resizeImage",
            prefix: "preview",
            maxWidth: "@",
            maxHeight: "@",
            minWidth: "@",
            minHeight: "@",
            crop: "@",
            orientation: "@",
            thumbnail: "@",
            canvas: "@",
            disabled: "@disableImagePreview"
        }, {
            action: "setImage",
            name: "@imagePreviewName",
            disabled: "@disableImagePreview"
        }, {
            action: "deleteImageReferences",
            disabled: "@disableImageReferencesDeletion"
        }), e.widget("blueimp.fileupload", e.blueimp.fileupload, {
            options: {
                loadImageFileTypes: /^image\/(gif|jpeg|png|svg\+xml)$/,
                loadImageMaxFileSize: 1e7,
                imageMaxWidth: 1920,
                imageMaxHeight: 1080,
                imageOrientation: !1,
                imageCrop: !1,
                disableImageResize: !0,
                previewMaxWidth: 80,
                previewMaxHeight: 80,
                previewOrientation: !0,
                previewThumbnail: !0,
                previewCrop: !1,
                previewCanvas: !0
            },
            processActions: {
                loadImage: function(n, r) {
                    if (r.disabled) return n;
                    var i = this,
                        s = n.files[n.index],
                        o = e.Deferred();
                    return e.type(r.maxFileSize) === "number" && s.size > r.maxFileSize || r.fileTypes && !r.fileTypes.test(s.type) || !t(s, function(e) {
                        e.src && (n.img = e), o.resolveWith(i, [n])
                    }, r) ? n : o.promise()
                },
                resizeImage: function(n, r) {
                    if (r.disabled || !n.canvas && !n.img) return n;
                    r = e.extend({
                        canvas: !0
                    }, r);
                    var i = this,
                        s = e.Deferred(),
                        o = r.canvas && n.canvas || n.img,
                        u = function(e) {
                            e && (e.width !== o.width || e.height !== o.height || r.forceResize) && (n[e.getContext ? "canvas" : "img"] = e), n.preview = e, s.resolveWith(i, [n])
                        },
                        a;
                    if (n.exif) {
                        r.orientation === !0 && (r.orientation = n.exif.get("Orientation"));
                        if (r.thumbnail) {
                            a = n.exif.get("Thumbnail");
                            if (a) return t(a, u, r), s.promise()
                        }
                    }
                    return o ? (u(t.scale(o, r)), s.promise()) : n
                },
                saveImage: function(t, n) {
                    if (!t.canvas || n.disabled) return t;
                    var r = this,
                        i = t.files[t.index],
                        s = e.Deferred();
                    return t.canvas.toBlob ? (t.canvas.toBlob(function(e) {
                        e.name || (i.type === e.type ? e.name = i.name : i.name && (e.name = i.name.replace(/\..+$/, "." + e.type.substr(6)))), i.type !== e.type && delete t.imageHead, t.files[t.index] = e, s.resolveWith(r, [t])
                    }, n.type || i.type, n.quality), s.promise()) : t
                },
                loadImageMetaData: function(n, r) {
                    if (r.disabled) return n;
                    var i = this,
                        s = e.Deferred();
                    return t.parseMetaData(n.files[n.index], function(t) {
                        e.extend(n, t), s.resolveWith(i, [n])
                    }, r), s.promise()
                },
                saveImageMetaData: function(e, t) {
                    if (!(e.imageHead && e.canvas && e.canvas.toBlob && !t.disabled)) return e;
                    var n = e.files[e.index],
                        r = new Blob([e.imageHead, this._blobSlice.call(n, 20)], {
                            type: n.type
                        });
                    return r.name = n.name, e.files[e.index] = r, e
                },
                setImage: function(e, t) {
                    return e.preview && !t.disabled && (e.files[e.index][t.name || "preview"] = e.preview), e
                },
                deleteImageReferences: function(e, t) {
                    return t.disabled || (delete e.img, delete e.canvas, delete e.preview, delete e.imageHead), e
                }
            }
        })
    }), define("jquery.fileupload-image", ["jquery.fileupload-image/jquery.fileupload-image"], function(e) {
        return e
    }),
    function(e, t) {
        function i(t, n) {
            var r, i, o, u = t.nodeName.toLowerCase();
            return "area" === u ? (r = t.parentNode, i = r.name, !t.href || !i || r.nodeName.toLowerCase() !== "map" ? !1 : (o = e("img[usemap=#" + i + "]")[0], !!o && s(o))) : (/input|select|textarea|button|object/.test(u) ? !t.disabled : "a" === u ? t.href || n : n) && s(t)
        }

        function s(t) {
            return e.expr.filters.visible(t) && !e(t).parents().addBack().filter(function() {
                return e.css(this, "visibility") === "hidden"
            }).length
        }
        var n = 0,
            r = /^ui-id-\d+$/;
        e.ui = e.ui || {}, e.extend(e.ui, {
            version: "1.10.3",
            keyCode: {
                BACKSPACE: 8,
                COMMA: 188,
                DELETE: 46,
                DOWN: 40,
                END: 35,
                ENTER: 13,
                ESCAPE: 27,
                HOME: 36,
                LEFT: 37,
                NUMPAD_ADD: 107,
                NUMPAD_DECIMAL: 110,
                NUMPAD_DIVIDE: 111,
                NUMPAD_ENTER: 108,
                NUMPAD_MULTIPLY: 106,
                NUMPAD_SUBTRACT: 109,
                PAGE_DOWN: 34,
                PAGE_UP: 33,
                PERIOD: 190,
                RIGHT: 39,
                SPACE: 32,
                TAB: 9,
                UP: 38
            }
        }), e.fn.extend({
            focus: function(t) {
                return function(n, r) {
                    return typeof n == "number" ? this.each(function() {
                        var t = this;
                        setTimeout(function() {
                            e(t).focus(), r && r.call(t)
                        }, n)
                    }) : t.apply(this, arguments)
                }
            }(e.fn.focus),
            scrollParent: function() {
                var t;
                return e.ui.ie && /(static|relative)/.test(this.css("position")) || /absolute/.test(this.css("position")) ? t = this.parents().filter(function() {
                    return /(relative|absolute|fixed)/.test(e.css(this, "position")) && /(auto|scroll)/.test(e.css(this, "overflow") + e.css(this, "overflow-y") + e.css(this, "overflow-x"))
                }).eq(0) : t = this.parents().filter(function() {
                    return /(auto|scroll)/.test(e.css(this, "overflow") + e.css(this, "overflow-y") + e.css(this, "overflow-x"))
                }).eq(0), /fixed/.test(this.css("position")) || !t.length ? e(document) : t
            },
            zIndex: function(n) {
                if (n !== t) return this.css("zIndex", n);
                if (this.length) {
                    var r = e(this[0]),
                        i, s;
                    while (r.length && r[0] !== document) {
                        i = r.css("position");
                        if (i === "absolute" || i === "relative" || i === "fixed") {
                            s = parseInt(r.css("zIndex"), 10);
                            if (!isNaN(s) && s !== 0) return s
                        }
                        r = r.parent()
                    }
                }
                return 0
            },
            uniqueId: function() {
                return this.each(function() {
                    this.id || (this.id = "ui-id-" + ++n)
                })
            },
            removeUniqueId: function() {
                return this.each(function() {
                    r.test(this.id) && e(this).removeAttr("id")
                })
            }
        }), e.extend(e.expr[":"], {
            data: e.expr.createPseudo ? e.expr.createPseudo(function(t) {
                return function(n) {
                    return !!e.data(n, t)
                }
            }) : function(t, n, r) {
                return !!e.data(t, r[3])
            },
            focusable: function(t) {
                return i(t, !isNaN(e.attr(t, "tabindex")))
            },
            tabbable: function(t) {
                var n = e.attr(t, "tabindex"),
                    r = isNaN(n);
                return (r || n >= 0) && i(t, !r)
            }
        }), e("<a>").outerWidth(1).jquery || e.each(["Width", "Height"], function(n, r) {
            function u(t, n, r, s) {
                return e.each(i, function() {
                    n -= parseFloat(e.css(t, "padding" + this)) || 0, r && (n -= parseFloat(e.css(t, "border" + this + "Width")) || 0), s && (n -= parseFloat(e.css(t, "margin" + this)) || 0)
                }), n
            }
            var i = r === "Width" ? ["Left", "Right"] : ["Top", "Bottom"],
                s = r.toLowerCase(),
                o = {
                    innerWidth: e.fn.innerWidth,
                    innerHeight: e.fn.innerHeight,
                    outerWidth: e.fn.outerWidth,
                    outerHeight: e.fn.outerHeight
                };
            e.fn["inner" + r] = function(n) {
                return n === t ? o["inner" + r].call(this) : this.each(function() {
                    e(this).css(s, u(this, n) + "px")
                })
            }, e.fn["outer" + r] = function(t, n) {
                return typeof t != "number" ? o["outer" + r].call(this, t) : this.each(function() {
                    e(this).css(s, u(this, t, !0, n) + "px")
                })
            }
        }), e.fn.addBack || (e.fn.addBack = function(e) {
            return this.add(e == null ? this.prevObject : this.prevObject.filter(e))
        }), e("<a>").data("a-b", "a").removeData("a-b").data("a-b") && (e.fn.removeData = function(t) {
            return function(n) {
                return arguments.length ? t.call(this, e.camelCase(n)) : t.call(this)
            }
        }(e.fn.removeData)), e.ui.ie = !!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()), e.support.selectstart = "onselectstart" in document.createElement("div"), e.fn.extend({
            disableSelection: function() {
                return this.bind((e.support.selectstart ? "selectstart" : "mousedown") + ".ui-disableSelection", function(e) {
                    e.preventDefault()
                })
            },
            enableSelection: function() {
                return this.unbind(".ui-disableSelection")
            }
        }), e.extend(e.ui, {
            plugin: {
                add: function(t, n, r) {
                    var i, s = e.ui[t].prototype;
                    for (i in r) s.plugins[i] = s.plugins[i] || [], s.plugins[i].push([n, r[i]])
                },
                call: function(e, t, n) {
                    var r, i = e.plugins[t];
                    if (!i || !e.element[0].parentNode || e.element[0].parentNode.nodeType === 11) return;
                    for (r = 0; r < i.length; r++) e.options[i[r][0]] && i[r][1].apply(e.element, n)
                }
            },
            hasScroll: function(t, n) {
                if (e(t).css("overflow") === "hidden") return !1;
                var r = n && n === "left" ? "scrollLeft" : "scrollTop",
                    i = !1;
                return t[r] > 0 ? !0 : (t[r] = 1, i = t[r] > 0, t[r] = 0, i)
            }
        })
    }(jQuery),
    function(e, t) {
        var n = 0,
            r = Array.prototype.slice,
            i = e.cleanData;
        e.cleanData = function(t) {
            for (var n = 0, r;
                (r = t[n]) != null; n++) try {
                e(r).triggerHandler("remove")
            } catch (s) {}
            i(t)
        }, e.widget = function(t, n, r) {
            var i, s, o, u, a = {},
                f = t.split(".")[0];
            t = t.split(".")[1], i = f + "-" + t, r || (r = n, n = e.Widget), e.expr[":"][i.toLowerCase()] = function(t) {
                return !!e.data(t, i)
            }, e[f] = e[f] || {}, s = e[f][t], o = e[f][t] = function(e, t) {
                if (!this._createWidget) return new o(e, t);
                arguments.length && this._createWidget(e, t)
            }, e.extend(o, s, {
                version: r.version,
                _proto: e.extend({}, r),
                _childConstructors: []
            }), u = new n, u.options = e.widget.extend({}, u.options), e.each(r, function(t, r) {
                if (!e.isFunction(r)) {
                    a[t] = r;
                    return
                }
                a[t] = function() {
                    var e = function() {
                            return n.prototype[t].apply(this, arguments)
                        },
                        i = function(e) {
                            return n.prototype[t].apply(this, e)
                        };
                    return function() {
                        var t = this._super,
                            n = this._superApply,
                            s;
                        return this._super = e, this._superApply = i, s = r.apply(this, arguments), this._super = t, this._superApply = n, s
                    }
                }()
            }), o.prototype = e.widget.extend(u, {
                widgetEventPrefix: s ? u.widgetEventPrefix : t
            }, a, {
                constructor: o,
                namespace: f,
                widgetName: t,
                widgetFullName: i
            }), s ? (e.each(s._childConstructors, function(t, n) {
                var r = n.prototype;
                e.widget(r.namespace + "." + r.widgetName, o, n._proto)
            }), delete s._childConstructors) : n._childConstructors.push(o), e.widget.bridge(t, o)
        }, e.widget.extend = function(n) {
            var i = r.call(arguments, 1),
                s = 0,
                o = i.length,
                u, a;
            for (; s < o; s++)
                for (u in i[s]) a = i[s][u], i[s].hasOwnProperty(u) && a !== t && (e.isPlainObject(a) ? n[u] = e.isPlainObject(n[u]) ? e.widget.extend({}, n[u], a) : e.widget.extend({}, a) : n[u] = a);
            return n
        }, e.widget.bridge = function(n, i) {
            var s = i.prototype.widgetFullName || n;
            e.fn[n] = function(o) {
                var u = typeof o == "string",
                    a = r.call(arguments, 1),
                    f = this;
                return o = !u && a.length ? e.widget.extend.apply(null, [o].concat(a)) : o, u ? this.each(function() {
                    var r, i = e.data(this, s);
                    if (!i) return e.error("cannot call methods on " + n + " prior to initialization; " + "attempted to call method '" + o + "'");
                    if (!e.isFunction(i[o]) || o.charAt(0) === "_") return e.error("no such method '" + o + "' for " + n + " widget instance");
                    r = i[o].apply(i, a);
                    if (r !== i && r !== t) return f = r && r.jquery ? f.pushStack(r.get()) : r, !1
                }) : this.each(function() {
                    var t = e.data(this, s);
                    t ? t.option(o || {})._init() : e.data(this, s, new i(o, this))
                }), f
            }
        }, e.Widget = function() {}, e.Widget._childConstructors = [], e.Widget.prototype = {
            widgetName: "widget",
            widgetEventPrefix: "",
            defaultElement: "<div>",
            options: {
                disabled: !1,
                create: null
            },
            _createWidget: function(t, r) {
                r = e(r || this.defaultElement || this)[0], this.element = e(r), this.uuid = n++, this.eventNamespace = "." + this.widgetName + this.uuid, this.options = e.widget.extend({}, this.options, this._getCreateOptions(), t), this.bindings = e(), this.hoverable = e(), this.focusable = e(), r !== this && (e.data(r, this.widgetFullName, this), this._on(!0, this.element, {
                    remove: function(e) {
                        e.target === r && this.destroy()
                    }
                }), this.document = e(r.style ? r.ownerDocument : r.document || r), this.window = e(this.document[0].defaultView || this.document[0].parentWindow)), this._create(), this._trigger("create", null, this._getCreateEventData()), this._init()
            },
            _getCreateOptions: e.noop,
            _getCreateEventData: e.noop,
            _create: e.noop,
            _init: e.noop,
            destroy: function() {
                this._destroy(), this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)), this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName + "-disabled " + "ui-state-disabled"), this.bindings.unbind(this.eventNamespace), this.hoverable.removeClass("ui-state-hover"), this.focusable.removeClass("ui-state-focus")
            },
            _destroy: e.noop,
            widget: function() {
                return this.element
            },
            option: function(n, r) {
                var i = n,
                    s, o, u;
                if (arguments.length === 0) return e.widget.extend({}, this.options);
                if (typeof n == "string") {
                    i = {}, s = n.split("."), n = s.shift();
                    if (s.length) {
                        o = i[n] = e.widget.extend({}, this.options[n]);
                        for (u = 0; u < s.length - 1; u++) o[s[u]] = o[s[u]] || {}, o = o[s[u]];
                        n = s.pop();
                        if (r === t) return o[n] === t ? null : o[n];
                        o[n] = r
                    } else {
                        if (r === t) return this.options[n] === t ? null : this.options[n];
                        i[n] = r
                    }
                }
                return this._setOptions(i), this
            },
            _setOptions: function(e) {
                var t;
                for (t in e) this._setOption(t, e[t]);
                return this
            },
            _setOption: function(e, t) {
                return this.options[e] = t, e === "disabled" && (this.widget().toggleClass(this.widgetFullName + "-disabled ui-state-disabled", !!t).attr("aria-disabled", t), this.hoverable.removeClass("ui-state-hover"), this.focusable.removeClass("ui-state-focus")), this
            },
            enable: function() {
                return this._setOption("disabled", !1)
            },
            disable: function() {
                return this._setOption("disabled", !0)
            },
            _on: function(t, n, r) {
                var i, s = this;
                typeof t != "boolean" && (r = n, n = t, t = !1), r ? (n = i = e(n), this.bindings = this.bindings.add(n)) : (r = n, n = this.element, i = this.widget()), e.each(r, function(r, o) {
                    function u() {
                        if (!t && (s.options.disabled === !0 || e(this).hasClass("ui-state-disabled"))) return;
                        return (typeof o == "string" ? s[o] : o).apply(s, arguments)
                    }
                    typeof o != "string" && (u.guid = o.guid = o.guid || u.guid || e.guid++);
                    var a = r.match(/^(\w+)\s*(.*)$/),
                        f = a[1] + s.eventNamespace,
                        l = a[2];
                    l ? i.delegate(l, f, u) : n.bind(f, u)
                })
            },
            _off: function(e, t) {
                t = (t || "").split(" ").join(this.eventNamespace + " ") + this.eventNamespace, e.unbind(t).undelegate(t)
            },
            _delay: function(e, t) {
                function n() {
                    return (typeof e == "string" ? r[e] : e).apply(r, arguments)
                }
                var r = this;
                return setTimeout(n, t || 0)
            },
            _hoverable: function(t) {
                this.hoverable = this.hoverable.add(t), this._on(t, {
                    mouseenter: function(t) {
                        e(t.currentTarget).addClass("ui-state-hover")
                    },
                    mouseleave: function(t) {
                        e(t.currentTarget).removeClass("ui-state-hover")
                    }
                })
            },
            _focusable: function(t) {
                this.focusable = this.focusable.add(t), this._on(t, {
                    focusin: function(t) {
                        e(t.currentTarget).addClass("ui-state-focus")
                    },
                    focusout: function(t) {
                        e(t.currentTarget).removeClass("ui-state-focus")
                    }
                })
            },
            _trigger: function(t, n, r) {
                var i, s, o = this.options[t];
                r = r || {}, n = e.Event(n), n.type = (t === this.widgetEventPrefix ? t : this.widgetEventPrefix + t).toLowerCase(), n.target = this.element[0], s = n.originalEvent;
                if (s)
                    for (i in s) i in n || (n[i] = s[i]);
                return this.element.trigger(n, r), !(e.isFunction(o) && o.apply(this.element[0], [n].concat(r)) === !1 || n.isDefaultPrevented())
            }
        }, e.each({
            show: "fadeIn",
            hide: "fadeOut"
        }, function(t, n) {
            e.Widget.prototype["_" + t] = function(r, i, s) {
                typeof i == "string" && (i = {
                    effect: i
                });
                var o, u = i ? i === !0 || typeof i == "number" ? n : i.effect || n : t;
                i = i || {}, typeof i == "number" && (i = {
                    duration: i
                }), o = !e.isEmptyObject(i), i.complete = s, i.delay && r.delay(i.delay), o && e.effects && e.effects.effect[u] ? r[t](i) : u !== t && r[u] ? r[u](i.duration, i.easing, s) : r.queue(function(n) {
                    e(this)[t](), s && s.call(r[0]), n()
                })
            }
        })
    }(jQuery),
    function(e, t) {
        var n = !1;
        e(document).mouseup(function() {
            n = !1
        }), e.widget("ui.mouse", {
            version: "1.10.3",
            options: {
                cancel: "input,textarea,button,select,option",
                distance: 1,
                delay: 0
            },
            _mouseInit: function() {
                var t = this;
                this.element.bind("mousedown." + this.widgetName, function(e) {
                    return t._mouseDown(e)
                }).bind("click." + this.widgetName, function(n) {
                    if (!0 === e.data(n.target, t.widgetName + ".preventClickEvent")) return e.removeData(n.target, t.widgetName + ".preventClickEvent"), n.stopImmediatePropagation(), !1
                }), this.started = !1
            },
            _mouseDestroy: function() {
                this.element.unbind("." + this.widgetName), this._mouseMoveDelegate && e(document).unbind("mousemove." + this.widgetName, this._mouseMoveDelegate).unbind("mouseup." + this.widgetName, this._mouseUpDelegate)
            },
            _mouseDown: function(t) {
                if (n) return;
                this._mouseStarted && this._mouseUp(t), this._mouseDownEvent = t;
                var r = this,
                    i = t.which === 1,
                    s = typeof this.options.cancel == "string" && t.target.nodeName ? e(t.target).closest(this.options.cancel).length : !1;
                if (!i || s || !this._mouseCapture(t)) return !0;
                this.mouseDelayMet = !this.options.delay, this.mouseDelayMet || (this._mouseDelayTimer = setTimeout(function() {
                    r.mouseDelayMet = !0
                }, this.options.delay));
                if (this._mouseDistanceMet(t) && this._mouseDelayMet(t)) {
                    this._mouseStarted = this._mouseStart(t) !== !1;
                    if (!this._mouseStarted) return t.preventDefault(), !0
                }
                return !0 === e.data(t.target, this.widgetName + ".preventClickEvent") && e.removeData(t.target, this.widgetName + ".preventClickEvent"), this._mouseMoveDelegate = function(e) {
                    return r._mouseMove(e)
                }, this._mouseUpDelegate = function(e) {
                    return r._mouseUp(e)
                }, e(document).bind("mousemove." + this.widgetName, this._mouseMoveDelegate).bind("mouseup." + this.widgetName, this._mouseUpDelegate), t.preventDefault(), n = !0, !0
            },
            _mouseMove: function(t) {
                return e.ui.ie && (!document.documentMode || document.documentMode < 9) && !t.button ? this._mouseUp(t) : this._mouseStarted ? (this._mouseDrag(t), t.preventDefault()) : (this._mouseDistanceMet(t) && this._mouseDelayMet(t) && (this._mouseStarted = this._mouseStart(this._mouseDownEvent, t) !== !1, this._mouseStarted ? this._mouseDrag(t) : this._mouseUp(t)), !this._mouseStarted)
            },
            _mouseUp: function(t) {
                return e(document).unbind("mousemove." + this.widgetName, this._mouseMoveDelegate).unbind("mouseup." + this.widgetName, this._mouseUpDelegate), this._mouseStarted && (this._mouseStarted = !1, t.target === this._mouseDownEvent.target && e.data(t.target, this.widgetName + ".preventClickEvent", !0), this._mouseStop(t)), !1
            },
            _mouseDistanceMet: function(e) {
                return Math.max(Math.abs(this._mouseDownEvent.pageX - e.pageX), Math.abs(this._mouseDownEvent.pageY - e.pageY)) >= this.options.distance
            },
            _mouseDelayMet: function() {
                return this.mouseDelayMet
            },
            _mouseStart: function() {},
            _mouseDrag: function() {},
            _mouseStop: function() {},
            _mouseCapture: function() {
                return !0
            }
        })
    }(jQuery),
    function(e, t) {
        function n(e, t, n) {
            return e > t && e < t + n
        }

        function r(e) {
            return /left|right/.test(e.css("float")) || /inline|table-cell/.test(e.css("display"))
        }
        e.widget("ui.sortable", e.ui.mouse, {
            version: "1.10.3",
            widgetEventPrefix: "sort",
            ready: !1,
            options: {
                appendTo: "parent",
                axis: !1,
                connectWith: !1,
                containment: !1,
                cursor: "auto",
                cursorAt: !1,
                dropOnEmpty: !0,
                forcePlaceholderSize: !1,
                forceHelperSize: !1,
                grid: !1,
                handle: !1,
                helper: "original",
                items: "> *",
                opacity: !1,
                placeholder: !1,
                revert: !1,
                scroll: !0,
                scrollSensitivity: 20,
                scrollSpeed: 20,
                scope: "default",
                tolerance: "intersect",
                zIndex: 1e3,
                activate: null,
                beforeStop: null,
                change: null,
                deactivate: null,
                out: null,
                over: null,
                receive: null,
                remove: null,
                sort: null,
                start: null,
                stop: null,
                update: null
            },
            _create: function() {
                var e = this.options;
                this.containerCache = {}, this.element.addClass("ui-sortable"), this.refresh(), this.floating = this.items.length ? e.axis === "x" || r(this.items[0].item) : !1, this.offset = this.element.offset(), this._mouseInit(), this.ready = !0
            },
            _destroy: function() {
                this.element.removeClass("ui-sortable ui-sortable-disabled"), this._mouseDestroy();
                for (var e = this.items.length - 1; e >= 0; e--) this.items[e].item.removeData(this.widgetName + "-item");
                return this
            },
            _setOption: function(t, n) {
                t === "disabled" ? (this.options[t] = n, this.widget().toggleClass("ui-sortable-disabled", !!n)) : e.Widget.prototype._setOption.apply(this, arguments)
            },
            _mouseCapture: function(t, n) {
                var r = null,
                    i = !1,
                    s = this;
                if (this.reverting) return !1;
                if (this.options.disabled || this.options.type === "static") return !1;
                this._refreshItems(t), e(t.target).parents().each(function() {
                    if (e.data(this, s.widgetName + "-item") === s) return r = e(this), !1
                }), e.data(t.target, s.widgetName + "-item") === s && (r = e(t.target));
                if (!r) return !1;
                if (this.options.handle && !n) {
                    e(this.options.handle, r).find("*").addBack().each(function() {
                        this === t.target && (i = !0)
                    });
                    if (!i) return !1
                }
                return this.currentItem = r, this._removeCurrentsFromItems(), !0
            },
            _mouseStart: function(t, n, r) {
                var i, s, o = this.options;
                this.currentContainer = this, this.refreshPositions(), this.helper = this._createHelper(t), this._cacheHelperProportions(), this._cacheMargins(), this.scrollParent = this.helper.scrollParent(), this.offset = this.currentItem.offset(), this.offset = {
                    top: this.offset.top - this.margins.top,
                    left: this.offset.left - this.margins.left
                }, e.extend(this.offset, {
                    click: {
                        left: t.pageX - this.offset.left,
                        top: t.pageY - this.offset.top
                    },
                    parent: this._getParentOffset(),
                    relative: this._getRelativeOffset()
                }), this.helper.css("position", "absolute"), this.cssPosition = this.helper.css("position"), this.originalPosition = this._generatePosition(t), this.originalPageX = t.pageX, this.originalPageY = t.pageY, o.cursorAt && this._adjustOffsetFromHelper(o.cursorAt), this.domPosition = {
                    prev: this.currentItem.prev()[0],
                    parent: this.currentItem.parent()[0]
                }, this.helper[0] !== this.currentItem[0] && this.currentItem.hide(), this._createPlaceholder(), o.containment && this._setContainment(), o.cursor && o.cursor !== "auto" && (s = this.document.find("body"), this.storedCursor = s.css("cursor"), s.css("cursor", o.cursor), this.storedStylesheet = e("<style>*{ cursor: " + o.cursor + " !important; }</style>").appendTo(s)), o.opacity && (this.helper.css("opacity") && (this._storedOpacity = this.helper.css("opacity")), this.helper.css("opacity", o.opacity)), o.zIndex && (this.helper.css("zIndex") && (this._storedZIndex = this.helper.css("zIndex")), this.helper.css("zIndex", o.zIndex)), this.scrollParent[0] !== document && this.scrollParent[0].tagName !== "HTML" && (this.overflowOffset = this.scrollParent.offset()), this._trigger("start", t, this._uiHash()), this._preserveHelperProportions || this._cacheHelperProportions();
                if (!r)
                    for (i = this.containers.length - 1; i >= 0; i--) this.containers[i]._trigger("activate", t, this._uiHash(this));
                return e.ui.ddmanager && (e.ui.ddmanager.current = this), e.ui.ddmanager && !o.dropBehaviour && e.ui.ddmanager.prepareOffsets(this, t), this.dragging = !0, this.helper.addClass("ui-sortable-helper"), this._mouseDrag(t), !0
            },
            _mouseDrag: function(t) {
                var n, r, i, s, o = this.options,
                    u = !1;
                this.position = this._generatePosition(t), this.positionAbs = this._convertPositionTo("absolute"), this.lastPositionAbs || (this.lastPositionAbs = this.positionAbs), this.options.scroll && (this.scrollParent[0] !== document && this.scrollParent[0].tagName !== "HTML" ? (this.overflowOffset.top + this.scrollParent[0].offsetHeight - t.pageY < o.scrollSensitivity ? this.scrollParent[0].scrollTop = u = this.scrollParent[0].scrollTop + o.scrollSpeed : t.pageY - this.overflowOffset.top < o.scrollSensitivity && (this.scrollParent[0].scrollTop = u = this.scrollParent[0].scrollTop - o.scrollSpeed), this.overflowOffset.left + this.scrollParent[0].offsetWidth - t.pageX < o.scrollSensitivity ? this.scrollParent[0].scrollLeft = u = this.scrollParent[0].scrollLeft + o.scrollSpeed : t.pageX - this.overflowOffset.left < o.scrollSensitivity && (this.scrollParent[0].scrollLeft = u = this.scrollParent[0].scrollLeft - o.scrollSpeed)) : (t.pageY - e(document).scrollTop() < o.scrollSensitivity ? u = e(document).scrollTop(e(document).scrollTop() - o.scrollSpeed) : e(window).height() - (t.pageY - e(document).scrollTop()) < o.scrollSensitivity && (u = e(document).scrollTop(e(document).scrollTop() + o.scrollSpeed)), t.pageX - e(document).scrollLeft() < o.scrollSensitivity ? u = e(document).scrollLeft(e(document).scrollLeft() - o.scrollSpeed) : e(window).width() - (t.pageX - e(document).scrollLeft()) < o.scrollSensitivity && (u = e(document).scrollLeft(e(document).scrollLeft() + o.scrollSpeed))), u !== !1 && e.ui.ddmanager && !o.dropBehaviour && e.ui.ddmanager.prepareOffsets(this, t)), this.positionAbs = this._convertPositionTo("absolute");
                if (!this.options.axis || this.options.axis !== "y") this.helper[0].style.left = this.position.left + "px";
                if (!this.options.axis || this.options.axis !== "x") this.helper[0].style.top = this.position.top + "px";
                for (n = this.items.length - 1; n >= 0; n--) {
                    r = this.items[n], i = r.item[0], s = this._intersectsWithPointer(r);
                    if (!s) continue;
                    if (r.instance !== this.currentContainer) continue;
                    if (i !== this.currentItem[0] && this.placeholder[s === 1 ? "next" : "prev"]()[0] !== i && !e.contains(this.placeholder[0], i) && (this.options.type === "semi-dynamic" ? !e.contains(this.element[0], i) : !0)) {
                        this.direction = s === 1 ? "down" : "up";
                        if (this.options.tolerance !== "pointer" && !this._intersectsWithSides(r)) break;
                        this._rearrange(t, r), this._trigger("change", t, this._uiHash());
                        break
                    }
                }
                return this._contactContainers(t), e.ui.ddmanager && e.ui.ddmanager.drag(this, t), this._trigger("sort", t, this._uiHash()), this.lastPositionAbs = this.positionAbs, !1
            },
            _mouseStop: function(t, n) {
                if (!t) return;
                e.ui.ddmanager && !this.options.dropBehaviour && e.ui.ddmanager.drop(this, t);
                if (this.options.revert) {
                    var r = this,
                        i = this.placeholder.offset(),
                        s = this.options.axis,
                        o = {};
                    if (!s || s === "x") o.left = i.left - this.offset.parent.left - this.margins.left + (this.offsetParent[0] === document.body ? 0 : this.offsetParent[0].scrollLeft);
                    if (!s || s === "y") o.top = i.top - this.offset.parent.top - this.margins.top + (this.offsetParent[0] === document.body ? 0 : this.offsetParent[0].scrollTop);
                    this.reverting = !0, e(this.helper).animate(o, parseInt(this.options.revert, 10) || 500, function() {
                        r._clear(t)
                    })
                } else this._clear(t, n);
                return !1
            },
            cancel: function() {
                if (this.dragging) {
                    this._mouseUp({
                        target: null
                    }), this.options.helper === "original" ? this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper") : this.currentItem.show();
                    for (var t = this.containers.length - 1; t >= 0; t--) this.containers[t]._trigger("deactivate", null, this._uiHash(this)), this.containers[t].containerCache.over && (this.containers[t]._trigger("out", null, this._uiHash(this)), this.containers[t].containerCache.over = 0)
                }
                return this.placeholder && (this.placeholder[0].parentNode && this.placeholder[0].parentNode.removeChild(this.placeholder[0]), this.options.helper !== "original" && this.helper && this.helper[0].parentNode && this.helper.remove(), e.extend(this, {
                    helper: null,
                    dragging: !1,
                    reverting: !1,
                    _noFinalSort: null
                }), this.domPosition.prev ? e(this.domPosition.prev).after(this.currentItem) : e(this.domPosition.parent).prepend(this.currentItem)), this
            },
            serialize: function(t) {
                var n = this._getItemsAsjQuery(t && t.connected),
                    r = [];
                return t = t || {}, e(n).each(function() {
                    var n = (e(t.item || this).attr(t.attribute || "id") || "").match(t.expression || /(.+)[\-=_](.+)/);
                    n && r.push((t.key || n[1] + "[]") + "=" + (t.key && t.expression ? n[1] : n[2]))
                }), !r.length && t.key && r.push(t.key + "="), r.join("&")
            },
            toArray: function(t) {
                var n = this._getItemsAsjQuery(t && t.connected),
                    r = [];
                return t = t || {}, n.each(function() {
                    r.push(e(t.item || this).attr(t.attribute || "id") || "")
                }), r
            },
            _intersectsWith: function(e) {
                var t = this.positionAbs.left,
                    n = t + this.helperProportions.width,
                    r = this.positionAbs.top,
                    i = r + this.helperProportions.height,
                    s = e.left,
                    o = s + e.width,
                    u = e.top,
                    a = u + e.height,
                    f = this.offset.click.top,
                    l = this.offset.click.left,
                    c = this.options.axis === "x" || r + f > u && r + f < a,
                    h = this.options.axis === "y" || t + l > s && t + l < o,
                    p = c && h;
                return this.options.tolerance === "pointer" || this.options.forcePointerForContainers || this.options.tolerance !== "pointer" && this.helperProportions[this.floating ? "width" : "height"] > e[this.floating ? "width" : "height"] ? p : s < t + this.helperProportions.width / 2 && n - this.helperProportions.width / 2 < o && u < r + this.helperProportions.height / 2 && i - this.helperProportions.height / 2 < a
            },
            _intersectsWithPointer: function(e) {
                var t = this.options.axis === "x" || n(this.positionAbs.top + this.offset.click.top, e.top, e.height),
                    r = this.options.axis === "y" || n(this.positionAbs.left + this.offset.click.left, e.left, e.width),
                    i = t && r,
                    s = this._getDragVerticalDirection(),
                    o = this._getDragHorizontalDirection();
                return i ? this.floating ? o && o === "right" || s === "down" ? 2 : 1 : s && (s === "down" ? 2 : 1) : !1
            },
            _intersectsWithSides: function(e) {
                var t = n(this.positionAbs.top + this.offset.click.top, e.top + e.height / 2, e.height),
                    r = n(this.positionAbs.left + this.offset.click.left, e.left + e.width / 2, e.width),
                    i = this._getDragVerticalDirection(),
                    s = this._getDragHorizontalDirection();
                return this.floating && s ? s === "right" && r || s === "left" && !r : i && (i === "down" && t || i === "up" && !t)
            },
            _getDragVerticalDirection: function() {
                var e = this.positionAbs.top - this.lastPositionAbs.top;
                return e !== 0 && (e > 0 ? "down" : "up")
            },
            _getDragHorizontalDirection: function() {
                var e = this.positionAbs.left - this.lastPositionAbs.left;
                return e !== 0 && (e > 0 ? "right" : "left")
            },
            refresh: function(e) {
                return this._refreshItems(e), this.refreshPositions(), this
            },
            _connectWith: function() {
                var e = this.options;
                return e.connectWith.constructor === String ? [e.connectWith] : e.connectWith
            },
            _getItemsAsjQuery: function(t) {
                var n, r, i, s, o = [],
                    u = [],
                    a = this._connectWith();
                if (a && t)
                    for (n = a.length - 1; n >= 0; n--) {
                        i = e(a[n]);
                        for (r = i.length - 1; r >= 0; r--) s = e.data(i[r], this.widgetFullName), s && s !== this && !s.options.disabled && u.push([e.isFunction(s.options.items) ? s.options.items.call(s.element) : e(s.options.items, s.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"), s])
                    }
                u.push([e.isFunction(this.options.items) ? this.options.items.call(this.element, null, {
                    options: this.options,
                    item: this.currentItem
                }) : e(this.options.items, this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"), this]);
                for (n = u.length - 1; n >= 0; n--) u[n][0].each(function() {
                    o.push(this)
                });
                return e(o)
            },
            _removeCurrentsFromItems: function() {
                var t = this.currentItem.find(":data(" + this.widgetName + "-item)");
                this.items = e.grep(this.items, function(e) {
                    for (var n = 0; n < t.length; n++)
                        if (t[n] === e.item[0]) return !1;
                    return !0
                })
            },
            _refreshItems: function(t) {
                this.items = [], this.containers = [this];
                var n, r, i, s, o, u, a, f, l = this.items,
                    c = [
                        [e.isFunction(this.options.items) ? this.options.items.call(this.element[0], t, {
                            item: this.currentItem
                        }) : e(this.options.items, this.element), this]
                    ],
                    h = this._connectWith();
                if (h && this.ready)
                    for (n = h.length - 1; n >= 0; n--) {
                        i = e(h[n]);
                        for (r = i.length - 1; r >= 0; r--) s = e.data(i[r], this.widgetFullName), s && s !== this && !s.options.disabled && (c.push([e.isFunction(s.options.items) ? s.options.items.call(s.element[0], t, {
                            item: this.currentItem
                        }) : e(s.options.items, s.element), s]), this.containers.push(s))
                    }
                for (n = c.length - 1; n >= 0; n--) {
                    o = c[n][1], u = c[n][0];
                    for (r = 0, f = u.length; r < f; r++) a = e(u[r]), a.data(this.widgetName + "-item", o), l.push({
                        item: a,
                        instance: o,
                        width: 0,
                        height: 0,
                        left: 0,
                        top: 0
                    })
                }
            },
            refreshPositions: function(t) {
                this.offsetParent && this.helper && (this.offset.parent = this._getParentOffset());
                var n, r, i, s;
                for (n = this.items.length - 1; n >= 0; n--) {
                    r = this.items[n];
                    if (r.instance !== this.currentContainer && this.currentContainer && r.item[0] !== this.currentItem[0]) continue;
                    i = this.options.toleranceElement ? e(this.options.toleranceElement, r.item) : r.item, t || (r.width = i.outerWidth(), r.height = i.outerHeight()), s = i.offset(), r.left = s.left, r.top = s.top
                }
                if (this.options.custom && this.options.custom.refreshContainers) this.options.custom.refreshContainers.call(this);
                else
                    for (n = this.containers.length - 1; n >= 0; n--) s = this.containers[n].element.offset(), this.containers[n].containerCache.left = s.left, this.containers[n].containerCache.top = s.top, this.containers[n].containerCache.width = this.containers[n].element.outerWidth(), this.containers[n].containerCache.height = this.containers[n].element.outerHeight();
                return this
            },
            _createPlaceholder: function(t) {
                t = t || this;
                var n, r = t.options;
                if (!r.placeholder || r.placeholder.constructor === String) n = r.placeholder, r.placeholder = {
                    element: function() {
                        var r = t.currentItem[0].nodeName.toLowerCase(),
                            i = e("<" + r + ">", t.document[0]).addClass(n || t.currentItem[0].className + " ui-sortable-placeholder").removeClass("ui-sortable-helper");
                        return r === "tr" ? t.currentItem.children().each(function() {
                            e("<td>&#160;</td>", t.document[0]).attr("colspan", e(this).attr("colspan") || 1).appendTo(i)
                        }) : r === "img" && i.attr("src", t.currentItem.attr("src")), n || i.css("visibility", "hidden"), i
                    },
                    update: function(e, i) {
                        if (n && !r.forcePlaceholderSize) return;
                        i.height() || i.height(t.currentItem.innerHeight() - parseInt(t.currentItem.css("paddingTop") || 0, 10) - parseInt(t.currentItem.css("paddingBottom") || 0, 10)), i.width() || i.width(t.currentItem.innerWidth() - parseInt(t.currentItem.css("paddingLeft") || 0, 10) - parseInt(t.currentItem.css("paddingRight") || 0, 10))
                    }
                };
                t.placeholder = e(r.placeholder.element.call(t.element, t.currentItem)), t.currentItem.after(t.placeholder), r.placeholder.update(t, t.placeholder)
            },
            _contactContainers: function(t) {
                var i, s, o, u, a, f, l, c, h, p, d = null,
                    v = null;
                for (i = this.containers.length - 1; i >= 0; i--) {
                    if (e.contains(this.currentItem[0], this.containers[i].element[0])) continue;
                    if (this._intersectsWith(this.containers[i].containerCache)) {
                        if (d && e.contains(this.containers[i].element[0], d.element[0])) continue;
                        d = this.containers[i], v = i
                    } else this.containers[i].containerCache.over && (this.containers[i]._trigger("out", t, this._uiHash(this)), this.containers[i].containerCache.over = 0)
                }
                if (!d) return;
                if (this.containers.length === 1) this.containers[v].containerCache.over || (this.containers[v]._trigger("over", t, this._uiHash(this)), this.containers[v].containerCache.over = 1);
                else {
                    o = 1e4, u = null, p = d.floating || r(this.currentItem), a = p ? "left" : "top", f = p ? "width" : "height", l = this.positionAbs[a] + this.offset.click[a];
                    for (s = this.items.length - 1; s >= 0; s--) {
                        if (!e.contains(this.containers[v].element[0], this.items[s].item[0])) continue;
                        if (this.items[s].item[0] === this.currentItem[0]) continue;
                        if (p && !n(this.positionAbs.top + this.offset.click.top, this.items[s].top, this.items[s].height)) continue;
                        c = this.items[s].item.offset()[a], h = !1, Math.abs(c - l) > Math.abs(c + this.items[s][f] - l) && (h = !0, c += this.items[s][f]), Math.abs(c - l) < o && (o = Math.abs(c - l), u = this.items[s], this.direction = h ? "up" : "down")
                    }
                    if (!u && !this.options.dropOnEmpty) return;
                    if (this.currentContainer === this.containers[v]) return;
                    u ? this._rearrange(t, u, null, !0) : this._rearrange(t, null, this.containers[v].element, !0), this._trigger("change", t, this._uiHash()), this.containers[v]._trigger("change", t, this._uiHash(this)), this.currentContainer = this.containers[v], this.options.placeholder.update(this.currentContainer, this.placeholder), this.containers[v]._trigger("over", t, this._uiHash(this)), this.containers[v].containerCache.over = 1
                }
            },
            _createHelper: function(t) {
                var n = this.options,
                    r = e.isFunction(n.helper) ? e(n.helper.apply(this.element[0], [t, this.currentItem])) : n.helper === "clone" ? this.currentItem.clone() : this.currentItem;
                return r.parents("body").length || e(n.appendTo !== "parent" ? n.appendTo : this.currentItem[0].parentNode)[0].appendChild(r[0]), r[0] === this.currentItem[0] && (this._storedCSS = {
                    width: this.currentItem[0].style.width,
                    height: this.currentItem[0].style.height,
                    position: this.currentItem.css("position"),
                    top: this.currentItem.css("top"),
                    left: this.currentItem.css("left")
                }), (!r[0].style.width || n.forceHelperSize) && r.width(this.currentItem.width()), (!r[0].style.height || n.forceHelperSize) && r.height(this.currentItem.height()), r
            },
            _adjustOffsetFromHelper: function(t) {
                typeof t == "string" && (t = t.split(" ")), e.isArray(t) && (t = {
                    left: +t[0],
                    top: +t[1] || 0
                }), "left" in t && (this.offset.click.left = t.left + this.margins.left), "right" in t && (this.offset.click.left = this.helperProportions.width - t.right + this.margins.left), "top" in t && (this.offset.click.top = t.top + this.margins.top), "bottom" in t && (this.offset.click.top = this.helperProportions.height - t.bottom + this.margins.top)
            },
            _getParentOffset: function() {
                this.offsetParent = this.helper.offsetParent();
                var t = this.offsetParent.offset();
                this.cssPosition === "absolute" && this.scrollParent[0] !== document && e.contains(this.scrollParent[0], this.offsetParent[0]) && (t.left += this.scrollParent.scrollLeft(), t.top += this.scrollParent.scrollTop());
                if (this.offsetParent[0] === document.body || this.offsetParent[0].tagName && this.offsetParent[0].tagName.toLowerCase() === "html" && e.ui.ie) t = {
                    top: 0,
                    left: 0
                };
                return {
                    top: t.top + (parseInt(this.offsetParent.css("borderTopWidth"), 10) || 0),
                    left: t.left + (parseInt(this.offsetParent.css("borderLeftWidth"), 10) || 0)
                }
            },
            _getRelativeOffset: function() {
                if (this.cssPosition === "relative") {
                    var e = this.currentItem.position();
                    return {
                        top: e.top - (parseInt(this.helper.css("top"), 10) || 0) + this.scrollParent.scrollTop(),
                        left: e.left - (parseInt(this.helper.css("left"), 10) || 0) + this.scrollParent.scrollLeft()
                    }
                }
                return {
                    top: 0,
                    left: 0
                }
            },
            _cacheMargins: function() {
                this.margins = {
                    left: parseInt(this.currentItem.css("marginLeft"), 10) || 0,
                    top: parseInt(this.currentItem.css("marginTop"), 10) || 0
                }
            },
            _cacheHelperProportions: function() {
                this.helperProportions = {
                    width: this.helper.outerWidth(),
                    height: this.helper.outerHeight()
                }
            },
            _setContainment: function() {
                var t, n, r, i = this.options;
                i.containment === "parent" && (i.containment = this.helper[0].parentNode);
                if (i.containment === "document" || i.containment === "window") this.containment = [0 - this.offset.relative.left - this.offset.parent.left, 0 - this.offset.relative.top - this.offset.parent.top, e(i.containment === "document" ? document : window).width() - this.helperProportions.width - this.margins.left, (e(i.containment === "document" ? document : window).height() || document.body.parentNode.scrollHeight) - this.helperProportions.height - this.margins.top];
                /^(document|window|parent)$/.test(i.containment) || (t = e(i.containment)[0], n = e(i.containment).offset(), r = e(t).css("overflow") !== "hidden", this.containment = [n.left + (parseInt(e(t).css("borderLeftWidth"), 10) || 0) + (parseInt(e(t).css("paddingLeft"), 10) || 0) - this.margins.left, n.top + (parseInt(e(t).css("borderTopWidth"), 10) || 0) + (parseInt(e(t).css("paddingTop"), 10) || 0) - this.margins.top, n.left + (r ? Math.max(t.scrollWidth, t.offsetWidth) : t.offsetWidth) - (parseInt(e(t).css("borderLeftWidth"), 10) || 0) - (parseInt(e(t).css("paddingRight"), 10) || 0) - this.helperProportions.width - this.margins.left, n.top + (r ? Math.max(t.scrollHeight, t.offsetHeight) : t.offsetHeight) - (parseInt(e(t).css("borderTopWidth"), 10) || 0) - (parseInt(e(t).css("paddingBottom"), 10) || 0) - this.helperProportions.height - this.margins.top])
            },
            _convertPositionTo: function(t, n) {
                n || (n = this.position);
                var r = t === "absolute" ? 1 : -1,
                    i = this.cssPosition !== "absolute" || this.scrollParent[0] !== document && !!e.contains(this.scrollParent[0], this.offsetParent[0]) ? this.scrollParent : this.offsetParent,
                    s = /(html|body)/i.test(i[0].tagName);
                return {
                    top: n.top + this.offset.relative.top * r + this.offset.parent.top * r - (this.cssPosition === "fixed" ? -this.scrollParent.scrollTop() : s ? 0 : i.scrollTop()) * r,
                    left: n.left + this.offset.relative.left * r + this.offset.parent.left * r - (this.cssPosition === "fixed" ? -this.scrollParent.scrollLeft() : s ? 0 : i.scrollLeft()) * r
                }
            },
            _generatePosition: function(t) {
                var n, r, i = this.options,
                    s = t.pageX,
                    o = t.pageY,
                    u = this.cssPosition !== "absolute" || this.scrollParent[0] !== document && !!e.contains(this.scrollParent[0], this.offsetParent[0]) ? this.scrollParent : this.offsetParent,
                    a = /(html|body)/i.test(u[0].tagName);
                return this.cssPosition === "relative" && (this.scrollParent[0] === document || this.scrollParent[0] === this.offsetParent[0]) && (this.offset.relative = this._getRelativeOffset()), this.originalPosition && (this.containment && (t.pageX - this.offset.click.left < this.containment[0] && (s = this.containment[0] + this.offset.click.left), t.pageY - this.offset.click.top < this.containment[1] && (o = this.containment[1] + this.offset.click.top), t.pageX - this.offset.click.left > this.containment[2] && (s = this.containment[2] + this.offset.click.left), t.pageY - this.offset.click.top > this.containment[3] && (o = this.containment[3] + this.offset.click.top)), i.grid && (n = this.originalPageY + Math.round((o - this.originalPageY) / i.grid[1]) * i.grid[1], o = this.containment ? n - this.offset.click.top >= this.containment[1] && n - this.offset.click.top <= this.containment[3] ? n : n - this.offset.click.top >= this.containment[1] ? n - i.grid[1] : n + i.grid[1] : n, r = this.originalPageX + Math.round((s - this.originalPageX) / i.grid[0]) * i.grid[0], s = this.containment ? r - this.offset.click.left >= this.containment[0] && r - this.offset.click.left <= this.containment[2] ? r : r - this.offset.click.left >= this.containment[0] ? r - i.grid[0] : r + i.grid[0] : r)), {
                    top: o - this.offset.click.top - this.offset.relative.top - this.offset.parent.top + (this.cssPosition === "fixed" ? -this.scrollParent.scrollTop() : a ? 0 : u.scrollTop()),
                    left: s - this.offset.click.left - this.offset.relative.left - this.offset.parent.left + (this.cssPosition === "fixed" ? -this.scrollParent.scrollLeft() : a ? 0 : u.scrollLeft())
                }
            },
            _rearrange: function(e, t, n, r) {
                n ? n[0].appendChild(this.placeholder[0]) : t.item[0].parentNode.insertBefore(this.placeholder[0], this.direction === "down" ? t.item[0] : t.item[0].nextSibling), this.counter = this.counter ? ++this.counter : 1;
                var i = this.counter;
                this._delay(function() {
                    i === this.counter && this.refreshPositions(!r)
                })
            },
            _clear: function(e, t) {
                this.reverting = !1;
                var n, r = [];
                !this._noFinalSort && this.currentItem.parent().length && this.placeholder.before(this.currentItem), this._noFinalSort = null;
                if (this.helper[0] === this.currentItem[0]) {
                    for (n in this._storedCSS)
                        if (this._storedCSS[n] === "auto" || this._storedCSS[n] === "static") this._storedCSS[n] = "";
                    this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")
                } else this.currentItem.show();
                this.fromOutside && !t && r.push(function(e) {
                    this._trigger("receive", e, this._uiHash(this.fromOutside))
                }), (this.fromOutside || this.domPosition.prev !== this.currentItem.prev().not(".ui-sortable-helper")[0] || this.domPosition.parent !== this.currentItem.parent()[0]) && !t && r.push(function(e) {
                    this._trigger("update", e, this._uiHash())
                }), this !== this.currentContainer && (t || (r.push(function(e) {
                    this._trigger("remove", e, this._uiHash())
                }), r.push(function(e) {
                    return function(t) {
                        e._trigger("receive", t, this._uiHash(this))
                    }
                }.call(this, this.currentContainer)), r.push(function(e) {
                    return function(t) {
                        e._trigger("update", t, this._uiHash(this))
                    }
                }.call(this, this.currentContainer))));
                for (n = this.containers.length - 1; n >= 0; n--) t || r.push(function(e) {
                    return function(t) {
                        e._trigger("deactivate", t, this._uiHash(this))
                    }
                }.call(this, this.containers[n])), this.containers[n].containerCache.over && (r.push(function(e) {
                    return function(t) {
                        e._trigger("out", t, this._uiHash(this))
                    }
                }.call(this, this.containers[n])), this.containers[n].containerCache.over = 0);
                this.storedCursor && (this.document.find("body").css("cursor", this.storedCursor), this.storedStylesheet.remove()), this._storedOpacity && this.helper.css("opacity", this._storedOpacity), this._storedZIndex && this.helper.css("zIndex", this._storedZIndex === "auto" ? "" : this._storedZIndex), this.dragging = !1;
                if (this.cancelHelperRemoval) {
                    if (!t) {
                        this._trigger("beforeStop", e, this._uiHash());
                        for (n = 0; n < r.length; n++) r[n].call(this, e);
                        this._trigger("stop", e, this._uiHash())
                    }
                    return this.fromOutside = !1, !1
                }
                t || this._trigger("beforeStop", e, this._uiHash()), this.placeholder[0].parentNode.removeChild(this.placeholder[0]), this.helper[0] !== this.currentItem[0] && this.helper.remove(), this.helper = null;
                if (!t) {
                    for (n = 0; n < r.length; n++) r[n].call(this, e);
                    this._trigger("stop", e, this._uiHash())
                }
                return this.fromOutside = !1, !0
            },
            _trigger: function() {
                e.Widget.prototype._trigger.apply(this, arguments) === !1 && this.cancel()
            },
            _uiHash: function(t) {
                var n = t || this;
                return {
                    helper: n.helper,
                    placeholder: n.placeholder || e([]),
                    position: n.position,
                    originalPosition: n.originalPosition,
                    offset: n.positionAbs,
                    item: n.currentItem,
                    sender: t ? t.element : null
                }
            }
        })
    }(jQuery), define("Libs/jQuery/UI", ["Libs/jQuery/UI/jquery-ui-1.10.3.custom"], function(e) {
        return e
    }), define("Libs/jQuery/UI/jquery-ui-1.10.3.custom", function() {}), define("Form/Components/Photos", ["Form/Component", "UI/Dialog/Views/Default", "jquery.fileupload", "jquery.fileupload-image", "jquery.fileupload-process", "Libs/jQuery/UI"], function(e, t) {
        var n = e.extend({
            defaults: {
                title: "Фотографии"
            },
            defaultOptions: {
                url: "/api/upload",
                limitConcurrentUploads: 1,
                disableImageResize: /Android(?!.*Chrome)|Opera/.test(window.navigator && navigator.userAgent),
                imageMaxWidth: 1e3,
                imageMaxHeight: 1e3
            },
            initialize: function(e) {
                _.bindAll(this), this.options = _.extend(_.clone(this.defaults), e), this.render()
            },
            onClose: function() {
                this.$el.find("#fileupload1").fileupload("destroy"), $("#fileupload2").fileupload("destroy")
            },
            render: function() {
                return this.$el.append(this.template()), this.$el.addClass("photos-component"), this.showAddButton(), this.defaultOptions.done = this.onDone, this.$el.find("#fileupload1").fileupload(this.defaultOptions).on("fileuploadadd", this.onAdd), $("#fileupload2").fileupload(this.defaultOptions).on("fileuploadadd", this.onAdd), this
            },
            GetValue: function() {
                var e = {};
                this.namespace && (e[this.namespace] = {});
                var t = this.namespace ? e[this.namespace] : e;
                return t.photo = _.map(this.$el.find(".preview:not(.waiting)"), function(e) {
                    return $(e).find("img").attr("data-name")
                }), e
            },
            onAdd: function(e, t) {
                for (var n = 0; n < t.files.length; n++) this.appendPreview().find("span").click(function() {
                    $(this).parent().remove()
                })
            },
            onDone: function(e, t) {
                t.result.length > 0 && (_.each(t.result, function(e) {
                    var t = this.$el.find(".preview.waiting:first");
                    return e.error ? (t.remove(), this.uploadError(e.error)) : (t.removeClass("waiting"), t.find("div").append("<img>").find("img").attr("src", e.thumbnail_url).attr("data-name", e.name), t.find("span").unbind("click").click(function() {
                        $.ajax({
                            type: "DELETE",
                            url: "/api/upload/" + e.name
                        }), $(this).parent().remove()
                    }), null)
                }, this), this.sortable())
            },
            uploadError: function(e) {
                this.dialog && this.dialog.close(), e == "Filetype not allowed" && (e = "Неподдерживаемый тип файла"), this.dialog = new t({
                    content: e
                })
            },
            sortable: function() {
                this.$el.find(".add-photos-previews").sortable({
                    items: ".preview"
                })
            },
            showAddButton: function() {
                this.$el.find(".add-photos-previews").append(this.addButtonTemplate())
            },
            appendPreview: function() {
                return $(this.previewTemplate()).insertBefore(this.$el.find(".add-button"))
            },
            addButtonTemplate: function() {
                return '<div class="add-button">                        <input id="fileupload1" type="file" name="files[]" accept="image/jpeg" multiple>                        <div>загрузить фото</div>                    </div>'
            },
            previewTemplate: function() {
                return '<div class="preview waiting"><div></div><span><i class="b-i"></i>удалить</span></div>'
            },
            template: function() {
                return '            <div class="add-photos-title">' + this.options.title + '</div>            <div class="add-photos-previews"></div>            '
            }
        });
        return n
    }), define("Base/Payment/Views/Window", ["backbone", "Shared/Abstract/View", "UI/Dialog/Views/Default"], function(e, t, n) {
        var r = t.extend({
            initialize: function() {
                _.bindAll(this)
            },
            Base: function() {
                if (!window.Auth.get("uid")) {
                    window.ContainerView.ShowAuthWindow();
                    return
                }
                this.choosePeriodWindow({}).on("month", this.basePayForMonth).on("24hr", this.basePayFor24hr)
            },
            basePayForMonth: function() {
                var e = _.template(this.payMethodTemplate(), {
                        title: "Оплата сервиса «База» на один месяц ( 120 грн )",
                        service: "base",
                        period: "month",
                        sms: !1,
                        p24: !0,
                        bank: !0,
                        card: !0,
                        smsDescription: null,
                        p24Description: null,
                        bankDescription: null,
                        cardDescription: null
                    }),
                    t = (new n({
                        content: e,
                        controls: [],
                        containerCss: {
                            width: 421
                        },
                        contentCss: {
                            padding: 0
                        }
                    })).on("click", this.basePayMethodClickHandler).on("close", this.Base);
                this.appendSubview(t)
            },
            basePayFor24hr: function() {
                var e = _.template(this.payMethodTemplate(), {
                        title: "Оплата сервиса «База» на 24 часа ( 10 грн )",
                        service: "base",
                        period: "24hr",
                        sms: !0,
                        p24: !0,
                        bank: !1,
                        card: !0,
                        smsDescription: null,
                        p24Description: null,
                        bankDescription: null,
                        cardDescription: null
                    }),
                    t = (new n({
                        content: e,
                        controls: [],
                        containerCss: {
                            width: 421
                        },
                        contentCss: {
                            padding: 0
                        }
                    })).on("click", this.basePayMethodClickHandler).on("close", this.Base);
                this.appendSubview(t)
            },
            basePayMethodClickHandler: function(e, t) {
                var n = t.parents(".pay-method").attr("data-method") || t.attr("data-method"),
                    r = e.$el.find("#service").val(),
                    i = e.$el.find("#period").val();
                if (!n || !r || !i) return;
                n == "bank" && this.bankMethod({
                    service: r,
                    period: i
                }), n == "mobile" && this.mobileMethod({
                    title: "Оплата сервиса «База» на 24 часа",
                    prefix: "БАЗА",
                    number: 2442,
                    sum: "10.00",
                    phone: window.User.phone.replace(/(\d{3})(\d{2})(\d{3})(\d{2})(\d{2})/, "+$1 $2 $3-$4-$5")
                }), n == "p24" && this.p24Method({
                    service: r,
                    period: i
                }), n == "card" && this.cardMethod({
                    service: r,
                    period: i,
                    title: "Оплата сервиса «База» на 1 месяц",
                    info: "Стоимость подключения к сервису База на 1                            месяц — 120,00 грн. Оплата за подключение к сервису возврату не подлежит."
                }), e.hide({
                    silent: !0
                })
            },
            Exclusive: function() {
                if (!window.Auth.get("uid")) {
                    window.ContainerView.ShowAuthWindow();
                    return
                }
                var e = _.template(this.payMethodTemplate(), {
                        service: "exclusive",
                        period: "",
                        title: "Оплата услуги «Эксклюзив»",
                        sms: !0,
                        p24: !0,
                        bank: !0,
                        card: !0,
                        smsDescription: "<span>5</span> грн. — <span>1</span> эксклюзив",
                        p24Description: "<span>20</span> грн. — <span>4</span> эксклюзива",
                        bankDescription: "<span>20</span> грн. — <span>4</span> эксклюзива",
                        cardDescription: "<span>20</span> грн. — <span>4</span> эксклюзива"
                    }),
                    t = (new n({
                        content: e,
                        controls: [],
                        containerCss: {
                            width: 421
                        },
                        contentCss: {
                            padding: 0
                        }
                    })).on("click", this.exclusivePayMethodClickHandler).on("close", function() {
                        window.Router.navigate("/base-/", !0)
                    });
                t.$el.find(".pay [data-method=mobile]").detach().insertAfter(t.$el.find(".pay .pay-titles")), this.appendSubview(t)
            },
            chooseCountWindow: function(e) {
                var t = _.template(this.chooseCountWindowTpl(), {
                        title: "Оплата сервиса «ыэкус»",
                        price1: 5,
                        price4: 20,
                        price8: 40
                    }),
                    r = new n({
                        content: t,
                        controls: [],
                        containerCss: {
                            width: 480
                        },
                        contentCss: {
                            padding: 0
                        }
                    });
                return r.on("click", function(e, t) {
                    var n = t.parents(".pay-period").attr("data-period") || t.attr("data-period");
                    if (!n) return;
                    this.trigger(n), e.close()
                }), this.appendSubview(r), r
            },
            choosePeriodWindow: function(e) {
                var t = _.template(this.choosePeriodWindowTpl(), {
                        title: "Оплата сервиса «База»",
                        priceMonth: 120,
                        price24hr: 10
                    }),
                    r = new n({
                        content: t,
                        controls: [],
                        containerCss: {
                            width: 420
                        },
                        contentCss: {
                            padding: 0
                        }
                    });
                return r.on("click", function(e, t) {
                    var n = t.parents(".pay-period").attr("data-period") || t.attr("data-period");
                    if (!n) return;
                    this.trigger(n), e.close()
                }), this.appendSubview(r), r
            },
            exclusivePayMethodClickHandler: function(e, t) {
                var n = t.parents(".pay-method").attr("data-method") || t.attr("data-method");
                if (!n) return;
                n == "bank" && (this.bankMethod({
                    service: "exclusive",
                    count: 4
                }), window.Router.navigate("/base-/", !0)), n == "mobile" && this.mobileMethod({
                    title: "Оплата услуги «Эксклюзив»",
                    number: 4422,
                    sum: "5.00",
                    prefix: "ЭКСК",
                    phone: window.User.phone.replace(/(\d{3})(\d{2})(\d{3})(\d{2})(\d{2})/, "+$1 $2 $3-$4-$5"),
                    onClose: function() {
                        window.Router.navigate("/base-/", !0)
                    }
                }), n == "p24" && this.p24Method({
                    service: "exclusive",
                    count: 4
                }), n == "card" && this.cardMethod({
                    service: "exclusive",
                    count: 4,
                    title: "Оплата услуги «Эксклюзив» (4 шт)",
                    info: "Стоимость размещения Эксклюзива — 5 грн.                                Стоимость заказа<br /> (4 шт х 5,00 грн.) — 20,00 грн.                                Оплата за заказ возврату не подлежит."
                }), e.hide({
                    silent: !0
                })
            },
            bankMethod: function(e) {
                this.invoiceHTML(e)
            },
            mobileMethod: function(e) {
                var t = this.smsMethodTemplate(e),
                    r = new n({
                        content: t,
                        controls: [],
                        containerCss: {
                            width: 421
                        },
                        contentCss: {
                            padding: 0
                        }
                    });
                _.isFunction(e.onClose) && r.on("close", e.onClose), this.appendSubview(r)
            },
            p24Method: function(e) {
                var t = "/route.php?payments.getP24Data[0][service]=" + e.service + "&payments.getP24Data[0][count]=" + e.count + "&payments.getP24Data[0][period]=" + e.period;
                $.get(t, function(e) {
                    e = $.parseJSON(e);
                    var t = $('                <form id="pay-form" method="post" action="https://api.privatbank.ua:9083/p24api/ishop">                <input type="text" name="amt" value="' + e.amt + '"/>                <input type="text" name="ccy" value="' + e.ccy + '" />                <input type="hidden" name="merchant" value="' + e.merchant + '" />                <input type="hidden" name="order" value="' + e.order + '" />                <input type="hidden" name="details" value="' + e.details + '" />                <input type="hidden" name="ext_details" value="' + e.ext_details + '" />                <input type="hidden" name="pay_way" value="' + e.pay_way + '" />                <input type="hidden" name="return_url" value="' + e.return_url + '" />                <input type="hidden" name="server_url" value="' + e.server_url + '" />                </form>');
                    t.appendTo("body"), t.submit(), t.remove()
                })
            },
            cardMethod: function(e) {
                var t = this,
                    r = "/route.php?payments.getAcquiringData[0][service]=" + e.service + "&payments.getAcquiringData[0][count]=" + e.count + "&payments.getAcquiringData[0][period]=" + e.period;
                $.get(r, function(r) {
                    var i = t.cardPayTemplate(r, e),
                        s = new n({
                            content: i,
                            controls: [],
                            containerCss: {
                                width: 421
                            },
                            contentCss: {
                                padding: 0
                            }
                        });
                    this.appendSubview(s)
                })
            },
            invoiceHTML: function(e) {
                var t = $('<form id="pay-form" method="post" target="_blank" action="/my/invoice.php">                   <input type="hidden" name="data" value=\'' + $.toJSON(e) + "' />                   </form>");
                t.appendTo("body"), t.submit(), t.remove()
            },
            payMethodTemplate: function() {
                return '            <div class="pay">                <input type="hidden" id="service" value="<%= service %>">                <input type="hidden" id="period" value="<%= period %>">                <div class="pay-block pay-titles">                    <div class="pay-text-1"><%= title %></div>                    <div class="pay-text-2">Выберите способ оплаты</div>                </div>                <% if (p24) { %>                <div class="pay-block pay-method" data-method="p24">                    <div class="pay-icon pay-p24"></div>                    <div class="pay-info">                        <div class="pay-text-3">Через Приват24</div>                        <div class="pay-text-4">Оплата через Приват24 <%= p24Description ? "( " + p24Description + " )" : "" %></div>                    </div>                </div>                <% } if (card) { %>                <div class="pay-block pay-method" data-method="card">                    <div class="pay-icon pay-card"></div>                    <div class="pay-info">                        <div class="pay-text-3">Банковской картой</div>                        <div class="pay-text-4">Visa или MasterCard <%= cardDescription ? "( " + cardDescription + " )" : "" %></div>                    </div>                </div>                <% } if (bank) { %>                <div class="pay-block pay-method" data-method="bank">                    <div class="pay-icon pay-bank"></div>                    <div class="pay-info">                        <div class="pay-text-3">В кассе банка</div>                        <div class="pay-text-4">Оплата по счету <%= bankDescription ? "( " + bankDescription + " )" : "" %></div>                    </div>                </div>                <% } if (sms) {%>                <div class="pay-block pay-method" data-method="mobile">                    <div class="pay-icon pay-mobile"></div>                    <div class="pay-info">                        <div class="pay-text-3">Через мобильный телефон</div>                        <div class="pay-text-4">Оплата через SMS <%= smsDescription ? "( " + smsDescription + " )" : "" %></div>                    </div>                </div>                <% } %>            </div>'
            },
            cardPayTemplate: function(e, t) {
                return '            <div class="pay">                <div class="pay-block pay-titles">                    <div class="pay-text-1">' + t.title + '</div>                    <div class="pay-text-2">С помощью карт платёжных систем Visa или MasterCard</div>                </div>                <div class="pay-block">                    <div class="pay-text-5">После нажатия кнопки <span>«Далее»</span>, Вы</div>                    <div class="pay-text-5">будете перенаправлены на страницу</div>                    <div class="pay-text-5">сервиса безопасных платежей нашего</div>                    <div class="pay-text-5">эквайрингового партнёра.</div>                </div>                <div class="pay-block pay-operator-info">                    <div class="pay-text-6">' + t.info + '                     Эквайринговый партёр ПАО КБ «ПриватБанк», лицензия НБУ № 22 от 05.10.2011                     г., телефон поддержки клиентов 0-800-500-003 (бесплатно по Украине с                     городских телефонов), адрес в сети Internet www.privatbank.ua.                    </div>                </div>                <div class="pay-block">                    <img src="/images/visa-mcard.png" />                </div>                <div class="pay-block pay-button">                    ' + e + '                    <div onclick="$(\'.pay form\').submit();" class="ui-button">Далее</div>                </div>            </div>'
            },
            smsMethodTemplate: function(e) {
                return '            <div class="pay">                <div class="pay-block pay-titles">                    <div class="pay-text-1">' + e.title + '</div>                    <div class="pay-text-2">Через мобильный телефон</div>                </div>                <div class="pay-block">                    <div class="pay-text-5">Отправьте SMS со словом <span>' + e.prefix + '</span></div>                    <div class="pay-text-5">с Вашего телефона ' + e.phone + '</div>                    <div class="pay-text-5">на номер <span>' + e.number + '</span></div>                </div>                <div class="pay-block pay-operator-info">                    <div class="pay-text-6">Стоимость SMS — ' + e.sum + " грн.  Тариф в гривнах с учетом НДС.                     Дополнительно удерживается сбор в Пенсионный фонд в размере 7.5% от стоимости услуги без                     учета НДС. Технический партнер ООО «ТЕЛЕМАТИКС», информационная служба: (044) 383-20-90,                     (050) 440-15-59 (с 9:00 до 18:00, в рабочие дни). Для всех национальных GSM операторов и СДМА.                     Услуга предоставляется совершеннолетним.                    </div>                </div>            </div>"
            },
            choosePeriodWindowTpl: function() {
                return '            <div class="pay">                <div class="pay-block pay-titles">                    <div class="pay-text-1"><%= title %></div>                    <div class="pay-text-2">Выберите период подключения</div>                </div>                <div class="pay-block pay-period" data-period="month">                    <div class="pay-icon-period pay-month"></div>                    <div class="pay-info">                        <div class="pay-text-3">Один месяц</div>                        <div class="pay-text-4">Доступ на протяжении месяца ( <span><%= priceMonth %></span> грн )</div>                    </div>                </div>                <div class="pay-block pay-period" data-period="24hr">                    <div class="pay-icon-period pay-24hr"></div>                    <div class="pay-info">                        <div class="pay-text-3">24 часа</div>                        <div class="pay-text-4">Доступ на протяжении<br>24 часов ( <span><%= price24hr %></span> грн )</div>                    </div>                </div>            </div>'
            },
            chooseCountWindowTpl: function() {
                return '            <div class="pay w480">                <div class="pay-block pay-titles">                    <div class="pay-text-1"><%= title %></div>                    <div class="pay-text-2">Выберите количество эксклюзивов</div>                </div>                <div class="pay-block pay-period" data-period="month">                    <div class="pay-count">1</div>                    <div class="pay-info">                        <div class="pay-text-3">эксклюзив</div>                        <div class="pay-text-4">( <span><%= price1 %></span> грн )</div>                    </div>                </div>                <div class="pay-block pay-period" data-period="24hr">                    <div class="pay-count">4</div>                    <div class="pay-info">                        <div class="pay-text-3">эксклюзива</div>                        <div class="pay-text-4">Доступ на протяжении<br>24 часов ( <span><%= price4 %></span> грн )</div>                    </div>                </div>                <div class="pay-block pay-period" data-period="24hr">                    <div class="pay-count">8</div>                    <div class="pay-info">                        <div class="pay-text-3">эксклюзивов</div>                        <div class="pay-text-4">Доступ на протяжении<br>24 часов ( <span><%= price8 %></span> грн )</div>                    </div>                </div>            </div>'
            }
        });
        return r
    }), define("Base/Exclusive/Views/Add", ["Shared/Abstract/View", "Base/Exclusive/Model", "Base/Exclusive/Fields", "Base/Ad/Model", "Shared/Listing/Collection", "Form/Component", "Form/Components/Address", "Form/Components/Photos", "UI/Dialog/Views/Default", "Base/Payment/Views/Window", "Base/Config"], function(e, t, n, r, i, s, o, u, a, f, l) {
        var c = e.extend({
            events: {
                "click .submit .ui-button": "submit"
            },
            attributes: {
                "class": "page-add"
            },
            tooltips: [],
            initialize: function() {
                _.bindAll(this), window.ServicesModel.fetch({
                    success: this.checkService
                }), this.listings = new i, this.model = new t, Backbone.Validation.bind(this), this.listenTo(this.model, "validated:valid", this.valid), this.listenTo(this.model, "validated:invalid", this.invalid)
            },
            checkService: function() {
                if (!window.ServicesModel.get("exclusive") || window.ServicesModel.get("exclusive") <= 0) {
                    var e = new f;
                    this.appendSubview(e), e.Exclusive()
                }
            },
            GetName: function() {
                return "exclusive"
            },
            valid: function() {
                this.$el.find(".input-error").removeClass("input-error"), _.each(this.tooltips, function(e) {
                    e.hide()
                })
            },
            invalid: function(e, t) {
                this.$el.find(".input-error").removeClass("input-error"), _.each(this.tooltips, function(e) {
                    e.hide()
                });
                var n = !1;
                _.each(t, function(e, t) {
                    var r = this.form.GetField(t);
                    r && r.Invalid(), _.isString(e) && (this.tooltips.push(r.ShowTooltip(e)), n = !0)
                }, this);
                if (n === !0) return;
                new a({
                    content: "Заполните все обязательные поля",
                    containerCss: {
                        width: 280
                    }
                })
            },
            render: function() {
                this.$el.append(this.template()), this.loaderShow(), this.makeFormContainer(), this.form.AddGroup({
                    name: "operation",
                    namespace: "main"
                }), this.getListings(this.addOperationField);
                var e = _.where(l.filters, {
                    name: "region"
                });
                return e = e ? _.pluck(e[0].items, "id") : null, this.form.AddComponent({
                    name: "address",
                    namespace: "terrain",
                    view: new o({
                        availableRegions: e
                    })
                }), this.form.AddGroup([{
                    name: "estateType",
                    namespace: "main"
                }, {
                    name: "params",
                    namespace: "params"
                }, {
                    name: "text",
                    namespace: "info"
                }, {
                    name: "price",
                    namespace: "params"
                }, {
                    name: "photo",
                    namespace: "info"
                }]), this.addDefaultFields(), this.form.AddComponent({
                    name: "photo",
                    namespace: "info",
                    view: u
                }), this
            },
            makeFormContainer: function() {
                this.form = new s, this.appendSubview(this.form, this.$el.find(".form"))
            },
            getListings: function(e) {
                this.listings.Fetch(["operation", "marketSegment", "estateType", "p10", "p20"], e)
            },
            addOperationField: function() {
                this.form.GetGroup("operation").AddField({
                    name: "operation",
                    title: "Операция:",
                    required: !0,
                    type: "select",
                    options: {
                        width: 186,
                        data: this.listings.Get("operation")
                    }
                }).on("change", this.operationChanged), this.form.GetGroup("operation").AddSpoiler(), this.loaderHide()
            },
            removeEstateTypeField: function() {
                this.form.RemoveGroup("estateType")
            },
            operationChanged: function(e) {
                this.form.EmptyGroup(["estateType", "price", "params"]), this.form.EmptyComponent("address");
                if (e.length === 0) {
                    this.form.GetField("params.price") && this.form.GetField("params.price").SetUnit("");
                    return
                }
                var t = "";
                _.include([1, 4], e[0].id) && (t = "$"), _.include([2, 5], e[0].id) && (t = "грн"), _.include([3], e[0].id) && (t = "грн/сут"), this.model.set("main.operation", e), this.multiple = _.include([4, 5], e[0].id), this.addPriceField(), this.form.GetField("params.price").SetUnit(t), this.form.GetComponent("address").SetMultiple(this.multiple).SetRequired("street", !this.multiple).SetRender("street", !this.multiple).render(), this.model.unset("main.estateType"), this.addEstateTypeField()
            },
            addEstateTypeField: function() {
                var e = this.model.get("main.estateType"),
                    t = this.listings.Get("estateType");
                _.isArray(e) && e.length && this.multiple && (t = _.filter(t, function(t) {
                    return t.marketSegment == e[0].marketSegment
                })), this.form.GetGroup("estateType").AddField({
                    name: "estateType",
                    title: "Тип объекта:",
                    required: !0,
                    type: "select",
                    options: {
                        width: 186,
                        data: t,
                        selected: _.isArray(e) ? e : [],
                        multiple: this.multiple,
                        renderSelectedInDropdown: !this.multiple,
                        showDefaultItem: !this.multiple
                    }
                }).on("change", this.estateTypeChanged), this.form.GetGroup("estateType").AddSpoiler()
            },
            estateTypeChanged: function(e) {
                this.form.EmptyGroup("params"), this.model.set("main.estateType", e), this.form.EmptyGroup("estateType"), this.addEstateTypeField();
                var t = n.Get({
                    marketSegment: _.pluck(this.model.get("main.estateType"), "marketSegment"),
                    operation: _.pluck(this.model.get("main.operation"), "id"),
                    listings: this.listings,
                    multiple: this.multiple
                });
                _.each(this.model.GetFields(), function(e) {
                    var n = _.clone(t[_.isArray(e) ? e[0] : e]);
                    _.isArray(e) && e[1] === !0 && (n.required = !0), this.form.GetGroup("params").AddField(n)
                }, this), this.form.GetGroup("params").AddSpoiler()
            },
            addPriceField: function() {
                this.form.GetGroup("price").AddField({
                    name: "price",
                    title: this.multiple ? "Бюджет:" : "Цена за объект:",
                    required: !0,
                    type: "input",
                    width: 80,
                    maxlength: 8,
                    options: {
                        "class": "input-number"
                    }
                }), this.form.GetGroup("price").AddSpoiler()
            },
            addDefaultFields: function() {
                this.form.GetGroup("text").AddField({
                    name: "text",
                    title: "Описание:",
                    required: !0,
                    type: "textarea"
                }), this.form.GetGroup("text").AddSpoiler()
            },
            submit: function() {
                var e = this.form.GetValue();
                this.model.clear({
                    silent: !0
                }).set(e).validate(), this.model.isValid() === !0 && (this.loaderShow(), this.model.save({}, {
                    success: this.saveSuccessHandler
                }))
            },
            saveSuccessHandler: function(e, t) {
                if (t.err) return this.loaderHide(), new a({
                    content: t.message || "Ошибка добавления эксклюзива. Обратитесь к администратору."
                });
                window.Services.exclusive = window.Services.exclusive - 1;
                var n = new r(t.data),
                    i = n.get("terrain.region")[0].id,
                    s = "/base-/?region=" + i + "&locality=" + _.find(REGIONS, function(e) {
                        return e.id == i
                    }).regionCenter + "&type=" + n.getType() + "&marketSegment=" + n.get("main.marketSegment")[0].id + "&operation=" + n.get("main.operation")[0].id;
                window.Router.navigate(s, !0)
            },
            loaderShow: function(e) {
                var t = this.$el.find(".container-right"),
                    n = {
                        top: t.position().top + 33,
                        height: t.height() - 18,
                        minHeight: 300,
                        zIndex: 2
                    };
                e && !("cid" in e) && (n = _.extend(n, e)), $("#base-loader").css(n).show()
            },
            loaderHide: function() {
                $("#base-loader").hide()
            },
            template: function() {
                return '             <div id="base-loader"></div>             <div class="container-left">                <div class="hint">Добавление эксклюзива<i class="b-i"></i></div>             </div>             <div class="container-right">                 <div class="title">Добавление эксклюзива</div>                 <div class="form"></div>                 <div class="fileupload">                    <a><i class="b-i"></i>Загрузить фотографии</a>                    <input type="file" id="fileupload2" name="files[]" accept="image/jpeg" multiple>                 </div>                 <div class="submit">                     <div class="ui-button">Добавить эксклюзив</div>                </div>             </div>'
            }
        });
        return c
    }), define("Base/Tools/Views/SocialShare", ["Shared/Abstract/View", "UI/Dialog/Views/Default"], function(e, t) {
        var n = e.extend({
            events: {
                "click .vk-share": "ShareVk",
                "click .vk-submit": "SubmitVk"
            },
            initialize: function() {
                _.bindAll(this), this.render()
            },
            ShareVk: function() {
                var e = "http://www.kg-r.com/base/" + (window.User && window.User.referral ? "?ref=" + window.User.referral : "");
                window.open("https://vk.com/share.php?url=" + e, "", "width=605, height=399")
            },
            SubmitVk: function() {
                var e = this;
                window.VK.Auth.login(function(n) {
                    n && n.session && n.session.mid ? e.sendPostInfo(n.session.mid) : new t({
                        content: "Возникла ошибка.<br> Обратитесь к администратору."
                    })
                })
            },
            sendPostInfo: function(e) {
                $.post("/api/base/socialShare", {
                    userProfileId: e
                }, function(e) {
                    (new t({
                        content: e.message || "Возникла ошибка.<br> Обратитесь к администратору."
                    })).on("ok close", function() {
                        window.location.href = "/base-/"
                    })
                })
            },
            template: function() {
                return '                <div class="step">Шаг 1. Расскажите о Базе друзьям ВКонтакте</div>                <div class="description"><div class="ui-button vk-share">Рассказать друзьям</div></div>                <div class="step">Шаг 2. Подтвердите наличие записи у Вас на стене</div>                <div class="description"><div class="ui-button vk-submit">Подвердить</div></div>            '
            }
        });
        return n
    }), define("Shared/SinglePage/Views/Main", ["Shared/Abstract/View", "Shared/EJS", "Base/Tools/Views/SocialShare"], function(e, t, n) {
        var r = e.extend({
            initialize: function(e, t) {
                _.bindAll(this), this.page = t
            },
            render: function() {
                return document.title = this.options.title, document.description = this.options.description, t.render(this.options.content.template, this.options.content.data, this.append), this
            },
            append: function(e) {
                this.$el.append(e), typeof this[this.page] == "function" && this[this.page]()
            },
            "/base-": function() {
                window.ContainerView.$el.find("#counter-exclusive").text(window.Services.exclusive || "");
                var e = this.options.ViewName;
                this.GetName = function() {
                    return e
                }
            },
            "/base-/about": function() {
                window.ContainerView.$el.find("#counter-exclusive").text(window.Services.exclusive || ""), this.GetName = function() {
                    return "base"
                }
            },
            "/base-/free": function() {
                this.appendSubview(new n, this.$el.find(".base-free")), window.ContainerView.$el.find("#counter-exclusive").text(window.Services.exclusive || ""), this.GetName = function() {
                    return "base"
                }
            }
        });
        return r
    }), define("Shared/SinglePage/App", ["Shared/SinglePage/Views/Main"], function(e) {
        var t = function(t, n, r) {
            var i = window.Pages[n];
            if (!i) return;
            var s = new e($.extend(!0, {}, i, r), n);
            t.show(s)
        };
        return t
    }), define("Base/App", ["Base/MainView", "UI/Dialog/Views/Default", "Shared/Functions", "Base/Config", "Base/Exclusive/Views/Add", "Shared/SinglePage/App", "moment"], function(e, t, n, r, i, s, o) {
        var u = function(t, o) {
            if ($.browser.msie) {
                window.ContainerView.badBrowser();
                return
            }
            o === "exclusive" ? window.ContainerView.MainMenuItemClick("/base-/exclusive") : window.ContainerView.MainMenuItemClick("/base-/");
            if (o.search("payWindow=") !== -1) {
                var u = o.match(/payWindow\=(.*?)(?:$|\&)/)[1];
                u && window.ContainerView.ShowPaymentWindow(u)
            }
            if (o === "exclusive" && window.Auth.get("uid") !== null) {
                t.close();
                var a = new i;
                t.show(a);
                return
            }
            if (window.Auth.get("uid") === null || !window.ServicesModel.get("base")) {
                $.get("/api/base/last", function(e) {
                    s(t, "/base-", {
                        ViewName: "base",
                        content: {
                            data: {
                                uid: window.Auth.get("uid"),
                                service: window.ServicesModel.get("base"),
                                LastFor24hr: e
                            }
                        }
                    })
                });
                return
            }
            window.ServicesModel.fetch(), o = n.uri2obj(o);
            if (!o.region || !o.locality || !o.type || !o.marketSegment || !o.operation) {
                var f = $.cookie(),
                    l = r.defaults;
                f["base-region"] && f["base-locality"] && f["base-type"] && f["base-marketSegment"] && f["base-operation"] && (l = {
                    region: f["base-region"],
                    locality: f["base-locality"],
                    type: f["base-type"],
                    marketSegment: f["base-marketSegment"],
                    operation: f["base-operation"]
                }), o = _.extend(l, o);
                var c = parseInt(o.locality.toString().split("-")[0]),
                    h = _.find(r.localities, function(e) {
                        return e.id === c
                    });
                h ? o.locality = h.id + (h.area || h.isAreaCenter ? "-" + (h.area || h.isAreaCenter) : "") : o = r.defaults, Router.navigate(r.rootUrl + "?" + n.obj2uri(o), !0);
                return
            }
            t.close();
            var p = new e(o);
            t.show(p)
        };
        return u
    }), define("Router", ["backbone", "ViewManager", "Base/App", "Shared/SinglePage/App"], function(e, t, n, r) {
        var i = e.Router.extend({
            initialize: function() {
                this.viewManager = new t;
                for (var e in window.Pages) window.Pages[e].addToRouter !== !1 && this.route(e.replace(/^\//, ""), "page")
            },
            routes: {
                "base-/": "base",
                "base-/*path": "base"
            },
            base: function(e) {
                e || (e = window.location.search), n(this.viewManager, e)
            },
            page: function() {
                r(this.viewManager, window.location[Modernizr.history ? "pathname" : "hash"])
            }
        });
        return i
    }), define("Shared/Auth/Model", ["backbone"], function(e) {
        var t = e.Model.extend({
            url: "/api/login",
            initialize: function() {
                _.bindAll(this), this.set({
                    uid: window.Uid
                })
            },
            login: function(e, t) {
                $.post("/api/login", e, function(e) {
                    e.error ? t(e) : window.location.reload()
                })
            },
            logout: function() {
                $.post("/api/logout", this.afterLogout)
            },
            afterLogout: function(e) {
                this.clear(), this.set(e), Router.navigate("/login", !0)
            }
        });
        return t
    }), define("Shared/EventManager/Model", ["backbone"], function(e) {
        var t = e.Model.extend({
            initialize: function() {
                _.bindAll(this), this.ClearNotifies(), window.Socket.Main.on("connect_error", this._socketsError), window.Socket.Main.on("reload", this._reload), window.Socket.Base.on("base", this._base), window.Socket.Base.on("user-filters", this._userFilters), window.Socket.Base.on("base-need-update-counters", this._baseNeedUpdateCounters), window.Socket.Base.on("base-admin-update-ad", this._baseAdminUpdateAd), window.Socket.Main.on("update-users-online", this._updateUsersOnline), window.Socket.Main.on("user-connected", this._userConnected), window.Socket.Main.on("user-disconnected", this._userDisconnected)
            },
            ClearNotifies: function() {
                if (!Modernizr.localstorage) return;
                window.localStorage.removeItem("event-manager-notifies")
            },
            RegisterNotify: function(e) {
                if (!Modernizr.localstorage || !e) return null;
                var t = window.localStorage.getItem("event-manager-notifies") || {};
                return _.isString(t) && (t = $.parseJSON(t)), _.isUndefined(t[e]) && (t[e] = 0), window.localStorage.setItem("event-manager-notifies", $.toJSON(t)), e
            },
            CheckNotify: function(e) {
                if (!Modernizr.localstorage) return null;
                var t = window.localStorage.getItem("event-manager-notifies") || {};
                return _.isString(t) && (t = $.parseJSON(t)), t[e] === 0
            },
            UnRegisterNotify: function(e) {
                if (!Modernizr.localstorage) return;
                var t = window.localStorage.getItem("event-manager-notifies") || {};
                _.isString(t) && (t = $.parseJSON(t)), t[e] === 0 && (t[e] = 1), window.localStorage.setItem("event-manager-notifies", $.toJSON(t))
            },
            _socketsError: function() {
                window.UsersOnline = []
            },
            _reload: function() {
                window.location.reload()
            },
            _base: function(e) {
                this.trigger("Base", e, this.RegisterNotify(e.eventId))
            },
            _userFilters: function(e) {
                this.trigger("UserFilters", e)
            },
            _services: function(e) {
                window.Services = e
            },
            _message: function(e) {
                this.clear({
                    silent: !0
                }).set(e, {
                    silent: !0
                }), this.trigger("Message", this.toJSON())
            },
            _baseComment: function(e) {
                this.trigger("BaseComment", e)
            },
            _baseAdminUpdateAd: function(e) {
                this.trigger("BaseAdminUpdateAd", e.ad)
            },
            _baseUpdateCounters: function(e) {
                this.trigger("BaseUpdateCounters", e)
            },
            _baseNeedUpdateCounters: function(e) {
                this.trigger("BaseNeedUpdateCounters", e)
            },
            _updateUsersOnline: function(e) {
                this.trigger("UserOnlineUpdated"), window.UsersOnline = e
            },
            _userConnected: function(e) {
                window.UsersOnline = _.union(window.UsersOnline, [e.uid]), this.trigger("UserConnected", e.uid)
            },
            _userDisconnected: function(e) {
                window.UsersOnline = _.without(window.UsersOnline, e.uid), this.trigger("UserDisconnected", e.uid)
            }
        });
        return t
    }), define("Shared/Session/Model", ["Libs/Backbone/DeepModel"], function() {
        var e = Backbone.DeepModel.extend({
            initialize: function() {
                _.bindAll(this), $(window).unload(this.clearSession)
            },
            Save: function(e, t) {
                if (!Modernizr.localstorage) return;
                var n = this.loadSession() || {};
                n[e] = t, this.saveSession(n)
            },
            Clear: function(e) {
                if (!Modernizr.localstorage) return;
                var t = this.loadSession() || {};
                delete t[e], this.saveSession(t)
            },
            Load: function(e) {
                var t = this.loadSession() || {};
                return t[e]
            },
            saveSession: function(e) {
                if (!Modernizr.localstorage) return;
                window.localStorage.setItem("session", $.toJSON(e))
            },
            loadSession: function() {
                return Modernizr.localstorage ? $.parseJSON(window.localStorage.getItem("session")) : null
            },
            clearSession: function() {
                if (!Modernizr.localstorage) return;
                window.localStorage.removeItem("session")
            }
        });
        return e
    }),
    function() {
        var e = {
            "/base-/about": {
                title: "База ― недвижимость без посредников!",
                description: "Объявления от собственников. Квартиры, дома и другая недвижимость. Телефоны владельцев.",
                content: {
                    template: "pages/baseAbout"
                }
            },
            "/base-/free": {
                title: "База ― недвижимость без посредников!",
                description: "Объявления от собственников. Квартиры, дома и другая недвижимость. Телефоны владельцев.",
                content: {
                    template: "pages/baseFree"
                }
            },
            "/base-": {
                title: "База ― недвижимость без посредников!",
                description: "Объявления от собственников. Квартиры, дома и другая недвижимость. Телефоны владельцев.",
                content: {
                    template: "pages/basePromo"
                },
                addToRouter: !1
            },
            "/base-/*": {
                title: "База ― недвижимость без посредников!",
                description: "Объявления от собственников. Квартиры, дома и другая недвижимость. Телефоны владельцев.",
                addToRouter: !1
            }
        };
        typeof module != "undefined" && module.exports && (module.exports = e), typeof define == "function" && define.amd && define("StaticPages", [], function() {
            return e
        })
    }(), define("Shared/Auth/Views/Window", ["Shared/Abstract/View", "UI/Dialog/Views/Default"], function(e, t) {
        var n = e.extend({
            initialize: function() {
                _.bindAll(this), this.render()
            },
            events: {
                "click .ui-button": "submit",
                "click .base-checkbox": "toggleCheckbox",
                "click .forgot-password": "forgotPassword"
            },
            render: function() {
                this.$el.append(this.template()), this.dialog = (new t({
                    content: this,
                    containerCss: {
                        width: 265
                    },
                    controls: []
                })).on("show", function(e) {
                    e.$el.find(".input-text").first().focus()
                }).on("keypress", function(e, t) {
                    t == 13 && e.$el.find(".ui-button").trigger("click")
                })
            },
            toggleCheckbox: function(e) {
                var t = $(e.currentTarget);
                t.toggleClass("base-checkbox-checked"), t.find("input").prop("checked", t.hasClass("base-checkbox-checked"))
            },
            forgotPassword: function() {
                this.dialog.hide(), (new t({
                    content: this.forgotPasswordTemplate(),
                    containerCss: {
                        width: 455,
                        textAlign: "left"
                    }
                })).on("close", window.ContainerView.ShowAuthWindow)
            },
            submit: function() {
                this.$el.find(".input-text").first().blur(), this.model.login({
                    login: this.$el.find("#login").val(),
                    password: this.$el.find("#password").val(),
                    rememberme: this.$el.find("#rememberme").hasClass("ui-checkbox-checked")
                }, this.onLogin)
            },
            onLogin: function(e) {
                e.error === 101 && (this.dialog.hide(), (new t({
                    content: e.message
                })).on("close", window.ContainerView.ShowAuthWindow))
            },
            template: function() {
                return '            <div class="login-window">                <div class="login-window-title">Вход в личный кабинет</div>                <div>                    <div class="odd">Логин:</div><div class="even">                        <input id="login" class="input-text" type="text">                    </div>                </div>                <div>                    <div class="odd">Пароль:</div><div class="even">                        <input id="password" class="input-text" type="password">                    </div>                </div>                <div>                    <div class="odd"></div><div class="even">                        <div class="ui-checkbox" id="rememberme"><div></div>Запомнить меня</div>                    </div>                </div>                <div>                    <div class="odd"></div><div class="even">                        <div class="ui-button">Войти</div>                        <div class="forgot-password">                            <div class="f-dashed f-11 f-white">Забыли логин</div>                            <div class="f-dashed f-11 f-white">или пароль?</div>                        </div>                    </div>                </div>            </div>'
            },
            forgotPasswordTemplate: function() {
                return '            <div>Для восстановления логина или пароля отправьте SMS-сообщение с текстом PAROL             на номер 8668 с Вашего номера мобильного телефона, введенного при регистрации             на сайте. В ответном SMS-сообщении Вы получите логин и новый пароль, который             всегда можно изменить в своём личном кабинете.</div>            <br />            <div class="f-11 f-white">Стоимость отправки SMS — 0,50 грн. для абонентов КИЕВСТАР,             Beeline™, 0,60 грн. для абонентов МТС и 0,59 для абонентов life:). Тариф в гривнах с             учетом НДС. Дополнительно удерживается сбор в Пенсионный фонд в размере 7,5% от стоимости             услуги без учёта НДС. Только для совершеннолетних.            Техническая поддержка ПО ВОПРОСАМ SMS-сервиса: +38 (044) 224-8668 круглосуточно.             Организатор: ЧП "Магнетар", сервис "TurboSMS".            03150, Киев-150, а/я 503.</div>'
            }
        });
        return n
    }),
    function() {
        var e = {
            region: {
                required: !0,
                msg: "Не все обязательные поля заполнены"
            },
            city: function(e, t, n) {
                if (!n.area && !e) return "Не все обязательные поля заполнены"
            },
            town: function(e, t, n) {
                if (n.area && !e) return "Не все обязательные поля заполнены"
            },
            firstName: {
                required: !0,
                msg: "Не все обязательные поля заполнены"
            },
            lastName: {
                required: !0,
                msg: "Не все обязательные поля заполнены"
            },
            gender: {
                required: !0,
                msg: "Не все обязательные поля заполнены"
            },
            login: function(e) {
                if (!e) return "Не все обязательные поля заполнены";
                if (e.match(/[^A-z\d]/g) !== null) return "Недопустимые символы в логине. Используйте цифры и латинские символы."
            },
            password1: {
                minLength: 6,
                msg: "Пароль должен содержать не менее 6 символов"
            },
            password2: {
                equalTo: "password1",
                msg: "Введенные пароли не совпадают"
            },
            code: {
                required: !0,
                msg: "Не все обязательные поля заполнены"
            },
            phone: {
                required: !0,
                msg: "Не все обязательные поля заполнены"
            },
            agreement: {
                acceptance: !0,
                msg: "Для регистрации необходимо принять условия Пользовательского соглашения"
            }
        };
        typeof module != "undefined" && module.exports && (module.exports = e), typeof define == "function" && define.amd && define("Shared/Register/Validator", [], function() {
            return e
        })
    }(), define("Shared/Register/Model", ["backbone", "Shared/Register/Validator"], function(e, t) {
        var n = e.Model.extend({
            url: "/api/register",
            checkPhoneUrl: "/api/register/phone/",
            initialize: function() {
                _.bindAll(this)
            },
            validation: t,
            checkPhone: function(e, t) {
                $.getJSON(this.checkPhoneUrl + e, function(e) {
                    t[e.status === "ok" ? "success" : "error"]()
                })
            }
        });
        return n
    }), define("Shared/Register/Views/Dialog", ["backbone", "UI/Dialog/Views/Default", "UI/Form/Views/Select", "Shared/Abstract/View", "Shared/Terrain/Model", "Shared/Register/Model"], function(e, t, n, r, i, s) {
        var o = r.extend({
            currentStep: 0,
            data: {},
            initialize: function() {
                _.bindAll(this), this.model = new s, e.Validation.bind(this), this.bindTo(this.model, "validated:valid", this.valid), this.bindTo(this.model, "validated:invalid", this.invalid), this.render(), this.nextStep(), this.Terrain = new i
            },
            onClose: function() {
                e.Validation.unbind(this)
            },
            events: {
                "keyup .register-phone input": "onPhoneKeyPress",
                "keydown .register-phone input": "onPhoneKeyDown",
                "click .register-submit": "registerSubmit"
            },
            render: function() {
                this.dialog = (new t({
                    content: this,
                    containerClass: "register-dialog",
                    controls: [
                        ["next", "Далее"]
                    ]
                })).on("next", this.nextStep).on("close", this.close)
            },
            nextStep: function() {
                var e = "step" + ++this.currentStep;
                _.isFunction(this[e]) && this[e]()
            },
            prevStep: function() {
                --this.currentStep
            },
            step1: function() {
                this.$el.empty().append(this.step1Template()), this.dialog.setPosition()
            },
            step2: function() {
                var e = this.$el.find(".ui-radio-selected").data("value");
                if (!e) return this.step1Error();
                this.data.userType = e, this.$el.html(this.step2Template()), this.step2SetFocus(), this.dialog.setPosition()
            },
            step3: function() {
                var e = "380" + _.map(this.$el.find("input"), function(e) {
                    return e.value
                }).join("");
                if (e.length < 12) return this.step2Error1(e.length);
                this.model.checkPhone(e, {
                    success: this.step3GetTerrain,
                    error: this.step2Error2
                }), this.data.phone = e
            },
            registerSubmit: function() {
                var e = _.serializeForm(this.$el.find(".register-form"));
                this.model.set(e) && this.model.save({}, {
                    success: this.registerSuccess
                })
            },
            valid: function() {
                this.$el.find(".input-error").removeClass("input-error")
            },
            invalid: function(e, n) {
                this.$el.find(".input-error").removeClass("input-error");
                if (_.size(n) == 0) return;
                new t({
                    content: _.values(n)[0]
                });
                for (var r in n) {
                    if (r == "agreement") continue;
                    if (r == "city" || r == "area") r = "cityArea";
                    r == "password1" && this.$el.find("[name=password2]").addClass("input-error"), this.$el.find("[name=" + r + "]").addClass("input-error")
                }
            },
            registerSuccess: function(e, n) {
                n.uid ? window.location.href = "/base-/?region=" + n.region : n.error && new t({
                    content: n.message
                })
            },
            step3GetTerrain: function() {
                this.Terrain.Get(["regions"], this.step3Render)
            },
            step3Render: function(e) {
                this.$el.html(this.step3Template()), this.dialog.$el.find(".ui-dialog-controls").remove(), this.dialog.setPosition(), this.region = (new n({
                    width: 183,
                    data: e.regions
                })).on("change", this.onRegionChange), this.appendSubview(this.region, this.$el.find("#region")), window.ContainerView.getCurrentRegion() && (this.region.SetByIds([window.ContainerView.getCurrentRegion().id]), this.onRegionChange([window.ContainerView.getCurrentRegion()])), this.gender = new n({
                    width: 183,
                    data: [{
                        id: "male",
                        title: "Мужской",
                        type: "gender"
                    }, {
                        id: "female",
                        title: "Женский",
                        type: "gender"
                    }]
                }), this.appendSubview(this.gender, this.$el.find("#gender")), this.getGeoPosition()
            },
            getGeoPosition: function() {},
            onRegionChange: function(e) {
                if (!e.length) {
                    this.$el.find("#cityAreaContainer, #townContainer").hide();
                    return
                }
                this.$el.find("#townContainer").hide(), this.Terrain.Get([
                    ["cityAreas", e[0].id]
                ], this.renderCityArea)
            },
            onCityAreaChange: function(e) {
                if (!e.length || e[0].type !== "area") {
                    this.$el.find("#townContainer").hide();
                    return
                }
                this.Terrain.Get([
                    ["towns", e[0].id]
                ], this.renderTowns)
            },
            renderCityArea: function(e) {
                this.$el.find("#cityAreaContainer")[e.cityAreas.length ? "show" : "hide"](), this.cityArea && this.cityArea.close();
                try {
                    var t = _.where(e.cityAreas, {
                        id: _.find(REGIONS, function(e) {
                            return e.id == this.region.GetOne().id
                        }, this).regionCenter
                    })
                } catch (r) {}
                this.cityArea = (new n({
                    width: 183,
                    data: e.cityAreas,
                    selected: t || []
                })).on("change", this.onCityAreaChange), this.appendSubview(this.cityArea, this.$el.find("#cityArea"))
            },
            renderTowns: function(e) {
                this.$el.find("#townContainer")[e.towns.length ? "show" : "hide"](), this.town && this.town.close(), this.town = new n({
                    width: 183,
                    data: e.towns
                }), this.appendSubview(this.town, this.$el.find("#town"))
            },
            step1Error: function() {
                new t({
                    content: "Пожалуйста, выберите Ваш статус"
                }), this.prevStep()
            },
            step2Error1: function(e) {
                var n = e == 0 ? "Необходимо ввести номер мобильного телефона" : "Номер телефона указан некорректно";
                (new t({
                    content: n
                })).on("close", this.step2SetFocus), this.prevStep()
            },
            step2Error2: function() {
                var e = "Учетная запись с таким номером телефона уже существует";
                (new t({
                    content: e
                })).on("close", this.step2SetFocus), this.prevStep()
            },
            step2SetFocus: function() {
                var e = this.$el.find("input");
                e.first().val().length < 2 ? e.first().focus() : e.last().focus()
            },
            onPhoneKeyPress: function(e) {
                _.eKeys(e)[0] == 13 && (_.stopPropagation(e), $(e.currentTarget).blur(), this.nextStep())
            },
            onPhoneKeyDown: function(e) {
                var t = $(e.currentTarget);
                t.hasClass("code") && t.val().length == 2 ? t.next().focus() : t.hasClass("number") && t.val().length == 0 && t.prev().focus()
            },
            step1Template: function() {
                return '            <div class="register-block">                <div class="f-18 f-white">Регистрация. Шаг 1/3</div>            </div>            <div class="register-block f-13">Выберите Ваш статус:</div>            <div class="register-block f-13 f-white">                <div class="ui-radio" name="userType" data-value="realtor"><div></div>Риэлтор</div>                <div class="ui-radio" name="userType" data-value="visitor"><div></div>Посетитель (не риэлтор)</div>            </div>            <div class="register-block f-11"><span class="f-white">Риэлтор (агент, брокер, маклер)</span>             — статус пользователя, свидетельствующий о его принадлежности к профессиональной риэлтоской              деятельности.            </div>            <div class="register-block f-11"><span class="f-white">Посетитель (владелец объекта, покупатель,             арендатор)</span> — статус пользователя, свидетельствующий о его заинтересованности в             приобретении, продаже, обмене, аренде объекта недвижимости с помощью сайта.            </div>'
            },
            step2Template: function() {
                return '            <div class="register-block">                <div class="f-18 f-white">Регистрация. Шаг 2/3</div>            </div>            <div class="register-block f-13">Введите номер Вашего мобильного телефона для получения             кода подтверждения</div>            <div class="register-block register-phone">                <div class="f-26 f-white country-code">+380</div>                <input type="text" class="input-text input-number code" maxlength="2">                <input type="text" class="input-text input-number number" maxlength="7">                <div>                    <div class="f-11 code-hint">Код</div>                    <div class="f-11 number-hint">Номер телефона</div>                </div>            </div>            <div class="register-block f-11"><span class="f-white">Код подтверждения</span> — уникальный             код в виде комбинации латинских букв и цифр, необходимый для прохождения удостоверительной             процедуры регистрации. Данный код приходит пользователю в SMS-сообщении и служит подтверждением             принадлежности ему указанного номера мобильного телефона.            </div>'
            },
            step3Template: function() {
                return '            <div class="register-block">                <div class="f-18 f-white">Регистрация. Шаг 3/3</div>            </div>            <div class="register-block f-12 register-form">                <div>                    <div class="odd">Регион:</div>                    <div class="even"><div id="region" name="region"></div></div>                </div>                <div id="cityAreaContainer">                    <div class="odd">Город / Район:</div>                    <div class="even"><div id="cityArea" name="cityArea"></div></div>                </div>                <div id="townContainer">                    <div class="odd">Нас. пункт:</div>                    <div class="even"><div id="town" name="town"></div></div>                </div>                <div>                    <div class="odd">Имя:</div>                    <div class="even"><input type="text" name="firstName" class="input-text input-ru"></div>                </div>                <div>                    <div class="odd">Фамилия:</div>                    <div class="even"><input type="text" name="lastName" class="input-text input-ru"></div>                </div>                <div>                    <div class="odd">Пол:</div>                    <div class="even"><div id="gender" name="gender"></div></div>                </div>                <div>                    <div class="odd">Логин:</div>                    <div class="even">                        <input type="text" name="login" class="input-text input-regexp" data-regexp="^[A-z\\d]+$">                    </div>                </div>                <div>                    <div class="odd">Пароль:</div>                    <div class="even"><input type="password" name="password1" class="input-text"></div>                </div>                <div>                    <div class="odd">Повторите пароль:</div>                    <div class="even"><input type="password" name="password2" class="input-text"></div>                </div>                <div>                    <div class="odd">Код подтверждения:</div>                    <div class="even"><input type="text" name="code" class="input-text"></div>                </div>                <input type="hidden" name="phone" value="' + this.data.phone + '">                <input type="hidden" name="userType" value="' + this.data.userType + '">                <div>                    <div class="odd"></div>                    <div class="even">                        <div class="ui-checkbox" name="agreement"><div></div>Я принимаю условия</div>                        <a href="/argeement.php" class="f-white f-dashed">Пользовательского соглашения</a>                    </div>                </div>                <div>                    <div class="odd"></div>                    <div class="even">                        <div class="ui-button register-submit">Зарегистрироваться</div>                    </div>                </div>            </div>            '
            }
        });
        return o
    }), define("UI/Dialog/Views/BadBrowser", ["backbone", "Shared/Abstract/View", "Shared/EJS", "UI/Dialog/Views/Default"], function(e, t, n, r) {
        var i = t.extend({
            initialize: function() {
                _.bindAll(this), n.render("windows/browser", {}, this.render)
            },
            render: function(e) {
                (new r({
                    content: e,
                    containerClass: "bad-browser",
                    controls: []
                })).on("close", function() {
                    window.location.href = "/my"
                })
            }
        });
        return i
    }), define("Shared/Container/Views/Main", ["Shared/Abstract/View", "Base/Payment/Views/Window", "UI/Dialog/Views/Default", "UI/Notify/Views/Default", "UI/Form/Views/Select", "Shared/Auth/Views/Window", "Shared/Register/Views/Dialog", "UI/Dialog/Views/BadBrowser"], function(e, t, n, r, i, s, o, u) {
        var a = e.extend({
            el: "body",
            initialize: function() {
                _.bindAll(this), this.MainMenuItemClick(window.location.pathname), $(document).bind("scroll.upButton", this.onScroll), this.bindTo(window.EventManager, "BaseComment", this.showBaseCommentNotify), this.render()
            },
            events: {
                "click .main-menu-base a": "MainMenuItemClick",
                "click .base-pay-button": "BasePayButtonClick",
                "click #report-a-bug": "ReportABug",
                "click #write-to-admin": "WriteToAdmin",
                "click #up-button": "ScrollUp",
                "click #login-button": "ShowAuthWindow",
                "click .register-button": "ShowRegisterWindow",
                "click .ui-radio": "radioToggle",
                "click .ui-checkbox": "checkboxToggle",
                "keypress .input-ru": "inputRu",
                "keypress .input-en": "inputEn",
                "keypress .input-number": "inputNumber",
                "keypress .input-regexp": "inputRegexp"
            },
            render: function() {
                this.makeCurrentRegionSelect()
            },
            resizeWindow: function(e) {
                this.ShowBigLoader(function() {
                    $("#main-container")[e ? "addClass" : "removeClass"]("w1120"), _.resizeWindow(), window.ContainerView.HideBigLoader()
                })
            },
            set990: function() {
                $("#main-container").removeClass("w1120").addClass("w990"), _.resizeWindow()
            },
            set1120: function() {
                $("#main-container").removeClass("w990").addClass("w1120"), _.resizeWindow()
            },
            makeCurrentRegionSelect: function() {
                this.selectContainer = this.$el.find("#current-region"), this.select = (new i({
                    data: REGIONS,
                    defaultItem: {
                        id: null,
                        title: "Украина"
                    },
                    showDefaultItem: !0,
                    containerClass: "current-region-container",
                    dropdownClass: "current-region-dropdown",
                    width: 150,
                    showDropDownButton: !1,
                    selected: $.parseJSON($.cookie("current-region") || "[]"),
                    formatSelection: function(e) {
                        return '<span class="b-i triangle"></span><span class="current-region-selection">' + e.title + "</span>"
                    }
                })).on("change", this.currentRegionSelectOnChange), this.appendSubview(this.select, this.selectContainer)
            },
            getCurrentRegion: function() {
                return this.select.GetOne()
            },
            currentRegionSelectOnChange: function(e) {
                $.cookie("current-region", $.toJSON(e), {
                    expires: 365
                }), window.EventManager.trigger("CurrentRegionChange", e)
            },
            ShowAuthWindow: function() {
                new s({
                    model: window.Auth
                })
            },
            ShowRegisterWindow: function() {
                new o
            },
            ShowBigLoader: function(e) {
                $("#page").append('<div id="big-loader"></div>'), $("#big-loader").fadeIn(200, _.isFunction(e) ? e : function() {})
            },
            HideBigLoader: function(e) {
                $("#big-loader").fadeOut(200, function() {
                    $("#big-loader").remove(), _.isFunction(e) && e()
                })
            },
            inputRu: function(e) {
                if (_.eKeyType(e) !== "ru") return !1
            },
            inputEn: function(e) {
                if (_.eKeyType(e) !== "en") return !1
            },
            inputNumber: function(e) {
                if (_.eKeyType(e) !== "number") return !1
            },
            inputRegexp: function(e) {
                if ((new RegExp($(e.currentTarget).data("regexp"), "g")).test(String.fromCharCode(e.keyCode || e.which)) === !1) return !1
            },
            radioToggle: function(e) {
                $(e.currentTarget).addClass("ui-radio-selected").siblings().removeClass("ui-radio-selected")
            },
            checkboxToggle: function(e) {
                $(e.currentTarget).toggleClass("ui-checkbox-checked")
            },
            MainMenuItemClick: function(e) {
                var t = _.isString(e) ? e : $(e.currentTarget).attr("href");
                $(".main-menu-base").find('a[href="' + t + '"]').addClass("selected").siblings().removeClass("selected")
            },
            BasePayButtonClick: function() {
                var e = window.Router.viewManager.currentViewName();
                this.ShowPaymentWindow(e)
            },
            ShowPaymentWindow: function(e) {
                this.payWindowView && this.payWindowView.close(), this.payWindowView = new t, this.appendSubview(this.payWindowView), e === "base" && this.payWindowView.Base(), e === "exclusive" && this.payWindowView.Exclusive()
            },
            onScroll: function() {
                this.$el.find("#up-button")[window.scrollY > 300 ? "show" : "hide"]()
            },
            ScrollUp: function() {
                this.$el.find("#up-button").hide(), window.scrollTo(0, 0)
            },
            showBaseCommentNotify: function(e) {
                return;
                var t, n, i, s, o
            },
            baseCommentNotifyTemplate: function() {
                return '            <div>                <a class="underline-on-hover router-false" target="_blank" href="<%= userHref %>"><%= userName %></a>                 прокомментировал объект в Базе                <a class="underline-on-hover" href="<%= baseAdHref %>"><%= baseAdTitle %></a>            </div>            <div class="ui-notify-comment-text"><%= commentText %></div>            '
            },
            ReportABug: function() {
                this.feedback(this.reportABugTemplate(), this.reportABugOnSendTemplate())
            },
            WriteToAdmin: function() {
                this.feedback(this.writeToAdminTemplate(), this.writeToAdminOnSendTemplate())
            },
            feedback: function(e, t) {
                (new n({
                    content: e,
                    containerClass: "feedback",
                    controls: [
                        ["send", "Отправить"]
                    ]
                })).on("send", function(e) {
                    var r = $.trim(e.$el.find("textarea").val());
                    if (!r) {
                        new n({
                            content: "Введите текст сообщения"
                        });
                        return
                    }
                    e.hide(), new n({
                        content: t,
                        containerClass: "feedback feedback-onsend"
                    }), $.post("/route.php", {
                        "messages.send": [SITE_ADMINS[0], r]
                    })
                })
            },
            badBrowser: function() {
                var e = new u;
                this.appendSubview(e)
            },
            reportABugTemplate: function() {
                return '            <div class="f-14 f-white">Сообщить об ошибке</div>            <div class="feedback-text">Заметили ошибку или неточности             на нашем сайте, сообщите об этом администратору, и мы              исправим в ближайшее время.</div>            <div class="feedback-label">Текст:</div>            <textarea></textarea>'
            },
            writeToAdminTemplate: function() {
                return '            <div class="f-14 f-white">Написать администратору</div>            <div class="feedback-text">У Вас возник вопрос, идея или             пожелание, сообщите об этом администратору.</div>            <div class="feedback-label">Текст:</div>            <textarea></textarea>'
            },
            reportABugOnSendTemplate: function() {
                return '            <div class="f-14 f-white">Сообщение отправлено</div>            <div class="feedback-text">Благодарим Вас за своевременное сообщение по улучшению работы нашего сайта</div>'
            },
            writeToAdminOnSendTemplate: function() {
                return '            <div class="f-14 f-white">Сообщение отправлено</div>            <div class="feedback-text">Благодарим Вас за Ваши вопросы, идеи и пожелания, они для нас очень важны.</div>'
            }
        });
        return a
    }), define("Shared/Audio", [], function() {
        return {
            Play: function(e) {
                document.getElementById("sound-" + e) && document.getElementById("sound-" + e).play()
            }
        }
    }), define("Shared/Services/Model", ["backbone"], function(e) {
        var t = e.Model.extend({
            url: "/api/services",
            initialize: function() {
                this.listenTo(this, "change", this.updateViews), this.updateViews()
            },
            updateViews: function() {
                window.ContainerView.$el.find("#counter-exclusive").text(this.get("exclusive") || "")
            }
        });
        return t
    }), define("Chat/Views/Main", ["Shared/Abstract/View"], function(e) {
        var t = e.extend({
            attributes: {
                id: "chat-window"
            },
            events: {
                "click .submit": "sendMessage"
            },
            initialize: function() {
                this.render()
            },
            sendMessage: function() {
                this.$chat.append(_.template(this.messageTemplate(), {
                    text: this.$textarea.val(),
                    user: window.User
                })), this.$textarea.val(""), this.$chat.scrollTo("max")
            },
            render: function() {
                return this.$el.append(this.template()), this.$el.appendTo("body"), this.$chat = this.$el.find(".chat"), this.$textarea = this.$el.find("textarea"), this
            },
            messageTemplate: function() {
                return '<div class="chat-message">                <div class="user">                    <img src="<%= PREFIX_AVATAR + user.avatar %>" class="base-ad-thumb">                </div>                <div class="body">                    <div class="username"><a><%= user.name + ( user.agency ? " (" + user.agency + ")" : "" ) %></a></div>                    <div class="text"><span><%= text %></span></div>                </div>            </div>'
            },
            template: function() {
                return '                <div class="chat"></div>                <div class="chat-new-message">                    <textarea></textarea>                    <div class="ui-button submit">Отправить</div>                </div>'
            }
        });
        return t
    }),
    function() {
        var e = function(e) {
            e.mixin({
                declension: function(e, t, n) {
                    var r = [2, 0, 1, 1, 1, 2],
                        i = e % 100 > 4 && e % 100 < 20 ? 2 : r[Math.min(e % 10, 5)];
                    return n ? t[i] : e + " " + t[i]
                },
                switchLatin: function(e) {
                    var t = e,
                        n = "qwertyuiop[]asdfghjkl;'zxcvbnm,./QWERTYUIOP{}ASDFGHJKL:\"ZXCVBNM<>?",
                        r = "йцукенгшщзхъфывапролджэячсмитьбю.ЙЦУКЕНГШЩЗХЪФЫВАПРОЛДЖЭЯЧСМИТЬБЮ,";
                    for (var i = 0, s = n.length; i < s; i++) t = t.split(n.charAt(i)).join(r.charAt(i));
                    return t
                },
                resizeWindow: function() {
                    var e = (window.innerWidth - $("#main-container").width()) / 2;
                    e < 0 && (e = 0), $("#up-button").width(e), $("#main-container").css("margin-left", e)
                },
                eKeys: function(e) {
                    return [e.keyCode || e.which, e.shiftKey, e.ctrlKey]
                },
                eKeyType: function(t) {
                    var n = e.eKeys(t)[0];
                    if (n > 47 && n < 58) return "number";
                    if (n > 96 && n < 123 || n > 64 && n < 91) return "en";
                    if (n > 1039 && n < 1104) return "ru";
                    if (n == 13 || n == 58 || n == 8 || n == 9) return "control"
                },
                stopPropagation: function(e) {
                    e.stopPropagation ? e.stopPropagation() : e.cancelBubble = !0
                },
                obj2uri: function(e, t) {
                    var n = [];
                    for (var r in e) {
                        var i = t ? t + "[" + r + "]" : r,
                            s = e[r];
                        n.push(typeof s == "object" && s !== null ? this.obj2uri(s, i) : encodeURIComponent(i) + "=" + encodeURIComponent(s))
                    }
                    return n.join("&")
                },
                serializeForm: function(e) {
                    var t = {};
                    return e.find(".ui-ms").each(function() {
                        var e = $(this).data("multiselect").Get();
                        e.length && e[0].type && (t[e[0].type] = e)
                    }), e.find("input[type=text], input[type=hidden], input[type=password], textarea").each(function() {
                        var e = $(this);
                        e.attr("name") && (t[e.attr("name")] = e.val())
                    }), e.find(".ui-checkbox").each(function() {
                        var e = $(this);
                        e.attr("name") && (t[e.attr("name")] = e.hasClass("ui-checkbox-checked"))
                    }), e.find(".ui-radio-selected").each(function() {
                        var e = $(this);
                        e.attr("name") && (t[e.attr("name")] = e.data("value"))
                    }), t
                },
                objectFirstItem: function(e) {
                    for (var t in e) return e[t]
                },
                objectLastItem: function(t) {
                    var n = e.size(t),
                        r = 1;
                    for (var i in t) {
                        if (r === n) return t[i];
                        r++
                    }
                },
                priceFormat: function(e, t) {
                    var n = "";
                    if (e) {
                        t || (t = " "), e = e.split(" ");
                        if (e[1]) var r = e[1];
                        e = e[0], e = parseInt(e).toString().split(""), e.reverse();
                        for (var i in e) n += e[i], (i + 1) % 3 || (n += t);
                        n = n.split(""), n.reverse(), n = n.join("")
                    }
                    return r ? n + " " + r : n
                },
                doGetCaretPosition: function(t) {
                    e.isjQuery(t) && (t = t.get(0));
                    var n = 0;
                    if (document.selection) {
                        t.focus();
                        var r = document.selection.createRange();
                        r.moveStart("character", -t.value.length), n = r.text.length
                    } else if (t.selectionStart || t.selectionStart == "0") n = t.selectionStart;
                    return n
                },
                isSelected: function(t) {
                    e.isjQuery(t) && (t = t.get(0));
                    var n = t.selectionEnd - t.selectionStart;
                    return !!n
                },
                setCaretPosition: function(t, n) {
                    e.isjQuery(t) && (t = t.get(0));
                    if (t.setSelectionRange) {
                        t.focus();
                        try {
                            t.setSelectionRange(n, n)
                        } catch (r) {}
                    } else if (t.createTextRange) {
                        var i = t.createTextRange();
                        i.collapse(!0), i.moveEnd("character", n), i.moveStart("character", n), i.select()
                    }
                },
                uri2obj: function(e) {
                    if (!e) return {};
                    var t = {};
                    e = e.split("&");
                    for (var n = 0; n < e.length; n++) {
                        var r = e[n].split("=");
                        if (r[0]) {
                            var i = decodeURIComponent(r[0]).replace(/^\?/, ""),
                                s = i.match(/^[^\[]+/)[0],
                                o = i.match(/\[[^\]]+\]/g),
                                u = decodeURIComponent(r[1] + "");
                            if (o) {
                                var a = o[0].replace(/[\]\[]/g, "");
                                s in t || (t[s] = isNaN(a) ? {} : []);
                                var f = t[s];
                                for (var l = 0; l < o.length; l++) {
                                    var c = o[l].replace(/[\]\[]/g, ""),
                                        h = o[l + 1] ? o[l + 1].replace(/[\]\[]/g, "") : !1;
                                    h ? (c in f || (f[c] = isNaN(h) ? {} : []), f = f[c]) : (u == "null" && (u = null), f[c] = u)
                                }
                            } else u == "null" && (u = null), t[s] = u
                        }
                    }
                    return t
                },
                isjQuery: function(e) {
                    return e != null && e.constructor === jQuery
                },
                deepExtend: function(t, n) {
                    for (var r in n) r in t ? e.deepExtend(t[r], n[r]) : t[r] = n[r];
                    return t
                },
                plainObject: function(t) {
                    if (!e.isObject(t)) return null;
                    var n = {};
                    return e.each(t, function(t, r) {
                        e.isObject(t) && r[0] !== "$" ? e.each(t, function(e, t) {
                            n[r + "." + t] = e
                        }) : n[r] = t
                    }), n
                }
            })
        };
        typeof module != "undefined" && module.exports && (module.exports = e), typeof define == "function" && define.amd && define("UnderscoreExtends", ["underscore"], e)
    }(), window.Modernizr = function(e, t, n) {
        function r(e) {
            g.cssText = e
        }

        function i(e, t) {
            return r(E.join(e + ";") + (t || ""))
        }

        function s(e, t) {
            return typeof e === t
        }

        function o(e, t) {
            return !!~("" + e).indexOf(t)
        }

        function u(e, t) {
            for (var r in e) {
                var i = e[r];
                if (!o(i, "-") && g[i] !== n) return t == "pfx" ? i : !0
            }
            return !1
        }

        function a(e, t, r) {
            for (var i in e) {
                var o = t[e[i]];
                if (o !== n) return r === !1 ? e[i] : s(o, "function") ? o.bind(r || t) : o
            }
            return !1
        }

        function f(e, t, n) {
            var r = e.charAt(0).toUpperCase() + e.slice(1),
                i = (e + " " + x.join(r + " ") + r).split(" ");
            return s(t, "string") || s(t, "undefined") ? u(i, t) : (i = (e + " " + T.join(r + " ") + r).split(" "), a(i, t, n))
        }

        function l() {
            h.input = function(n) {
                for (var r = 0, i = n.length; r < i; r++) L[n[r]] = n[r] in y;
                return L.list && (L.list = !!t.createElement("datalist") && !!e.HTMLDataListElement), L
            }("autocomplete autofocus list placeholder max min multiple pattern required step".split(" ")), h.inputtypes = function(e) {
                for (var r = 0, i, s, o, u = e.length; r < u; r++) y.setAttribute("type", s = e[r]), i = y.type !== "text", i && (y.value = b, y.style.cssText = "position:absolute;visibility:hidden;", /^range$/.test(s) && y.style.WebkitAppearance !== n ? (d.appendChild(y), o = t.defaultView, i = o.getComputedStyle && o.getComputedStyle(y, null).WebkitAppearance !== "textfield" && y.offsetHeight !== 0, d.removeChild(y)) : /^(search|tel)$/.test(s) || (/^(url|email)$/.test(s) ? i = y.checkValidity && y.checkValidity() === !1 : i = y.value != b)), k[e[r]] = !!i;
                return k
            }("search tel url email datetime date month week time datetime-local number range color".split(" "))
        }
        var c = "2.6.2",
            h = {},
            p = !0,
            d = t.documentElement,
            v = "modernizr",
            m = t.createElement(v),
            g = m.style,
            y = t.createElement("input"),
            b = ":)",
            w = {}.toString,
            E = " -webkit- -moz- -o- -ms- ".split(" "),
            S = "Webkit Moz O ms",
            x = S.split(" "),
            T = S.toLowerCase().split(" "),
            N = {
                svg: "http://www.w3.org/2000/svg"
            },
            C = {},
            k = {},
            L = {},
            A = [],
            O = A.slice,
            M, _ = function(e, n, r, i) {
                var s, o, u, a, f = t.createElement("div"),
                    l = t.body,
                    c = l || t.createElement("body");
                if (parseInt(r, 10))
                    while (r--) u = t.createElement("div"), u.id = i ? i[r] : v + (r + 1), f.appendChild(u);
                return s = ["&#173;", '<style id="s', v, '">', e, "</style>"].join(""), f.id = v, (l ? f : c).innerHTML += s, c.appendChild(f), l || (c.style.background = "", c.style.overflow = "hidden", a = d.style.overflow, d.style.overflow = "hidden", d.appendChild(c)), o = n(f, e), l ? f.parentNode.removeChild(f) : (c.parentNode.removeChild(c), d.style.overflow = a), !!o
            },
            D = function() {
                function e(e, i) {
                    i = i || t.createElement(r[e] || "div"), e = "on" + e;
                    var o = e in i;
                    return o || (i.setAttribute || (i = t.createElement("div")), i.setAttribute && i.removeAttribute && (i.setAttribute(e, ""), o = s(i[e], "function"), s(i[e], "undefined") || (i[e] = n), i.removeAttribute(e))), i = null, o
                }
                var r = {
                    select: "input",
                    change: "input",
                    submit: "form",
                    reset: "form",
                    error: "img",
                    load: "img",
                    abort: "img"
                };
                return e
            }(),
            P = {}.hasOwnProperty,
            H;
        !s(P, "undefined") && !s(P.call, "undefined") ? H = function(e, t) {
            return P.call(e, t)
        } : H = function(e, t) {
            return t in e && s(e.constructor.prototype[t], "undefined")
        }, Function.prototype.bind || (Function.prototype.bind = function(e) {
            var t = this;
            if (typeof t != "function") throw new TypeError;
            var n = O.call(arguments, 1),
                r = function() {
                    if (this instanceof r) {
                        var i = function() {};
                        i.prototype = t.prototype;
                        var s = new i,
                            o = t.apply(s, n.concat(O.call(arguments)));
                        return Object(o) === o ? o : s
                    }
                    return t.apply(e, n.concat(O.call(arguments)))
                };
            return r
        }), C.flexbox = function() {
            return f("flexWrap")
        }, C.flexboxlegacy = function() {
            return f("boxDirection")
        }, C.canvas = function() {
            var e = t.createElement("canvas");
            return !!e.getContext && !!e.getContext("2d")
        }, C.canvastext = function() {
            return !!h.canvas && !!s(t.createElement("canvas").getContext("2d").fillText, "function")
        }, C.webgl = function() {
            return !!e.WebGLRenderingContext
        }, C.touch = function() {
            var n;
            return "ontouchstart" in e || e.DocumentTouch && t instanceof DocumentTouch ? n = !0 : _(["@media (", E.join("touch-enabled),("), v, ")", "{#modernizr{top:9px;position:absolute}}"].join(""), function(e) {
                n = e.offsetTop === 9
            }), n
        }, C.geolocation = function() {
            return "geolocation" in navigator
        }, C.postmessage = function() {
            return !!e.postMessage
        }, C.websqldatabase = function() {
            return !!e.openDatabase
        }, C.indexedDB = function() {
            return !!f("indexedDB", e)
        }, C.hashchange = function() {
            return D("hashchange", e) && (t.documentMode === n || t.documentMode > 7)
        }, C.history = function() {
            return !!e.history && !!history.pushState
        }, C.draganddrop = function() {
            var e = t.createElement("div");
            return "draggable" in e || "ondragstart" in e && "ondrop" in e
        }, C.websockets = function() {
            return "WebSocket" in e || "MozWebSocket" in e
        }, C.rgba = function() {
            return r("background-color:rgba(150,255,150,.5)"), o(g.backgroundColor, "rgba")
        }, C.hsla = function() {
            return r("background-color:hsla(120,40%,100%,.5)"), o(g.backgroundColor, "rgba") || o(g.backgroundColor, "hsla")
        }, C.multiplebgs = function() {
            return r("background:url(https://),url(https://),red url(https://)"), /(url\s*\(.*?){3}/.test(g.background)
        }, C.backgroundsize = function() {
            return f("backgroundSize")
        }, C.borderimage = function() {
            return f("borderImage")
        }, C.borderradius = function() {
            return f("borderRadius")
        }, C.boxshadow = function() {
            return f("boxShadow")
        }, C.textshadow = function() {
            return t.createElement("div").style.textShadow === ""
        }, C.opacity = function() {
            return i("opacity:.55"), /^0.55$/.test(g.opacity)
        }, C.cssanimations = function() {
            return f("animationName")
        }, C.csscolumns = function() {
            return f("columnCount")
        }, C.cssgradients = function() {
            var e = "background-image:",
                t = "gradient(linear,left top,right bottom,from(#9f9),to(white));",
                n = "linear-gradient(left top,#9f9, white);";
            return r((e + "-webkit- ".split(" ").join(t + e) + E.join(n + e)).slice(0, -e.length)), o(g.backgroundImage, "gradient")
        }, C.cssreflections = function() {
            return f("boxReflect")
        }, C.csstransforms = function() {
            return !!f("transform")
        }, C.csstransforms3d = function() {
            var e = !!f("perspective");
            return e && "webkitPerspective" in d.style && _("@media (transform-3d),(-webkit-transform-3d){#modernizr{left:9px;position:absolute;height:3px;}}", function(t, n) {
                e = t.offsetLeft === 9 && t.offsetHeight === 3
            }), e
        }, C.csstransitions = function() {
            return f("transition")
        }, C.fontface = function() {
            var e;
            return _('@font-face {font-family:"font";src:url("https://")}', function(n, r) {
                var i = t.getElementById("smodernizr"),
                    s = i.sheet || i.styleSheet,
                    o = s ? s.cssRules && s.cssRules[0] ? s.cssRules[0].cssText : s.cssText || "" : "";
                e = /src/i.test(o) && o.indexOf(r.split(" ")[0]) === 0
            }), e
        }, C.generatedcontent = function() {
            var e;
            return _(["#", v, "{font:0/0 a}#", v, ':after{content:"', b, '";visibility:hidden;font:3px/1 a}'].join(""), function(t) {
                e = t.offsetHeight >= 3
            }), e
        }, C.video = function() {
            var e = t.createElement("video"),
                n = !1;
            try {
                if (n = !!e.canPlayType) n = new Boolean(n), n.ogg = e.canPlayType('video/ogg; codecs="theora"').replace(/^no$/, ""), n.h264 = e.canPlayType('video/mp4; codecs="avc1.42E01E"').replace(/^no$/, ""), n.webm = e.canPlayType('video/webm; codecs="vp8, vorbis"').replace(/^no$/, "")
            } catch (r) {}
            return n
        }, C.audio = function() {
            var e = t.createElement("audio"),
                n = !1;
            try {
                if (n = !!e.canPlayType) n = new Boolean(n), n.ogg = e.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/, ""), n.mp3 = e.canPlayType("audio/mpeg;").replace(/^no$/, ""), n.wav = e.canPlayType('audio/wav; codecs="1"').replace(/^no$/, ""), n.m4a = (e.canPlayType("audio/x-m4a;") || e.canPlayType("audio/aac;")).replace(/^no$/, "")
            } catch (r) {}
            return n
        }, C.localstorage = function() {
            try {
                return localStorage.setItem(v, v), localStorage.removeItem(v), !0
            } catch (e) {
                return !1
            }
        }, C.sessionstorage = function() {
            try {
                return sessionStorage.setItem(v, v), sessionStorage.removeItem(v), !0
            } catch (e) {
                return !1
            }
        }, C.webworkers = function() {
            return !!e.Worker
        }, C.applicationcache = function() {
            return !!e.applicationCache
        }, C.svg = function() {
            return !!t.createElementNS && !!t.createElementNS(N.svg, "svg").createSVGRect
        }, C.inlinesvg = function() {
            var e = t.createElement("div");
            return e.innerHTML = "<svg/>", (e.firstChild && e.firstChild.namespaceURI) == N.svg
        }, C.smil = function() {
            return !!t.createElementNS && /SVGAnimate/.test(w.call(t.createElementNS(N.svg, "animate")))
        }, C.svgclippaths = function() {
            return !!t.createElementNS && /SVGClipPath/.test(w.call(t.createElementNS(N.svg, "clipPath")))
        };
        for (var B in C) H(C, B) && (M = B.toLowerCase(), h[M] = C[B](), A.push((h[M] ? "" : "no-") + M));
        return h.input || l(), h.addTest = function(e, t) {
                if (typeof e == "object")
                    for (var r in e) H(e, r) && h.addTest(r, e[r]);
                else {
                    e = e.toLowerCase();
                    if (h[e] !== n) return h;
                    t = typeof t == "function" ? t() : t, typeof p != "undefined" && p && (d.className += " " + (t ? "" : "no-") + e), h[e] = t
                }
                return h
            }, r(""), m = y = null,
            function(e, t) {
                function n(e, t) {
                    var n = e.createElement("p"),
                        r = e.getElementsByTagName("head")[0] || e.documentElement;
                    return n.innerHTML = "x<style>" + t + "</style>", r.insertBefore(n.lastChild, r.firstChild)
                }

                function r() {
                    var e = g.elements;
                    return typeof e == "string" ? e.split(" ") : e
                }

                function i(e) {
                    var t = v[e[p]];
                    return t || (t = {}, d++, e[p] = d, v[d] = t), t
                }

                function s(e, n, r) {
                    n || (n = t);
                    if (m) return n.createElement(e);
                    r || (r = i(n));
                    var s;
                    return r.cache[e] ? s = r.cache[e].cloneNode() : c.test(e) ? s = (r.cache[e] = r.createElem(e)).cloneNode() : s = r.createElem(e), s.canHaveChildren && !l.test(e) ? r.frag.appendChild(s) : s
                }

                function o(e, n) {
                    e || (e = t);
                    if (m) return e.createDocumentFragment();
                    n = n || i(e);
                    var s = n.frag.cloneNode(),
                        o = 0,
                        u = r(),
                        a = u.length;
                    for (; o < a; o++) s.createElement(u[o]);
                    return s
                }

                function u(e, t) {
                    t.cache || (t.cache = {}, t.createElem = e.createElement, t.createFrag = e.createDocumentFragment, t.frag = t.createFrag()), e.createElement = function(n) {
                        return g.shivMethods ? s(n, e, t) : t.createElem(n)
                    }, e.createDocumentFragment = Function("h,f", "return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&(" + r().join().replace(/\w+/g, function(e) {
                        return t.createElem(e), t.frag.createElement(e), 'c("' + e + '")'
                    }) + ");return n}")(g, t.frag)
                }

                function a(e) {
                    e || (e = t);
                    var r = i(e);
                    return g.shivCSS && !h && !r.hasCSS && (r.hasCSS = !!n(e, "article,aside,figcaption,figure,footer,header,hgroup,nav,section{display:block}mark{background:#FF0;color:#000}")), m || u(e, r), e
                }
                var f = e.html5 || {},
                    l = /^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,
                    c = /^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,
                    h, p = "_html5shiv",
                    d = 0,
                    v = {},
                    m;
                (function() {
                    try {
                        var e = t.createElement("a");
                        e.innerHTML = "<xyz></xyz>", h = "hidden" in e, m = e.childNodes.length == 1 || function() {
                            t.createElement("a");
                            var e = t.createDocumentFragment();
                            return typeof e.cloneNode == "undefined" || typeof e.createDocumentFragment == "undefined" || typeof e.createElement == "undefined"
                        }()
                    } catch (n) {
                        h = !0, m = !0
                    }
                })();
                var g = {
                    elements: f.elements || "abbr article aside audio bdi canvas data datalist details figcaption figure footer header hgroup mark meter nav output progress section summary time video",
                    shivCSS: f.shivCSS !== !1,
                    supportsUnknownElements: m,
                    shivMethods: f.shivMethods !== !1,
                    type: "default",
                    shivDocument: a,
                    createElement: s,
                    createDocumentFragment: o
                };
                e.html5 = g, a(t)
            }(this, t), h._version = c, h._prefixes = E, h._domPrefixes = T, h._cssomPrefixes = x, h.hasEvent = D, h.testProp = function(e) {
                return u([e])
            }, h.testAllProps = f, h.testStyles = _, d.className = d.className.replace(/(^|\s)no-js(\s|$)/, "$1$2") + (p ? " js " + A.join(" ") : ""), h
    }(this, this.document),
    function(e, t, n) {
        function r(e) {
            return "[object Function]" == d.call(e)
        }

        function i(e) {
            return "string" == typeof e
        }

        function s() {}

        function o(e) {
            return !e || "loaded" == e || "complete" == e || "uninitialized" == e
        }

        function u() {
            var e = v.shift();
            m = 1, e ? e.t ? h(function() {
                ("c" == e.t ? k.injectCss : k.injectJs)(e.s, 0, e.a, e.x, e.e, 1)
            }, 0) : (e(), u()) : m = 0
        }

        function a(e, n, r, i, s, a, f) {
            function l(t) {
                if (!d && o(c.readyState) && (w.r = d = 1, !m && u(), c.onload = c.onreadystatechange = null, t)) {
                    "img" != e && h(function() {
                        b.removeChild(c)
                    }, 50);
                    for (var r in T[n]) T[n].hasOwnProperty(r) && T[n][r].onload()
                }
            }
            var f = f || k.errorTimeout,
                c = t.createElement(e),
                d = 0,
                g = 0,
                w = {
                    t: r,
                    s: n,
                    e: s,
                    a: a,
                    x: f
                };
            1 === T[n] && (g = 1, T[n] = []), "object" == e ? c.data = n : (c.src = n, c.type = e), c.width = c.height = "0", c.onerror = c.onload = c.onreadystatechange = function() {
                l.call(this, g)
            }, v.splice(i, 0, w), "img" != e && (g || 2 === T[n] ? (b.insertBefore(c, y ? null : p), h(l, f)) : T[n].push(c))
        }

        function f(e, t, n, r, s) {
            return m = 0, t = t || "j", i(e) ? a("c" == t ? E : w, e, t, this.i++, n, r, s) : (v.splice(this.i++, 0, e), 1 == v.length && u()), this
        }

        function l() {
            var e = k;
            return e.loader = {
                load: f,
                i: 0
            }, e
        }
        var c = t.documentElement,
            h = e.setTimeout,
            p = t.getElementsByTagName("script")[0],
            d = {}.toString,
            v = [],
            m = 0,
            g = "MozAppearance" in c.style,
            y = g && !!t.createRange().compareNode,
            b = y ? c : p.parentNode,
            c = e.opera && "[object Opera]" == d.call(e.opera),
            c = !!t.attachEvent && !c,
            w = g ? "object" : c ? "script" : "img",
            E = c ? "script" : w,
            S = Array.isArray || function(e) {
                return "[object Array]" == d.call(e)
            },
            x = [],
            T = {},
            N = {
                timeout: function(e, t) {
                    return t.length && (e.timeout = t[0]), e
                }
            },
            C, k;
        k = function(e) {
            function t(e) {
                var e = e.split("!"),
                    t = x.length,
                    n = e.pop(),
                    r = e.length,
                    n = {
                        url: n,
                        origUrl: n,
                        prefixes: e
                    },
                    i, s, o;
                for (s = 0; s < r; s++) o = e[s].split("="), (i = N[o.shift()]) && (n = i(n, o));
                for (s = 0; s < t; s++) n = x[s](n);
                return n
            }

            function o(e, i, s, o, u) {
                var a = t(e),
                    f = a.autoCallback;
                a.url.split(".").pop().split("?").shift(), a.bypass || (i && (i = r(i) ? i : i[e] || i[o] || i[e.split("/").pop().split("?")[0]]), a.instead ? a.instead(e, i, s, o, u) : (T[a.url] ? a.noexec = !0 : T[a.url] = 1, s.load(a.url, a.forceCSS || !a.forceJS && "css" == a.url.split(".").pop().split("?").shift() ? "c" : n, a.noexec, a.attrs, a.timeout), (r(i) || r(f)) && s.load(function() {
                    l(), i && i(a.origUrl, u, o), f && f(a.origUrl, u, o), T[a.url] = 2
                })))
            }

            function u(e, t) {
                function n(e, n) {
                    if (e) {
                        if (i(e)) n || (f = function() {
                            var e = [].slice.call(arguments);
                            l.apply(this, e), c()
                        }), o(e, f, t, 0, u);
                        else if (Object(e) === e)
                            for (p in h = function() {
                                var t = 0,
                                    n;
                                for (n in e) e.hasOwnProperty(n) && t++;
                                return t
                            }(), e) e.hasOwnProperty(p) && (!n && !--h && (r(f) ? f = function() {
                                var e = [].slice.call(arguments);
                                l.apply(this, e), c()
                            } : f[p] = function(e) {
                                return function() {
                                    var t = [].slice.call(arguments);
                                    e && e.apply(this, t), c()
                                }
                            }(l[p])), o(e[p], f, t, p, u))
                    } else !n && c()
                }
                var u = !!e.test,
                    a = e.load || e.both,
                    f = e.callback || s,
                    l = f,
                    c = e.complete || s,
                    h, p;
                n(u ? e.yep : e.nope, !!a), a && n(a)
            }
            var a, f, c = this.yepnope.loader;
            if (i(e)) o(e, 0, c, 0);
            else if (S(e))
                for (a = 0; a < e.length; a++) f = e[a], i(f) ? o(f, 0, c, 0) : S(f) ? k(f) : Object(f) === f && u(f, c);
            else Object(e) === e && u(e, c)
        }, k.addPrefix = function(e, t) {
            N[e] = t
        }, k.addFilter = function(e) {
            x.push(e)
        }, k.errorTimeout = 1e4, null == t.readyState && t.addEventListener && (t.readyState = "loading", t.addEventListener("DOMContentLoaded", C = function() {
            t.removeEventListener("DOMContentLoaded", C, 0), t.readyState = "complete"
        }, 0)), e.yepnope = l(), e.yepnope.executeStack = u, e.yepnope.injectJs = function(e, n, r, i, a, f) {
            var l = t.createElement("script"),
                c, d, i = i || k.errorTimeout;
            l.src = e;
            for (d in r) l.setAttribute(d, r[d]);
            n = f ? u : n || s, l.onreadystatechange = l.onload = function() {
                !c && o(l.readyState) && (c = 1, n(), l.onload = l.onreadystatechange = null)
            }, h(function() {
                c || (c = 1, n(1))
            }, i), a ? l.onload() : p.parentNode.insertBefore(l, p)
        }, e.yepnope.injectCss = function(e, n, r, i, o, a) {
            var i = t.createElement("link"),
                f, n = a ? u : n || s;
            i.href = e, i.rel = "stylesheet", i.type = "text/css";
            for (f in r) i.setAttribute(f, r[f]);
            o || (p.parentNode.insertBefore(i, p), h(n, 0))
        }
    }(this, document), Modernizr.load = function() {
        yepnope.apply(window, [].slice.call(arguments, 0))
    }, define("Libs/Modernizr", ["Libs/Modernizr/modernizr-2.6.2.min"], function(e) {
        return e
    }), define("Libs/Modernizr/modernizr-2.6.2.min", function() {}),
    function(e) {
        typeof define == "function" && define.amd && define.amd.jQuery ? define("Libs/jQuery/Cookie/jquery.cookie-1.3.1", ["jquery"], e) : e(jQuery)
    }(function(e) {
        function n(e) {
            return e
        }

        function r(e) {
            return decodeURIComponent(e.replace(t, " "))
        }

        function i(e) {
            e.indexOf('"') === 0 && (e = e.slice(1, -1).replace(/\\"/g, '"').replace(/\\\\/g, "\\"));
            try {
                return s.json ? JSON.parse(e) : e
            } catch (t) {}
        }
        var t = /\+/g,
            s = e.cookie = function(t, o, u) {
                if (o !== undefined) {
                    u = e.extend({}, s.defaults, u);
                    if (typeof u.expires == "number") {
                        var a = u.expires,
                            f = u.expires = new Date;
                        f.setDate(f.getDate() + a)
                    }
                    return o = s.json ? JSON.stringify(o) : String(o), document.cookie = [encodeURIComponent(t), "=", s.raw ? o : encodeURIComponent(o), u.expires ? "; expires=" + u.expires.toUTCString() : "", u.path ? "; path=" + u.path : "", u.domain ? "; domain=" + u.domain : "", u.secure ? "; secure" : ""].join("")
                }
                var l = s.raw ? n : r,
                    c = document.cookie.split("; "),
                    h = t ? undefined : {};
                for (var p = 0, d = c.length; p < d; p++) {
                    var v = c[p].split("="),
                        m = l(v.shift()),
                        g = l(v.join("="));
                    if (t && t === m) {
                        h = i(g);
                        break
                    }
                    t || (h[m] = i(g))
                }
                return h
            };
        s.defaults = {}, e.removeCookie = function(t, n) {
            return e.cookie(t) !== undefined ? (e.cookie(t, "", e.extend(n, {
                expires: -1
            })), !0) : !1
        }
    }), define("Libs/jQuery/Cookie", ["Libs/jQuery/Cookie/jquery.cookie-1.3.1"], function(e) {
        return e
    }),
    function(e) {
        function r(e) {
            if (e in t.style) return e;
            var n = ["Moz", "Webkit", "O", "ms"],
                r = e.charAt(0).toUpperCase() + e.substr(1);
            if (e in t.style) return e;
            for (var i = 0; i < n.length; ++i) {
                var s = n[i] + r;
                if (s in t.style) return s
            }
        }

        function i() {
            return t.style[n.transform] = "", t.style[n.transform] = "rotateY(90deg)", t.style[n.transform] !== ""
        }

        function f(e) {
            return typeof e == "string" && this.parse(e), this
        }

        function l(e, t, n) {
            t === !0 ? e.queue(n) : t ? e.queue(t, n) : n()
        }

        function c(t) {
            var n = [];
            return e.each(t, function(t) {
                t = e.camelCase(t), t = e.transit.propertyMap[t] || e.cssProps[t] || t, t = d(t), e.inArray(t, n) === -1 && n.push(t)
            }), n
        }

        function h(t, n, r, i) {
            var s = c(t);
            e.cssEase[r] && (r = e.cssEase[r]);
            var o = "" + m(n) + " " + r;
            parseInt(i, 10) > 0 && (o += " " + m(i));
            var u = [];
            return e.each(s, function(e, t) {
                u.push(t + " " + o)
            }), u.join(", ")
        }

        function p(t, r) {
            r || (e.cssNumber[t] = !0), e.transit.propertyMap[t] = n.transform, e.cssHooks[t] = {
                get: function(n) {
                    var r = e(n).css("transit:transform");
                    return r.get(t)
                },
                set: function(n, r) {
                    var i = e(n).css("transit:transform");
                    i.setFromString(t, r), e(n).css({
                        "transit:transform": i
                    })
                }
            }
        }

        function d(e) {
            return e.replace(/([A-Z])/g, function(e) {
                return "-" + e.toLowerCase()
            })
        }

        function v(e, t) {
            return typeof e == "string" && !e.match(/^[\-0-9\.]+$/) ? e : "" + e + t
        }

        function m(t) {
            var n = t;
            return e.fx.speeds[n] && (n = e.fx.speeds[n]), v(n, "ms")
        }
        e.transit = {
            version: "0.9.9",
            propertyMap: {
                marginLeft: "margin",
                marginRight: "margin",
                marginBottom: "margin",
                marginTop: "margin",
                paddingLeft: "padding",
                paddingRight: "padding",
                paddingBottom: "padding",
                paddingTop: "padding"
            },
            enabled: !0,
            useTransitionEnd: !1
        };
        var t = document.createElement("div"),
            n = {},
            s = navigator.userAgent.toLowerCase().indexOf("chrome") > -1;
        n.transition = r("transition"), n.transitionDelay = r("transitionDelay"), n.transform = r("transform"), n.transformOrigin = r("transformOrigin"), n.transform3d = i();
        var o = {
                transition: "transitionEnd",
                MozTransition: "transitionend",
                OTransition: "oTransitionEnd",
                WebkitTransition: "webkitTransitionEnd",
                msTransition: "MSTransitionEnd"
            },
            u = n.transitionEnd = o[n.transition] || null;
        for (var a in n) n.hasOwnProperty(a) && typeof e.support[a] == "undefined" && (e.support[a] = n[a]);
        t = null, e.cssEase = {
            _default: "ease",
            "in": "ease-in",
            out: "ease-out",
            "in-out": "ease-in-out",
            snap: "cubic-bezier(0,1,.5,1)",
            easeOutCubic: "cubic-bezier(.215,.61,.355,1)",
            easeInOutCubic: "cubic-bezier(.645,.045,.355,1)",
            easeInCirc: "cubic-bezier(.6,.04,.98,.335)",
            easeOutCirc: "cubic-bezier(.075,.82,.165,1)",
            easeInOutCirc: "cubic-bezier(.785,.135,.15,.86)",
            easeInExpo: "cubic-bezier(.95,.05,.795,.035)",
            easeOutExpo: "cubic-bezier(.19,1,.22,1)",
            easeInOutExpo: "cubic-bezier(1,0,0,1)",
            easeInQuad: "cubic-bezier(.55,.085,.68,.53)",
            easeOutQuad: "cubic-bezier(.25,.46,.45,.94)",
            easeInOutQuad: "cubic-bezier(.455,.03,.515,.955)",
            easeInQuart: "cubic-bezier(.895,.03,.685,.22)",
            easeOutQuart: "cubic-bezier(.165,.84,.44,1)",
            easeInOutQuart: "cubic-bezier(.77,0,.175,1)",
            easeInQuint: "cubic-bezier(.755,.05,.855,.06)",
            easeOutQuint: "cubic-bezier(.23,1,.32,1)",
            easeInOutQuint: "cubic-bezier(.86,0,.07,1)",
            easeInSine: "cubic-bezier(.47,0,.745,.715)",
            easeOutSine: "cubic-bezier(.39,.575,.565,1)",
            easeInOutSine: "cubic-bezier(.445,.05,.55,.95)",
            easeInBack: "cubic-bezier(.6,-.28,.735,.045)",
            easeOutBack: "cubic-bezier(.175, .885,.32,1.275)",
            easeInOutBack: "cubic-bezier(.68,-.55,.265,1.55)"
        }, e.cssHooks["transit:transform"] = {
            get: function(t) {
                return e(t).data("transform") || new f
            },
            set: function(t, r) {
                var i = r;
                i instanceof f || (i = new f(i)), n.transform === "WebkitTransform" && !s ? t.style[n.transform] = i.toString(!0) : t.style[n.transform] = i.toString(), e(t).data("transform", i)
            }
        }, e.cssHooks.transform = {
            set: e.cssHooks["transit:transform"].set
        }, e.fn.jquery < "1.8" && (e.cssHooks.transformOrigin = {
            get: function(e) {
                return e.style[n.transformOrigin]
            },
            set: function(e, t) {
                e.style[n.transformOrigin] = t
            }
        }, e.cssHooks.transition = {
            get: function(e) {
                return e.style[n.transition]
            },
            set: function(e, t) {
                e.style[n.transition] = t
            }
        }), p("scale"), p("translate"), p("rotate"), p("rotateX"), p("rotateY"), p("rotate3d"), p("perspective"), p("skewX"), p("skewY"), p("x", !0), p("y", !0), f.prototype = {
            setFromString: function(e, t) {
                var n = typeof t == "string" ? t.split(",") : t.constructor === Array ? t : [t];
                n.unshift(e), f.prototype.set.apply(this, n)
            },
            set: function(e) {
                var t = Array.prototype.slice.apply(arguments, [1]);
                this.setter[e] ? this.setter[e].apply(this, t) : this[e] = t.join(",")
            },
            get: function(e) {
                return this.getter[e] ? this.getter[e].apply(this) : this[e] || 0
            },
            setter: {
                rotate: function(e) {
                    this.rotate = v(e, "deg")
                },
                rotateX: function(e) {
                    this.rotateX = v(e, "deg")
                },
                rotateY: function(e) {
                    this.rotateY = v(e, "deg")
                },
                scale: function(e, t) {
                    t === undefined && (t = e), this.scale = e + "," + t
                },
                skewX: function(e) {
                    this.skewX = v(e, "deg")
                },
                skewY: function(e) {
                    this.skewY = v(e, "deg")
                },
                perspective: function(e) {
                    this.perspective = v(e, "px")
                },
                x: function(e) {
                    this.set("translate", e, null)
                },
                y: function(e) {
                    this.set("translate", null, e)
                },
                translate: function(e, t) {
                    this._translateX === undefined && (this._translateX = 0), this._translateY === undefined && (this._translateY = 0), e !== null && e !== undefined && (this._translateX = v(e, "px")), t !== null && t !== undefined && (this._translateY = v(t, "px")), this.translate = this._translateX + "," + this._translateY
                }
            },
            getter: {
                x: function() {
                    return this._translateX || 0
                },
                y: function() {
                    return this._translateY || 0
                },
                scale: function() {
                    var e = (this.scale || "1,1").split(",");
                    return e[0] && (e[0] = parseFloat(e[0])), e[1] && (e[1] = parseFloat(e[1])), e[0] === e[1] ? e[0] : e
                },
                rotate3d: function() {
                    var e = (this.rotate3d || "0,0,0,0deg").split(",");
                    for (var t = 0; t <= 3; ++t) e[t] && (e[t] = parseFloat(e[t]));
                    return e[3] && (e[3] = v(e[3], "deg")), e
                }
            },
            parse: function(e) {
                var t = this;
                e.replace(/([a-zA-Z0-9]+)\((.*?)\)/g, function(e, n, r) {
                    t.setFromString(n, r)
                })
            },
            toString: function(e) {
                var t = [];
                for (var r in this)
                    if (this.hasOwnProperty(r)) {
                        if (!n.transform3d && (r === "rotateX" || r === "rotateY" || r === "perspective" || r === "transformOrigin")) continue;
                        r[0] !== "_" && (e && r === "scale" ? t.push(r + "3d(" + this[r] + ",1)") : e && r === "translate" ? t.push(r + "3d(" + this[r] + ",0)") : t.push(r + "(" + this[r] + ")"))
                    }
                return t.join(" ")
            }
        }, e.fn.transition = e.fn.transit = function(t, r, i, s) {
            var o = this,
                a = 0,
                f = !0;
            typeof r == "function" && (s = r, r = undefined), typeof i == "function" && (s = i, i = undefined), typeof t.easing != "undefined" && (i = t.easing, delete t.easing), typeof t.duration != "undefined" && (r = t.duration, delete t.duration), typeof t.complete != "undefined" && (s = t.complete, delete t.complete), typeof t.queue != "undefined" && (f = t.queue, delete t.queue), typeof t.delay != "undefined" && (a = t.delay, delete t.delay), typeof r == "undefined" && (r = e.fx.speeds._default), typeof i == "undefined" && (i = e.cssEase._default), r = m(r);
            var c = h(t, r, i, a),
                p = e.transit.enabled && n.transition,
                d = p ? parseInt(r, 10) + parseInt(a, 10) : 0;
            if (d === 0) {
                var v = function(e) {
                    o.css(t), s && s.apply(o), e && e()
                };
                return l(o, f, v), o
            }
            var g = {},
                y = function(r) {
                    var i = !1,
                        a = function() {
                            i && o.unbind(u, a), d > 0 && o.each(function() {
                                this.style[n.transition] = g[this] || null
                            }), typeof s == "function" && s.apply(o), typeof r == "function" && r()
                        };
                    d > 0 && u && e.transit.useTransitionEnd ? (i = !0, o.bind(u, a)) : window.setTimeout(a, d), o.each(function() {
                        d > 0 && (this.style[n.transition] = c), e(this).css(t)
                    })
                },
                b = function(e) {
                    this.offsetWidth, y(e)
                };
            return l(o, f, b), this
        }, e.transit.getTransitionValue = h
    }(jQuery), define("Libs/jQuery/Transit", ["Libs/jQuery/Transit/jquery.transit-0.9.9"], function(e) {
        return e
    }), define("Libs/jQuery/Transit/jquery.transit-0.9.9", function() {}),
    function(e) {
        function n(e) {
            return typeof e == "object" ? e : {
                top: e,
                left: e
            }
        }
        var t = e.scrollTo = function(t, n, r) {
            e(window).scrollTo(t, n, r)
        };
        t.defaults = {
            axis: "xy",
            duration: parseFloat(e.fn.jquery) >= 1.3 ? 0 : 1,
            limit: !0
        }, t.window = function(t) {
            return e(window)._scrollable()
        }, e.fn._scrollable = function() {
            return this.map(function() {
                var t = this,
                    n = !t.nodeName || e.inArray(t.nodeName.toLowerCase(), ["iframe", "#document", "html", "body"]) != -1;
                if (!n) return t;
                var r = (t.contentWindow || t).document || t.ownerDocument || t;
                return /webkit/i.test(navigator.userAgent) || r.compatMode == "BackCompat" ? r.body : r.documentElement
            })
        }, e.fn.scrollTo = function(r, i, s) {
            return typeof i == "object" && (s = i, i = 0), typeof s == "function" && (s = {
                onAfter: s
            }), r == "max" && (r = 9e9), s = e.extend({}, t.defaults, s), i = i || s.duration, s.queue = s.queue && s.axis.length > 1, s.queue && (i /= 2), s.offset = n(s.offset), s.over = n(s.over), this._scrollable().each(function() {
                function h(e) {
                    u.animate(l, i, s.easing, e && function() {
                        e.call(this, r, s)
                    })
                }
                if (r == null) return;
                var o = this,
                    u = e(o),
                    a = r,
                    f, l = {},
                    c = u.is("html,body");
                switch (typeof a) {
                    case "number":
                    case "string":
                        if (/^([+-]=)?\d+(\.\d+)?(px|%)?$/.test(a)) {
                            a = n(a);
                            break
                        }
                        a = e(a, this);
                        if (!a.length) return;
                    case "object":
                        if (a.is || a.style) f = (a = e(a)).offset()
                }
                e.each(s.axis.split(""), function(e, n) {
                    var r = n == "x" ? "Left" : "Top",
                        i = r.toLowerCase(),
                        p = "scroll" + r,
                        d = o[p],
                        v = t.max(o, n);
                    if (f) l[p] = f[i] + (c ? 0 : d - u.offset()[i]), s.margin && (l[p] -= parseInt(a.css("margin" + r)) || 0, l[p] -= parseInt(a.css("border" + r + "Width")) || 0), l[p] += s.offset[i] || 0, s.over[i] && (l[p] += a[n == "x" ? "width" : "height"]() * s.over[i]);
                    else {
                        var m = a[i];
                        l[p] = m.slice && m.slice(-1) == "%" ? parseFloat(m) / 100 * v : m
                    }
                    s.limit && /^\d+$/.test(l[p]) && (l[p] = l[p] <= 0 ? 0 : Math.min(l[p], v)), !e && s.queue && (d != l[p] && h(s.onAfterFirst), delete l[p])
                }), h(s.onAfter)
            }).end()
        }, t.max = function(t, n) {
            var r = n == "x" ? "Width" : "Height",
                i = "scroll" + r;
            if (!e(t).is("html,body")) return t[i] - e(t)[r.toLowerCase()]();
            var s = "client" + r,
                o = t.ownerDocument.documentElement,
                u = t.ownerDocument.body;
            return Math.max(o[i], u[i]) - Math.min(o[s], u[s])
        }
    }(jQuery), define("Libs/jQuery/ScrollTo", ["Libs/jQuery/ScrollTo/jquery.scrollTo-1.4.3.1"], function(e) {
        return e
    }), define("Libs/jQuery/ScrollTo/jquery.scrollTo-1.4.3.1", function() {}),
    function($) {
        var escape = /["\\\x00-\x1f\x7f-\x9f]/g,
            meta = {
                "\b": "\\b",
                "	": "\\t",
                "\n": "\\n",
                "\f": "\\f",
                "\r": "\\r",
                '"': '\\"',
                "\\": "\\\\"
            },
            hasOwn = Object.prototype.hasOwnProperty;
        $.toJSON = typeof JSON == "object" && JSON.stringify ? JSON.stringify : function(e) {
            if (e === null) return "null";
            var t, n, r, i, s = $.type(e);
            if (s === "undefined") return undefined;
            if (s === "number" || s === "boolean") return String(e);
            if (s === "string") return $.quoteString(e);
            if (typeof e.toJSON == "function") return $.toJSON(e.toJSON());
            if (s === "date") {
                var o = e.getUTCMonth() + 1,
                    u = e.getUTCDate(),
                    a = e.getUTCFullYear(),
                    f = e.getUTCHours(),
                    l = e.getUTCMinutes(),
                    c = e.getUTCSeconds(),
                    h = e.getUTCMilliseconds();
                return o < 10 && (o = "0" + o), u < 10 && (u = "0" + u), f < 10 && (f = "0" + f), l < 10 && (l = "0" + l), c < 10 && (c = "0" + c), h < 100 && (h = "0" + h), h < 10 && (h = "0" + h), '"' + a + "-" + o + "-" + u + "T" + f + ":" + l + ":" + c + "." + h + 'Z"'
            }
            t = [];
            if ($.isArray(e)) {
                for (n = 0; n < e.length; n++) t.push($.toJSON(e[n]) || "null");
                return "[" + t.join(",") + "]"
            }
            if (typeof e == "object") {
                for (n in e)
                    if (hasOwn.call(e, n)) {
                        s = typeof n;
                        if (s === "number") r = '"' + n + '"';
                        else {
                            if (s !== "string") continue;
                            r = $.quoteString(n)
                        }
                        s = typeof e[n], s !== "function" && s !== "undefined" && (i = $.toJSON(e[n]), t.push(r + ":" + i))
                    }
                return "{" + t.join(",") + "}"
            }
        }, $.evalJSON = typeof JSON == "object" && JSON.parse ? JSON.parse : function(str) {
            return eval("(" + str + ")")
        }, $.secureEvalJSON = typeof JSON == "object" && JSON.parse ? JSON.parse : function(str) {
            var filtered = str.replace(/\\["\\\/bfnrtu]/g, "@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g, "]").replace(/(?:^|:|,)(?:\s*\[)+/g, "");
            if (/^[\],:{}\s]*$/.test(filtered)) return eval("(" + str + ")");
            throw new SyntaxError("Error parsing JSON, source is not valid.")
        }, $.quoteString = function(e) {
            return e.match(escape) ? '"' + e.replace(escape, function(e) {
                var t = meta[e];
                return typeof t == "string" ? t : (t = e.charCodeAt(), "\\u00" + Math.floor(t / 16).toString(16) + (t % 16).toString(16))
            }) + '"' : '"' + e + '"'
        }
    }(jQuery), define("Libs/jQuery/JSON", ["Libs/jQuery/JSON/jquery.json-2.4"], function(e) {
        return e
    }), define("Libs/jQuery/JSON/jquery.json-2.4", function() {}), requirejs(["backbone", "Config", "Libs/Backbone/Validation", "Router", "Shared/Auth/Model", "Shared/EventManager/Model", "Shared/Session/Model", "StaticPages", "Shared/Container/Views/Main", "Shared/Audio", "Shared/Services/Model", "Chat/Views/Main", "UnderscoreExtends", "Libs/Modernizr", "Libs/jQuery/Cookie", "Libs/jQuery/Transit", "Libs/jQuery/ScrollTo", "Libs/jQuery/JSON"], function(Backbone, Config, BackboneValidation, Router, AuthModel, EventManager, Session, StaticPages, ContainerView, Audio, ServicesModel, ChatView) {
        $(document).ready(function() {
            function Hit() {
                if (typeof __last_url != "undefined" && __last_url === window.location.href) return;
                __last_url = window.location.href
            }
            window.Socket = {
                Main: io.connect(SOCKETIO_HOST),
                Base: io.connect(SOCKETIO_HOST + "/base")
            }, window.EventManager = new EventManager, window.Session = new Session, window.Uid = Uid, window.User = window.User === "" ? {} : $.parseJSON(window.User), window.Auth = new AuthModel, window.Pages = StaticPages, window.ContainerView = new ContainerView, window.Router = new Router, window.Router.on("route navigateWithoutTrigger", Hit), window.AppData = {
                date: function(e) {
                    $.get("/api/datetime", function(t) {
                        e(t.date)
                    })
                },
                time: function() {
                    return (new DateObject).getTime()
                }
            }, window.Services = window.Services === "" ? {} : $.parseJSON(window.Services), window.ServicesModel = new ServicesModel(window.Services), window.Audio = Audio, window.UsersOnline = [], typeof VK == "object" && window.VK.init({
                apiId: 2350028
            });
            if ($.browser.msie) {
                window.ContainerView.badBrowser();
                return
            }
            Modernizr.history ? Backbone.history.start({
                pushState: !0
            }) : Backbone.history.start({
                root: "/base-/",
                pushState: !0
            }), $("a:not(.router-false)").live("click", function(e) {
                e.preventDefault(), $(e.currentTarget).attr("href") && (window.Router.navigate($(e.currentTarget).attr("href"), !$(this).hasClass("trigger-false")), window.Router.trigger("navigateWithoutTrigger"))
            }), $.support.transition || ($.fn.transition = $.fn.animate), $(window).error(function(e) {
                $.post("/api/errorReport", {
                    filename: e.originalEvent.filename,
                    line: e.originalEvent.lineno,
                    message: e.originalEvent.message
                })
            }), eval(function() {
                var e = "",
                    t, n = 0,
                    r = "",
                    i = "118!97!114!32!68!97!116!101!79!98!106!101!99!116!32!61!32!102!117!110!99!116!105!111!110!40!41!32!123!10!32!32!32!32!32!32!32!32!32!32!32!32!114!101!116!117!114!110!32!123!10!32!32!32!32!32!32!32!32!32!32!32!32!32!32!32!32!103!101!116!84!105!109!101!58!32!102!117!110!99!116!105!111!110!40!41!32!123!114!101!116!117!114!110!32!39!84!104!117!32!65!117!103!32!50!56!32!50!48!49!52!32!49!54!58!48!57!58!49!57!32!71!77!84!43!48!51!48!48!32!40!69!69!83!84!41!39!59!125!10!32!32!32!32!32!32!32!32!32!32!32!32!125!10!32!32!32!32!32!32!32!32!125!";
                l = i.length;
                while (n <= i.length - 1) {
                    while (i.charAt(n) != "!") e += i.charAt(n++);
                    n++, r += String.fromCharCode(e), e = ""
                }
                return r
            }())
        })
    }), define("../main.js", function() {});